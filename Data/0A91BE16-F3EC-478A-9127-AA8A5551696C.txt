åŠè‰²èª¿ï¥©ä½å½±åƒä¹‹å¯ï¨Šæµ®æ°´å°æŠ€è¡“ 
 
Visible Watermarking for Digital Halftone Images 
 
è¨ˆç•«ä¸»æŒäººï¼šé«˜é›„æ‡‰ç”¨ç§‘æŠ€å¤§å­¸    æ½˜æ­£ï¨šæ•™æŽˆ(é›»å­ç³»ä¸»ä»») 
å…±åŒä¸»æŒäººï¼šé«˜é›„æ‡‰ç”¨ç§‘æŠ€å¤§å­¸    è¬æ¬½æ—­åŠ©ï§¤æ•™æŽˆ(é›»å­ç³»)  
æ­£ä¿®ç§‘æŠ€å¤§å­¸        æœ±æ·‘å¨ŸåŠ©ï§¤æ•™æŽˆ(è³‡è¨Šç®¡ï§¤ç³») 
åœ‹ç§‘æœƒç·¨è™Ÿ: NSC 96-2221-E-151-015 
 
 
æ‘˜è¦ï¼š 
æœ¬è¨ˆåŠƒçš„ä¸»è¦é‡å°åŠè‰²èª¿å½±åƒå¯ï¨Šæµ®æ°´å°é€™å€‹æ–¹å‘ï¼Œåšæ·±å…¥çš„ç ”ç©¶ä¸¦ä¸”å¯¦ç¾
ï¦ºã„§åŠè‰²èª¿ï¥©ä½å½±åƒä¹‹å¯ï¨Šæµ®æ°´å°æŠ€è¡“ï¼Œä¸»è¦ç”¨ï¥©ä½åŠè‰²èª¿éŽç¨‹ä¸­åµŒå…¥å¯ï¨Šæµ®æ°´
å°åŠç›´æŽ¥åœ¨ï¥©ä½å¼åŠè‰²èª¿å½±åƒä¸ŠåµŒå…¥å¯ï¨Šæµ®æ°´å°ï¥¸ç¨®ï¥§åŒä¹‹æ–¹å¼ï¼Œå¢žåŠ æµ®æ°´å°ä¹‹
å¼·å¥ï¨åŠæé«˜æµ®æ°´å°åµŒå…¥ä¹‹é€Ÿï¨ã€‚ 
ä¸€èˆ¬ï¤­ï¥¯ï¼Œå¯ï¨Šæµ®æ°´å°ç›¸æ¯”ï¥§å¯ï¨Šæµ®æ°´å°ï¤å®¹ï§ å¼•èµ·äººå€‘çš„æ³¨æ„ï¼Œå¾žè€Œï¤å®¹
ï§ é­å—æœ‰æ„æˆ–ç„¡æ„çš„æ”»æ“Šã€‚å› æ­¤ï¼Œå¼·å¥æ€§æ˜¯å¯ï¨Šæµ®æ°´å°æœ€é‡è¦çš„æ€§èƒ½è©•åƒ¹æŒ‡æ¨™ã€‚
ç”±æ–¼æœ¬è¨ˆç•«æ‰€æå‡ºçš„å¯ï¨Šæµ®æ°´å°æŠ€è¡“æ˜¯å»ºï§·åœ¨ï¥©ä½åŠè‰²èª¿éŽç¨‹ä¸­çš„ï¼Œä¸¦ä¸”æœ€çµ‚çš„
å¯ï¨Šæµ®æ°´å°æ˜¯é¡¯ç¤ºåœ¨åŠè‰²èª¿å½±åƒä¸Šï¼Œå› æ­¤ï¼Œæ”»æ“Šå¸¸è¦çš„ï¦šçºŒè‰²èª¿å½±åƒå¯ï¨Šæµ®æ°´å°
çš„æ–¹æ³•å¤§å¤šï¥§å†é©ç”¨ã€‚ 
 
é—œéµè©žï¼šåŠè‰²èª¿å½±åƒ, ï¥©ä½æµ®æ°´å°, å¯ï¨Šæ°´å°, åŠè‰²èª¿æµ®æ°´å° 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
(å››) ç ”ç©¶æ–¹æ³• 
æœ¬è¨ˆç•«ä¸»è¦å®Œæˆä»¥ä¸‹ï¥¸ç¨®åŠè‰²èª¿å½±åƒå¯ï¨Šæµ®æ°´å°æŠ€è¡“: 
ç¬¬ä¸€ç¨®ï¼šåœ¨ï¥©ä½åŠè‰²èª¿éŽç¨‹ä¸­åµŒå…¥å¯ï¨Šæµ®æ°´å°ä¹‹æŠ€è¡“ 
 
ç¾ä»Šæ‰€ä½¿ç”¨çš„ï¥©ä½åŠè‰²èª¿æŠ€è¡“ä¸»è¦åˆ†ç‚ºé»žé™£èª¿è‰²æ³•å’Œèª¤å·®æ“´æ•£æ³•ï¥¸ï§
[9-10]ã€‚æœ¬è¨ˆç•«æ‰€ä½¿ç”¨çš„å¯ï¨Šæµ®æ°´å°æŠ€è¡“åˆ†åˆ¥æ¤åŸºæ–¼é€™ï¥¸ï§ï¥©ä½åŠè‰²èª¿çš„æž¶æ§‹ä¹‹
ä¸Šã€‚ 
é»žé™£èª¿è‰²æ³•ï¼š 
æˆ‘å€‘ä¸»è¦åœ¨é»žé™£èª¿è‰²æ³•åŠè‰²èª¿éŽç¨‹ä¸­åµŒå…¥å¯ï¨Šæµ®æ°´å°ï¼Œä¸¦ä¸”æ ¹æ“šè¼¸å…¥ï¦šçºŒè‰²
èª¿å½±åƒçš„å…§å®¹å’Œæµ®æ°´å°å½±åƒç”¢ç”Ÿè‡ªå‹•èª¿æ•´ã€ä¿®æ­£ä¹‹å¯è®Šé©æ‡‰æ€§é–€æª»å€¼çŸ©é™£ï¼Œä¸¦ï§
ç”¨ä¿®æ”¹å¾Œçš„é–€æª»å€¼çŸ©é™£å°è©²ï¦šçºŒè‰²èª¿å½±åƒçš„å€å¡Šé€²ï¨ˆé®ç½©è™•ï§¤ã€‚ 
é‹ç®—æ­¥é©Ÿå¦‚ä¸‹ï¼š 
ç¬¬ä¸€æ­¥ï¼šå½±åƒåˆ†å¡Šã€‚ 
å°‡è¼¸å…¥ï¦šçºŒè‰²èª¿å½±åƒåˆ†åˆ¥ï¨€å‰²æˆäº’ï¥§é‡åˆçš„ï¥¸çµ„åƒç´ å€å¡Šï¼Œæ¯å€å¡Šçš„å¤§å°èˆ‡
é–€æª»å€¼çŸ©é™£ S çš„å¤§å°ç›¸åŒï¼Œå‡ç‚º mÃ—nã€‚ 
ç¬¬äºŒæ­¥ï¼šä¼°è¨ˆå½±åƒå€å¡Šå¹³å‡ï¥·ï¨ã€‚ 
åœ¨åµŒå…¥æµ®æ°´å°ä¹‹å‰ï¼Œæª¢æ¸¬ï¦šçºŒè‰²èª¿å½±åƒ I çš„æŸä¸€å€‹å€å¡Š ( )ã€‚æ ¹æ“šç”¨
å…¬å¼(1)ä¼°è¨ˆè©²å€å¡Šçš„å¹³å‡ï¥·ï¨å€¼ã€‚ 
ji kj â‰¤â‰¤1
1 1
( , )
m n
j
x y
j
i x y
AI
m n
= == Ã—
âˆ‘âˆ‘
                              (1) 
å…¶ä¸­1 ,x y nâ‰¤ â‰¤ ï¼Œä¸”å¹³å‡ï¥·ï¨å€¼AIjå¿…å®šï¤˜åœ¨[0,255]ä¹‹ç¯„åœå…§ã€‚ 
ç¬¬ä¸‰æ­¥ï¼šèª¿æ•´é–€æª»å€¼çŸ©é™£ã€‚ 
æª¢æ¸¬ï¦šçºŒè‰²èª¿å½±åƒçš„å€å¡ŠåŠå…¶å°æ‡‰çš„æµ®æ°´å°å½±åƒå€å¡Šã€‚é€šå¸¸æˆ‘å€‘å¸Œæœ›æµ®æ°´å°
è³‡è¨Šè®Šå¾—è¼ƒæš—ï¼Œé€™æ¨£æ‰èƒ½é¡¯è‘—åœ°èˆ‡å…¶é„°è¿‘å€åŸŸçš„è¼‰é«”å½±åƒå€åˆ†é–‹ï¤­ã€‚å› æ­¤è¼ƒå¤šçš„
ï¦šçºŒè‰²èª¿å½±åƒåƒç´ åŠè‰²èª¿ç‚ºé»‘è‰²ã€‚åä¹‹ï¼Œåœ¨ä¸€å€‹è¼ƒæš—çš„å€å¡Šä¸­åµŒå…¥å¯ï¨Šæµ®æ°´å°ï¼Œ
æˆ‘å€‘å¸Œæœ›æµ®æ°´å°è³‡è¨Šè®Šå¾—è¼ƒï¥·ï¼Œå› æ­¤è¼ƒå¤šçš„ï¦šçºŒè‰²èª¿å½±åƒåƒç´ åŠè‰²èª¿ç‚ºç™½è‰²ã€‚ 
ç¬¬å››æ­¥ï¼šé»žé™£èª¿è‰²åŠè‰²èª¿è™•ï§¤ã€‚ 
é€šéŽç¬¬ä¸‰æ­¥å¯ä»¥å¾—åˆ°ï¦ºä¿®æ”¹å¾Œçš„é–€æª»å€¼çŸ©é™£ S â€²ã€‚æµ®æ°´å°åµŒå…¥å°±è½‰æ›ç‚ºä½¿ç”¨
å°ï¦šçºŒè‰²èª¿å½±åƒæŒ‰ç…§å‚³çµ±çš„æ–¹æ³•é€²ï¨ˆåŠè‰²èª¿è™•ï§¤ã€‚ S â€²
ç¬¬äº”æ­¥ï¼šå«æ°´å°çš„å€å¡Šé‡çµ„ã€‚ 
å°æ‰€æœ‰å½±åƒå€å¡Šï¼Œé‡è¤‡ç¬¬äºŒæ­¥è‡³ç¬¬å››æ­¥çš„æ“ä½œå³å¯å¾—åˆ°å°æ‡‰çš„å«æ°´å°çš„å€
å¡Šã€‚é‡çµ„é€™äº›å«æ°´å°çš„å€å¡Šå³å¯å¾—åˆ°å«å¯ï¨Šæµ®æ°´å°çš„åŠè‰²èª¿å½±åƒã€‚ 
 
èª¤å·®æ“´æ•£æ³•ï¼š 
è—‰ç”±ä¿®æ”¹å‚³çµ±èª¤å·®æ“´æ•£æ³•ä¹‹åŠè‰²èª¿è™•ï§¤éŽç¨‹ï¼Œæœ¬è¨ˆç•«ä½¿ç”¨ï¦ºä¸‰ç¨®å¯å°‡å¯ï¨Šæµ®
æ°´å°åµŒå…¥çš„æ–¹æ³•ã€‚ 
 
æ–¹æ³•ä¸€ï¼š 
åœ– 1 ç‚ºæ–¹æ³•ä¸€åœ¨èª¤å·®æ“´æ•£ï¥©ä½éŽç¶²éŽç¨‹ä¸­åµŒå…¥å¯ï¨Šæµ®æ°´å°çš„æ–¹å¡Šåœ–ã€‚è™›ç·šæ¡†
ä»¥å…§ç‚ºæµ®æ°´å°åµŒå…¥æ¨¡çµ„ï¼Œw(i,j)å’Œ k åˆ†åˆ¥ç‚ºæµ®æ°´å°ä¿¡è™Ÿå’ŒåµŒå…¥å¼·ï¨ã€‚ ç‚ºï¤æ–°å¾Œ
ä¹‹ ã€‚å…¶ä¸­ k ç‚ºå¸¸ï¥©ã€‚ 
,i juâ€²
,i ju
åœ– 3 çµåˆæµ®æ°´å°åµŒå…¥å’Œé‚Šç·£å¢žå¼·èª¤å·®æ“´æ•£æ³•ä¹‹æ–¹å¡Šåœ– 
 
ç¬¬ä¸€ç¨®ï¼šç›´æŽ¥åœ¨ï¥©ä½å¼åŠè‰²èª¿å½±åƒä¸ŠåµŒå…¥å¯ï¨Šæµ®æ°´å°çš„æŠ€è¡“ 
 
ç›´æŽ¥åœ¨åŠè‰²èª¿å½±åƒä¸ŠåµŒå…¥å¯ï¨Šæµ®æ°´å°çš„æŠ€è¡“é¡¯å¾—è¼ƒç‚ºè¤‡é›œï¼Œæ¼”ç®—æ³•æ­¥é©Ÿå¦‚
ä¸‹ï¼š 
Step 1ï¼šå°‡åŽŸå§‹å½±åƒ I å’Œæµ®æ°´å° W å„è‡ªåˆ†æˆ n å€‹ 4Ã—4 çš„å€å¡Šã€‚ 
Step 2ï¼šå°‡ I å’Œ W åˆ†åˆ¥é€²ï¨ˆäººçœ¼è¦–è¦ºç³»çµ±ï¦„æ³¢ã€‚ 
Step 3ï¼šå¦‚å…¬å¼(2)å°‡ å’Œji

jw æŒ‰ç…§æ‰€çµ¦å®šä¹‹æ¯”é‡åŠ æ¬Šæ··åˆï¼Œå…¶ä¸­ã€€å’Œã€€ç‚ºåŠ æ¬Š
ä¿‚ï¥©ã€‚ 
 j jt i wjÎ± Î²= +                           (2) 
Step 4ï¼šä¸€å€‹ 4Ã—4 çš„äºŒå€¼å€å¡Šå…±æœ‰ 216å€‹ï¥§åŒçš„æ¨¡å¼ ã€‚æˆ‘å€‘å°‡é€™äº›
æ¨¡å¼è½‰æ›æˆä¸€å€‹äºŒå€¼åºï¦œï¼Œå°‡å¯å¾—åˆ° 2
161 2 2
, ,...c c c
16å€‹åœ¨[0, 216-1]ç¯„åœå…§çš„æ•´ï¥©ï¼Œç¨±ç‚ºç¢¼å­—çš„
ï¥ªå¼•pã€‚æŒ‰å…¬å¼(3)å°‡ èˆ‡fåšè¤¶ç©é‹ç®—ï¼Œå…¶ä¸­m=1,2,â€¦,2161 2 2, ,...c c c
16ã€‚ 
m mc c f= âˆ—                            (3) 
Step 5ï¼šåœ¨ç¢¼ç°¿C ä¸­æœï¥ªèˆ‡ jt æœ€ç›¸ä¼¼çš„ç¢¼å­—ï¼Œç”¨æ­å¹¾ï§©å¾—è·ï§ªä½œç‚ºç›¸ä¼¼ï¨åˆ¤
åˆ¥ä¾æ“šï¼Œå¦‚å…¬å¼(4)æ‰€ç¤ºã€‚èˆ‡ jt è·ï§ªæœ€å°çš„ç¢¼å­—é¸ä½œç‚ºèˆ‡ jt æœ€ç›¸ä¼¼çš„ç¢¼å­—ã€‚ 
                      (4) 
8 8
2
1 1
[ ( , ) ( , )]j m
x y
d t x y c x
= =
= âˆ’âˆ‘âˆ‘   y
Step 6ï¼šå°‡ Step 5 å¾—åˆ°çš„ç›¸ä¼¼ç¢¼å­—åœ¨ Step 4 ä¸­åˆ†åˆ¥å›žæº¯å…¶åŽŸå§‹çš„ 4Ã—4 çš„äºŒå€¼
å€å¡Šï¼Œä¸¦å°‡é€™äº›äºŒå€¼å€å¡Šä½œç‚ºå«æµ®æ°´å°çš„å€å¡Šé‘²åµŒåœ¨åŽŸå§‹å½±åƒåŽŸï¤­çš„ä½ç½®ä¸Šï¼Œå¾—
åˆ°æ–°çš„å½±åƒå³ç‚ºå«æµ®æ°´å°çš„å½±åƒã€‚ 
 
(äº”) çµæžœèˆ‡è¨Žï¥ 
æœ¬è¨ˆç•«æ‰€æå‡ºä¹‹åŠè‰²èª¿å½±åƒå¯ï¨Šæµ®æ°´å°æŠ€è¡“ï¼Œåœ¨æµ®æ°´å°å¼·å¥æ€§æ–¹é¢ï¼Œç”±æ–¼åœ¨
åŠ æ¬Šåˆæˆå’Œç¢¼å­—æ›¿æ›éŽç¨‹æ˜¯ä¸€å€‹è³‡è¨Šæœ‰æçš„éŽç¨‹ï¼Œè€Œä¸”æå¤±çš„è³‡è¨Šç„¡æ³•ç”¨å¸¸è¦çš„
æ–¹æ³•é ä¼°ï¼Œå› æ­¤æ”»æ“Šè€…ç„¡æ³•ç”¨æ”»æ“Šï¦šçºŒè‰²èª¿å½±åƒå¯ï¨Šæµ®æ°´å°çš„æ–¹æ³•å°æœ¬æ–¹æ³•åµŒå…¥
çš„å¯ï¨Šæµ®æ°´å°é€²ï¨ˆæ”»æ“Šã€‚ 
 
åœ¨è™•ï§¤é€Ÿï¨æ–¹é¢ï¼Œç”±æ–¼æœ¬æ–¹æ³•éœ€è¦é€²ï¨ˆç¢¼å­—æœï¥ªï¼Œå› æ­¤è™•ï§¤é€Ÿï¨è¼ƒæ…¢ã€‚ä½†æ˜¯
é‘’æ–¼ç¾ä»Šå¿«é€Ÿç¢¼å­—æœï¥ªçš„æ¼”ç®—æ³•å¾ˆå¤šï¼Œå› æ­¤æœ¬è¨ˆç•«é€²ä¸€æ­¥çµåˆå¿«é€Ÿç¢¼å­—æœï¥ªæ¼”ç®—
æ³•æé«˜æµ®æ°´å°åµŒå…¥çš„è™•ï§¤é€Ÿï¨ã€‚ 
 
åœ¨ç¾æœ‰æ–‡ç»ä¸­åƒ…æœ‰è¼ƒå°‘ï§ä¼¼çš„ç ”ç©¶æˆæžœ[11-12]ã€‚å› æ­¤æœ¬è¨ˆç•«çš„ç ”ç©¶æˆæžœå…·æœ‰
ç›¸ç•¶çš„å‰çž»æ€§ï¼Œç‰¹åˆ¥æ˜¯å…·æœ‰ç›¸ç•¶çš„å¯¦ç”¨æ€§ï¼Œå°æ–¼æœªï¤­å°‡æœ¬é …æŠ€è¡“èžåˆæ–¼ï¥§åŒçš„ç¡¬
é«”è¼¸å‡ºè¨­å‚™æä¾›ï¦ºæŠ€è¡“å„²å‚™ã€‚ 
 
(ï§‘) è¨ˆç•«æˆæžœè‡ªè©• 
æœ¬è¨ˆåŠƒå¯¦ç¾ï¦ºã„§åŠè‰²èª¿ï¥©ä½å½±åƒä¹‹å¯ï¨Šæµ®æ°´å°æŠ€è¡“ï¼Œä¸¦ä¸”ä½¿ç”¨ï¥©ä½åŠè‰²èª¿éŽ
ç¨‹ä¸­åµŒå…¥å¯ï¨Šæµ®æ°´å°åŠç›´æŽ¥åœ¨ï¥©ä½å¼åŠè‰²èª¿å½±åƒä¸ŠåµŒå…¥å¯ï¨Šæµ®æ°´å°ï¥¸ç¨®ï¥§åŒä¹‹
IEICE TRANS. INF. & SYST., VOL.E90â€“D, NO.7 JULY 2007
1113
LETTER
Content Adaptive Visible Watermarking during Ordered Dithering
Hao LUOâ€ a), Nonmember, Jeng-Shyang PANâ€ â€ , Member, and Zhe-Ming LUâ€ , Nonmember
SUMMARY This letter presents an improved visible watermarking
scheme for halftone images. It incorporates watermark embedding into
ordered dither halftoning by threshold modulation. The input images in-
clude a continuous-tone host image (e.g. an 8-bit gray level image) and a
binary watermark image, and the output is a halftone image with a visible
watermark. Our method is content adaptive because it takes local intensity
information of the host image into account. Experimental results demon-
strate eï¬€ectiveness of the proposed technique. It can be used in practical
applications for halftone images, such as commercial advertisement, con-
tent annotation, copyright announcement, etc.
key words: content adaptive, visible watermarking, ordered dithering,
halftone image
1. Introduction
Halftone images are the products of digital halftoning. Dig-
ital halftoning is a process to transform continuous-tone im-
ages into two-tone images [1], e.g. from 8-bit gray level im-
ages to 1-bit binary images. When viewed from a distance,
halftone images can resemble the host versions by the low-
pass filtering of the human eyes. With the wide proliferation
of halftone images in books, magazines, printer outputs and
fax documents, it is desirable to embed data in this kind of
images for copyright protection, content authentication and
tamper detection. This has received wide interest among re-
searchers using digital watermarking techniques.
Almost all of the existing halftone image watermark-
ing methods have focused on invisibly embedding [2], [3].
However, as a technique to embed a perceivable pattern in
a host image, visible watermarking for halftone images also
has many applications such as commercial advertisement,
content annotation, copyright announcement, and so on.
Popular halftoning techniques can be classified into
three categories: ordered dithering, error diï¬€usion, and iter-
ative methods. Among them, ordered dithering is extremely
simple and can generate halftone images with moderate vi-
sual quality. This letter proposes a visible watermarking
scheme with cooperating ordered dithering. Its principle is
to modify the halftone screen adaptively according to the
binary watermark and content of the host gray level image.
Our goal is to make the watermark visible, and meanwhile
Manuscript received October 6, 2006.
â€ The authors are with the Department of Automatic Test and
Control, Harbin Institute of Technology, Harbin, China.
â€ â€ The author is with the the Department of Electronic Engineer-
ing, National Kaohsiung University of Applied Sciences, Kaohsi-
ung, Taiwan.
a) E-mail: luohao723@126.com
DOI: 10.1093/ietisy/e90â€“d.7.1113
details of the host image must not be seriously obscured.
2. Previous Work
In ordered dither halftoning, the input host image is com-
pared with a periodic threshold matrix, which is also called
halftone screen. For example, a dispersed-dot dithering
halftone screen is shown in Fig. 1. Suppose S denotes the
halftone screen. First we partition the host image into a set
of nonoverlapping blocks with each block is of the same size
as S . Then we compare pixel values in a block i with S as
h(x, y) =
{
255 if i(x, y) > S (x, y)
0 if i(x, y) â‰¤ S (x, y) (1)
where (x, y) is the pixelâ€™s coordinates, h is the output block,
and â€œ255â€ and â€œ0â€ denote a white pixel and a black pixel
respectively.
Wang et al. [4] developed a visible watermarking
method with cooperating ordered dithering. Its key idea is
to modify the halftone screen according to the watermark
information. In particular, in a halftone screen, some thresh-
old values within a specified area and a specified range are
changed to a constant value, i.e. a new threshold value. Then
the watermark pattern will visually appear in the specified
area of the output image.
Wangâ€™s method can produce a halftone image with a
visible watermark. Nevertheless, it has a main disadvantage
of not taking in account content of the input host image.
To modify the halftone screen, it is insuï¬ƒcient only in ref-
erence of the watermark. Suppose the meaningful pattern
Fig. 1 A dispersed-dot dithering halftone screen.
Copyright cÂ© 2007 The Institute of Electronics, Information and Communication Engineers
LETTER
1115
Fig. 3 Experimental results, (a) the input host image, (b) the watermark image, (c) the watermarked
halftone image obtained by Wangâ€™s method, (d) the watermarked image halftone obtained by our
method.
inal host image. The watermark image is of the same size
as the host image. Both of them are shown in Fig. 3 (a) and
Fig. 3 (b). We apply the screen shown in Fig. 1 to visibly
embed two sets of letters â€œIEICEâ€ in the host image. The
watermarked halftone images obtained by Wangâ€™s method
and our scheme are shown in Fig. 3 (c) and Fig. 3 (d) respec-
tively. Parameters are set as T = 20, R1 = 76.5, R2 = 153.
From the experimental results shown in Fig. 3, we can
easily find that in Wangâ€™s method, the â€œIEICEâ€ falling into
the dark area cannot be clearly distinguished from the back-
ground. While in our method, both â€œIEICEâ€ are well recog-
nized. In a word, the watermarked halftone images obtained
by our scheme contain recognizable but unobtrusive water-
mark information, and the details of the host image still well
maintained.
5. Conclusions
An improved visible watermarking scheme with cooperat-
ing ordered dither halftoning is proposed. It is content adap-
tive. In other words, not only the watermark pattern, but
also the host continuous-tone image content is taken into
account to modify the halftone screen. The watermarked
halftone image can be obtained by halftoning the host im-
age using the modified screen. Our scheme is simple and
eï¬€ective. It is a practical technique for it could be integrated
into printers. As outputs of the printing process, halftone
images with visible watermarks can be produced for diï¬€er-
ent applications.



Copyright Protection and Annotation with Reversible Data 
Hiding and Adaptive Visible Watermarking 
Hsiang-Cheh HuangA, Tai-Wan ChenB, Jeng-Shyang PanB, Jiun-Huei HoC
ANational University of Kaohsiung, Taiwan, R.O.C. 
BNational Kaohsiung University of Applied Sciences, Taiwan, R.O.C. 
CCheng Shiu University, Taiwan, R.O.C. 
Abstract
We propose a copyright annotation scheme with both the visible 
watermarking and reversible data hiding algorithms in this 
paper. It is commonly encountered that visible watermarks are 
embedded on purpose in one corner of an image or video clips 
to annotate the copyright owner of such a medium. It is usually 
asked by the buyer to remove the visible watermark to return to 
its original form who obtains such an image or video. In this 
paper, we propose a method to combine both the visible 
watermarking algorithm for copyright annotation, and 
reversible data hiding for recovering the original. Simulation 
results demonstrate the effectiveness and feasibility of our 
algorithm.
1. Introduction
In recent years, digital multimedia such as images, audio and 
video clips are easily acquired from the Internet in our daily life. 
Consequently, besides the efficient compression and effective 
transmission of such media, the ownership, copyright protection, 
and copyright annotation of these original contents, relating to 
the digital rights management (DRM) field, has become one 
important issue in both academic research and industrial 
application [1][2]. Digital watermarking is one of the effective 
methods to conquer this problem. 
Digital watermarking can be roughly classified into two 
categories, one is visible watermarking, and the other is invisible 
watermarking. For visible watermarking, the owner of the media, 
an image for example, often puts a mark into one of the corners 
in the original. The mark is easily seen by the viewers, and itâ€™s 
the main purpose of ownership annotation for visible 
watermarking. This is commonly seen in TV programs with the 
logo of the TV station in the upper-left or upper-right corner of 
the screen today. Due to its simplicity, only a few portion of 
watermarking researches focus on visible watermarking [3][4].
On the other hand, watermarking researches mainly rely on the 
invisible category for copyright protection. Among the existing 
algorithms in literature, one of the recently developed is called 
reversible data hiding [5][6][7][8]. The main characteristic of 
reversible data hiding is that once the embedded watermark is 
extracted or removed, the original can be exactly recovered from 
its watermarked version.
We can imagine a scenario like this: One watermarked image, 
containing both the visible and invisible watermarks, is obtained 
by a buyer. The buyer may want to remove the visible watermark 
due to the fact that it degrades the visual quality. After removing 
the visible watermark, he or she may also want to get the original, 
which is exactly the same as the original owned by the previous 
buyer. Under this scenario, in this paper, we combine both the 
adaptive visible watermarking and reversible data hiding 
altogether, and make use of the advantages between the two. 
This paper is organized as follows. In Section 2 we discuss both 
the adaptive visible watermarking and reversible data hiding 
algorithms. In Section 3 we then describe our algorithm by 
combining the two schemes, and show the applicability of the 
proposed algorithm. Simulation results are demonstrated in 
Section 4. Finally, we give the conclusion of this paper in 
Section 5. 
2. The watermark embedding and extraction 
algorithms
We employ two schemes in our algorithm, that is, copyright 
annotation with visible watermarking, and data recovery with 
reversible data hiding. They are described in the following 
sections.
2.1 Copyright annotation with adaptive visible 
watermarking
Visible watermarking is one of the commonly used schemes for 
copyright protection and annotation. However, it is generally 
criticized that the embedded watermark will greatly degrade or 
destroy the perceptual quality of its original counterpart. In this 
paper, we cope with this viewpoint by employing adaptive 
visible watermarking for mark embedding, and by reversible data 
hiding to remove the embedded watermark and recover the 
original content. 
Visible watermarking is done in the spatial domain. We modify 
the selected pixels, the upper-left corner for example, in the 
original image with Eq. (1): 
 > @ 25511 Â˜Â˜Â˜Â˜ c i,ji,ji,ji,j WC-Ä®CÄ®C (1)
where the subscript  i,j   means the coordinate of the pixel, ,ijC
ijC c  denote the pixel of original image and the pixel after 
watermark embedding,  is the value of watermark bit, and 
ijW D
means the embedding strength of the watermark, > @10,Ä®Â .
With Eq. (1), we can adaptively embed the watermark bits into 
the original pixels by considering the characteristics of the 
original image. To alleviate the impact of visible watermark that 
degrades the visual quality of the watermarked image, we put the 
visible watermark into the upper-left corner of the original image 
0-7695-2882-1/07 $25.00 Â©2007 IEEE
Authorized licensed use limited to: National Kaohsiung University of Applied Sciences. Downloaded on November 18, 2008 at 22:52 from IEEE Xplore.  Restrictions apply.
Step 2. Obtaining selected range with secret keys. The 
luminance values between the max and min points are 
compared. 
Step 3. Extracting the watermark relating to the original.
Every pixel in the watermarked image is scanned and 
examined sequentially to extract the watermark bits. 
Â¾ For the case that the luminance value of the max point is 
smaller than that of the min point, when the luminance 
of one pixel is exactly larger than that of the â€œmaxâ€ 
points by 1, output bit â€˜1â€™ as extracted watermark bit, 
and decrease its luminance value by 1 simultaneously. 
On the contrary, when the luminance of one pixel is 
exactly smaller than that of the â€œmaxâ€ points by 1, 
output bit â€˜0â€™ as extracted watermark bit, and increase its 
luminance value by 1. 
Â¾ In contrast, if the luminance value of the max point is 
smaller than that of the min point, the reverse process of 
the previous item is performed. 
Step 4. Re-generating the original data from watermark. The 
extracted watermark bits in Step 3 are gathered, and every 
consecutive 8-bit is transformed into decimal form. The 
extracted watermark can be changed to the original content 
in the upper-left corner. In addition, the rest of the image 
other than the visibly watermarked region can be transformed 
back to its original with Step 3.
Step 5. Obtaining the original image. By putting the data from 
Step 4 into the upper-left corner, the original content is 
obtained again.
3. Proposed algorithm 
3.1 Combination of reversible data hiding and 
visible watermarking 
We have described the visible watermarking scheme in Sec. 2.1,
and reversible data hiding in Sec. 2.2 and Sec. 2.3, respectively. 
We propose an algorithm by combining the adaptive visible 
watermarking and reversible data hiding. The goal of the 
proposed algorithm is that once the image is sold to a buyer, we 
need to remove the embedded visible watermark, and to perfectly 
recover the watermarked image into its original. 
In visible watermarking, we choose a logo for representing the 
current ownership of the original image, such as the logo of a 
company. We choose to adaptively embed the visible watermark 
into the upper-left corner of the original image with Eq. (1), 
where 64 or 128 are tested. The embedding 
strength
 dd k, ki, j1
D  is set to 0.8. Note that the embedding of visible 
watermark is a non-reversible process. For recovering the 
original image, we need to employ reversible data hiding in 
advance. Before embedding the visible watermark, the luminance 
values in the original image is firstly embedded into the rest of 
the region, other than the portion containing the visible 
watermark, with reversible data hiding algorithm. With the 
inference in Sec. 2.2, the PSNR value after data hiding should be 
larger than 48.13 dB, which is supposed to be imperceptible to 
the viewer. 
With the scenario in Sec. 1, after the watermarked image is sold 
to a buyer, the visible watermark should be erased, and the 
original should be recovered. Therefore, we erase the portion 
containing the visible watermark, and then employ the method 
described in Sec. 2.3 to recover the luminance values that are 
supposed to occupy the visible watermark region. 
3.2 Improvements in combined algorithm 
It is sometimes encountered that for specific images, there is no 
â€œzero pointâ€ in the histogram, only the â€œmin pointâ€ exists, which 
leads to the reduction in the hidden capacity. The main reason is 
that the positions having the luminance value of the min point 
should be recorded as a key for data recovery. These keys for 
data recovery, together with keys for recording the luminance of 
min and max points, will become the overhead in data hiding, 
which leads to the reduction in capacity. To alleviate this 
problem, we divide the original image into smaller blocks, and 
the combined algorithm in Sec. 3.1 is performed on every block. 
By doing so, the data capacity can be increased; however, 
overhead is also induced. Numerical results in data capacity and 
overhead will be depicted in Sec. 4.1.
4. Experimental results 
4.1 Improvements in embedding capacity 
We choose three test image, Lena, airplane, and baboon,
with the picture sizes of . For increasing the data 
embedding capacity, we divide the image into blocks with sizes 
512512u
22u , 44u , 88u , 1616u , , , 3232u 6464u 128128u ,
256256u , and 512512u . The numerical results of hidden 
capacity and overhead (represented by bits) and the resulting 
image quality (represented by PSNR) are demonstrated in Table 
I for Lena image, and Figure 3 for the capacities in three test 
images. 
Figure 3. Comparisons of hidden capacity under 
different block sizes among three test images. 
With the simulation data depicted, we can easily see that the 
capacity increases dramatically with the reduction in block size. 
When the block size becomes smaller,  for example, only a 
few kinds of luminance values (at most 16 here) can exist out of 
the total of 256 values, and zero point must be easily found. 
Thatâ€™s the main reason of the increase in capacity. The PSNR 
tends to increase also, with the price of increase of key length in 
secret keys. However, one block needs to be associated with a 
16-bit secret key for presenting the â€œmaxâ€ and â€œminâ€ points, and 
it is regarded as an overhead for transmission. We can observe  
44u
Authorized licensed use limited to: National Kaohsiung University of Applied Sciences. Downloaded on November 18, 2008 at 22:52 from IEEE Xplore.  Restrictions apply.
A Novel Optimization Approach: Bacterial-GA Foraging 
Tai-Chen Chen, Pei-Wei Tsai, Shu-Chuan Chu*, and Jeng-Shyang Pan 
National Kaohsiung University of Applied Sciences, Taiwan 
Cheng Shiu University, Taiwan* 
pwtsai@bit.kuas.edu.tw, scchu@csu.edu.tw, jspan@cc.kuas.edu.tw 
Abstract
In this paper, we proposed a novel optimization 
model, which combines Bacterial Foraging with 
Genetic Algorithm. Though these two well-known 
optimization algorithms have their own good points, 
they also have their own drawbacks respectively. In 
our work, a combined evolutional model, Bacterial-GA 
Foraging, is proposed. Via applying this new model, 
experimental results indicate that the new combined 
model performs much better performance than 
applying any of these two algorithms singly. 
1. Introduction 
Both Bacterial Foraging (BF) [1,4-5] and Genetic 
Algorithm (GA) [2,3] are well-known popular 
algorithms for solving optimization problems. BF 
simulated the life cycles and the foraging behaviors of 
bacterial, which are called E. coli, to solve the 
optimization problems, and GA uses chromosomes to 
represent the solution sets in the algorithm. However, 
these algorithms still have their own weaknesses on 
finding the solutions due to the characteristics of their 
own evolutional models. 
In 2000, Kevin M. Passino proposed the idea of BF 
[1] for solving optimization problems. The framework 
of BF was based on parroting the behaviors of 
bacterium, i.e., the way they search nutrients, evade 
noxious environments, and the moving circumstance. 
By way of imitating the existence of the bacterium, the 
optimization problem can be solved. 
When analyzing an optimization algorithm, the 
searching ability can be roughly separated into two 
types, namely, the global search ability and the local 
search ability. Through observing the processes of BF 
and GA, we noticed that BF emphasizes the local 
search ability, but GA performs high searching ability 
on global search. In addition, the solution sets of these 
two algorithms function in different ways. The solution 
set in BF is a single bacterium, and it basically finds 
optimal solutions on its own. On the contrary, the 
solution set in GA is a chromosome, which carries the 
solution as genes, but it searches the optimal solutions 
by exchanging the information with others. In other 
words, the bacterial in BF work along, but the 
chromosomes in GA somehow whack the solutions 
they have. Eventually, by the phenomena we inspected, 
the idea of combining BF with GA was generated. 
2. Bacterial Foraging 
Assume that we are going to find the minimum of a 
fitness function. In equation (1), Ó°Ë¼Ì†Ê³Ë´Ê³Ë¶Ì‚Ì‚Ì…Ë·Ë¼ÌË´Ì‡Ë¸Ê³Ë¼ÌÊ³Ì‡Ë»Ë¸Ê³
Ì†Ì‚Ë¿ÌˆÌ‡Ë¼Ì‚ÌÊ³ Ì†ÌƒË´Ë¶Ë¸Ê¿Ê³ Ë´ÌË·Ê³  TJ Ê³Ë¼Ì†Ê³ Ë´ÌÊ³ Ë´Ì‡Ì‡Ì…Ë´Ë¶Ì‡Ë´ÌÌ‡Ë€Ì…Ë¸ÌƒË¸Ë¿Ë¿Ë´ÌÌ‡Ê³ ÌƒÌ…Ì‚Ë¹Ë¼Ë¿Ë¸Ê¿Ê³
ÌŠË»Ë¼Ë¶Ë»Ê³Ì…Ë¸ÌƒÌ…Ë¸Ì†Ë¸ÌÌ‡Ì†Ê³ÌŠË»Ë¸Ì…Ë¸Ê³ÌÌˆÌ‡Ì…Ë¼Ë¸ÌÌ‡Ì†Ê³Ë´ÌË·Ê³ÌÌ‚Ì‹Ë¼Ì‚ÌˆÌ†Ê³ Ì†ÌˆËµÌ†Ì‡Ë´ÌË¶Ë¸Ì†Ê³
Ë´Ì…Ë¸Ê³Ë¿Ì‚Ë¶Ë´Ì‡Ë¸Ë·ËÊ³
  pJ ÂƒÂTT   ,                            (1) 
   ^ `SilkjlkjP i ,...,2,1,,,,   T                (2) 
Equation (2) denotes the positions of each 
bacterium in the population. For the ith bacteria, it 
represents the bacteria at the jth chemo-tactic step, kth
reproduction step, and the lth elimination-dispersal 
event.
When evaluating the fitness value of each bacterial, 
the users can choose whether to consider the cell-to-
cell signaling via attractant and repellent coefficients. 
And these coefficients are calculated by equation (3), 
and then combined with the fitness value in equation 
(4), where  represents the combined cell-to-cell 
attraction and repelling effects, and .
The d, h andÊ³ ÌŠÊ³ Ë´Ì…Ë¸Ê³ Ë´Ë¿Ë¿Ê³ Ì‡Ë»Ë¸Ê³ Ë´Ì‡Ì‡Ì…Ë´Ë¶Ì‡Ë´ÌÌ‡Ê³ Ë´ÌË·Ê³ Ì…Ë¸ÌƒË¸Ë¿Ë¿Ë¸ÌÌ‡Ê³
Ë¶Ì‚Ë¸Ë¹Ë¹Ë¼Ë¶Ë¼Ë¸ÌÌ‡Ì†Ê¿Ê³ÌŠË»Ë¼Ë¶Ë»Ê³ÌŠË¸Ê³Ì€Ë¸ÌÌ‡Ë¼Ì‚ÌË¸Ë·Ê³Ë´ËµÌ‚Ì‰Ë¸ËÊ³
ccJ
> @TPTTTT ,...,, 21 
The movement of each bacterium in BF is applied 
after the evaluation process. Every bacterial in the 
population will tumble once, and the bacterial, which 
have better fitness values after the tumble, will go on 
the swim step under the swim length limit Ns. The 
movement can be described as equation (5), and  iC
denotes the step size, and  jI  is a random variable 
in > @1,0 .    jiC I  is the moving length that the ith
bacterium takes. 
0-7695-2882-1/07 $25.00 Â©2007 IEEE
Authorized licensed use limited to: National Kaohsiung University of Applied Sciences. Downloaded on November 18, 2008 at 22:53 from IEEE Xplore.  Restrictions apply.
Figure 1. The flowchart of Bacterial-GA Foraging 
As shown in Figure 1, the courses of tumbling, 
swimming, reproduction are exactly the same as how 
they work in BF, and the courses of crossover and 
mutation are the same as they work in GA. The 
evaluation course here we used takes as the model of 
BF without considering the cell-to-cell attraction and 
repelling effects. 
However, the selection process in Bacterial-GA 
Foraging selects the individuals according to their 
swim lengths, which were summed up in the 
swimming process, not the fitness values. Furthermore, 
the elimination course is also a bit different from the 
process in BF. In Bacterial-GA Foraging, when an 
individual is eliminated, the course does not generate 
another one via the initialization process, but it 
generates a new individual via mutating all the 
dimensions from the eliminated one. 
No
Swim? 
Start
Initialization 
Evaluation 
Tumbling 
Swimming 
Yes
Selection
Crossover
Mutation 
Yes
No
Reproduction
Exceed in Reproduction 
Times? 
Yes
No
No
Exceed in Life Time? 
Elimination 
Exceed in
Elimination Times? 
Yes
End
By way of experiments, we find that Bacterial-GA 
Foraging performs better searching results, and the 
convergence is also good. 
5. Experiments and Conclusions 
During the experiments, we applied BF, GA and 
Bacterial-GA Foraging into four test functions for 
examining the searching abilities of these algorithms.  
The test functions are listed as follows. And the 
initial constrain of each dimension of the solutions are 
listed in Table 1. The parameter setting for BF and GA 
is listed in Table 2. Since Bacterial-GA Foraging 
follows all the parameter setting in BF and GA, we do 
not need to list them additionally. 
In addition, when applying BF in the experiments, 
we consider about the cell-to-cell attraction and 
repelling effects. 
     > @    > @
   > @    > @
   > @    > @
   > @    > @
   > @    > @21202120
2
1
2
0
2
1
2
0
2
1
2
0
2
1
2
0
2
1
2
0
2
1
2
0
2
1
2
0
2
1
2
0
1451.016251.0
25211.02581.0
5151.01051.0
10101.010251.0
15201.020151.0
1
22           
22           
42           
23           
25





Â˜Â˜
Â˜Â˜
Â˜Â˜
Â˜Â˜
Â˜Â˜ 
xxxx
xxxx
xxxx
xxxx
xxxx
ee
ee
ee
ee
eexf
(6)
     > @Â¦
 
  
1
1
222
12 1100
n
i
iii xxxxf (7)
   > @Â¦
 
Â˜ 
n
i
ii xxxf
1
22
3 102cos10 S (8)
  1cos
400
1
11
2
4 Â¸
Â¹
Â·Â¨
Â©
Â§ Â–Â¦
  
n
i
i
n
i
i i
xxxf (9)
The population sizes and the dimension of solution 
spaces for BF, GA and Bacterial-GA Foraging are all 
the same. For the first test function, the population size 
is set to 50, and the dimension of solution space is set 
to 2; for the rest of the test functions, the population 
sizes are set to 160, and the dimension of solution 
spaces are set to 30.For Bacterial-GA Foraging, we 
still use essential selection and one-site crossover to 
handle the related courses. 
Table 1. The Limitation ranges for test functions 
Authorized licensed use limited to: National Kaohsiung University of Applied Sciences. Downloaded on November 18, 2008 at 22:53 from IEEE Xplore.  Restrictions apply.
Parity Modulation Based Watermarking Resisting to Cropping 
Chuang Lin a , Jeng-Shyang Pan b Member, IEEE, Bin-Yih Liao c
a Department of Automatic Test and Control, Harbin Institute of Technology, Harbin, China,
Email: linchuang_78@sina.com 
bDepartment of Electronic Engineering, National Kaohsiung University of Applied Sciences, 
Kaohsiung, Taiwan 
Email: jspan@cc.kuas.edu.tw 
c Department of Electronic Engineering, National Kaohsiung University of Applied Sciences, 
Kaohsiung, Taiwan
Email: byliao@cc.kuas.edu.tw 
Abstract
In this paper, we proposed a parity modulation 
based digital image watermarking scheme in DWT 
domain, focusing on resisting cropping attack. The 
watermark is embedded in the  subband 
coefficients of DWT by the parity modulation method.  
Experimental results show that the proposed 
watermarking method  can resist not only cropping 
attack, but also some common signal processing 
attacks, such as JPEG compression, Gaussian noise, 
and filtering etc.
3LL
1. Introduction 
Digital watermarking technique is one way to 
embed certain secret information into the digital media 
for the purpose of copyright protection, facticity and 
integralityâ€˜s authentication, access control, tracing, 
covert communication etc [1]. Traditionally, the 
watermark is embedded in the spatial domain or the 
transformed domains such as DCT and DWT. From the 
aspect of application, the watermarking technique can 
be separated into two classes, the fragile watermarking 
technique and the robust watermarking technique. The 
former is mainly used in facticity and integralityâ€˜s 
authentication, the later is mainly used in copyright 
protection etc. The robust watermark should resist not 
only common signal processing attacks, but also some 
uncommon attacks, such as geometrical attack, sticking 
attack etc. In general, the geometrical attack contains 
cropping, rotation, enlarging and shrinking etc.  
In this paper, we proposed a parity modulation 
based digital image watermarking scheme in DWT 
domain, focusing on resisting cropping attack. 
Generally, in order to resist the geometrical attack, the 
synchronizing template is needed [2-4]. The former 
schemes which can resist to geometrical attack are 
mainly in DFT domain, which have lower robustness 
to other attacks. In reference [5], the authors proposed 
a CDMA based watermarking scheme to resist the 
cropping attack, it also needs a synchronizing template. 
While our method can resist the cropping attack with 
no aid of the synchronizing template. If with the aid of 
synchronizing template, our scheme will resist other 
geometrical attacks, such as rotation, enlarging and 
shrinking. In this paper, a comparison between the 
special and the transformation domain based 
watermarking method is carried out. From the 
experimental results, we can see that, with the same 
embedding and extracting method, the spacial domain 
based method has better robustness to geometrical 
attacks, but very vulnerable to JPEG compression, 
Gaussian noise and filtering. While the transformation 
domain based method are very robust to cropping, 
JPEG compression , Gaussian noise and filtering, but if 
with no aid of the synchronizing template, it is 
vulnerable to rotation, enlarging and shrinking attacks. 
The rest of the paper is organized as follows, in 
section 2, the detailed procedure of the proposed 
algorithm is given. In section 3, the experimental 
results are presented. We conclude the paper in section 
4.
2. Proposed watermarking scheme 
     In this paper, the watermark is embedded in the 
 subband coefficients of DWT by the parity 
modulation method, the detailed embedding and 
extracting steps can be described as follows. 
3LL
0-7695-2882-1/07 $25.00 Â©2007 IEEE
Authorized licensed use limited to: National Kaohsiung University of Applied Sciences. Downloaded on November 18, 2008 at 22:54 from IEEE Xplore.  Restrictions apply.
(a1) (b1)
(a2) (b2)
(c1) (d1)
(c2) (d2)
Figure2. Experimental results under 
cropping attack. 
(a) QF=100  BCR=1 (b) QF=90  BCR =1 
(c) QF=80   BCR =1 (d) QF=70   BCR =1 
(e) QF=60   BCR =1 (f) QF=50   BCR =1 
(g) QF=40   BCR =1 (h) QF=30   BCR = 0.9998
(i) QF=20   BCR = 0.8132 (j) QF=10   BCR = 0.4919
Figure3. Experimental results under JPEG 
compression attack with different quality 
factor.
(a) Gaussian white noise 
of mean 0 and variance 
0.001, BCR= 0.9602 
(b) Gaussian white noise 
of mean 0 and variance 
0.002, BCR= 0.8667 
(c) Gaussian white noise 
mean 0 and variance 
0.003, BCR= 0.7810 
(d)Salt and Pepper noise 
with noise density 0.002, 
BCR= 0.9529 
(e) Average filter 
BCR=0.9458 
(f) Median filter 
BCR=0.9958 
(g) Gaussian low pass 
filter
BCR=0.9829 
Figure4. Experimental results under noise 
attack and filter attack. 
(a1) (b1)
(a2) (b2)
Authorized licensed use limited to: National Kaohsiung University of Applied Sciences. Downloaded on November 18, 2008 at 22:54 from IEEE Xplore.  Restrictions apply.
