use the NH-LDPC codes in encrypted data transmission, 
where the target syndrome b is used as the secret key 
(available only to legitimate users) for encryption 
and decryption. One problem is that, even without the 
knowledge of b, an illegitimate user can still 
demodulate a codewordâ€™s systematic part, albeit with 
a much higher error probability than legitimate ones. 
To counter this problem, a descrambler is 
incorporated at the receiver to magnify the effect of 
the errors from demodulation so that the illegitimate 
user can not obtain intelligible information content. 
Simulations show thatthe proposed joint coding-
encryption scheme works well as long as the channel 
signal-to-noise ratio (SNR) is properly controlled to 
lie within a specific range. 
è‹±æ–‡é—œéµè©ï¼š parity check matrix, nonhomogeneous LDPC codes,target 
syndrome, joint coding-encryption, secret key, 
descrambler. 
 
even number
of 1â€™s
0










ğ‘Ÿ1ğ‘šğ‘›





	
	
	
	
	

ğ‘Ÿ1ğ‘šğ‘›= Prob( odd number of
1â€™s in other branches)
(a) ğ‘ğ‘š=0
odd number
of 1â€™s
1










ğ‘Ÿ1ğ‘šğ‘›





	
	
	
	
	

ğ‘Ÿ1ğ‘šğ‘›= Prob( even number of
1â€™s in other branches)
(b) ğ‘ğ‘š=1
Fig. 1. Computation at the check node, (a)ğ‘ğ‘š = 0 (b)ğ‘ğ‘š = 1
target syndrome is that Hx is the syndrome and x is a
codeword if and only if its syndrome hits the target, which is b.
The members, expressed in the form of ğ‘›-component column
vectors, in ğ’ are codewords. Obviously, nonhomogeneous
LDPC codes include conventional LDPC codes as a special
case, wherein the target syndrome is set to be the zero vector
in GF(ğ‘)ğ‘šÃ—1.
Next, let us describe how to carry out encoding and de-
coding for nonhomogeneous LDPC codes. The decoding is
presented first. Then, the encoding follows.
A. Decoding of nonhomogeneous LDPC codes
Decoding of NH-LDPC codes is almost the same as homo-
geneous LDPC codes. Here let us adopt the notations ğ‘Ÿğ‘¥ğ‘šğ‘› and
ğ‘ğ‘¥ğ‘šğ‘› from MacKay and Nealâ€™s paper [7], where ğ‘š and ğ‘› are
indices to the check nodes and the variable nodes, respectively.
We want to admit that our use of the notations ğ‘š and ğ‘› is
a little inconsistent (but convenient, in the sense of taking
advantage of MacKay and Nealâ€™s paper [7]). They are indices
to the check/variable nodes in this subsection (i.e. Sec. II-A),
but they are the parameters describing the size of the PCM H
in any other part of this paper. Returning to the decoding issue,
the only modification needed for the NH-LDPC decoding is
to change the second half of the â€œHorizontal stepâ€ (i.e. belief
propagation from check node ğ‘š to variable node ğ‘›) in [7] into
set ğ‘Ÿ0ğ‘šğ‘› =
{
(1 + ğ›¿ğ‘Ÿğ‘šğ‘›)/2 , if ğ‘ğ‘š = 0 ,
(1âˆ’ ğ›¿ğ‘Ÿğ‘šğ‘›)/2 , if ğ‘ğ‘š = 1 , (2)
and ğ‘Ÿ1ğ‘šğ‘› = 1 âˆ’ ğ‘Ÿ0ğ‘šğ‘›, where ğ‘ğ‘š is the ğ‘šth component of the
target syndrome b. ğ‘ğ‘š can also be interpreted as the intended
check sum at the ğ‘šth check node. Graphically interpreted as
the check node in the Tanner graph [8], the effect of ğ‘ğ‘š being
0 or 1 is shown in Fig. 1. The â€œVertical stepâ€ (i.e. belief
propagation from a variable node to a check node) in [7],
which computes ğ‘ğ‘¥ğ‘šğ‘›, remains the same for the NH-LDPC
decoding. Iterative belief propagation between the â€œVertical
stepâ€ and the new â€œHorizontal stepâ€ (i.e. Eq. (2)) produces
the decoded codeword.
B. Encoding of nonhomogeneous LDPC codes
In encoding a message word into a codeword of an NH-
LDPC code, so far we have been successful only for the
systematic fashion. More precisely speaking, the codeword x
consists of two parts: s and p, which are the (ğ‘› âˆ’ ğ‘š) Ã— 1
message vector and the ğ‘š Ã— 1 parity vector, respectively.
Furthermore, the PCM H is splitted into two submatrices H1
(of size ğ‘š Ã— (ğ‘› âˆ’ğ‘š)) and H2 (of size ğ‘š Ã—ğ‘š) so that the
code defining condition (i.e. the condition that defines C in
Eq (1)) can be rewritten as
Hx =
[
H1 H2
] [ s
p
]
= b (3)
Rearranging Eq.(3) and assuming that H2 is nonsingular, we
obtain the equation for computing the parity check vector:
p = Hâˆ’12 (bâˆ’H1s) . (4)
Obviously, here the nonsingularity of H2 is a key constraint.
In addition, since H2 is part of the PCM of a LDPC code, it
should be sparse and free of 4-branch cycles (usually referred
to as â€œcycle-4 freeâ€). The design for a nonsingular, sparse,
and cycle-4 free matrix is not a trivial issue. We describe our
approach for generating such a matrix in the next subsection.
C. PCM for systematic nonhomogeneous LDPC codes
It is well known that short cycles, especially cycles consist-
ing of 4 branches, in a PCMâ€™s corresponding Tanner graph lead
to poor decoding performance (measured in BER (bit error
rate)). Therefore, we must use cycle-4 free PCMâ€™s in LDPC
codes. A necessary condition for the PCM H = [H1 H2]
(as defined in Eq. (3)) to be cycle-4 free is that H2 should
be cycle-4 free. In addition, we learned that H2 must be
nonsingular from Sec. II-B. Our proposal is to impose the
circulant structure on H2, with three 1â€™s on each row, to
simplify its design. More precisely speaking, let the first row
of H2 have nonzero elements (i.e. 1â€™s) only at positions 1,
1 + ğ›¿1, 1 + ğ›¿1 + ğ›¿2, where ğ›¿1 and ğ›¿2 are positive integers,
and 1 + ğ›¿1 + ğ›¿2 â‰¤ ğ‘š. From the second row on, any row is
obtained by circulantly shifting the row immediately above
to the right. If there are even number of 1â€™s in one row of
H2, then its determinant is 0 (because summing all column to
the rightmost column produces an all-zero column). If there
are odd number of 1â€™s randomly placed in one row of H2,
it is observed then that H2 has about a 50% chance of being
nonsingular. As to the issue of avoiding length-4 cycles in H2,
we can apply the following theorem:
The H2 as constructed above is cycle-4 free if and only if
2Î”1 +Î”2 âˆ•= ğ‘š for all of the three choices of (Î”1,Î”2):
(Î”1,Î”2) = (ğ›¿1, ğ›¿2), (ğ›¿2,ğ‘š âˆ’ ğ›¿1 âˆ’ ğ›¿2), and (ğ‘š âˆ’ ğ›¿1 âˆ’
ğ›¿2, ğ›¿1).
After H2 has been constructed, the next step is to construct
H1. In the construction of H1, the only criterion is that it
does not result in any length-4 cycles in H. Since H1 is also
sparse, avoiding length-4 cycles in H is not difficult. We start
by randomly placing ğœ†âˆ’3 1â€™s in the first of row of H1, where
ğœ† is the row-weight of H. Then, another ğœ†âˆ’3 1â€™s are randomly
placed into the second row of H1. We then check whether any
length-4 cycle exists in H. If yes, we randomly shift some of
the 1â€™s in this row of H1 to its neighboring positions and
recheck the cycle-4 condition. Since H is sparse, repeating
354
Alice
m ğœ‹ m
â€²
Segmentor 
t1
t2
tğ¿
	t Scrambler 
s = At
NH-LDPC
Encoder
x =
[
s
p
]
Channel
x
â€² =
[
sâ€²
pâ€²
]

(sË†E)
NH-LDPC
Decoder
sË†BDescrambler
tË†B
(tË†E)
tË†E = A
âˆ’1sË†E
tË†B = A
âˆ’1sË†B
t1
t2
tğ¿
	DesegmentorË†m
â€²
B
(mË†â€²E)
Bob
Eve
mË†Bğœ‹âˆ’1
(mË†E)
Fig. 4. The joint coding-encryption scheme
10âˆ’8 10âˆ’7 10âˆ’6 10âˆ’5 10âˆ’4 10âˆ’3 10âˆ’2 10âˆ’1 100
10âˆ’5
10âˆ’4
10âˆ’3
10âˆ’2
10âˆ’1
100
O
ut
pu
t B
ER
Input BER
Fig. 5. Transfer characteristics of the descrambler
BER of tË†E (at the descrambler output) is much higher than the
BER of sË†E. Through proper setup for the channel SNR (signal-
to-noise power ratio) to get a medium-to-low BER of sâ€², we
can drive the BER of tË†E to be so high that tË†E becomes totally
unintelligible. As to Bob, he can properly perform the NH-
LDPC decoding because he knows b. Therefore, the decoded
result of s, which is denoted as sË†B in Fig. 4, has a very
low BER as long as the channel SNR is not very low. Then,
even after the error magnification effect, the descrambled data
sequence tË†B still has a very low (or at least acceptable) BER.
There can be various ways to implement the scram-
bler/descrambler pair. In this paper, we choose to use random
but invertible matrices for them. Shown in Fig. 5 is the
transfer characteristics (i.e. output BER vs. input BER) for
a descrambler of length 255. In other words, the Aâˆ’1 in
Fig. 4 is a 255 Ã— 255 matrix. In this figure, we see that this
descrambler magnifies the BER by a factor of approximately
127.5 (= 255/2) for very low input BER.
IV. SIMULATION ON ENCRYPTED DATA TRANSMISSION
In this section, we check what Bob and Eve will receive
during the encrypted data transmission with the scheme pro-
posed in the previous section, through simulation. A binary
image (the logo of NTUST: the denoised version of Fig7(a))
is used as the source data sent out by Alice. The received
results by Bob and Eve are shown in terms of visual images
and BERâ€™s.
The setup for the simulation is described below. The PCM
used for the NH-LDPC encoding/decoding in Fig. 4 is the
one shown in Fig. 2, which corresponds to a (510, 255) code.
The descrambler is a binary 255 Ã— 255 invertible matrix,
whose transfer characteristic is shown in Fig. 5. The interleaver
operates on the whole image. The secret key (i.e. the target
syndrome) b is a random binary vector of length 255. The
modulation is BPSK (binary-phase shift keying). The channel
is AWGN (additive white Gaussian noise).
Before we actually feed the source data into the proposed
encryption scheme and then pass it through the channel, we
can do some theoretical analysis regarding the BERâ€™s as
sensed by Bob and Eve. Fig. 6 shows the BER of Bob and
Eve before and after the descrambling. The leftmost curve is
Bobâ€™s BER before the descrambling. Actually, it is exactly
the rightmost curve in Fig. 3. After descrambling, this BER is
raised (by a factor of about 127.5 when the SNR is high). The
result is the curve with the legend â€œNH-LDPC+Descramblerâ€.
More precisely speaking, the composition of the NH-LDPC
BER curve in Fig. 3 and the transfer characteristics of the
descrambler in Fig. 5 produces the â€œNH-LDPC+Descramblerâ€
curve in Fig. 6. Next let us try to analyze what happens to
Eve when she tries to eavesdrop the data sent out by Alice.
Since Eve does not have the secret key b, she can not perform
the NH-LDPC decoding. The best she can do is to directly
extract the systematic part of the received codeword, which
is modulated by BPSK. Therefore, Eve suffers a BER of
ğ‘„(
âˆš
2 â‹… SNR â‹…ğ‘…), where ğ‘… is the code rate (= 1/2 in our
simulation scenario) and ğ‘„(ğ‘§) is the probability that a standard
normal random variable is greater than ğ‘§. In Fig. 6, this is
the curve with the legend â€œBPSK(code rate=0.5)â€. This curve
shows the BER suffered by Eve before the descrambling. After
the desrambling, however, this curve is raised (through the
mapping by the curve in Fig. 5). The result is the topmost
curve in Fig. 6 and represents the BER as sensed by Eve after
the desrambling.
Shown in Figs. Fig. 7-8 are two received results, corre-
sponding to two different SNRâ€™s, by Bob and Eve (i.e. the mË†B
and mË†E in Fig. 4), where a binary image of size 750 Ã— 500
was used as the source data. The SNR value for each image
transmission is show in the figure caption. In addition to the
visual presentation of the received images, the BERâ€™s are also
shown in the figures. From those figures, we see that Bob
received clear (although a little corrupted) images while Eve
received illegible images. Actually, we had many more similar
results from our simulation. Based on those results, we roughly
conclude that the acceptance BER threshold for Bob is 0.001
and the rejection BER threshold for Eve is 0.465. We use those
two thresholds to intersect Bobâ€™s and Eveâ€™s BER curves in
Fig. 6. The intersection of BER= 0.001 and Bobâ€™s BER curve
occurs at SNR= 3.8dB, which means that in order for Bob to
356
 5 
 
åœ‹ç§‘æœƒè£œåŠ©å°ˆé¡Œç ”ç©¶è¨ˆç•«é …ä¸‹å‡ºå¸­åœ‹éš›å­¸è¡“æœƒè­°å¿ƒå¾—å ±å‘Š 
                              æ—¥æœŸï¼š 2011  å¹´ 12  æœˆ 9  æ—¥ 
                                 
 
 
 
è¨ˆç•«ç·¨è™Ÿ NSC 99-2221-E-011-054 
è¨ˆç•«åç¨± åœ¨å¤šè¼¸å…¥å¤šè¼¸å‡ºé€šè¨Šç’°å¢ƒä¸‹é‹ä½œä¹‹çµåˆäº†æ¸¦è¼ªç­‰åŒ–ä¹‹ç¶²è·¯ç·¨ç¢¼æ©Ÿåˆ¶ 
å‡ºåœ‹äººå“¡
å§“å 
å½­å€«å¿  
æœå‹™æ©Ÿæ§‹
åŠè·ç¨± 
è‡ºç£ç§‘æŠ€å¤§å­¸é›»å­ç³»åšå£«ç ”ç©¶ç”Ÿ 
æœƒè­°æ™‚é–“ 
2011å¹´ 4æœˆ 18æ—¥
è‡³ 2011å¹´ 4æœˆ 
20æ—¥ 
æœƒè­°åœ°é» 
Qingdao, China. 
æœƒè­°åç¨± 
(ä¸­æ–‡)  
2011å¹´ä¸–ç•Œç ”ç©¶å”æœƒé€šè¨Šèˆ‡è¡Œå‹•è¨ˆç®—åœ‹éš›ç ”è¨æœƒ 
(è‹±æ–‡)  
2011 WRI International Conference on Communications and Mobile 
Computing 
ç™¼è¡¨è«–æ–‡
é¡Œç›® 
(ä¸­æ–‡) 
éé½Šæ¬¡æ€§ä¹‹ä½å¯†åº¦æª¢æŸ¥ç¢¼æ–¼åŠ å¯†é€šè¨Šä¹‹æ‡‰ç”¨ 
(è‹±æ–‡)  
Nonhomogeneous LDPC Codes and Their Application to Encrypted 
Communication 
é™„ä»¶å›› 
 7 
äºŒã€èˆ‡æœƒå¿ƒå¾— 
æœ¬æœƒè­°ç”±å¤§é™¸çš„å­¸è¡“æ©Ÿæ§‹ç™¼èµ·å·²åˆ°ç¬¬ä¸‰å±†,å¯ä»¥çœ‹å‡ºä»–å€‘ç©æ¥µçš„åœ¨çˆ­å–å…¶å­¸è¡“çŸ¥å
åº¦åŠå½±éŸ¿åŠ›ï¼Œä¸è«–æœƒè­°ä¸­çš„è»Ÿç¡¬é«”è¨­å‚™èˆ‡è­°ç¨‹å®‰æ’éƒ½å¯çœ‹çš„å‡ºé€²æ­¥ï¼Œæ‰€æœ‰åœ¨æœƒè­°ä¸­
æ‰€ç™¼è¡¨çš„è«–æ–‡éƒ½å¯ä»¥ç¶“ç”± IEEE Xplore ç³»çµ±æ‰¾å¾—åˆ°,ä¸”å·²æœ‰ Ei Compendex çš„æŒ‡æ¨™æ•¸
(index)ã€‚ 
 
ä¸‰ã€è€ƒå¯Ÿåƒè§€æ´»å‹•(ç„¡æ˜¯é …æ´»å‹•è€…ç•¥) 
 
å››ã€å»ºè­° 
åœ‹å…§æ‡‰å¤šèˆ‰è¾¦åœ‹éš›å‹çš„ç ”è¨æœƒï¼Œè®“åœ‹å…§å­¸ç”Ÿæœ‰æ©Ÿæœƒåƒèˆ‡èˆ‡è¨“ç·´å…¶ä»¥è‹±æ–‡æµåˆ©å ±å‘Šä»–
å€‘çš„è«–æ–‡çš„èƒ½åŠ›ã€‚ 
 
äº”ã€æ”œå›è³‡æ–™åç¨±åŠå…§å®¹ 
   å¤§æœƒè«–æ–‡é›†ç´™æœ¬ 
 
å…­ã€å…¶ä»– 
 
 
 
 
 
99 å¹´åº¦å°ˆé¡Œç ”ç©¶è¨ˆç•«ç ”ç©¶æˆæœå½™æ•´è¡¨ 
è¨ˆç•«ä¸»æŒäººï¼šè³´å¤è²¡ è¨ˆç•«ç·¨è™Ÿï¼š99-2221-E-011-054- 
è¨ˆç•«åç¨±ï¼šåœ¨å¤šè¼¸å…¥å¤šè¼¸å‡ºé€šè¨Šç’°å¢ƒä¸‹é‹ä½œä¹‹çµåˆäº†æ¸¦è¼ªç­‰åŒ–ä¹‹ç¶²è·¯ç·¨ç¢¼æ©Ÿåˆ¶ 
é‡åŒ– 
æˆæœé …ç›® 
å¯¦éš›å·²é”
æˆæ•¸ï¼ˆè¢«æ¥
å—æˆ–å·²ç™¼
è¡¨ï¼‰ 
é æœŸç¸½é”æˆ
æ•¸(å«å¯¦éš›
å·²é”æˆæ•¸)
æœ¬è¨ˆç•«
å¯¦éš›è²¢
ç»ç™¾åˆ†
æ¯” 
å–®ä½ 
å‚™è¨»ï¼ˆè³ªåŒ–èªªæ˜ï¼šå¦‚æ•¸
å€‹è¨ˆç•«å…±åŒæˆæœã€æˆ
æœåˆ—ç‚ºè©²æœŸåˆŠä¹‹å°é¢
æ•…äº‹...ç­‰ï¼‰ 
æœŸåˆŠè«–æ–‡ 0 0 100%  
ç ”ç©¶å ±å‘Š /æŠ€è¡“å ±
å‘Š 0 0 100%  
ç ”è¨æœƒè«–æ–‡ 1 1 80% 
ç¯‡ 
L. C. Peng, C. H. Lai and 
K. T. Lay, â€™Increase in 
System Utilization Rate 
and Selection of 
Optimum Code Rate in 
Turbo-Coded DS-CDMA 
Systems,â€™ in Proc. of 
2011 the 7th National 
Workshop on Internet 
and Communication 
Technology, Taipei, 
Taiwan, pp. 162-167, 
April 2011. 
 
è«–æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100%   
ç”³è«‹ä¸­ä»¶æ•¸ 0 0 100%  å°ˆåˆ© å·²ç²å¾—ä»¶æ•¸ 0 0 100% ä»¶  
ä»¶æ•¸ 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šåˆ©é‡‘ 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 0 0 100%  
åšå£«ç”Ÿ 0 0 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å…§ 
åƒèˆ‡è¨ˆç•«äººåŠ› 
ï¼ˆæœ¬åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ç† 0 0 100% 
äººæ¬¡ 
 
æœŸåˆŠè«–æ–‡ 0 0 100%  
ç ”ç©¶å ±å‘Š /æŠ€è¡“å ±
å‘Š 0 0 100%  
åœ‹å¤– è«–æ–‡è‘—ä½œ 
ç ”è¨æœƒè«–æ–‡ 1 1 80% 
ç¯‡ 
K. T. Lay, C. H. H and L. 
C. 
Peng, â€™Nonhomogeneous 
LDPC Codes and Their 
Application to 
Encrypted 
Communication,â€™ in 
