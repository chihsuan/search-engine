ä¸­æ–‡æ‘˜è¦ 
è¿‘å¹´ä¾†æ§åˆ¶å™¨å€åŸŸç¶²è·¯å·²ç¶“å¾ˆæ™®éåœ°æ‡‰ç”¨åˆ°æ±½è»Šã€å·¥æ¥­ç•Œç­‰é ˜åŸŸä¸Šï¼Œæˆç‚ºè»Šèº«é›»å­é€šè¨Šç¶²è·¯çš„ä¸»è¦éª¨
å¹¹ä¹‹ä¸€ã€‚éš¨è‘—è»Šè¼‰è³‡é€šè¨Šæ‡‰ç”¨çš„æ™®åŠåŒ–ï¼Œåœ¨æ•´åˆè»Šèº«é›»å­é€šè¨Šç¶²è·¯ä¸Šå°‡æœƒé‡åˆ°çš„å•é¡ŒåŒ…æ‹¬ï¼š(1) å¦‚ä½•è¨­è¨ˆ
è»Šè¼‰é–˜é“å™¨ä¾†å°‡è»Šèº«é›»å­é€šè¨Šç¶²è·¯ä¸Šçš„è¨Šæ¯æ“·å–å‡ºä¾†ï¼›(2) å¦‚ä½•é¸æ“‡åˆé©çš„é€šè¨Šä»‹é¢å°‡æ“·å–åˆ°çš„è³‡è¨Šç¶“ç”±
è»Šè¼‰é–˜é“å™¨é€åˆ°å¾Œç«¯ä¼ºæœå™¨ï¼›(3) å¦‚ä½•ç¸®çŸ­è»Šè¼‰é–˜é“å™¨åœ¨è»Ÿç¡¬é«”é–‹ç™¼ä¸Šçš„æ™‚ç¨‹ç­‰ã€‚ 
æœ¬è¨ˆç•«çš„ä¸»è¦ç ”ç©¶ç›®çš„æ˜¯è¦æå‡ºä¸€å€‹å¿«é€Ÿåˆæœ‰æ•ˆç‡çš„æ–¹æ³•å”åŠ©å·¥ç¨‹å¸«å€‘é–‹ç™¼è»Šè¼‰é–˜é“å™¨ï¼Œä½¿å·¥ç¨‹å¸«å€‘
å¯ä»¥ä¸ç”¨ç®¡åº•å±¤çš„é©…å‹•ç¨‹å¼ã€ä½œæ¥­ç³»çµ±ã€åŠç¡¬é«”é›»è·¯æ˜¯å¦‚ä½•è¨­è¨ˆï¼Œåªè¦å°ˆå¿ƒåœ¨ä¸Šå±¤æ‡‰ç”¨ç¨‹å¼çš„é–‹ç™¼å·¥ä½œä¸Šã€‚
æœ¬è¨ˆç•«å¯¦ä½œçš„ä¸€å€‹å¹³å°æ•´åˆäº†æ§åˆ¶å™¨å€åŸŸåŒ¯æµæ’ã€è—ç‰™å’Œ USB ç­‰é€šè¨Šä»‹é¢ï¼Œä¸¦å¯¦ä½œä¸€å€‹è»Šè¼‰é–˜é“å™¨ç¨‹å¼ç”¢
ç”Ÿå™¨ï¼Œä¾›è»Ÿé«”è¨­è¨ˆå¸«å€‘é¸æ“‡ä»–å€‘æ‰€éœ€è¦çš„åŠŸèƒ½ä¾†å¿«é€Ÿåœ°ç”¢ç”Ÿè»Šè¼‰é–˜é“å™¨çš„ç¨‹å¼æ¡†æ¶ï¼Œé€™äº›åŠŸèƒ½æ¡ç”¨æ¨¡çµ„åŒ–
çš„è¨­è¨ˆæ–¹å¼ï¼Œè»Ÿé«”è¨­è¨ˆå¸«å€‘åªéœ€è¦ç·¨ä¿®ä¸»ç¨‹å¼ä¾†é–‹ç™¼ä»–å€‘æ‰€éœ€è¦çš„æ‡‰ç”¨åŠŸèƒ½ï¼Œç‚ºäº†æå‡è»Šè¼‰é–˜é“å™¨åŸ·è¡Œå¤š
å·¥çš„èƒ½åŠ›ï¼Œæˆ‘å€‘åœ¨æå‡ºçš„è»Ÿé«”æ¡†æ¶ä¸Šè£è¼‰ä¸€å€‹å°å‹çš„å³æ™‚ä½œæ¥­ç³»çµ±ï¼Œç¶“ç”±æˆ‘å€‘æä¾›çš„å¹³å°å¯ä»¥æœ‰æ•ˆåœ°ç¸®çŸ­
é–‹ç™¼æ™‚é–“åŠæå‡ç¨‹å¼çš„æ•ˆèƒ½ã€‚ 
é—œéµè©: æ§åˆ¶å™¨å€åŸŸç¶²è·¯ã€è—ç‰™ã€é–˜é“å™¨ã€æ¡†æ¶ä½œæ¥­ã€å³æ™‚ä½œæ¥­ç³»çµ± 
 
Abstract 
In recent years, the control area network (CAN) has been widely adopted in automobile, industry control, and 
other fields. The CAN has become one of backbone of the intra-communication network inside a vehicle. With the 
popularity of telematics applications in integrated the vehicle intra-communication network, we will encounter the 
following problems including: (1) how to design a gateway to retrieval information from the vehicle 
intra-communication network; (2) how to choose an appropriate communication interface to send the retrieved 
information by the gateway to a backend server; (3) how to shorten the gateway in software and hardware 
development on schedule.  
The main purpose of this project is to a faster method to help engineers for developing a gateway. We 
implemented a platform to integrate communication interfaces that include CAN, Bluetooth, and USB and 
developed a program generator for engineers that they only need to focus in application development and do not 
need to care how to design the driver, operation system, and hardware. The engineers first select features designed 
in modular and then the program generator generates their program framework in shortest time. In order to enhance 
the performance of the gateway, we implemented a tiny real-time operation system running in the platform. With 
our platform, engineers only need to modify the main program for implementing their applications that reduces 
development time and the tiny real-time operation system can improve the performances.  
Keywords: Control area network, Bluetooth, gateway, framework, real-time operation system.  
åŠç¡¬é«”é›»è·¯æ˜¯å¦‚ä½•è¨­è¨ˆï¼Œåªè¦å°ˆå¿ƒåœ¨ä¸Šå±¤æ‡‰ç”¨ç¨‹å¼çš„é–‹ç™¼å·¥ä½œä¸Šã€‚æœ¬è¨ˆç•«å¯¦ä½œçš„ä¸€å€‹å¹³
å°æ•´åˆäº†æ§åˆ¶å™¨å€åŸŸåŒ¯æµæ’ã€è—ç‰™ã€å’Œ USBç­‰é€šè¨Šä»‹é¢ï¼Œæˆ‘å€‘å°‡è¨­è¨ˆä¸€å€‹è»Šè¼‰é–˜é“å™¨çš„
ç¨‹å¼æ¡†æ¶ç”¢ç”Ÿå™¨ï¼Œè—‰ç”±é€™å€‹æ¡†æ¶å¿«é€Ÿåœ°ä¾æ“šè¨­è¨ˆè€…çš„æ‡‰ç”¨éœ€æ±‚ç”¢ç”Ÿè©²å¹³å°çš„æ¡†æ¶ç¨‹å¼ç¢¼
åŠåƒè€ƒé›»è·¯ï¼Œä¾†å¹«åŠ©å‰›é–‹å§‹é€²å…¥é€™å€‹é ˜åŸŸçš„ä½¿ç”¨è€…ä»¥è¼ƒçŸ­çš„æ™‚é–“ä¾†ç†Ÿæ‚‰å¾®æ§åˆ¶å™¨çš„æ‡‰ç”¨
èˆ‡æ§åˆ¶å™¨å€åŸŸç¶²è·¯æ ¸å¿ƒçš„æ§åˆ¶ï¼Œè®“å·¥ç¨‹å¸«å¿«é€Ÿå…¥é–€ï¼Œé€²è€Œç¸®çŸ­é–‹ç™¼æ™‚é–“ï¼Œç‰¹åˆ¥æ˜¯åœ¨æ•´åˆ
æ§åˆ¶å™¨å€åŸŸç¶²è·¯ä¹‹è»Šè¼‰è³‡é€šè¨Šæ‡‰ç”¨ä¸Šã€‚ 
 
äºŒã€ç³»çµ±æ¶æ§‹ 
æˆ‘å€‘çš„æ¶æ§‹æ˜¯ä»¥å¾®è™•ç†æ§åˆ¶å™¨ç‚ºæ ¸å¿ƒï¼Œå¦‚åœ– 1 æ‰€ç¤ºï¼Œé€éå¾®è™•ç†æ§åˆ¶å™¨çš„åŠŸèƒ½
ä¾†å¯¦ç¾æˆ‘å€‘è¦è¨­è¨ˆè©²å¹³å°æ¶æ§‹çš„æƒ³æ³•ï¼Œæœ‰é—œæ–¼é€™é¡†å¾®è™•ç†æ§åˆ¶å™¨å¯ä»¥é”åˆ°çš„åŠŸèƒ½å‡
å¯ä»¥åœ¨é€™å€‹æ¶æ§‹ä¾†å¯¦ç¾ï¼Œæ­¤å¤–ï¼Œæˆ‘å€‘åœ¨å¾®è™•ç†æ§åˆ¶å™¨ä¸Šå±¤è¦åŠƒäº†ä¸€å€‹å°å‹çš„å³æ™‚ä½œ
æ¥­ç³»çµ±ä¾†åšç¨‹å¼çš„æ’ç¨‹ï¼Œé€™å€‹ä½œæ¥­ç³»çµ±æ˜¯ç‚ºäº†è§£æ±ºç¨‹å¼åŸ·è¡Œæ•ˆç‡çš„å•é¡Œï¼Œé€éé€™å€‹
ä½œæ¥­ç³»çµ±ä¾†ç¢ºä¿æˆ‘å€‘è¦è™•ç†çš„äº‹ä»¶èƒ½åœ¨ä¸€å®šçš„æ™‚é–“å…§å®Œæˆä¸”ä¸æœƒæœ‰éºæ¼ï¼Œè€Œæ¶æ§‹ä¸­
çš„å°å‹å³æ™‚ä½œæ¥­ç³»çµ±æ˜¯é€éå¾®è™•ç†æ§åˆ¶å™¨çš„è¨ˆæ™‚å™¨ï¼ˆTIMERï¼‰çš„åŠŸèƒ½ä¾†å¯¦ç¾ã€‚ 
åœ¨å°å‹å³æ™‚ä½œæ¥­ç³»çµ±çš„ä¸Šå±¤å¯ä»¥çœ‹åˆ°æˆ‘å€‘è¦åŠƒå‡ºä¾†çš„é€šè¨Šä»‹é¢ï¼Œé€™è£¡é¢åŒ…æ‹¬äº†
CANã€UARTã€Bluetooth ç­‰ç­‰çš„é€šè¨Šä»‹é¢ï¼Œåœ¨æˆ‘å€‘çš„è¦åŠƒæ˜¯æ¨¡çµ„åŒ–çš„è¨­è¨ˆä¾†å‘ˆç¾åŠŸ
èƒ½ï¼Œåœ¨æœ€ä¸Šå±¤çš„æ‡‰ç”¨æ¯ä¸€å€‹æ¨¡çµ„çš„æ“´å……ï¼Œä½¿ç”¨è€…å¯ä»¥ç”¨ç¹¼æ‰¿çš„æ–¹å¼ä¾†é¸æ“‡ä»–å€‘æ‰€éœ€
çš„æ‡‰ç”¨ï¼Œé€™æ¨£çš„è¨­è¨ˆè®“ä½¿ç”¨è€…å¯ä»¥å¾ˆè¼•é¬†çš„è¦åŠƒå‡ºä»–å€‘æ‰€è¦å¯¦ç¾çš„åŠŸèƒ½ï¼Œæˆ‘å€‘å¯ç”±
åœ– 1 çœ‹åˆ°æœ€ä¸Šå±¤å‡æ˜¯æˆ‘å€‘æ‡‰ç”¨çš„ç¯„åœï¼Œèˆ‰ä¾‹ä¾†èªªï¼šåœ¨è»Šè¼‰è¨ºæ–·æ‡‰ç”¨ä¸­ï¼Œæˆ‘å€‘å¯ä»¥é€
é CAN çš„æ¨¡çµ„ä¾†å¯¦ç¾åŠŸèƒ½ï¼Œæœ€ä¸Šå±¤çš„è»Šè¼‰è¨ºæ–·éƒ¨ä»½ä¾¿å¯ä»¥ç¹¼æ‰¿ CAN çš„åŠŸèƒ½ä¾†å¯¦
ç¾ã€‚ 
 
 
 
 åœ– 2 è»Šè¼‰é–˜é“å™¨é››å‹ 
 
 
åœ– 3 è»Šè¼‰é–˜é“å™¨ä¹‹å°åˆ·é›»è·¯æ¿ 
  
 åœ– 5 ç³»çµ±æ¸¬è©¦ 
 
äº”ã€çµè«– 
å› æ§åˆ¶å™¨å€åŸŸç¶²è·¯æ ¸å¿ƒæ™¶ç‰‡å…§æš«å­˜å™¨ç¹å¤šï¼Œè¨­è¨ˆä¸€å€‹å¯ä»¥æ“·å–è»Šå…§è³‡è¨Šçš„æ‡‰ç”¨æœ‰å…¶å›°é›£
æ€§ã€‚å°ä¸€èˆ¬å·¥ç¨‹å¸«è€Œè¨€ï¼Œé–‹ç™¼è»Šè¼‰é–˜é“å™¨å¿…é ˆè¦èŠ±è²»å¾ˆå¤šçš„æ™‚é–“åœ¨ç ”è®€ç›¸é—œçš„æŠ€è¡“æ–‡ä»¶èˆ‡
å­¸ç¿’é–‹ç™¼é€™äº›è£ç½®çš„ç›¸é—œçŸ¥è­˜ï¼Œé€ æˆè»Šè¼‰é–˜é“å™¨é–‹ç™¼æ™‚ç¨‹éé•·ã€‚ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œæˆ‘å€‘
å¯¦ä½œçš„ä¸€å¥—è»Šè¼‰é–˜é“å™¨çš„å¹³å°åŠæ¡†æ¶ç¨‹å¼ç”¢ç”Ÿå™¨ï¼Œèƒ½æœ‰æ•ˆåœ°å”åŠ©å·¥ç¨‹å¸«é–‹ç™¼æ•´åˆè»Šèº«é›»å­
é€šè¨Šç¶²è·¯çš„è»Šè¼‰è³‡é€šè¨Šæ‡‰ç”¨ç¨‹å¼ã€‚ 
æœªä¾†æˆ‘å€‘å°‡æœå‘ä¸‹åˆ—å¹¾å€‹æ–¹å‘é€²è¡Œç›¸é—œç ”ç©¶ï¼š 
(1) ä»¥æ¨¡å‹æª¢æŸ¥å™¨ä¾†å»ºç«‹è»Šèº«é›»å­é€šè¨Šç¶²è·¯ä¹‹æ•ˆèƒ½è©•ä¼°æ¨¡å‹ã€‚ 
(2) ç ”ç©¶å…¶ä»–è»Šèº«é›»å­é€šè¨Šç¶²è·¯ï¼Œå¦‚ï¼šLINã€MOSTã€FlexReyã€Safe-by-Wireã€‚ 
(3) å¯¦ä½œæ›´ç©©å®šæ›´å®‰å…¨çš„è»Šè¼‰ç›¸é—œä¹‹è»Ÿé«”å…ƒä»¶ã€‚ 
 
References 
[1] D. Paret â€œMultiplexed Networks for Embedded Systems CAN, LIN, FlexRay, 
Safe-by-Wire â€¦,â€ Wiley, pp. 14-19, 2007. 
[2] C. Dressler and O. Fischer, â€œCAN basics: CAN in Automation history and CAN, part 1 of 
8,â€ Industrial Automation Asia, pp. 22-23, January 2007. 
åœ‹ç§‘æœƒè£œåŠ©å°ˆé¡Œç ”ç©¶è¨ˆç•«æˆæœå ±å‘Šè‡ªè©•è¡¨ 
è«‹å°±ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹åº¦ã€é”æˆé æœŸç›®æ¨™æƒ…æ³ã€ç ”ç©¶æˆæœä¹‹å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹
å€¼ï¼ˆç°¡è¦æ•˜è¿°æˆæœæ‰€ä»£è¡¨ä¹‹æ„ç¾©ã€åƒ¹å€¼ã€å½±éŸ¿æˆ–é€²ä¸€æ­¥ç™¼å±•ä¹‹å¯èƒ½æ€§ï¼‰ã€æ˜¯å¦é©
åˆåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨æˆ–ç”³è«‹å°ˆåˆ©ã€ä¸»è¦ç™¼ç¾æˆ–å…¶ä»–æœ‰é—œåƒ¹å€¼ç­‰ï¼Œä½œä¸€ç¶œåˆè©•ä¼°ã€‚ 
1. è«‹å°±ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹åº¦ã€é”æˆé æœŸç›®æ¨™æƒ…æ³ä½œä¸€ç¶œåˆè©•ä¼° 
â–   é”æˆç›®æ¨™ 
â–¡ æœªé”æˆç›®æ¨™ï¼ˆè«‹èªªæ˜ï¼Œä»¥ 100 å­—ç‚ºé™ï¼‰ 
â–¡ å¯¦é©—å¤±æ•— 
â–¡ å› æ•…å¯¦é©—ä¸­æ–· 
â–¡ å…¶ä»–åŸå›  
èªªæ˜ï¼š 
  è¨ˆç•«å·²å®Œæˆè»Šè¼‰é–˜é“å™¨çš„è»Ÿç¡¬é«”è¨­è¨ˆï¼Œä¸¦å¯¦ä½œä¸€å¡Šå…·å‚™ CAN åŠ Bluetooth é–˜
é“å™¨çš„é›»è·¯æ¿åŠå¯¦ä½œä¸€å¥— OBU ç¨‹å¼ç”¢ç”Ÿå™¨ç”¨ä¾†ç”¢ç”Ÿè»Šè¼‰é–˜é“å™¨çš„ç¨‹å¼æ¡†æ¶ã€‚ 
2. ç ”ç©¶æˆæœåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨æˆ–ç”³è«‹å°ˆåˆ©ç­‰æƒ…å½¢ï¼š 
è«–æ–‡ï¼šâ– å·²ç™¼è¡¨ â–¡æœªç™¼è¡¨ä¹‹æ–‡ç¨¿ â–¡æ’°å¯«ä¸­ â–¡ç„¡ 
å°ˆåˆ©ï¼šâ–¡å·²ç²å¾— â–¡ç”³è«‹ä¸­ â– ç„¡ 
æŠ€è½‰ï¼šâ–¡å·²æŠ€è½‰ â–¡æ´½è«‡ä¸­ â– ç„¡ 
å…¶ä»–ï¼šï¼ˆä»¥ 100 å­—ç‚ºé™ï¼‰ 
 
3. è«‹ä¾å­¸è¡“æˆå°±ã€æŠ€è¡“å‰µæ–°ã€ç¤¾æœƒå½±éŸ¿ç­‰æ–¹é¢ï¼Œè©•ä¼°ç ”ç©¶æˆæœä¹‹å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹
å€¼ï¼ˆç°¡è¦æ•˜è¿°æˆæœæ‰€ä»£è¡¨ä¹‹æ„ç¾©ã€åƒ¹å€¼ã€å½±éŸ¿æˆ–é€²ä¸€æ­¥ç™¼å±•ä¹‹å¯èƒ½æ€§ï¼‰ï¼ˆä»¥
500 å­—ç‚ºé™ï¼‰ 
æœ¬è¨ˆç•«æ‰€å®Œæˆçš„è»Šè¼‰é–˜é“å™¨èƒ½æˆåŠŸåœ°ç¶“ç”± OBDII è®€å–è»Šèº«é›»å­é€šè¨Šç¶²è·¯ä¸Šçš„
è³‡è¨Šï¼Œå¦‚ï¼šè½‰é€Ÿã€æ²¹ï¥¾ç­‰ã€‚æˆ‘å€‘ä¹Ÿåœ¨ç¦ç‰¹ Focus é€²è¡Œå¯¦è»Šæ¸¬è©¦ã€‚ç‚ºäº†æ¸›è¼•è»Ÿ
é«”å·¥ç¨‹å¸«ç™¼å±•è»Šè¼‰ç›¸é—œæ‡‰ç”¨ç¨‹å¼çš„è² æ“”ï¼Œæˆ‘å€‘ä¹Ÿå¯¦ä½œä¸€å¥— OBU ç¨‹å¼ç”¢ç”Ÿå™¨ï¼Œ
å¯ä»¥ç”¢ç”Ÿè»Ÿé«”æ¡†æ¶ã€‚æœ¬è¨ˆç•«æˆæœä¹Ÿåœ¨æ—¥æœ¬å¤§é˜ªåŠä¸­åœ‹æµ·å—å³¶ç™¼è¡¨ï¼Œç‰¹åˆ¥æ˜¯åœ¨
æµ·å—å³¶èˆ‰è¾¦çš„æµ·å³½å…©å²¸å››åœ°ç„¡ç·šé›»ç§‘æŠ€ç ”è¨æœƒå¼•èµ·èˆ‡æœƒè€…é«˜åº¦é‡è¦–ï¼Œæ˜¯ä¸€é …
éå¸¸å¯¦ç”¨åˆæœ‰ç”¢æ¥­åƒ¹å€¼çš„ç ”ç©¶ã€‚ 
 
 
 
 
 
ä¸€ã€åƒåŠ æœƒè­°ç¶“é 
ä»Šå¹´7æœˆ13-16æ—¥åƒåŠ ç”±æ—¥æœ¬Osakaå¤§å­¸èˆ‰è¡Œçš„ç¬¬å…«å±†IEEEE International 
Conference on Industrial Informaticsï¼Œæ­¤æœƒè­°æ¶µè“‹ä¸»é¡Œå¯ä»¥åˆ†æŠ€è¡“é¡ä¸»é¡Œ
åŠç‰¹åˆ¥ä¸»é¡Œã€‚åœ¨æŠ€è¡“é¡ä¸»é¡Œæœ‰15å€‹ä¸»é¡Œï¼ŒåŒ…æ‹¬ï¼šå¤§æ¨“è‡ªå‹•åŒ–å’Œæ™ºæ…§å‹ä½å®…ã€å·¥
å» è‡ªå‹•åŒ–ã€ç¶ è‰²è³‡è¨ŠæŠ€è¡“ã€æ„Ÿæ¸¬èˆ‡é€šè¨Šã€å·¥æ¥­è³‡è¨Šå­¸æ‡‰ç”¨ã€äººæ©Ÿä»‹é¢ç­‰è­°é¡Œï¼›
è€Œåœ¨ç‰¹æ®Šä¸»é¡Œå‰‡ä»¥é€²éšè»Ÿé«”å·¥ç¨‹ã€èƒ½æºå’Œè³‡è¨ŠæŠ€è¡“ã€æœå‹™å·¥ç¨‹ã€è¡Œå‹•/ç„¡ç·šé€šè¨Š
ç¶²è·¯ç­‰è­°é¡Œã€‚ 
æœ¬äººåœ¨Osakaèˆ‰è¡Œçš„IEEEç ”è¨æœƒä¸Šï¼Œèˆ‡æœ¬æ ¡é„§ç¸½å‹™é•·æ’ç™¼ã€é„§æ‰€é•·æ¢ç¶±ã€æ¥Šè€å¸«
éŒ¦è¯ã€é¾è€å¸«æ˜æ”¿ç­‰åŒä»å…±ç™¼è¡¨ä¸‰ç¯‡æ–‡ç« ï¼Œåˆ†åˆ¥æ˜¯ã€ŒModeling CAN Network Using 
PRISMã€ã€ã€ŒA Mesh Network Reliability Analysis Using Reliability Block 
Diagramã€ã€ã€ŒA Low Cost and Effective Implementation of Standby Mode Power 
Reductionã€åˆ†åˆ¥ç”±æœ¬äººã€é„§æ‰€é•·æ¢ç¶±ã€æ¥Šè€å¸«éŒ¦è¯é€²è¡Œå£é ­å ±å‘Šï¼Œé¾è€å¸«æ˜æ”¿
å°ç ”è¨æœƒä¹Ÿå¾ˆæ„Ÿèˆˆè¶£å’Œæˆ‘å€‘ä¸‰äººåŒè¡ŒåƒåŠ æ­¤ç ”è¨æœƒã€‚ã€ŒModeling CAN Network 
Using PRISMã€æ–‡ç« ï¼Œå…¨æ–‡å¦‚é™„ä»¶ä¸€ã€‚ 
äºŒã€èˆ‡æœƒå¿ƒå¾— 
ã€ŒModeling CAN Network Using PRISMã€æ˜¯ä»Šå¹´åœ‹ç§‘æœƒçš„ç ”ç©¶æˆæœï¼Œæˆ‘å€‘
é¸æ“‡äº†PRISMå·¥å…·ä¾†é€²è¡Œå¡‘æ¨¡å·¥ä½œï¼Œè©²ç³»çµ±æ˜¯ä»¥é€šè¨Šé–˜é“ç‚ºæ ¸å¿ƒï¼Œä¸»è¦æ˜¯è©•ä¼° 
CAN Busçš„æ•ˆèƒ½ã€‚PRISMæ˜¯ä¸€å¥—æ©Ÿç‡æ¨¡å‹æª¢æŸ¥å·¥å…·ï¼Œå®ƒæä¾›äº†ç³»çµ±çš„æ­£è¦æ¨¡åŒ–å’Œ
åˆ†æï¼Œèƒ½å±•ç¾éš¨æ©Ÿçš„è¡Œç‚ºï¼Œè©²å·¥å…·æä¾›äº†é›¢æ•£æ™‚é–“é¦¬å¯å¤«éˆï¼ˆDiscrete-Time 
Markov Chainsï¼‰ã€é€£çºŒæ™‚é–“é¦¬å¯å¤«éˆï¼ˆContinuous-Time Markov Chainsï¼‰ã€ä»¥
åŠé¦¬å¯å¤«æ±ºç­–ç¨‹åºï¼ˆMarkov Decision Processesï¼‰ã€‚åœ¨æ­¤ç¯‡æ–‡ç« æˆ‘å€‘é¸ç”¨äº†é€£
çºŒæ™‚é–“é¦¬å¯å¤«éˆä¾†å»ºç«‹é–˜é“å™¨ä½¿ç”¨CAN Busçš„åˆ†ææ¨¡å¼ï¼Œåœ¨CAN Busä¸Šä¾†å»ºç«‹é–˜
é“å™¨å’Œé›»å­æ§åˆ¶å™¨é–“çš„è¨Šæ¯å‚³è¼¸ï¼Œç”±æ–¼CAN Busæ˜¯å±¬æ–¼å„ªå…ˆæ¬Šçš„æ»™æµæ’ï¼Œå› æ­¤å®¹
æ˜“é€ æˆä½å„ªå…ˆæ¬Šè¨Šæ¯ç”¢ç”Ÿé¤“æ­»ç¾è±¡ã€‚æœ¬ç¯‡æ–‡ç« å»ºç«‹ä¸‰å€‹é›»å­æ§åˆ¶å™¨å’Œä¸€å€‹é–˜é“
å™¨ä¹‹é–“çš„é€šè¨Šç³»çµ±æ¨¡å‹ï¼Œä¸¦è§€å¯Ÿå››å€‹å„ªå…ˆæ¬Šè¨Šæ¯ï¼šæ©Ÿæ²¹å£“åŠ›æŒ‡ç¤ºã€æ©Ÿæ²¹æº«åº¦æŒ‡
ç¤ºã€ç…ï¤‚æŒ‡ç¤ºã€é½’è¼ªè®Šé€ŸæŒ‡ç¤ºç­‰ã€‚å„ªå…ˆæ¬Šä»¥æ©Ÿæ²¹å£“åŠ›æŒ‡ç¤ºæœ€é«˜ï¼Œæ©Ÿæ²¹æº«åº¦æŒ‡ç¤º
Modeling CAN Network Using PRISM 
 
Cheng-Min Lin, Chen-Wei Yang
â€ 
, Hui-Kang Teng
â€¡
, Ming-Cheng Chung, Kuo-Chen Lang, Heng-Fa Teng 
Department of Computer and Communication Engineering, Nan Kai University of Technology 
 Department of Information Engineering and Computer Science, Feng Chia University
â€ 
 
Graduate Institute of Electrical Engineering, Nan Kai University of Technology
â€¡
 
lcm@nkut.edu.tw, P9525258@fcu.edu.tw, thk@nkut.edu.tw, t155@nkut.edu.tw, lkj@nkut.edu.tw, 
thf@nkut.edu.tw 
 
Abstract- Although the probabilistic model checking tool 
called PRISM had been applied in many communication 
systems, such as wireless local area network, Bluetooth, 
and ZigBee, the technique is not used in a controller area 
network (CAN). In this paper, we use PRISM to model the 
mechanism of priority messages for CAN because the 
mechanism lets CAN as leader in serial communication 
for automobile and industry control. Through modeling 
CAN, it is easy to analysis the characteristic of CAN for 
helping the development of security and efficiency for 
automobile. The Markov chain model helps us to model 
the behaviour of priority messages. According to the 
results of analysis and simulation, the high-priority 
messages have better throughput performance while 
low-priority messages have the potential to lose 
transmission when CAN traffic is higher.  
 
I. INTRODUCTION 
Control Area Network (CAN) has been one of the 
most successful network protocols since Robert Bosch 
GmbH introduced the serial bus system - CAN at the 
Society of Automotive Engineers (SAE) congress in 
February of 1986 éŒ¯èª¤! æ‰¾ä¸åˆ°åƒç…§ä¾†æºã€‚ . 
Today, almost every new vehicle manufactured in 
Europe is equipped with a CAN network for accessing 
information from the electronic controller unit (ECU) 
deployed in an intra-vehicle network. The CAN 
protocol was adopted as an international standard in 
1993. Today, almost every new vehicle manufactured 
in Europe is equipped with a CAN network for 
accessing information from the electronic controller 
unit (ECU) deployed in an intra-vehicle network. 
According to the CAN specification reported by Bosch, 
CAN has several important properties, including 
prioritization messages, guarantee of latency times, 
configuration flexibility, etc 2. Due to its advantages in 
bus access conflict resolution, CAN has been widely 
adopted in automobile and industry control, such as 
vehicles 34, smart sensors 4.A,  distributed fuel 
system 5, spectrometer slow control system 5.A, 
real-time communication systems 67, fault 
confinement 8, time triggered communication 9, and 
remote sensing 10. 
Although the CAN network has been successful in 
automobile and industry control, few attempts have 
been made to use CAN theory in practical applications. 
Modeling plays a critical role in the development of 
reliability products related to automobile and industry 
control used in real-time environments. We attempt 
to model the behavior of priority messages in CAN 
networks using a probabilistic model checking 
technique. The proposed technique can help the 
information processing system designer to evaluate 
system design factors quantification such as 
performance and reliability. A probabilistic model 
checker called PRISM 10.A is used as an automatic 
formal verification technique for the analysis of 
systems which exhibit stochastic behavior. We use this 
tool to analyze an example of the behavior of four 
priority messages.  
In 2002, Kwiatkowska et al. 11 model the two-way 
handshake mechanism of the IEEE 802.11 standard 
with a fixed network topology using probabilistic 
timed automata (PTA). The PTA can represent both 
nondeterministic and probabilistic. Duflot et al. in 
2006 12 present a formal analysis of the discovery 
phase of the Bluetooth wireless communication 
protocol using the DTMC model. Fruth 13 models 
é™„ä»¶ä¸€ã€æœƒè­°è«–æ–‡å…¨æ–‡ 
(2) ğ‘  âˆˆ ğ‘† is the initial state; 
(3) ğ‘: ğ‘† Ã— ğ‘† â†’ â„â‰¥0 is the transition rate matrix; 
(4) ğ¿: ğ‘† â†’ 2ğ´ğ‘ƒ  is a labelling function which assigns 
to each state ğ‘  âˆˆ ğ‘†  the set L(s) of atomic 
propositions (AP) that are valid in the state. 
For CTMCs, we should change the transition rate 
matrix R into the infinitesimal generator matrix Q. 
Hence, we calculate the matrix R to obtain the matrix 
Q. The calculation equation is given by 
ğ ğ‘ , ğ‘ â€² =  
ğ‘ ğ‘ , ğ‘ â€² if ğ‘  â‰  ğ‘ â€²
âˆ’ ğ‘ ğ‘ , ğ‘ â€²â€² ğ‘ â€²â€² â‰ ğ‘  otherwise.
  (7) 
As discussed above, we try to model a small CAN 
network with a priority queueing system with four 
levels of priorities appeared at 14 as shown in Fig. 3. 
Nodes 1, 2, and 3 are ECUs and they are transmitters. 
Node 4 is a gateway via OBDII to connect a CAN bus. 
Node 4 is a receiver for collecting all messages sent by 
other three nodes. Every node equipped with a queue 
stored up to N messages excepting the gateway node 
has queue size 4 times larger than other nodes. Node 
1 sends the message of break indication with ID of 
20H repeating 100 ms without data. Node 2 transmits 
in cyclic order every 1000 ms the message gear 
information (ID 30H) with 8 byte data. Node 3 has two 
types of messages. One is the highest priority message 
to indicate oil pressure and the other is lowest priority 
message to indicate oil temperature. They are repeatly 
to be sent eight byte data at 200 and 1000 ms, 
respectively. Node 4 will delete its received data in 
cyclic order every 1000 ms. 
We model the above example of a four-priority 
queueing system using the PRISM language as 
shown in Fig. 4. The source code using the PRISM 
can be divided into four parts. (1) Model selection 
and constant values are declared. First of all, we 
declare the example is a CTMC model using the 
keyword of stochastic. Only one constant of queue 
size is specified to N to represent the maximum 
number of buffers used to store every class of 
messages. (2) Four node modules and one bus module 
are designed and denoted by BreakIndicate, 
GearIndicate, OilIndicate, MonitorControl, and Bus. 
Each module has one or two queues represented by BI 
in BreakIndicate, GI in GearIndicate, OP and OT 
OilIndicate, and MC in MonitorControl. Their queue 
length excepting MC is 4N is specified in those 
constant values of N, respectively. The behaviour of 
each message module is described by four commands, 
comprising a guard and one or more updates. A 
command takes the form of â€œ[] guard ->rate1 : update1 
+ ... + raten : updaten;.â€ We use the first command to 
descript the above syntax. The guard, (BI<N) is a 
predicate over the two variables, BI and N, in the 
BreakIndicate module. The update, (BIâ€™=BI+1) 
describes a transition to increase the variable BI if the 
guard, (BI<N) is true. The update, (BIâ€™=BI+1) is also 
assigned an interarrival time of 50000 which will be 
assigned to the corresponding transition. Another 
update about the arrival rate occurs when the guard 
(BI=N) is held but no increase occurs in the queue BI. 
In the other words, the generated message is lost. We 
can use the synchronization mechanism which 
compels at least two actions in different modules to 
make simultaneous transitions. For example, arrival2 
C1 
Node 1: BreakIndicate 
Type: Transmitter 
Priority 2 
Queue size: N 
TXREP: 100ms 
ID: 20H 
Data: 0 Bytes 
C2 
Node 2: GearIndicate 
Type: Transmitter 
Priority 3 
Queue size: N 
TXREP: 1000ms 
ID: 30H 
Data: 8 Bytes 
C3 
Node 3: OilIndicate 
Type: Transmitter 
Priority 1 - Pressure 
Queue size: N 
TXREP: 200ms 
ID: 10H 
Data: 8 Bytes 
Priority 4 - Temperature 
Queue size: N 
TXREP: 1000ms 
ID: 40H 
Data: 8 Bytes 
(a)  
Node 4: MonitorControl 
Type: Receiver 
Queue size: 4*N 
DISREP: 1000ms 
 
C1 
CAN Bus 
C2 
Fig.  2. A CAN network with a four-priority queueing system 
consists of four nodes. 
C3 
(b)  
C1 
C2 
C3 
(c)  
C1 
C2 
C3 
(d)  
C1 
C2 
C3 
(e)  
Fig.  1. A priority queue system 
simulation time is 2x10
-6
 sec.    
In each module, the sending queue and receiving 
queue are combined as one queue for the messages 
observation. In Fig. 6, the CAN bus model is simulated 
with different queue number size from 1 to 10 in each 
module and the results are full queue probability. The 
BI full queue probability is the highest, because the 
arrival rate is higher than the others. Following the 
simulation step by step, the sending messages in BI 
should have more sending queues to serve. In MC full 
queue probability simulation, the full queue 
probability is also higher. Because the MC collects all 
messages, and the messages receiving rate is larger 
than service rate. In the other way, the idle probability 
is also simulated to observe the queue state. The OC 
and GC have low sending rate and the queue idle 
probability is higher than other, shown in Fig. 7. 
For verification the priority queueing model, each 
module message throughput is pointed out with 
different time and the queue size is fixed as 2. In Fig. 
8(a), the time from 0 to 1000 is simulated. The results 
show that the BI has higher priority to send the 
messages with high throughput and the others are 
kept down. Even the lower priority messages could 
not send out with the lower queue size, such as the 
OT. In Fig. 9, the simulation time is extend from 0 to 
100000, the numerical results show that the priority 
model is almost the same as the analysis of real CAN 
bus communication scenario response. 
 
Fig.  3. The full queue probability at steady-state is 
presented when N is changed from 1 to 10. 
 
 
Fig.7. The idle probability at steady-state is presented 
when N is changed from 1 to 10. 
 
 
(a) OP, OT, BI and GI 
 
(b) only OP and OT 
Fig. 8. The number of messages when N is 2 and T 
is from 0 to 1000 
const int T; 
P=? [ true U<=T ("OPQfull") ]  P=? [ true U<=T ("OTQfull") ]  
P=? [ true U<=T ("GIQfull") ]   P=? [ true U<=T ("BIQfull") ] 
P=? [ true U<=T ("MCQfull") ] P=? [ true U<=T ("OCidle") ] 
P=? [ true U<=T ("GCidle") ]  P=? [ true U<=T ("BCidle") ] 
P=? [ true U<=T ("MCidle") ]   
S=? [ "OPQfull" ]  S=? [ "OTQfull" ]  S=? [ "GIQfull" ]  
S=? [ "BIQfull" ] S=? [ "MCQfull" ] S=? [ "OCidle" ] 
S=? [ "GCidle" ] S=? [ "BCidle" ] S=? [ "MCidle" ] 
R{"OPmsg"}=? [ C<=T ] R{"OTmsg"}=? [ C<=T ] R{"BImsg"}=? [ C<=T ] 
R{"GImsg"}=? [ C<=T ] R{"OPloss"}=? [ C<=T ] R{"OTloss"}=? [ C<=T ] 
R{"BIloss"}=? [ C<=T ] R{"GIloss"}=? [ C<=T ]  
 
Fig. 5 Property of three-priority queueing system 
 
confinement in CAN networks,â€ IEEE Transactions on 
Industrial Informatics, Vol. 2,  No. 2,  pp. 78-85, May 
2006. 
9. M. Short, and M. J. Pont, â€œFault-Tolerant Time-Triggered 
Communication Using CAN,â€ IEEE Transactions on 
Industrial Informatics, Vol. 3,  No. 2,  pp. 131 â€“ 142, 
May 2007. 
10. E. Desa, P. K. Maurya, A. Pereira, A. M. Pascoal, R. G. 
Prabhudesai, A. Mascarenhas, R. Madhan,; S. G. P. 
Matondkar, G. Navelkar, S. Prabhudesai, and S. 
Afzulpurkar, â€œA Small Autonomous Surface Vehicle for 
Ocean Color Remote Sensing,â€ IEEE Journal of 
Oceanic Engineering, Vol. 32,  No. 2,  pp. 353-364, 
April 2007. 
A. Hinton, M. Kwiatkowska, G. Norman and D. Parker, 
â€œPRISM: A Tool for Automatic Verification of 
Probabilistic Systems,â€ In Proc. 12th International 
Conference on Tools and Algorithms for the 
Construction and Analysis of Systems (TACAS'06), 
Vol. 3920 of Lecture Notes in Computer Science, 
pp. 441-444, Springer, March 2006. 
11. M. Kwiatkowska, G. Norman and J. Sproston, 
â€œProbabilistic Model Checking of the IEEE 802.11 
Wireless Local Area Network Protocol,â€ In Proc. 
PAPM/PROBMIV'02, Vol. 2399 of Lecture Notes in 
Computer Science, pp. 169-187, 2002. 
12. M. Duflot, M. Kwiatkowska, G. Norman and D. Parker, â€œA 
Formal Analysis of Bluetooth Device Discovery,â€ 
International Journal on Software Tools for Technology 
Transfer (STTT), Vol. 8, No.6 , pp. 621-632, 2006. 
13. M. Fruth, â€œProbabilistic Model Checking of Contention 
Resolution in the IEEE 802.15.4 Low-Rate Wireless 
Personal Area Network Protocol,â€ In Proc. 2nd 
International Symposium on Leveraging Applications of 
Formal Methods, Verification and Validation (ISOLA'06), 
2006. 
14. W. Lawrenz, â€œCAN System Engineering From Theory to 
Practical Applications,â€ Springer, pp.86-87, 1997. 
15. M. Kwiatkowska, G. Norman and D. Parker, â€œStochastic 
Model Checking,â€ Formal Methods for the Design of 
Computer, Communication and Software Systems: 
Performance Evaluation, Vol. 4486 of Lecture Notes in 
Computer Science (Tutorial Volume), pp. 220-270, 
2007. 
 
 
98ï¦ï¨å°ˆé¡Œç ”ç©¶è¨ˆç•«ç ”ç©¶æˆæœå½™æ•´è¡¨ 
è¨ˆç•«ä¸»æŒäººï¼šï§´æ­£æ• è¨ˆç•«ç·¨è™Ÿï¼š98-2221-E-252-016- 
è¨ˆç•«åç¨±ï¼šå¤šåŠŸèƒ½ï¤‚è¼‰é€šè¨Šé–˜é“å™¨ä¹‹ç ”è£½ 
ï¥¾åŒ– 
æˆæœé …ç›® å¯¦éš›å·²é”æˆ
ï¥©ï¼ˆè¢«æ¥å—
æˆ–å·²ç™¼è¡¨ï¼‰
é æœŸç¸½é”æˆ
ï¥©(å«å¯¦éš›å·²
é”æˆï¥©) 
æœ¬è¨ˆç•«å¯¦
éš›è²¢ç»ç™¾
åˆ†æ¯” 
å–®ä½ 
å‚™ è¨» ï¼ˆ è³ª åŒ– ï¥¯
æ˜ï¼šå¦‚ï¥©å€‹è¨ˆç•«
å…±åŒæˆæœã€æˆæœ
ï¦œ ç‚º è©² æœŸ åˆŠ ä¹‹
å° é¢ æ•… äº‹ ...
ç­‰ï¼‰ 
æœŸåˆŠï¥æ–‡ 0 0 100%  
ç ”ç©¶å ±å‘Š/æŠ€è¡“å ±å‘Š 1 0 100%  
ç ”è¨æœƒï¥æ–‡ 0 0 100% 
ç¯‡ 
 
ï¥æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100%   
ç”³è«‹ä¸­ä»¶ï¥© 0 0 100%  å°ˆï§ å·²ç²å¾—ä»¶ï¥© 0 0 100% ä»¶  
ä»¶ï¥© 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šï§ï¤Š 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 3 0 100%  
åšå£«ç”Ÿ 2 0 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å…§ 
ï¥«èˆ‡è¨ˆç•«äººï¦Š 
ï¼ˆæœ¬åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ï§¤ 0 0 100% 
äººæ¬¡ 
 
æœŸåˆŠï¥æ–‡ 0 1 100%  
ç ”ç©¶å ±å‘Š/æŠ€è¡“å ±å‘Š 0 0 100%  
ç ”è¨æœƒï¥æ–‡ 4 0 100% 
ç¯‡ 
 
ï¥æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100% ç« /æœ¬  
ç”³è«‹ä¸­ä»¶ï¥© 0 0 100%  å°ˆï§ å·²ç²å¾—ä»¶ï¥© 0 0 100% ä»¶  
ä»¶ï¥© 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šï§ï¤Š 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 0 0 100%  
åšå£«ç”Ÿ 0 0 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å¤– 
ï¥«èˆ‡è¨ˆç•«äººï¦Š 
ï¼ˆå¤–åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ï§¤ 0 0 100% 
äººæ¬¡ 
 
 
