 æ•ˆæœè‡ªè©•  
ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹ï¨ ç›¸ç¬¦ 
é”æˆé æœŸç›®æ¨™æƒ…å½¢ å·²é”æˆ 
ç ”ç©¶æˆæœä¹‹å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹å€¼ EMCå¼ç”¢å“ä¸Šå¸‚çš„é‡è¦ä¾æ“šä¹‹ã„§ã€‚ç›®å‰
plateform-bored design methodology ä¹‹EMC
ï¨ˆç‚ºä¸»è¦æ§åˆ¶æ–¼è»Ÿé«”ï¨ˆç‚ºä¸Šã€‚æœ¬ç ”ç©¶ï§ç”¨ï¥¾
æ¸¬èˆ‡æ¨¡æ“¬ä»¥å»ºï§·è»Ÿé«”çš„EMCï¨ˆç‚ºï¼Œæˆ‘å€‘é‡å°
PIC12F629çš„å¾®æ§å™¨è¨­è¨ˆå‡ºISSæ¨¡æ“¬å™¨ï¼Œå¯æ¨¡
ä»¿å¾®æ§å™¨ä¹‹ï¨ˆç‚ºï¼Œä¸¦æ­é…æˆ‘å€‘ç¶“ï¥¾æ¸¬é€¼è¿‘æ‰€
å¾—åˆ°çš„å„å€‹æŒ‡ï¦¨é›»ï§Šæºï¼Œå»ºï§·æˆICDBè³‡ï¦¾
åº«ï¼Œå¯ä¾›ISSï¤­æ¨¡æ“¬åœ¨ï¥§åŒç¨‹å¼ä¸‹æ™‚ï¼Œæ‰€é€ 
æˆæ™‚åŸŸä¸Šçš„EMIæƒ…å½¢ã€‚ç›®å‰ä»ç‚ºå­¸è¡“ä¸Šä¹‹è¨
ï¥ï¼Œå·²ç™¼è¡¨ä¸‰ç¯‡åœ‹éš›æœƒè­°ï¥æ–‡ï¼Œä¸€ç¯‡åœ‹å…§æœƒ
è­°ï¥æ–‡ï¼ŒäºŒç¯‡åœ‹å…§æœŸåˆŠï¼Œä¸¦ä¸”å·²é€å¯©ä¸‰ç¯‡åœ‹
éš›æœŸåˆŠã€‚ 
æ˜¯å¦é©åˆåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨æˆ–ç”³è«‹å°ˆï§ æ˜¯ï¼Œå·²ç™¼è¡¨ä¸‹ï¦œï¥æ–‡ï¼š 
1. Shih-Yi Yuan, Jia-Wen Luo, Ming-Yuh 
Lin, Shry-Sann Liao, "Microcontroller 
instruction set simulator for EMI 
prediction", International Workshop on 
EMC of IC, Torino, Italy.(é™„ä»¶äºŒ) 
2. Shih-Yi Yuan, Huai-En Chung, Chiu-Kuo 
Chen, Shry-Sann Liao, "Irregular and 
long time current waveform handling 
improvement for EMC simulation," EMC 
Europe 2008, Hamburg, German, Aug. 
2008. (é™„ä»¶äº”) 
3. Shih-Yi Yuan, Huai-En Chung, 
Chiu-Kuo Chen, Shry-Sann Liao, "Time 
varying instruction current EMC 
simulation improvement," IEEE 
International Symposium on EMC, 
Detroit, USA, Aug. 2008. (é™„ä»¶ï§‘) 
4. è¢ä¸–ä¸€ã€é¾æ‡·æ©ã€ï¤å˜‰æ–‡ã€ï¤æµ©æ–‡, â€œæ‡‰
ç”¨æ–¼EMCä¹‹é›»ï§ŠæºEMIæ¨¡å‹ , ï¼‚2007 
å…¨åœ‹é›»ç£ç›¸å®¹æŠ€è¡“èˆ‡å¯¦å‹™ç ”è¨æœƒ, é€¢ç”²
å¤§å­¸, July. 2007.(é™„ä»¶ä¸ƒ) 
5. è¢ä¸–ä¸€, ï§´éŠ˜æ˜±, â€œæ‡‰ç”¨æ–¼EMCä¹‹ç¨‹å¼
EMIæ¨¡å‹ ,ï¼‚é›»å­æª¢æ¸¬èˆ‡å“ç®¡å­£åˆŠï¼Œ
é™„ä»¶ä¸€ 
å‡ºå¸­åœ‹éš›å­¸è¡“æœƒè­°å¿ƒå¾—å ±å‘Š 
                                                             
è¨ˆç•«ç·¨è™Ÿ NSC 96-2221-E-035 -104 
è¨ˆç•«åç¨± å¾®æ§å™¨æŒ‡ï¦¨ä¹‹é›»ç£ç›¸å®¹æ€§æ¨¡å‹ç ”ç©¶(I) 
å‡ºåœ‹äººå“¡å§“å 
æœå‹™æ©Ÿé—œåŠè·ç¨± 
è¢ä¸–ä¸€ 
é€¢ç”²å¤§å­¸é€šè¨Šå·¥ç¨‹ç³»åŠ©ï§¤æ•™æˆ 
æœƒè­°æ™‚é–“åœ°é» 2007 ï¦ 11 æœˆ 28 æ—¥â”€2007 ï¦ 11 æœˆ 30 æ—¥ã€ç¾©å¤§ï§ï¨¦ï¦³ 
æœƒè­°åç¨± 6th International Workshop on Electromagnetic Compatibility of Integrated Circuits (EMC Compo 2007) 
ç™¼è¡¨ï¥æ–‡é¡Œç›® Microcontroller Instruction Set Simulator for EMI Prediction 
ä¸€ã€ï¥«åŠ æœƒè­°ç¶“é 
æœ¬äººæ–¼ 11 æœˆ 27 æ—¥æ–¼æ¡ƒåœ’ä¸­æ­£åœ‹éš›æ©Ÿå ´å‰å¾€ç•¶åœ°ï¼Œç•¶åœ°æ™‚é–“ 11 æœˆ 27 æ—¥æŠµé”ï¼Œç¿Œæ—¥
ï¥«åŠ æœƒè­°ã€‚æœƒè­°æŠ€è¡“ç ”è¨é–‹å ´æ¼”ï¥¯åœ¨ 11 æœˆ 27 æ—¥æ—©ä¸Šèˆ‰ï¨ˆã€‚ç¸½è¨ˆæœ‰ï¤­è‡ª 20 å€‹åœ‹å®¶çš„ 57
ç¯‡ï¥æ–‡ç™¼è¡¨ã€‚æœ¬æ¬¡ç ”è¨æœƒç¹¼æ‰¿ï¦Œï¦å‚³çµ±ï¼Œä»¥ IC é›»ç£ç›¸å®¹æŠ€è¡“ç‚ºæ¢è¨æ ¸å¿ƒã€‚ 
äºŒã€èˆ‡æœƒå¿ƒå¾— 
ä¸€ã€æŠ€è¡“æœƒè­°æˆå“¡ï¼šæœ¬äººäº¦ç‚ºæ­¤æ¬¡æŠ€è¡“æœƒè­°ï¼ˆTechnical Program Committeeï¼‰æˆå“¡ä¹‹ä¸€ï¼ˆï¨Š
é™„ä»¶ä¸­Call for paperå®£å‚³è³‡ï¦¾ï¼‰ï¼Œæ­¤æ¬¡åˆ°æœƒï¼Œå°å„å€‹æˆå“¡å‡äº¤æ›åç‰‡èˆ‡é€²ï¨ˆå°è«‡ï¼Œå¸Œ
æœ›èƒ½å¤ ä¿ƒæˆè³‡è¨Šäº¤ï§Šèˆ‡çˆ¾å¾Œäº’å‹•æ©Ÿæœƒã€‚ 
äºŒã€ï¥æ–‡ç™¼è¡¨ï¼šæœ¬äººæ­¤æ¬¡ï¥æ–‡ç™¼è¡¨æ–¼11æœˆ30æ—¥ä¸ŠåˆEMC Issue in SoC design (II) sessionï¼Œ
è½çœ¾ç´„å››åä½ï¼Œç™¼è¡¨éç¨‹éå¸¸é †ï§ï¼Œç´„ï¦Œæ™‚äºŒååˆ†é˜ã€‚é€™æ¬¡ç™¼è¡¨ä¸»è¦å‚³é”çš„ç ”ç©¶æˆ
æœä»¥åŠè¨´æ±‚æ˜ç¢ºï¼Œå› ç‚ºéç¨‹ç·Šæ¹Šï¼Œåªå…è¨±ä¸€å€‹å•é¡Œï¼Œæœƒå¾Œä»æœ‰è¨±å¤šäººå°æ­¤è¡¨ç¤ºèˆˆè¶£ã€‚
æ­¤ï¦´åŸŸä¸­çš„è¨±å¤šé‡è¦æ•™æˆå‡è¡¨ç¤ºèˆ‡æœ¬å¯¦é©—æ˜¯åˆä½œç ”ç©¶æƒ³æ³•ï¼Œï¦µå¦‚æ—¥æœ¬WADAæ•™æˆã€
å·´è¥¿VARGASæ•™æˆã€æ³•åœ‹SICARDæ•™æˆã€‚ 
ä¸‰ã€çµèªï¼š EMC Compoç‚ºä¸–ç•Œå°‘ï¥©å°ˆé–€ç ”ç©¶ICé›»ç£ç›¸å®¹å°ˆé–€æŠ€è¡“çš„ç ”è¨æœƒï¼Œåœ¨ç™¼è¡¨å¾Œ
å°é¢å°æœ¬ç ”ç©¶çš„è©•èªå¤§éƒ¨åˆ†å‡ç‚ºæ­£é¢çš„ï¼Œå¢åŠ ï¦ºè¨±å¤šç ”ç©¶ä¿¡å¿ƒã€‚ 
å››ã€æ„Ÿè¬ï¼šé€™æ¬¡è¨ˆåŠƒèƒ½å‡ºå¸­ï¼Œé™¤æ„Ÿè¬åœ‹ç§‘æœƒè¨ˆç•«è´ŠåŠ©ï¼Œä¹Ÿæ„Ÿè¬é€¢ç”²æ ¡æ–¹çš„æ”¯æŒï¼Œå€‹äººè¦º
å¾—åœ¨ç ”ç©¶æ–¹å‘èˆ‡ç ”ç©¶äººè„ˆçš„å»ºï§·å‡åŠ©ï¨—ï¥¼å¤šã€‚ 
äº”ã€æ”œå›è³‡ï¦¾ï¼šæœƒè­°ï¥æ–‡é›†CDä¸€ç‰‡ã€é™¤äº¤ç”±ICEMCä¸­å¿ƒåœ¨ç‰ˆæ¬Šé™åˆ¶ä¸‹å‚™ä»½ï¼Œä»¥ä¾›æœ‰èˆˆè¶£
çš„ï¤´å¸«ï¥«è€ƒã€‚ 
æœ¬å¿ƒå¾—å ±å‘Šæ›¸å¦æª¢é™„ï¼šç™¼è¡¨ï¥æ–‡ä¹™ç¯‡ã€é å®šå ±å‘Šç¨‹åº(é™„ä»¶ä¸‰)ã€æŠ€è¡“æœƒè­°æˆå“¡è­‰æ˜(é™„ä»¶å››)ã€‚
This paper is organized as following: section 2 briefly 
describes the Instruction current model (ICM) and 
Instruction set simulator (ISS). Section 3 proposes the 
instruction set simulator adapted for EMI prediction for 
different program behavior. Experimental results are 
described in section 4 and followed by a conclusion. 
2.  ICM AND ISS 
The instruction current model (ICM) [1] is based on
the ICEM model [13] (Fig. 1). ICEM model has been 
successfully used to model the parasitic emission for 
many microcontrollers, ASICs, and programmable 
devices, within the range 1MHz-2GHz. 
ICM models include the entire ICEM model concept 
with one focus: the current source(s). ICEM model 
consists of core activity current source(s) to translate IC 
actives to EMC prediction parameter while ICM use 
large amount of current sources activated in different 
time to resemble each individual instruction. We 
carefully calibrate each machine code peak current 
behaviors by a group of current sources and use these 
information to predicted several different simple program 
EMI behavior very accurately [1]. 
ICM will use other parameters of ICEM in the same 
way. These parameters include lumped components 
(R/L/C) networks under different frequency and 
temperature to represent packages, probes, or test boards. 
These parameters can be provided by 
1. Chip suppliers: pin distribution/assignment, VLSI
processing technologies (to some extent), package 
parameters, IO pad parameters, supply/ground 
parameters in die, etc., 
2. IBIS model [14]: condensed package parameters 
of different conditions â€“ either from the original
chip/package suppliers or from other companies 
dedicated for IBIS model building, 
3. Circuit board manufactures, 
4. Chip testing industries, or 
5. Measured and calibrated by the system designers. 
ICM is provided for estimating different machine 
instructions current behavior which, in term, will estimate 
the EMI time domain behavior of a microcontroller.
Fig. 1. ICEM (adapted from [13]).
An Instruction Set Simulator (ISS) is a simulation 
model, which mimics the behavior of microprocessor by 
"reading" instructions and maintaining internal variables 
which represent the processor's registers. Instruction 
simulation provides the opportunity to detect errors 
before execution. 
The basic instruction simulation steps are â€“ first,
execute the monitoring program padding the name of the 
target program as an additional input parameter. The 
target program is then loaded into memory, but control is 
never passed to the code. A set of pseudo registers are set 
to what they would be if the program is given control 
directly. It may be necessary to amend some of these ISS 
models to point to other pseudo â€œcontrol blocksâ€
depending on the hardware and operating system. 
3. ICM AND ICDB BUILDING AND ISS 
MODIFICATION 
3.1 ICM and ICDB Building 
The measurement setups (Fig. 2), target design (Fig. 3), 
code for testing (Fig. 4(a)) and ICM model (Fig. 4(b)) are 
similar to [1]. 
Fig. 2. Measurement setups and testing board design. 
Fig. 3. PIC16F84A testing board (top and bottom view). 
The testing board use PICÂ® PIC16F84A [15], which is
massively used in automotive, industrial, low power
remote sensors, electronic locks and security applications. 
The external oscillator is limited to 10MHz and is 4 MHz 
for general usage. All the design rules and design guides 
from IEC [12] were followed. 
Each machine codeâ€™s EMI waveform is recorded by an
oscilloscope (Fig. 2) and an approximated ICM behavior 
is built as [1] described. For example: GOTO, NOP, 
ADD, etc. First, a single â€œGOTOâ€ ICM was built; then
â€œNOP + GOTOâ€ behavior is obtained and modeled (Fig.
4). By the use of SPICE and ICEM concept, we can build 
single â€œNOPâ€ ICM. Other target instruction is inserted in
the middle of pure NOP sequence (Fig. 5) to rule out the 
pipeline effect. The total ICM building flow is shown in 
Fig. 6. The pipeline effect will be further considered and 
added by a modified ISS. If the target instruction has 
more than one behavior (for example, a conditional jump), 
more ICMs are built for that target instruction. 
Fig. 9. The modified ISS architecture. 
3.2.2 PIC ISS Design For SID 
To simulate the behavior of a PIC system on SID, there 
are many components needed. All the components 
described here are related to software simulation 
functionalities to mimic the physical hardware. The
major simulation components of the modified ISS are
shown in Fig. 10. The most important component is the 
PIC ISS microcontroller component. We have created 
PIC-component by ourselves, while other components are 
from SID public domain. We will focus on the PIC ISS 
design only. 
Fig. 10. Major components for the modified ISS simulation. 
PIC ISS component design is shown in Fig. 11. Step 
subroutine functions as an active part to call other 
subroutines of the component. Step subroutine is driven 
by an external clock component which in turn is driven 
by SID simulation engine. Physical PIC microcontroller 
can accept clock signals externally or internally (by 
program). For SID simulation scenario, the external clock 
component can represent both external and internal 
physical clock. 
Fig. 11. Program structure of PIC-component. 
As step subroutine is driven by clock component, it
will call fetch subroutine to fetch the next instruction 
code from bus component. The bus component (accepting 
the fetch subroutine calls) will decode the address of the 
target (in this case, the memory), then toggle the memory 
componentâ€™s step subroutine which will find the
instruction stored in memory component at specific 
location and return to bus component and return back to 
PIC-component. This completes the first pipeline stage 
(stage 1) behavior. In the mean time, the second pipeline 
stage (stage 2) calls decode subroutine, which will be 
detailed in the following, to decode the previous 
instruction already fetched. 
When stage 2 is triggered, PIC ISS simulates the 
execution of the fetched machine instruction and calls the 
instruction-decoding subroutines which will change 
internal registers, access memory, do 
mathematical/logical operation, or any other behaviors to 
change the external/internal status of this microcontroller 
according to the exact machine instruction timing and 
functional behavior. 
These 2 stages mimic the physical PIC 
microcontrollerâ€™s 2-stage pipeline hardware architecture. 
Stage 1 will take 4 instruction cycles to fetch next 
instruction code from memory while stage 2 also handles 
one instruction code within the same 4 instruction cycles. 
Stage 1 will also takes care of external interrupt and reset 
functionalities according to PIC instruction cycle timing 
diagram [15]. 
After these 2 stages complete, PIC ISS component is
ready for next fetching-decoding-executing cycle and the 
iteration begins. 
3.2.3 Machine Instruction Codes Preparation 
When an assembly program or a C program is written,
a software tool (assembler or compiler) will translate this 
program to machine code. Or one can write the 
hexadecimal machine code directly but this situation is 
rare. Machine instruction codes reside in memory and 
functions as a guideline for microcontroller behavior. 
Simulator must have the same functionalities and 
generate the same output as the physical counterpart 
execution.
Our machine code preparation is done by assembler 
(MPLAB [17]) and compiler (HI-TECH PICC Lite[18]). 
These tools are freely distributed on internet. Programs 
(for example, Fig. 4(a)) are translated by MPLAB. 
Another tool is hex2bin, it translates hexadecimal file to 
memory image. MPLAB IDE is a software development 
platform of PIC microcontroller. To compile C language, 
MPLAB needs to cooperate with PICC [17]. PICC 
supports Microchip PICmicro 10/12/14/16/17 serial 
microcontrollers. It is a high performance C compiler, 
completely ISO/ANSI compatible and supporting all 
24/32 bit IEEE floating point standards. 
We use these tools and many testing programs as Fig. 4 
to obtain ICDB and final simulation and prediction 
results. We further write a more complex code (Fig. 12), 
to verify the correctness of the PIC ISS component.
3.2.4 ISS Modification for EMI Prediction 
As the PIC ISS component can function correctly, we
modified it to incorporate with ICDB to output the 
instruction current waveform. The ISS modification 
architecture is already illustrated in Fig. 9. 
The obtained current waveform is illustrated in Fig. 13.
The horizontal axis is time. The first instruction MOVLW 
occupies two time slices which is cycle 0 and cycle 1 
Fig. 16. Curve fitting and MSE calculation (mix instructions). 
4.4 ISS Prediction for complex program 
When the PIC ISS behavior model is verified by 
subsection 4.2 and the time domain EMI estimation result 
of some combination of instructions is approximated by 
subsection 4.3, we can use the modified PIC ISS to 
generate massive instruction current waveform and 
further use the instruction current waveform in 
WINSPICE to generate the EMI prediction of the target 
system. 
A fraction of the predicted instruction current 
waveform of the more complex program (Fig. 12) is 
shown in Fig. 17. After the waveform is generated, the 
waveform will feed into SPICE to generate final 
prediction result (Fig. 18). 
Fig. 17. EMI model of program 
Fig. 18. Final prediction result. 
5. CONCLUSION 
This paper discusses the prediction of complex 
program effect on EMI time-domain behaviors on a 
simple microcontroller. Using ICM concept and 
instruction set simulator, this work can predict, in time 
domain, accurate EMI behavior of the conduct emission. 
Simulation results show that every individual prediction 
is all in certain statistical range. The modified ISS can 
use ICDB to dynamically generate instruction current 
waveform and predict the target machineâ€™s any program 
EMI behavior. The observation and primary prediction 
techniques are proposed in the hope that this work will 
propose another dimension of techniques for embedded-
system software design, software design methodology, 
and driver code optimization. 
6. REFERENCES
[1] Shih-Yi Yuan, Chi-Feng Yang, Eitenne Sicard, Chiu-kuo 
Chen, and Shry-Sann Liao, â€EMI Prediction Under a
Different Program Behaviorâ€, IEEE EMC 2007 Hawaii, 
2007.
[2] ITRS information can be downloaded from
http://itrs.public.org 
[3] Shuo Wang, Fred C. Lee and Jacobus Daniel van Wyk. 
â€œDesign of Inductor Winding Capacitance cancellation for 
EMI suppression, â€ IEEE transactions on Power 
Electronics, Vol. 21, No. 6, 2006, pp. 1825-1832. 
[4] Jaejin Park, Ruifeng Sun, L. Richard Carley, and C. 
Patrick Yue, â€œA 10-Gbps, 8-PAM Parallel Interface with
Crosstalk Cancellation for Future Hard Disk Drive 
Channel ICâ€™s, â€ ISCAS 2005, Vol. 2, pp. 1162-1165. 
[5] David G. Wang, James L. Knighten, and P. Keith Muller 
â€œAn Integrated Vent, Heatsink and EMI Shield, â€ 8th IEEE 
symposium on Semiconductor Thermal Measurement an 
Management, 2002, pp. 125 â€“ 131.
[6] C. Wang, J. L. Drewniak, J. L. Knighten, D. Wang, R. 
Alexander and D.M. Hockansink, â€œGrounding of
heatpipe/heatspreader and heatsink structures for EMI 
mitigation, â€ IEEE International Symposium on 
Electromahnetic Compatibility Vol. 2, 2001, pp. 916 â€“ 920.
[7] Alexandru Andrei, Petru Eles, Zebo Peng, Marcus Schmitz 
and Bashir M. Al-Hashimi â€œEnergy Optimization of
Multiprocessor Systems on Chip by Voltage Selection.â€
IEEE Transactions on VLSI, Vol. 15, Issue 3, 2007, pp. 
262 â€“ 275.
[8] Etienne Sicard and Gilles Peres, â€œA Novel Software
Environment for Predicting the parasitic Emission of 
Integrated Circuits, â€ EMC 2005, Vol. 3, pp. vii-xix. 
[9] David Brooks and Margaret Martonosi, â€œValue-based clock
gating and operation packing: dynamic strategies for 
improving processor power and performance, â€ ACM
Transactions on Computer Systems, Vol. 18, Issue 2, 2000, 
pp. 89 â€“ 126.
[10] Chinhung Chan, Yucheng Chang, Hsichi Ho and Herming 
Chiueh, â€œA thermal-awre power management soft-IP for
platform-base Soc designs, â€ IEEE International 
Symposium on System-on-Chip 2004, pp. 181 â€“ 184.
[11] Enzo Baccarelli, Mauro Biagi, Cristian Pelizzoni and 
Nicola Cordeschi, Fabio Garzia, â€œA power Allocation
Algorithm for Throughput Maximization in Mobile 
Networks, â€ 6th
 IEEE International Symposium on 
WoWMoM 2005, pp. 437-445.
[12] IEC 61967 information can be founded from 
http://www.iec.ch/index.htnl l 
[13] Sonia Ben Dhia, Mohamed Ramdani, Etienne Sicard, 
â€œElectromagnetic compatibility of Integrated circuit, â€
2006, Springer Inc. 
[14] Syed B. Huq, â€œEase System Simulation With IBIS Device
Modelsâ€ Electronic Design, 1996, National Semiconductor 
Corporation. 
[15] PIC12F629 DATA sheet, 1998, Microchip Technology Inc. 
[16] SID can be downloaded from http://sourceware.org/sid/
[17] MPLAB IDE Userâ€™s guide, 2005, Microchip Technology 
inc.
[18] HI-TECH PICC can be downloaded from 
http://www.htsoft.com/ 
	 
. &  "     
    
1/*  1%	  &	*  2/

5%	 
!&2 7	+	

 '  (  
 1( &,
0 2 !0 5&<, , ,
.8 &       	
  	

   
/	  	  %!&
 ; 5:	    0 & 5&, 	+
Poster session 1
	 
; 
          
93 93 32%!
   	   	$ '    ) * '   + , 
  , 

/= 7		 ,	
	 % *
 	
    -( 
 $ $ , (  ./0 1
/!		 )%0 ,>*	
0 2 !0
  $ Â– & )  
  #% 	
 $  , 
 
&	 2*	

"  	
3   *  ' 	   
5%	  2/
 %2
. ' 
  	
 ' &  4 ' ,1&  $
5%	  7,*	* & %2
 ) ) , 
   '    & 	
 $
	$  -
 ( 5	
      5%     
5% 9,0 9	$ 93 32%!
	

 &    
) 6 93*	
( !0 21
'' 
:     
+$  	
  $

99	*0 &2!
 2& % *
' 	 $  
+$ & 
+ $
9 *Ã¨ &%
	
3	0$ - 7* 5%2! &,2%
 
Poster session 2
	 
' &  
+$     	

9 *Ã¨ &%
	
3	0$ - 7* 5%2! &,2%
' $  * ,   	 $ '  ! 	
	
71*+ >
 9*C*	 452 ,   !**
. '        
>&	A+ /	* 
 >266*6 27* /&	6	 %55&
"" ) * $ 
 7  	  ' 	  8 '
	 
%2/** %/	((	* 72!!%
".    # 	 #  & &
% && %,     !
"; (* &  &  
%9	0 36 ( !0 21
"  $ '  ) *  	:
%%	*  /= 5%	 	 % *
. 
 + (     	 

%7* @ 7	  (  &	0 90 Â– 	*0(
..             
   !	
' 
= ?0*	 = 2: /	*	 %	 -
 ( (	 	 	 
6th International Workshop on Electromagnetic 
Compatibility of Integrated Circuits
EMC COMPO 2007 
November 28-30, 2007, Torino, Italy 
www.emccompo07.polito.it 
 CALL FOR PAPERS 
The achievements in terms of operating frequency and integration of semiconductor 
technology constantly bring about new EMC challenges, which need necessarily to be 
addressed at the integrated circuit level. Being up-to-date is of paramount importance to be 
successful in this field. The EMC Compo 2007 symposium is intended to be a place for 
exchange of the latest research achievements and experiences in IC-level EMC and it is 
addressed to researchers both from industry and from academia. 
The workshop is focused on emission and susceptibility issues of digital, analog and mixed-
signal integrated circuits, with a particular attention to smart power technologies and System 
on a Chip (SoC) solutions. The most recent advances in measurement techniques, models, 
standards, tools and design methodologies will be discussed. We are looking forward to see 
you in Torino! 
Main Topics 
Paper Submission 
Complete papers should be written in English and submitted in PDF, Postscript or MS Word 
A4 format (max. 6 pages including title, 100-word abstract, illustrations and references). The 
contributions should be submitted electronically through the website: 
www.emccompo07.polito.it, where further information on paper preparation is available. 
The deadline for paper submission is May 30th 2007. Notification of acceptance will be 
given on June 30th, 2007. 
Workshop Venue 
Torino, in the north-west of Italy, has become world-famous as the 2006 Winter Olympic 
Games host city. It has a rich historical and cultural background and offers many recreation 
facilities which can be enjoyed by the participants during their stay. Torino can be easily 
reached by plane (international airport of Torino Caselle), by car and by train. 
Contacts and Information 
More details about the location and the organization can be found in the workshop website: 
www.emccompo07.polito.it. For further information do not hesitate to contact the organizing 
committee secretariat@emccompo07.polito.it, ph.:+39-011-564.5103, fax:+39-011-564.5199 
 STMicroelectronics MicroelectronicsEMC
       Group
â€¢ Measurement of IC susceptibility to EMI    â€¢ EMC issues in smart power ICs
â€¢ Measurement of IC EM emission â€¢ Tools to handle EMC at IC level
â€¢ IC modelling for EMC â€¢ EMC Issues in next generation ICs
â€¢ IC design for EMC compliance â€¢ Packaging
â€¢ EMC issues in System on Chip design â€¢ Signal integrity
â€¢ Substrate Coupling â€¢ Design of ESD protection for EMI
â€¢ Smart sensors susceptibility to EMI â€¢ EMC issues in ICs for wireless comms. 
â€¢ IC level EMC Education and e-learning â€¢ EMC issues in Multi Chip Modules (MCM)
	
	
		
Franco Fiori, Politecnico di Torino

	
Vincenzo Pozzolo, Polit. di Torino

Paolo S. Crovetti, Polit. di Torino 
Mauro Merlo, STMicroelectronics
Francesco Musolino, Polit. di Torino
Giusy Spinasanta, COREP 
		

	
Sonia Ben Dhia, INSA de Toulouse
Ross Carlton, Freescale 
Herman Casier, AMI
Mart Coenen, Philips
Bernd Deutschmann, Infineon
Franco Fiori, Politecnico di Torino
Todd Hubing,  Clemson University
Elya B. Joffe, KTM Proj. Eng.
Werner John, Fraunhofer IZM
Uwe Keller, Zuken
Frank Klotz, Infineon
Heiko Koehne, Qimonda
Frederic Lafon, VALEO
Jean-Luc Levant, Atmel Nantes
Christian Marot, Siemens VDO
Olivier Maurice, EADS
Mauro Merlo, STMicroelectronics
Davide Pandini, STMicroelectronics
Richard Perdriau, ESEO
Mohamed Ramdani, ESEO
Miquel Roca, Univ. de les Balears
Bob Ross, Teraspeed Consulting
Goeran Schubert, Temic
Etienne Sicard, INSA de Toulouse 
Kevin Slattery, Intel
Thomas Steinecke, Infineon
Igor Stievano, Politecnico di Torino
Boris Traa, Philips
Osami Wada, Kyoto University
Wolfgang Wilkening, Bosch 
Shih-Yi Yuan, Feng-Chia University 
é™„ä»¶å››
use ICDB to simulate the program-related LTVD current 
waveform [2]. 
The brief derivation procedure of LTVD current 
waveform is described in the following and the details 
can be found in [2]. The procedure is divided into three 
major steps: 
Step 1: Instruction current characterization and ICDB 
building. 
Step 2: ISS simulation to generate LTVD current 
waveform using ICDB. 
Step 3: EMC estimation by ICEM using LTVD 
current waveform as current source(s). 
Step 2 generates a LTVD current waveform as a 
current source which is implemented by a PWL file 
description for SPICE input format. 
Since the PWL waveform from step 2 is not 
periodical, one can expect that different time interval may 
have different frequency responses. These frequency 
responses can be simulated according to step 3 by 
Furious transformation. For example, assuming the 
system is executing 2 applications in a time-sharing 
operating system, the frequency responses of different 
time interval can be estimated by sorting out these 
frequency responses and arranges them in time-lined 
sequence. 
The concept is trivial. However, the size of PWL 
waveform file from the above scenario is large even for 
small fraction of a program and is too large for SPICE to 
completely simulate a simple program. For example, in 
our simulation, the file size of a simple bubble sort 
program implemented on PIC microcontroller will be 
10~100 MB depending on the sorting data size. 
III. METHODOLOGY PROPOSED 
The simplest way to get the final system-level 
simulation result is proposed by ICEM: using ICEMC 
tool set (Figure 1). However, the large PWL file size is a 
problem. The major reason that SPICE cannot handle 
LTVD is simulation that it needs to uptake the total PWL 
file before simulation. The whole PWL loading will take 
almost all SPICE running time to do the Input/Output 
access and the net result is the intolerable long waiting 
for file reading.  
 
It seems easy to improve it by cutting the LTVD 
waveform into pieces and simulating these pieces one by 
one then merge the simulation results by some method 
into one whole large simulation result. However, the 
simulation result is â€œunstableâ€ â€“ the frequency response 
(Fourier transform of the time-domain simulation result) 
is quite different depending on the piece size, the 
combination algorithm, or the merge window size. Thus, 
the naive way is not feasible.  
Instead of cutting the LTVD waveform into pieces, 
the proposed method buffers the LTVD waveform and 
send to SPICE though a time-lined queue during SPICE 
running. SLPS [7] is a SPICE â€œcomponentâ€ developed by 
Cadence and Cybernet. This component can make PSpice 
and Simulink [8] to simulate system-level circuits.  
The proposed method can cumulatively simulate 
according to the interval set by users. Thus, only near-
future LTVD waveform has to be buffered and handled 
during the simulation. We propose this buffered-file-
handling-SPICE component architecture and implement 
it by Simulink. 
Figure 2(a) shows the file buffer-handling algorithm 
and Figure 2(b) shows the architecture of the proposed 
method. Thus, the proposed simulation architecture is: 
1. Build an ICEM model on PSpice. 
2. Save the circuit of PSpice into Simulink by the 
Simulink Block provide by SLPS. 
3. Acquire the LTVD waveform according to [2]. 
4. Use Figure 2(a) to handle the LTVD waveform 
from step 3 and feed into SLPS module. 
5. Start to simulation, according to Figure 2(b). 
 
 
IV. EXPERIMENTAL RESULT 
The simulation is done by personal computer (PC). 
The PC includes AMD Opteron 144 CPU, 2GB RAM, 
and 250GB hard disk. Related software is described in 
previous sections. LTVD current waveform is acquired 
 
Figure 1. Instantaneous Current Model of IC-EMC tool 
 
Figure 2(b). buffered-file-handling-SPICE architecture 
 
Figure 2(a). buffered-LTVD-file-handling with SPICE architecture 
  
Because of the large file processing capability, the 
proposed methodology can predict the time-lined 
frequency responses without any problem. Figure 5(a) 
shows the frequency responses of Figure 3(c) sorted by 
time sequence. The x-axis is the log-frequency, the y-axis 
is the sorted time-line, and the z-axis is the frequency 
response. Figure 5(b) shows different time interval 
frequency responses chosen from Figure 5(a) and the 
difference between themâ€” the differences may be as 
large as 25 dBuV at different frequencies and some peaks 
even shift a little bit.  
 
 
 
The large EMI variations among different frequencies 
of Figure 5(a) and Figure 5(b) mean that the EMI 
behaviors are time-varying during application execution. 
These figures also show that the proposed methodology 
and concept can find a way to estimate the phenomena.  
V. CONCLUSION 
Although the EMC tests at presents only deal with 
infinite loop testing program running on such system to 
simplify the test, papers are suggested that application 
programs running on the system do have their impacts on 
EMC test. For estimating such kind of EMC behavior, a 
LTVD (long-term time-varying dynamic) instruction 
current waveform simulation is proposed.  
This paper proposes an efficient and flexible method 
(BHSP method) to get LTVD EMI behavior under 
complex program execution conditions. The proposed 
methods can handle much longer system-running-time 
simulation and are with comparable simulation quality 
and simulation speed. The experiment results show that 
these methods can handle much larger LTVD waveform 
with good simulation quality. The proposed method can 
be used and get almost identical simulation result of 
SPICE (less than 2E-27 MSE).  
The proposed methodology can handle much longer 
simulation time due to the ability of buffered file 
handling capability and can be implemented in any kind 
of languages (C/C++/VB/â€¦) or systems (compiled or 
interpreted). At present, this method is implemented by 
Simulink for concept demonstration and can not do a fair 
efficiency comparison. Nevertheless, the primary 
comparisons are made and the experimental results show 
that in LTVD instruction current waveform simulation, 
BHSP beats SPICE if system running time is longer than 
200 us. And at least 3 ms system running time can be 
simulated under present software and hardware 
environment. 
By using BHSP proposed, system time-varying EMI 
behavior phenomena under complex applications 
execution condition can be estimated. 
40 
30
50 
60 
70 
80 
90 
100
20
dB
uV
1M 10M2M 3M 4M 5M 20M 40M50M30M
0
10
20
30
40
50
60
70
80
Frequency(Hz)
dB
uV
 
 
Difference
 
Figure 5(b). Two time interval frequency responses 
seslected from Figure 6(a). 
 
Figure 5(a). Time-lined frequency responses of Figure 3(c) 
 
Figure 4. SPICE and BHSP for long-time simulation 
TABLE 2. SIMULATION TIME COMPARISON 
System  
running time SPICE BHSP 
10us >1.00 3.34  
25us 3.00  6.15  
50us 8.00  13.99 
75us 16.00  24.72 
100us 27.00  37.38 
200us N/A 52.21 
 
Time varying instruction current EMC simulation 
improvement 
Shih-Yi Yuan 
IC-EMC center, 
Feng Chia University, 
Taichung, Taiwan 
Huai-En Chung  
Communications 
Engineering Dept., 
Feng Chia University, 
Taichung, Taiwan 
Chiu-Kuo Chen 
Bureau of Standards, 
Metrology and 
Inspection, 
M.O.E.A, 
Taipei, Taiwan 
Shry-Sann Liao  
IC-EMC center, 
Feng Chia University, 
Taichung, Taiwan 
 
Abstractâ€”Other papers have suggested that different application 
programs running on a digital system have their own EMC effects. 
This paper proposes two efficient and flexible techniques to 
improve the simulation efficiency of techniques instruction current 
waveform proposed by our laboratory. Experimental results show 
the efficiency is improved while the simulation quality remains the 
same. 
Keywordsâ€”ICEM; Instruction Current Model; SW EMI effect; 
EMI simulation 
I. INTRODUCTION 
ICEM [1] is a standard model for the EMC behavior of IC. 
The standard model uses internal current source(s) to represent an 
IC internal gross current behavior and use the current source(s) to 
estimate the EMC of the target IC. The waveform of the current 
source is obtained from real measurement and approximated by 
periodical triangular or trapezoidal waveform. 
Software may change the total digital system behavior from 
time to time [2]. Our laboratory has proposed a concept [3], 
which is based on ICEM, to describe and estimate time-varying 
dynamic EMI behaviors using ICEMC tool [5]. The main 
concept is trying to derive a high order approximation 
instantaneous â€œinstruction-currentâ€ [3] waveform of the target 
ICâ€™s machine codes and feed the information into ICEMC tool 
and, then, get high order EMI behavior approximation result. 
ICEMC tool set uses SPICE engine to get the time-domain 
current behavior and from which it transforms the simulated 
result into frequency-domain EMC behavior. SPICE is â€œde factoâ€ 
industrial time-domain simulator, all other circuit simulation 
results are compared to the result of SPICE. In the scenario of the 
software-related time-varying dynamic EMI behavior estimation, 
we have proposed a methodology [3] which can derive the long 
term time-varying dynamic current source (LTVDCS) waveform 
of the instruction current from other sources. The LTVDCS 
waveform can be represented by a piecewise-linear (PWL) 
waveform and feed into SPICE to acquire the final estimation of 
EMI behavior of a specific board or system.  
However, the size of LTVDCS waveform file represented by 
PWL derived from the above scenario is large even for small 
fraction of a program and is too large for SPICE to completely 
simulate a simple program. For example, in our simulation, the 
file size of a simple bubble sort program implemented on 
Microchip PICÂ® microcontroller will generate 10~100 MB PWL 
waveform file depending on the sorting data size. 
The main contribution of this paper is to extend the research 
[6] and to propose two more efficient and flexible methods under 
different constrains to solve the problem instead of SPICE. These 
methods are all compared the simulation time and quality with 
ICEMC. The experimental results show that the proposed 
methods can handle much larger LTVDCS waveform in 
comparable simulation time (or even faster) with the same 
simulation quality. 
The paper is organized as following. Section 2 briefly 
explains the instruction current [3] concept and the LTVDCS 
derivation procedure. Section 3 describes the simulation 
methodologies once we obtain the LTVDCS. The first proposed 
method is also detailed in this section. Section 4 describes the 
second improvement which will increase both the simulation 
time on the first improvement. Section 5 is the experimental 
results. And finally, Section 6 gives the conclusions.  
II. INSTRUCTION CURRENT[3] AND LTVDCS(LONG TERM 
TIME-VARYING DYNAMIC CURRENT SOURCE) DERIVATION 
Instruction current is the concept previously proposed by our 
laboratory. The concept is used to derive each Machine-Code 
instantaneous current source waveform. Each machine code 
instantaneous current waveform is characterized through IEC 
61967 [4] measurement standard and put into an Instruction 
Current database (ICDB). A modified instruction set simulator 
(ISS) can use ICDB to simulate the program-related LTVDCS 
waveform [6]. 
The brief derivation procedure of LTVDCS waveform is 
described in the following and the details can be found in [6]. 
The procedure is divided into 3 major steps: 
1: Instruction current characterization and ICDB building. 
2: ISS simulation to generate LTVDCS waveform using 
ICDB. 
3: EMC estimation by ICEM using LTVDCS waveform as 
current source(s). 
é™„ä»¶å…­
 Figure 2 shows an example to represent an ICEM concept 
that includes a passive netlist structure and an active current 
source. The S-function is divided into two parts, one is the active 
current source part and another is the DC voltage part. We set the 
active current source to read the LTVDCS waveform as input. 
Since ICEM often deal with high frequency behavior, the DC 
behavior of the transfer function is simply ignored. Presently, the 
proposed method is also implemented by Simulink (Figure 3). 
V. EXPERIMENTAL RESULT 
The simulation is done by personal computer (PC). The PC 
includes AMD Opteron 144 CPU, 2GB RAM, and 250GB hard 
disk. Related software is described in previous sections. 
LTVDCS waveform is acquired from another simulation 
procedure [6]. Here, BHSP is an abbreviation for buffered-file-
handling-SPICE component methodology and BHSF is for 
buffered-file-handling-S-function component methodology. 
First, short time-varying dynamic current waveform file is 
generated to make sure the simulation quality. By comparing the 
two proposed method with ICEMC tool, the simulation of these 
three methods (SPICE, BHSP, BHSF) are under the same 
simulation environment with the same time-varying dynamic 
input. Figure 4(a) shows the simulation result within 2us. The 
signal measured under these three methods is almost identical. 
The simulation quality should be further analyzed and the mean 
square error (MSE) between ICEMC tool set is calculated in 
table 1. Table 1 shows the comparisons to SPICE simulation 
result.  
 
 
 
 
 
Figure 3. S-function for an ICEM of microcontroller system  
 
Figure 4(c). simulation result of signal within 100us 
 
Figure 4(a). simulation result of signal within 2us 
 
Figure 4(b). simulation result of signal within 10us 
TABLE 1. MSE COMPARING TO ICEMC 
System 
running time BHSP BHSF 
10us 1.75598E-029  2.92436E-006  
25us 1.56247E-028 2.97267E-006  
50us 6.35835E-028 2.98494E-006  
75us 1.25912E-027 2.98298E-006  
100us 1.93011E-027  2.97726E-006  
 
 
Figure 2. buffered-file-handling-S-function architecture  
these methods are implemented by Simulink for concept 
demonstration and can not do a fair efficiency comparison to the 
SPICE. Nevertheless, the primary efficiency comparisons are 
made and the experimental results show that in LTVDCS 
waveform simulation, BHSP beats SPICE if system running time 
is longer than 75 us. If it exists an S-parameterized transfer 
function built for the simulation box, the BHSF simulation 
efficiency further improves the BHSP by 20%.  
REFERENCES 
[1] T. Steinecke, D. Hesidenz and E. Miersch, â€œEMI Modeling and Simulation 
in the IC Design Process,â€ 17th International Zurich Symposium on 
Electromagnetic Compatibility, Feb. 2006, Singapore. 
[2] Martin Oâ€™Hara, "The EMC Impact of Embedded Software", Conformity, 
Sep. 2007, pp. 36 â€“ 45 
[3] S. Y. Yuan, C. F. Yang, E. Sicard, C. K. Chen, and S. S. Liao, â€œEMI 
Prediction Under Different Program Behavior,â€2007 IEEE EMC 
Symposium, Jul. 2007, Honolulu, USA. 
[4] IEC 61967 information can be founded from http://www.iec.ch/index.htnl 
[5] IC-EMC can be downloaded from http://www.ic-emc.org/ 
[6] S. Y. Yuan, J. W. Luo, M. Y. Lin, and S. S. Liao, â€œMicrocontroller 
instruction set simulator for EMI prediction,â€ 2007 EMC Compo, Nov. 
2007, Torino, Italy. 
[7] Simulink information can be found from http://www.mathworks.com/ 
[8] PSpice/Pspice SLPS Interface can be found from 
http://www.cybernet.co.jp/orcad/product/slps/ 
[9] Samuel Jefferson Mason, â€œFeedback theoryâ€”Some properties of signal 
flowgraphs,â€ Proc. IRE, vol. 64, pp. 1144â€“1156,  Sept. 1953. 
 
åï§‘é€²ä½æ ¼å¼ï¼Œå°šé ˆä»¥ Hex2Bin.exe åŠ ä»¥è½‰æˆäºŒé€²
ä½è¨˜æ†¶é«”å½±åƒæª”ã€‚ 
2.2.3. PSpice SLPS 
PSpice SLPS ç‚º Cadence å’Œ Cybernet å”åŒé–‹ç™¼
çš„ Pspice å…ƒä»¶ï¼Œå¥—éæ­¤å…ƒä»¶å°‡å¯è®“ PSpice èˆ‡
MATLAB æ¨¡æ“¬é›»æ°£æ©Ÿæ¢°å’Œç³»çµ±ç´šæ–¹å¡Šé›»ï¤·ï¼Œä»¥åŠ
åœ¨ PSpice é›»ï¤·æ–¹å¡Šä¸­çš„é›»å£“ã€é›»ï§ŠåŠåŠŸï¥¡å¯å‚³é”åˆ°
MATLAB/Simulink ä¸­é€²ï¨ˆæ¨¡æ“¬ç­‰åŠŸèƒ½ã€‚ 
3. ç ”ç©¶æˆæœ 
ä»¥ä¸‹ç ”ç©¶æˆæœéƒ¨åˆ†å°‡é¦–å…ˆä»‹ç´¹å¯¦ä½œæ¶æ§‹ï¼ŒIC å·¨
è§€ EMC æ¨¡å‹ä¹‹å»ºï§·ã€æŒ‡ï¦¨é›†é›»ï§Šæºè³‡ï¦¾åº«ã€æŒ‡ï¦¨
é›†æ¨¡æ“¬å™¨ã€ç¨‹å¼é›»ï§Šæº EMI æ¨¡å‹ç­‰äº”éƒ¨åˆ†ï¼ŒåŠ ä»¥ä»‹
ç´¹ï¥¯æ˜ã€‚ 
3.1. å¯¦ä½œæ¶æ§‹ 
åœ– 1 å±•ç¤ºæ•´å€‹æ¶æ§‹ï¼Œå³é‚Šæœ‰ä¸€å€‹æŒ‡ï¦¨é›†æ¨¡æ“¬å™¨
(å·¥å» å°åœ–ç¤º)ï¼Œä½œæ¥­æ–¼ Linux çš„ SID æ¨¡æ“¬å¼•æ“ä¹‹ä¸Šï¼Œ
æ¥å—æŒ‡ï¦¨é›»ï§Šæºæ¨¡å‹ã€ç¨‹å¼ç¢¼ï¥¸é …è¼¸å…¥ï¤­æºï¼ŒåŸ·ï¨ˆ
å¾Œå°‡ç”¢ç”Ÿæ™‚è„ˆé€±æœŸä¹‹é ä¼°åŠŸï¥¡æ¶ˆè€—ï¥©æ“šï¼Œå°‡æ‰€ç”¢ç”Ÿ
è³‡ï¦¾è¼¸å…¥ä»£å…¥ IC å·¨è§€ EMC æ¨¡å‹ä¹‹ä¸­ï¼Œï¥¥å¯å¾—åˆ°æ­¤
ç¨‹å¼å°æ–¼ EMI æ‰€é€ æˆçš„å½±éŸ¿ã€‚ 
 
åœ– 1   æœ¬ç ”ç©¶æ•´é«”å¯¦ä½œæ¶æ§‹ 
3.2. IC å·¨è§€ EMC æ¨¡å‹ 
æŒ‡ï¦¨é›»ï§Šæºæ¨¡å‹å³æŒ‡ï¦¨æ¶ˆè€—åŠŸï¥¡ï¼Œæœ¬å°ç¯€æ¢è¨
æŒ‡ï¦¨æ¶ˆè€—åŠŸï¥¡çš„ï¥¾æ¸¬åŠæ¨¡æ“¬ï¼Œé¦–å…ˆå¿…é ˆå°‡å¾…æ¸¬ä¹‹ IC
ï¤·ç½®æ–¼ä¸€å¡Šè¨­è¨ˆç¬¦åˆï¥¾æ¸¬æ³•è¦çš„é›»ï¤·æ¿ä¸Šï¼Œå†ä»¥ç¤º
æ³¢å™¨ï¥¾æ¸¬ IC VDD è…³ä½ä¸Šçš„é›»å£“æ³¢å½¢ã€‚å¾—åˆ°ï¥¾æ¸¬ï¥©
æ“šå¾Œå†ï§ç”¨æ³•åœ‹ INSA ä¸­å¿ƒæ‰€é–‹ç™¼çš„ IC-EMC[8]è»Ÿ
é«”çŒœæ¸¬ IC å·¨è§€ EMC æ¨¡å‹ä¸­å…§éƒ¨é›»ï¤·ï¥«ï¥©èˆ‡ PIC å„
æŒ‡ï¦¨çš„é›»ï§Šæºæ¨¡å‹ã€‚æœ€å¾Œå°æŒ‡ï¦¨æ¨¡å‹åŠ ä»¥é©—è­‰ï¼Œæ”¹
ä»¥ç¤ºæ³¢å™¨ï¥¾æ¸¬ Vss è…³ä½ä¸Šçš„é›»å£“æ³¢å½¢ï¼Œèˆ‡æ¨¡æ“¬æ¯”è¼ƒã€‚ 
å¦‚å‰æ‰€è¿°ï¼Œé¦–å…ˆä¾æ“š IEC61967-4[9]ï¥¾æ¸¬æ³•è¦è¨­
è¨ˆé›»ï¤·æ¿ï¼Œå› ç•¶é›»ï¤·åœ¨ä½œé«˜æ…‹èˆ‡ä½æ…‹(å³ 1 èˆ‡ 0)è®ŠåŒ–
æ™‚ï¼Œæœƒç”¢ç”Ÿæš«æ…‹é›»ï§Šè€Œä½¿é›»æº VDD ç”¢ç”Ÿé«˜é »ï¦’æ³¢ï¼Œ
é«˜é »ï¦’æ³¢æ˜¯ä¸€ç¨®é›œè¨Šï¼Œæ‰€ä»¥å¿…é ˆåœ¨é›»ï¤·æ¿ IC çš„
VDD èˆ‡ GND ä¹‹é–“[5]è·¨æ¥ä¸€å€‹ 20pF çš„é™¶ç“·é›»å®¹
å™¨ï¼Œä»¥æ¶ˆé™¤ VDD ä¸Šæ‰€ç”¢ç”Ÿçš„é«˜é »ï¦’æ³¢ã€‚å¦å¤–ï¼Œåœ¨
IC  VDD æ¥è…³å°‡ï¤…æ¥ä¸€å€‹ï¼‘Î©é›»é˜»åˆ°é›»æºï¼Œä»¥åŠä¸€
å€‹ 49Î©é›»é˜»åšé˜»æŠ—æ‰¹é…åˆ°ç¤ºæ³¢å™¨ã€‚ 
å°‡å¾…æ¸¬å¾®æ§å™¨ç‡’ï¤¿ä¸€çµ„åè¦†åŸ·ï¨ˆåŒä¸€æŒ‡ï¦¨ä¹‹
ç¨‹å¼åŠ ä»¥ï¥¾æ¸¬å…¶ç”¨ç¤ºæ³¢å™¨æŠ“ VDD è…³ä½ä¸Šçš„é€±æœŸé›»
å£“æ³¢å½¢(åœ– 2)ã€‚æ ¹æ“šæ–‡ç»[12][14]å°‡æ•´é«”é›»ï¤·ç¹ªè£½æˆ
IC å·¨è§€ EMC æ¨¡å‹(åœ– 3)ï¼Œç”±å³è€Œå·¦ï¥¯æ˜ï¼Œé›»ï§Šæº
I1~I8 è¡¨ç¤º IC ä¹‹ç¬æ™‚é›»ï§Šï¼Œç‚ºç¨‹å¼é›»ï§Šæºçš„æ™‚è®Šæ¨¡
å‹ï¼›C1 ç‚º IC å…§éƒ¨é›»æºå±¤èˆ‡åœ°å±¤é–“ä¹‹å»è€¦åˆé›»å®¹ï¼›
R1ã€R2ã€R3ã€R8ã€R9ã€L1ã€L2ã€L3ã€L4ã€C1ã€
C2 ç‚º IC å…§å·¨è§€çµ±è¨ˆä¹‹è¢«å‹•å…ƒä»¶ï¼Œå…¶ä¼°è¨ˆå€¼ä¾æ–‡ç»
[15]å¯å¤§ç´„ä¾è£½ç¨‹æŠ€è¡“åŠ ä»¥æ¨ä¼°ã€‚V2ã€R4ã€R5ã€R6ã€
R7ã€C3ã€C5 å‰‡ç‚ºå¤–éƒ¨é›»ï¤·ï¼Œå…¶ä¸­ R7 50Î©é—¡é‡‹ç¤ºæ³¢
å™¨è¼¸å…¥çµ„æŠ—ã€‚èª¿æ•´ I1~I8 ï¥«ï¥©ä½œ Spice é›»ï¤·æ¨¡æ“¬ï¼Œç›´
åˆ°æ¨¡æ“¬å‡ºçš„æ™‚åŸŸæ³¢å½¢èˆ‡å‰é¢ç¤ºæ³¢å™¨ï¥¾æ¸¬åˆ°çš„æ™‚é »
åŸŸè¨Šè™Ÿå»åˆ(åœ– 4)ã€‚è‡³æ­¤ï¼Œç›®æ¨™ ICEM æ¨¡å‹èˆ‡ç¨‹å¼é›»
ï§Šæºæ¨¡å‹å·²å–å¾—ã€‚ 
 
åœ– 2   ç¤ºæ³¢å™¨ï¥¾æ¸¬ VDDè…³ä½é›»å£“ 
åœ– 3   IC å·¨è§€ EMC æ¨¡å‹ 
 
åœ– 4   æ™‚åŸŸè¨Šè™Ÿæ¯”è¼ƒåœ–(è™›ç·šï¼šï¥¾æ¸¬ã€å¯¦ç·šï¼šæ¨¡æ“¬) 
3.3. æŒ‡ï¦¨é›†é›»ï§Šæºè³‡ï¦¾åº« 
å†é‡æ–°ç‡’ï¤¿ä¸€çµ„ä¸­é–“ç©¿æ’ç›®æ¨™æŒ‡ï¦¨ä¹‹ç¨‹å¼åŠ 
[1] MPLAB IDE ä½¿ç”¨æ‰‹å†Š. 
[2] å³ä¸€è¾², PIC16F84 å–®æ™¶ç‰‡å¾®é›»è…¦å…¥é–€å¯¦å‹™. æ°‘
88: å…¨è¯. 
[3] é¾å¯Œæ˜­, PIC16C84 å–®æ™¶ç‰‡å¾®é›»è…¦ æ°‘ 84: å…¨è¯. 
[4] ç¶“æ¿Ÿéƒ¨æ¨™æº–æª¢æª¢å±€. http://www.bsmi.gov.tw/.  
[5] è”¡æœæ´‹, å–®æ™¶ç‰‡å¾®é›»è…¦ 8051/8951 åŸï§¤èˆ‡æ‡‰ç”¨. 
ï§‘ç‰ˆ ed. 2003[æ°‘ 92] å…¨è¯. 
[6] ï§´æ¼¢ï¦. ï¥©ä½èˆ‡é€šä¿¡çš„é›»ç£ç’°å¢ƒæ•ˆæ‡‰. - EMC èˆ‡
SAR åˆ†æ.  2005  
http://www.ce.fcu.edu.tw/news/EMC ç°¡ä»‹.pdf  
[7] å”æ°¸å¥‡. EMC çš„ï¥¾æ¸¬æŠ€è¡“èˆ‡æ¨™æº–ç™¼å±•.  2006 
http://www.dyuee.net/EMC_tang.ppt. 
[8] ic-emc tool. http://www.ic-emc.org/. 
[9] iec.  http://www.iec.ch/. 
[10] microchip.  http://www.microchip.com/. 
[11] HI-TECH PICC. v8.05PL2 
http://soft.winzheng.com/Default.htm. 
[12] Ben Dhia, S., et al. Characterisation of 
micro-controller electromagnetic emission: 
models for an international standard. 2002. 
[13] HI-TECH PICC. http://www.htsoft.com/. 
[14] Crovetti, F.F.a.P., EME FILTERING EFFECT IN 
A MICROCONTROLLER POWER 
DISTRIBUTION NETWORK, in emc europe. 
2006: barcelona. 
[15] S. Ben Dhia, M.R.E.S., EMC of ICs: Techniques 
for low emission and susceptibility: Springer.
 
10A 100A
2
1.1 IC
IC
(Computer aided design, CAD)
(Optimization target)
( p e r f o r m a n c e ) ( p o w e r
consumption) (area)
3
4
IC
5
5
452 0 0 8  A p r i l  N o . 7 4
1
2 IC
3
4
  
 
  	
 
 
 
    
  
	

 
 
      
     	

  
 
     
  
     
    	
 
 
 
 
 
 
   
  
  
   

 
   	

 

  
     
   
     
  
   
     
   
     
  
   
   
    
     
     
   
   
     
    
   
  
  
!   
"! 
	
    
 
    !
   
    
  	  
  !
   
     

  !
     
   
   
   
    
      
     
  
 !  
    
 
 
 
 
 
 
 
 
  
   
 
  
  
  
  
  
 
  
 
  
  
  
  
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 
 
 
 
 
 
 
 
	# 
#
  
  !   
    
 
   
   
  
  
  
  
  
!   
   
 
 #  
 
 	   
  
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
	
 
  
  
 
 
  
 
 
	 
 $	#
 "
%#
 
  & 
  
'  	#

 	#	
 
	# 
 
    
     
    
 	
     

   
 
 
 
 	#
  !	# 
    
    
     	
 
  
 
  
   
    	

  

 
 
 
 
 
  
   
    
 
  	

 

 
  
  ! 
 	
  

 
  
   !
  
     
 	#   !  
 # 
	   
   
 ( 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  	
 
 
  
 
  	



  	
 
 
  
     
  
 
    
 	  	#
 	# 	#  
 	# )  
   
  	#   
*  
 
 (





 


  
   
     
    
     	



   
     
    
     
    
     
  
    
 
 
 	
 

 
 
 
 	

 

 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
     
  !   
      
      
      
      
      
      
      
      
    
  
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #
   
   
  
 ! 
    
   
	 
   
   

  
 !   
   
    
  
  	   
 
  	#  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #  
   
   
  
  
 
  
  
  
  
  
 
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
 
  
  !   
   
    
  
 	   
 #  
 
 	  
 #   
  
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
   
 
     

	  
   
   
    
  
     

	 
  
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
$  
!   
   
  !  
    
  !   
   
   !  
    
   !  
    
   
 ! 
   
  !   
    
    !  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 	

 

 
 
  	 	
 
 
  
    
   
 
   
   
  
  
   
   
  
  
 	#  
 	#   
	#   
    
 	

 

 
  
  
   	
 
 
 
     
      
    
      
     
      
    
     
      
      
     
  
    
   
 
 
 
 
 
 
 
 
 # 
  
   
 
   
    
 
    
  
   
   
 
  
 
  
  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
  
  
  
  
  
 
  
 
  
 !   
   
    
  
    

 	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
61967-1 8 IEC 61967-4 9
IEC 61967-4
1
1
1 5 0
IC 150 50
1.4 EMC
1.3
EMC
IC IC
IC
1.SPICE Simulation Program
with Integrated Circuit Emphasis
2.Seamless Co-Verification Environ-
ment  (CVE) (Mentor
Graphics)
/
(embedded system)
(SoC)
( v i r t u a l
prototype)
Seamless 
(coherent  memory
server)
Seamless 
3.SystemC OSCI (Open SystemC
Initiative)
C + +
C++ SystemC
(class) C++ C++
C + +
SystemC
C + +
SystemC
SystemC UTF
472 0 0 8  A p r i l  N o . 7 4
8 IEC-61967-1 layout
9 IEC-61967-4
  
 
  	
 
 
 
    
  
	

 
 
      
     	

  
 
     
  
     
    	
 
 
 
 
 
 
   
  
  
   

 
   	

 

  
     
   
     
  
   
     
   
     
  
   
   
    
     
     
   
   
     
    
   
  
  
!   
"! 
	
    
 
    !
   
    
  	  
  !
   
     

  !
     
   
   
   
    
      
     
  
 !  
    
 
 
 
 
 
 
 
 
  
   
 
  
  
  
  
  
 
  
 
  
  
  
  
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 
 
 
 
 
 
 
 
	# 
#
  
  !   
    
 
   
   
  
  
  
  
  
!   
   
 
 #  
 
 	   
  
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
	
 
  
  
 
 
  
 
 
	 
 $	#
 "
%#
 
  & 
  
'  	#

 	#	
 
	# 
 
    
     
    
 	
     

   
 
 
 
 	#
  !	# 
    
    
     	
 
  
 
  
   
    	

  

 
 
 
 
 
  
   
    
 
  	

 

 
  
  ! 
 	
  

 
  
   !
  
     
 	#   !  
 # 
	   
   
 ( 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  	
 
 
  
 
  	



  	
 
 
  
     
  
 
    
 	  	#
 	# 	#  
 	# )  
   
  	#   
*  
 
 (





 


  
   
     
    
     	



   
     
    
     
    
     
  
    
 
 
 	
 

 
 
 
 	

 

 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
     
  !   
      
      
      
      
      
      
      
      
    
  
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #
   
   
  
 ! 
    
   
	 
   
   

  
 !   
   
    
  
  	   
 
  	#  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #  
   
   
  
  
 
  
  
  
  
  
 
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
 
  
  !   
   
    
  
 	   
 #  
 
 	  
 #   
  
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
   
 
     

	  
   
   
    
  
     

	 
  
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
$  
!   
   
  !  
    
  !   
   
   !  
    
   !  
    
   
 ! 
   
  !   
    
    !  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 	

 

 
 
  	 	
 
 
  
    
   
 
   
   
  
  
   
   
  
  
 	#  
 	#   
	#   
    
 	

 

 
  
  
   	
 
 
 
     
      
    
      
     
      
    
     
      
      
     
  
    
   
 
 
 
 
 
 
 
 
 # 
  
   
 
   
    
 
    
  
   
   
 
  
 
  
  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
   
   
 
   
   
  
    
   
  
  
  
  
   
    
    
    
    
 
 
 
 
 
 
 
 
 
 
 
 
492 0 0 8  A p r i l  N o . 7 4
1.8 
11
( I n t e r n a t i o n a l
Electrotechnical Commission, IEC) IEC
61967-1 IEC61967-4
IC-EMC Tool
WinSpice
(Integrated Circui t  Electromagnet ic
Compatibility Model, IC-EMC Model)
(Instruction
Current Model, ICM)
(Instruction Set Simulation, ISS)
2.1 
12
13
R/L/C
2.2 
2.2.1 
1411
12 Schematic
13
14
  
 
  	
 
 
 
    
  
	

 
 
      
     	

  
 
     
  
     
    	
 
 
 
 
 
 
   
  
  
   

 
   	

 

  
     
   
     
  
   
     
   
     
  
   
   
    
     
     
   
   
     
    
   
  
  
!   
"! 
	
    
 
    !
   
    
  	  
  !
   
     

  !
     
   
   
   
    
      
     
  
 !  
    
 
 
 
 
 
 
 
 
  
   
 
  
  
  
  
  
 
  
 
  
  
  
  
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 
 
 
 
 
 
 
 
	# 
#
  
  !   
    
 
   
   
  
  
  
  
  
!   
   
 
 #  
 
 	   
  
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
	
 
  
  
 
 
  
 
 
	 
 $	#
 "
%#
 
  & 
  
'  	#

 	#	
 
	# 
 
    
     
    
 	
     

   
 
 
 
 	#
  !	# 
    
    
     	
 
  
 
  
   
    	

  

 
 
 
 
 
  
   
    
 
  	

 

 
  
  ! 
 	
  

 
  
   !
  
     
 	#   !  
 # 
	   
   
 ( 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  	
 
 
  
 
  	



  	
 
 
  
     
  
 
    
 	  	#
 	# 	#  
 	# )  
   
  	#   
*  
 
 (





 


  
   
     
    
     	



   
     
    
     
    
     
  
    
 
 
 	
 

 
 
 
 	

 

 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
     
  !   
      
      
      
      
      
      
      
      
    
  
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #
   
   
  
 ! 
    
   
	 
   
   

  
 !   
   
    
  
  	   
 
  	#  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #  
   
   
  
  
 
  
  
  
  
  
 
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
#
   
  
  
! 
    
   
	 
   
   

  
 !   
   
    
  
 	   

  	#  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
$  
!   
   
  !  
    
  !   
   
   !  
    
   !  
    
   
 ! 
   
  !   
    
    !  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 	

 

 
 
  	 	
 
 
  
    
   
 
   
   
  
  
   
   
  
  
 	#  
 	#   
	#   
    
 	

 

 
  
  
   	
 
 
 
     
      
    
      
     
      
    
     
      
      
     
  
    
   
 
 
 
 
 
 
 
 
 # 
  
   
 
   
    
 
    
  
   
   
 
  
 
  
  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
   
 
     

	  
   
   
    
  
     

	 
  
    
 
 
 
 
 
 
 
 
 
 
 
 
512 0 0 8  A p r i l  N o . 7 4
4 M H z 2 0
EMC
IC EMI
EMI
SID PIC12F629
Spice
ICM
ICM
EMI
EMI
EMI
[1] Shih-Yi Yuan, Chi-Feng Yang, Eitenne
Sicard, Chiu-kuo Chen, and Shry-Sann
Liao, â€œEMI Prediction Under a Different
Program Behaviorâ€, IEEE EMC 2007
Hawaii, 2007.
[2] ITRS information can be downloaded
from http://itrs.public.org
[3] Shuo Wang, Fred C. Lee and Jacobus
Daniel van Wyk. â€œDesign of Inductor
Winding Capacitance cancellation for
EMI suppression,â€ IEEE transactions on
Power Electronics, Vol. 21, No. 6, 2006,
17
18
19
  
 
  	
 
 
 
    
  
	

 
 
      
     	

  
 
     
  
     
    	
 
 
 
 
 
 
   
  
  
   

 
   	

 

  
     
   
     
  
   
     
   
     
  
   
   
    
     
     
   
   
     
    
   
  
  
!   
"! 
	
    
 
    !
   
    
  	  
  !
   
     

  !
     
   
   
   
    
      
     
  
 !  
    
 
 
 
 
 
 
 
 
  
   
 
  
  
  
  
  
 
  
 
  
  
  
  
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 
 
 
 
 
 
 
 
	# 
#
  
  !   
    
 
   
   
  
  
  
  
  
!   
   
 
 #  
 
 	   
  
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
	
 
  
  
 
 
  
 
 
	 
 $	#
 "
%#
 
  & 
  
'  	#

 	#	
 
	# 
 
    
     
    
 	
     

   
 
 
 
 	#
  !	# 
    
    
     	
 
  
 
  
   
    	

  

 
 
 
 
 
  
   
    
 
  	

 

 
  
  ! 
 	
  

 
  
   !
  
     
 	#   !  
 # 
	   
   
 ( 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  	
 
 
  
 
  	



  	
 
 
  
     
  
 
    
 	  	#
 	# 	#  
 	# )  
   
  	#   
*  
 
 (





 


  
   
     
    
     	



   
     
    
     
    
     
  
    
 
 
 	
 

 
 
 
 	

 

 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
     
  !   
      
      
      
      
      
      
      
      
    
  
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #
   
   
  
 ! 
    
   
	 
   
   

  
 !   
   
    
  
  	   
 
  	#  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #  
   
   
  
  
 
  
  
  
  
  
 
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
#
   
  
  
! 
    
   
	 
   
   

  
 !   
   
    
  
 	   

  	#  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
$  
!   
   
  !  
    
  !   
   
   !  
    
   !  
    
   
 ! 
   
  !   
    
    !  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 	

 

 
 
  	 	
 
 
  
    
   
 
   
   
  
  
   
   
  
  
 	#  
 	#   
	#   
    
 	

 

 
  
  
   	
 
 
 
     
      
    
      
     
      
    
     
      
      
     
  
    
   
 
 
 
 
 
 
 
 
 
  
  
  
  
  
  
 
  
 
  
 !   
   
    
  
     
 
 	 
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #  
   
   
  
  
 
  
  
  
  
  
 
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
2005
[25] 8051/8951
2003
[26] 8051
2002
[27] seamless 
[28] 
Emc sar
h t t p : / / w w w. c e . f c u . e d u . t w /
news/EMC .pdf 
[29] EMC
2006 http://www.dyuee.net/
EMC_tang.ppt
532 0 0 8  A p r i l  N o . 7 4
1
addwf 0.000255 bcf 0.001612
andwf 0.000256 bsf 0.001176
clrf 0.000372 btfsz not jump 0.001068
clrw 0.00025 btfsc 0.000645
comf 0.000558 btfss 0.000354
decf 0.000384 btfss 0.000519
Decfsz not jump 0.001446 addlw 0.001141
decfsz 0.000883 andlw 0.00019
incf 0.000407 call 0.000553
Incfsz not jump 0.001135 clrwdt 0.001328
incfsz 0.001591 goto 0.000411
iorwf 0.001596 iorlw 0.000381
movf 0.000502 movlw 0.000909
movwf 0.000738 retfie 0.000543
nop 0.000193 retlw 0.000544
rlf 0.001064 return 0.000889
rrf 0.001546 sublw 0.001348
subwf 0.00187 xorlw 0.001483
swapf 0.001151 xorwf 0.001517
  
 
  	
 
 
 
    
  
	

 
 
      
     	

  
 
     
  
     
    	
 
 
 
 
 
 
   
  
  
   

 
   	

 

  
     
   
     
  
   
     
   
     
  
   
   
    
     
     
   
   
     
    
   
  
  
!   
"! 
	
    
 
    !
   
    
  	  
  !
   
     

  !
     
   
   
   
    
      
     
  
 !  
    
 
 
 
 
 
 
 
 
  
   
 
  
  
  
  
  
 
  
 
  
  
  
  
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 
 
 
 
 
 
 
 
	# 
#
  
  !   
    
 
   
   
  
  
  
  
  
!   
   
 
 #  
 
 	   
  
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
	
 
  
  
 
 
  
 
 
	 
 $	#
 "
%#
 
  & 
  
'  	#

 	#	
 
	# 
 
    
     
    
 	
     

   
 
 
 
 	#
  !	# 
    
    
     	
 
  
 
  
   
    	

  

 
 
 
 
 
  
   
    
 
  	

 

 
  
  ! 
 	
  

 
  
   !
  
     
 	#   !  
 # 
	   
   
 ( 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  	
 
 
  
 
  	



  	
 
 
  
     
  
 
    
 	  	#
 	# 	#  
 	# )  
   
  	#   
*  
 
 (





 


  
   
     
    
     	



   
     
    
     
    
     
  
    
 
 
 	
 

 
 
 
 	

 

 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
     
  !   
      
      
      
      
      
      
      
      
    
  
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #
   
   
  
 ! 
    
   
	 
   
   

  
 !   
   
    
  
  	   
 
  	#  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
   
   
  
  
   
  
   
  
   
   
  
   
   
  
   
  
  
   
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	#  
#
  
  
  
   !   
    
    
  
 	   
 #  
 
 	  
 #   
  
   
    
   
   
    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
    
  
   ! 
  
    

	 
  

  
! 
    
 !   
     
   
 
    

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
 #  
   
   
  
  
 
  
  
  
  
  
 
  
  
  
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
  
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
#
   
  
  
! 
    
   
	 
   
   

  
 !   
   
    
  
 	   

  	#  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
	# 
#  
!  
    
 !   
     
     
     
     
     
     
     
     
   
 
     

	 
  
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
$  
!   
   
  !  
    
  !   
   
   !  
    
   !  
    
   
 ! 
   
  !   
    
    !  
   
 
 
 
 
 
 
 
 
 
 
 
 

  
!   
   

  
!   
  
 !    
    
  !   
    
 !    
    
    
   
  
   
   
  
 	

 

 
 
  	 	
 
 
  
    
   
 
   
   
  
  
   
   
  
  
 	#  
 	#   
	#   
    
 	

 

 
  
  
   	
 
 
 
     
      
    
      
     
      
    
     
      
      
     
  
    
   
 
 
 
 
 
 
 
 
 
  
  
  
  
  
  
 
  
 
  
 !   
   
    
  
     
 
 	 
   
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 	# 
#
   
  
  
! 
    
   
	 
   
   

  
 !   
   
    
  
 	   

  	#  
 
  
 
 
 
 
 
 
 
 
 
 
 
 
æœ¬æ–‡å°‡å°é€™äº›æ¨™æº–ä½œåŸºæœ¬ä»‹ç´¹ï¼ŒåŒæ™‚äº¦ï¥«è€ƒå…¶æ–¹æ³•ï¥¾æ¸¬ IC å±¤ç´šçš„é »åŸŸåŠæ™‚
åŸŸç‰¹æ€§ï¼Œä¸¦ä¾æ­¤å»ºï§·å…¶é›»ç£å¹²æ“¾æ¨¡å‹ï¼Œæ¥è‘—ï¼Œé€²ä¸€æ­¥åˆ†æåŠæ¯”å°ï¥¾æ¸¬èˆ‡æ¨¡å‹æ¨¡
æ“¬çš„çµæœï¼Œä¿¾ï§å»ºï§·ä¸€è¼ƒï¨ç¢ºçš„ IC-EMC æ¨¡å‹ï¼Œä»¥ï¥¥æŒæ¡ IC çš„ EMC ç‰¹æ€§ã€‚ 
æœ¬æ–‡æ¶æ§‹å…±åˆ†æˆ 6 å€‹ç« ç¯€ï¼Œç¬¬ 1 ç« ä»‹ç´¹ç ”ç©¶èƒŒæ™¯èˆ‡ç›®çš„ã€‚ç¬¬ 2 ç« ç©é«”é›»ï¤·
é›»ç£å¹²æ“¾ï¥¾æ¸¬çš„ä»‹ç´¹ç¬¬ 3 ç« ç©é«”é›»ï¤·ä¹‹é›»ç£å¹²æ“¾æ¨¡å‹çš„ä»‹ç´¹ï¼Œç¬¬ 4 ç« åœ‹éš›é–“ç™¼
å±•çš„ç¾æ³ã€‚ç¬¬ 5 ç« æ¨™æº–æª¢é©—å±€ç©é«”é›»ï¤·é›»ç£ç›¸å®¹å¯¦é©—å®¤åŸºç¤å»ºè¨­çš„è¦åŠƒã€‚ç¬¬ 6
ç« çµï¥ 
 
2. ç©é«”é›»ï¤·é›»ç£å¹²æ“¾çš„ï¥¾æ¸¬ [2][3][4][5][6][7] 
å»ºï§· IC é›»ç£å¹²æ“¾ï¥¾æ¸¬æ¨™æº– IEC 61967 ä¹‹ç›®çš„ï¼Œæ˜¯ç‚ºï¦ºå»ºï§·çµ±ä¸€çš„ IC é›»
ç£å¹²æ“¾ï¥¾æ¸¬ç’°å¢ƒï¼Œä»¥ï¥¾æ¸¬ï¤­è‡ª IC çš„ RF æ“¾å‹•ï¼Œä½¿ï¥¾æ¸¬çµæœå¯ä»¥åœ¨åŒä¸€å€‹ï¥«è€ƒ
æ¢ä»¶ä¸‹ï¼Œä½œæ¯”è¼ƒæˆ–ä½œç‚ºå»ºï§·ï¨ˆç‚ºæ¨¡å‹ä¹‹ä½¿ç”¨ï¼Œæ¯ä¸€ç¨®ï¥¾æ¸¬æ–¹æ³•å„æœ‰å…¶ç‰¹è‰²èˆ‡
é™åˆ¶ï¼Œä½¿ç”¨è€…å°‡ä¾è‡ªå·±çš„éœ€æ±‚é¸æ“‡é©åˆçš„æ¸¬è©¦æ–¹æ³•ã€‚ 
 
2.1 TEM Cell ï¥¾æ¸¬æ³• 
 2.1.1 ï¥¾æ¸¬ç³»çµ±çš„å»ºï§· 
        TEM Cell ï¥¾æ¸¬ç³»çµ±ä¹‹å»ºç½®(setup)å¦‚åœ– 2.1 æ‰€ç¤ºï¼Œæ‡‰ç”¨ä¸Šï¼Œå¯ä»¥å…ˆ
ä½¿ç”¨ TEM Cell æ³•ï¼ŒæŒ‘å‡ºå¹¾å€‹é›»ç£å¹²æ“¾è¼ƒå¤§çš„é »ï¥¡é»ï¼Œç„¶å¾Œé…åˆ IEC 61967-3
è¡¨é¢é›»å ´èˆ‡ç£å ´æƒæï¼Œæ‰¾å‡º IC é›»ï¤·å…§çš„å¹²æ“¾æºé›»ï¤·ï¼Œé‡å°é‚£éƒ¨ä»½çš„é›»ï¤·ï¼Œ
é‡æ–°è¨­è¨ˆæˆ–æ˜¯é‡æ–°ä½ˆç·š(Planning and Routing)ï¼Œæœ€å¾Œå†ä»¥ TEM Cell ï¥¾æ¸¬
æ³•ï¤­é©—è­‰å¾…æ¸¬ ICï¼Œç¢ºèªå…¶é›»å ´èˆ‡ç£å ´å¹²æ“¾æ˜¯å¦å·²ç¶“æœ‰æ”¹å–„ï¼Œç¬¦åˆè¦ç¯„çš„è¦
å®šã€‚ 
    ï¥¾æ¸¬ç³»çµ±çš„æ¶æ§‹ï¼Œå¦‚åœ– 2.1 æ‰€ç¤ºã€‚ç”±ä¸‹é¢å¹¾å€‹éƒ¨ä»½æ‰€çµ„æˆï¼š 
Â„ 1GHz TEM Cellï¼š 
Â„ é »è­œåˆ†æå„€(spectrum analyzer)ï¼š 
Â„ å‰ç½®æ”¾å¤§å™¨(preamplifier)ï¼š 
Â„ é‡å°å¾…æ¸¬ IC æ‰€è¨­è¨ˆä¹‹æ¸¬è©¦é›»ï¤·æ¿ï¼š 
Â„ çµ‚ç«¯é›»é˜» 50 æ­å§†   
 
 
 
 
 
åœ– 2.1 ç‚º TEM Cell ï¥¾æ¸¬ç³»çµ± 
(1)ï¥¾æ¸¬æ™‚ï¼Œå°‡å¾…æ¸¬é›»ï¤·æ¿å®‰è£åœ¨å®šä½ç§»å‹•å¹³å°ä¸Šï¼Œå¾…æ¸¬ IC å°‡æ“ä½œåœ¨æ‰€
æƒ³è¦çš„æ¸¬è©¦æ¨¡å¼ä¸‹ 
(2)å°‡é »è­œåˆ†æå„€ä¾æ¬¡è¨­å®šåœ¨æ‰€æƒ³è¦çš„é »ï¥¡é»ä¸Šã€‚ 
(3)æ¯ä¸€æ¬¡çš„ï¥¾æ¸¬ï¼Œå°‡ä½¿ç”¨ç¨‹å¼ï¤­é©…å‹•å®šä½ç§»å‹•å¹³å°ï¼Œä½¿å¾—è¿‘å ´æ¢é‡å¯
ä»¥åœ¨ IC çš„å°è£æˆ–æ˜¯æ™¶ç‰‡(die)æ­£ä¸Šæ–¹ç´„ 1mm-2mm è™•ä½œè¡¨é¢çš„æƒæï¼Œ
æ¢é‡ç§»åˆ°æ¯ä¸€å€‹ä½ç½®ï¼Œå»æ¢æ¸¬æœ€å¤§å€¼ï¼Œç„¶å¾Œå†ç§»åˆ°ä¸‹ä¸€å€‹ä½ç½®ï¼Œä¸€
ç›´åˆ°æƒå®Œæ‰€æœ‰ IC å¹³é¢ç‚ºæ­¢ã€‚ 
(4)å¾è¿‘å ´æ¢é‡æ‰€ï¥¾åˆ°çš„ IC æˆ–æ™¶ç‰‡(Die)è¡¨é¢é›»å ´æˆ–ç£å ´è³‡ï¦¾ï¼Œå°‡ç¶“å‰
ç½®æ”¾å¤§å™¨æ”¾å¤§å¾Œï¼Œé€åˆ°é »è­œåˆ†æå„€ï¼Œç¶“ä½¿ç”¨ Labview èªè¨€æ›¸å¯«ï¥¾æ¸¬
ç¨‹å¼ï¼Œå¯ä»¥å°‡æ‰€ï¥¾å¾—çš„é »ï¥¡å¤§å°ï¼Œé…åˆè©²å®šä½å¹³å°çš„ç›¸å°åº§æ¨™ä½ç½®ï¼Œ
åœ¨é›»è…¦ç•«å‡ºé›»å ´æˆ–ç£å ´åˆ†ä½ˆåœ–ã€‚å…¶ä¸­å®šä½å¹³å°çš„å®šä½å‘½ï¦¨æ˜¯ä½¿ç”¨
Labview ç¨‹å¼ï¼Œç¶“é GPIP æ¥é¢ï¼Œå°‡å®šä½çš„ä½ç½®å‘½ï¦¨ä¸‹é”è‡³å®šä½ç§»å‹•
å¹³å°ã€‚ 
ã€æ³¨æ„ã€‘ç•¶ä½¿ç”¨ç£é›»ç£å ´æ¢é‡ï¼Œé ˆä½œ 2å€‹åºï¦œçš„è¡¨é¢æƒæï¼Œé¦–å…ˆï¼Œæ¢æ¸¬
å™¨çš„è¿´åœˆ(probe loop)çš„æ–¹å‘ï¼Œæ²¿è‘— IC è¡¨é¢çš„ä¸€å€‹(X)è»¸çš„æ–¹å‘æƒå®Œ
å…¨éƒ¨å¾—åˆ° Xæ–¹å‘çš„ç£å ´åˆ†ä½ˆï¼Œæ¥è‘—ï¼Œå°‡æ¢æ¸¬å™¨çš„è¿´åœˆ(probe loop)çš„
æ–¹å‘æ²¿è‘— Yè»¸æƒå®Œå…¨éƒ¨å¾—åˆ° Yæ–¹å‘çš„ç£å ´åˆ†ä½ˆï¼Œç„¶å¾Œï¤æ›ç£é›»ç£å ´æ¢
é‡ï¼Œä»¥ Hz-probe(ç£é›»ç£å ´æ¢é‡) æ²¿è‘— X æˆ– Y è»¸æƒå®Œå…¨éƒ¨å¾—åˆ° Z æ–¹å‘
çš„ç£å ´åˆ†ä½ˆã€‚ 
 
2.3 ç›´æ¥è€¦åˆ 1æ­å§†/150 æ­å§†ï¥¾æ¸¬æ³• 
2.3.1 ï¥¾æ¸¬ç³»çµ±çš„å»ºï§· 
IEC 61967-4 æ˜¯ä½¿ç”¨ 1 æ­å§† RF é›»ï§Šæ¢é‡èˆ‡ 150 æ­å§†è€¦åˆç¶²ï¤·æ³•ï¤­ï¥¾æ¸¬
IC çš„å‚³å°å¹²æ“¾ã€‚ 
IC é›»ç£å¹²æ“¾ç™¼ç”Ÿçš„åŸå› ï¼Œæ˜¯å› ç‚º IC å…§éƒ¨ç”¢ç”Ÿå¾ˆå¿«é€Ÿçš„é›»å£“ã€é›»ï§Šè®ŠåŒ–
ï¥¡ï¼Œè€Œç”¢ç”Ÿ RF é›»ï§Šï¼Œé€™äº› RF é›»ï§Šç¶“ç”± IC çš„ pin è…³ï§Šå‡ºï¼Œç¶“é›»ï¤·æ¿çš„ä¿¡è™Ÿç·šã€
é›»æ¬–æˆ–æ’ç·š(cable)ï§Šåˆ°é€±é‚Šï¼Œå†ç¶“æœ‰é€±é‚Šçš„æ¥åœ°å›åˆ°é›»ï¤·æ¿çš„æ¥åœ°å¹³é¢åŠ
RF éš”ï§ªçš„åœ°ï¼Œç„¶å¾Œï¼Œå†ç¶“ç”±å›åˆ° IC çš„æ¥åœ°è…³ï¼Œå½¢æˆä¸€å€‹è¿´åœˆï¼Œé€™è¿´åœˆå¯ä»¥
çœ‹æˆæ˜¯ä¸€å€‹ç’°å½¢å¤©ç·š(loop antenna)ï¼Œæ‰€å½¢æˆçš„ RF é›œè¨Šé›»ï§Šçš„è¿´åœˆè¶Šå¤§ï¼Œæ‰€
ç”¢ç”Ÿçš„é›»ç£å¹²æ“¾è¶Šä½ï¼Œé›–ç„¶ IC å…§éƒ¨çµæ§‹æ‰€å½¢æˆçš„é›»ï§Šè¿´åœˆèˆ‡å¤–é¢æ‰€å½¢æˆçš„é›»
ï§Šè¿´åœˆç›¸è¼ƒï¼Œå°å¾ˆå¤šï¼Œä½†æ˜¯é‚£ IC çš„ RF é›»ï§Šé›œè¨Šï¼Œå»æ˜¯å¤–é¢é›»ï¤·é›»ç£å¹²æ“¾çš„
ï¤­æºèˆ‡é‡è¦èƒ½ï¥¾ï¼Œå¤–é¢çš„ RF é›»ï§Šè¿´åœˆå¥½åƒé›»ç£å¹²æ“¾æ”¾å¤§å™¨ä¸€æ¨£ï¼Œæˆ‘å€‘è¦ï¨‰ä½
é›»ç£å¹²æ“¾ï¼Œä¸€ç¨®æ˜¯æŠŠ RF é›»ï§Šè¿´åœˆè®Šå°ï¼Œæˆ–æ˜¯é˜»æ–·å¹²æ“¾æºèˆ‡å—å®³è€…(victims)
çš„å‚³å°æˆ–æ˜¯å¹…å°„ï¤·å¾‘ï¼Œæˆ–æ˜¯ç›´æ¥æ¸›å°‘ RF é›»ï§Šé›œè¨Šçš„å¤§å°ã€‚ 
åœ¨æ¸¬è©¦é›»ï¤·æ¿ä¸Šï¼Œä»»ä½•çš„ RF é›»ï§Šæœ‰å®ƒè‡ªå·±çš„è¿´åœˆå›åˆ° ICï¼Œå¤§éƒ¨ä»½ï¨¦æ˜¯
ç¶“ç”±æ¥åœ°æˆ–æ˜¯é›»æºç·šå›åˆ° IC æœ¬èº«ï¼Œå¦‚åœ– 2.3 æ‰€ç¤ºï¼Œè¿´åœˆ 1ä»£è¡¨é›»æºç·šï¼Œè¿´åœˆ
2 ä»£è¡¨è¼¸å‡ºä¿¡è™Ÿçš„è¿´åœˆï¼Œé€™ï¥¸å€‹ RF é›»ï¤·è¿´åœˆï¨¦æ˜¯ç¶“éå…±åŒçš„ RF éš”ï§ªåœ°èˆ‡é€±
é‚Šåœ°ï¼Œå›åˆ° IC åœ°ï¼Œå› æ­¤ï¼Œåœ¨ RF éš”ï§ªåœ°èˆ‡é€±é‚Šåœ°èˆ‡ IC åœ°ä¹‹é–“æ˜¯æœ€å¥½çš„ï¥¾æ¸¬ä½
2.4.1 ï¥¾æ¸¬ç³»çµ±çš„å»ºï§· 
      å·¥ä½œå¹³å°æ³•ï¤¥ç¬¬ç®±é«”ï¥¾æ¸¬æ³•çš„ï¥¾æ¸¬æ¶æ§‹ï¼Œæ˜¯å¾ IEC 61000-4-6 çš„ï¥¾æ¸¬
æ–¹æ³•(å¦‚åœ– 2.6)æ¨å°éï¤­çš„ï¼Œä¸»è¦æ˜¯ç”¨ï¤­ï¥¾æ¸¬ IC çš„å…±æ¨¡é›œè¨Šï¼ŒRF é›œè¨Šå¯ä»¥
æŠŠä»–åˆ†æˆå·®æ¨¡é›œè¨Šèˆ‡å…±æ¨¡é›œè¨Šï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå…±æ¨¡é›œè¨Šå° EMI çš„å½±éŸ¿æ¯”å·®æ¨¡
é›œè¨Šè¼ƒå¤§ï¼Œã€‚ 
    ï¥¾æ¸¬ç³»çµ±çš„æ¶æ§‹ï¼Œç”±ä¸‹é¢å¹¾å€‹éƒ¨ä»½æ‰€çµ„æˆï¼š(å¦‚åœ– 2.7) 
Â„ å·¥ä½œå¹³å°æ³•ï¤¥ç¬¬ç®±é«”(å¦‚åœ– 2.8) 
Â„ é »è­œåˆ†æå„€(spectrum analyzer)ï¼š 
Â„ ç›´ï§Šé›»æºä¾›æ‡‰å™¨ï¼š 
Â„ é‡å°å¾…æ¸¬ IC æ‰€è¨­è¨ˆä¹‹æ¸¬è©¦é›»ï¤·æ¿ï¼š 
Â„ ç¤ºæ³¢å™¨ 
Â„ çµ‚ç«¯é›»ï¤· 50 æ­å§†   
 
 
 
 
 
 
 
 åœ– 2.6 ç‚º IEC 61000-4-6 ï¥¾æ¸¬ç³»çµ±    åœ– 2.7 å·¥ä½œå¹³å°æ³•ï¤¥ç¬¬ç®±é«”ï¥¾æ¸¬ç³»çµ± 
 
 
 
 
 
 
 
åœ– 2.8 ç‚ºå·¥ä½œå¹³å°æ³•ï¤¥ç¬¬ç®±é«”å¯¦é«”åœ– 
2.5 ç£å ´æ¢é‡ï¥¾æ¸¬æ³• 
2.5.1 ï¥¾æ¸¬ç³»çµ±çš„å»ºï§· 
      ç£å ´æ¢é‡ï¥¾æ¸¬æ³•æ˜¯ä½¿ç”¨éæ¥è§¸å¼çš„æ–¹æ³•ï¤­ï¥¾æ¸¬ IC é›»æºèˆ‡ I/O è…³çš„ RF
é›»ï§Šï¼ŒPCB é›»ï¤·æ¿ä¸Šçš„å¹…å°„é›»ç£å¹²æ“¾çš„å½¢æˆæ˜¯ç”±æ–¼é›»ï¤·æ¿ä¸Šçš„ IC æ‰€ç”¢ç”Ÿçš„
RF é›»ï§Šï¼Œç¶“ç”±é›»æºæˆ–æ˜¯ I/O ä¿¡è™Ÿè…³ï¼Œï§Šåˆ°é›»ï¤·æ¿ä¸Šçš„ä¿¡è™Ÿç·šï¼Œç¶“æ’ç·šæˆ–é›»
çºœç·šåˆ°é€±é‚Šï¼Œå†ç”±é€±é‚Šçš„åœ°å›åˆ°é›»ï¤·æ¿çš„åœ°ï¼Œå†å›åˆ° IC çš„åœ°ï¼ŒIC æ‰€ç”¢ç”Ÿçš„
IC é›»ç£å¹²æ“¾ä¹‹é›»æºç·šç­‰æ•ˆæ¨¡å‹å¦‚åœ– 3.1 æ‰€ç¤ºï¼Œç­‰æ•ˆé›»ï¤·æ‰€ä½¿ç”¨ä¹‹ï¥«ï¥©ï¼Œå…¶
å®šç¾©ï¥¯æ˜å¦‚ä¸‹æ‰€ç¤ºï¼š 
- Ibï¼šRF é›œè¨Šé›»ï§Šã€‚  
-  LpackVddï¼šVdd é›»å£“æ¥è…³è‡³ bonding é–“ä¹‹ç­‰æ•ˆé›»æ„Ÿã€‚ 
- LpackVssï¼š Vss æ¥åœ°æ¥è…³è‡³ bonding é–“ä¹‹ç­‰æ•ˆé›»æ„Ÿã€‚ 
- RpackVddï¼š Vdd é›»å£“æ¥è…³è‡³ bonding é–“ä¹‹ç­‰æ•ˆé›»é˜»ã€‚ 
- RpackVssï¼š Vss æ¥åœ°æ¥è…³è‡³ bonding é–“ä¹‹ç­‰æ•ˆé›»é˜»ã€‚ 
- Cdï¼šVdd é›»å£“æ¥è…³èˆ‡ Vss æ¥åœ°æ¥è…³é–“ä¹‹ç­‰æ•ˆå¯„ç”Ÿé›»å®¹(parasitic 
capacitor)ã€‚  
- Rvddï¼šVdd bonding èˆ‡ die é–“ä¹‹ç­‰æ•ˆé›»é˜»ã€‚ 
- Rvssï¼š Vss bonding èˆ‡ die é–“ä¹‹ç­‰æ•ˆé›»é˜»ã€‚ 
- Lvddï¼šVdd bonding èˆ‡ die é–“ä¹‹ç­‰æ•ˆé›»æ„Ÿã€‚ 
- Lvssï¼šVss bonding èˆ‡ die é–“ä¹‹ç­‰æ•ˆé›»æ„Ÿã€‚ 
- Cbï¼š å…§éƒ¨ die ä¹‹ç­‰æ•ˆé›»å®¹ã€‚ 
 
 
 
 
 
 
åœ– 3.1 IC é›»ç£å¹²æ“¾ä¹‹é›»æºç·šç­‰æ•ˆæ¨¡å‹ 
 
3.2ç­‰æ•ˆæ¨¡å‹ï¥«ï¥©ä¹‹å»ºï§· 
3.2.1 RFé›œè¨Šé›»ï§ŠIbä¹‹å»ºï§· 
(1)å…§å®šå€¼ä¼°è¨ˆæ³• 
ä¸€èˆ¬è€Œè¨€ï¼ŒIbä¹‹å¤§å°ç‚ºï¥©å€‹mAè‡³1Aï¼ŒæŒçºŒ0.5 è‡³ 5nsï¼Œé€±æœŸç‚º500ps è‡³ 
50nsï¼Œé€šå¸¸ï¼ŒåŒæ™‚å‹•ä½œä¹‹Cellï¥©ç´„ä½”æ•´é«”die Cellï¥©ç´„10%å·¦å³ï¼Œæˆ‘å€‘å¯ä»¥
ï§ç”¨æŸ¥è¡¨æ³•ï¤­è¨ˆç®—RFé›œè¨Šé›»ï§Šç”¢ç”Ÿå™¨Ibä¹‹å¤§å°ï¼Œè¨ˆç®—æ–¹æ³•ï¥¯æ˜å¦‚ä¸‹ï¼š 
(a)å‡è¨­æˆ‘å€‘æœ‰ä¸€é¡†ASIC die æ™¶ç‰‡ï¼Œæ¡ç”¨0.18Î¼ mè£½ç¨‹æŠ€è¡“ï¼Œå…¶dieé¢ç©ç‚º
2x2=4 mmÂ²ã€‚æˆ‘å€‘ç”±è¡¨3.1å¯çŸ¥ï¼Œ0.18Î¼ mè£½ç¨‹æŠ€è¡“ï¼Œå…¶Cellå¯†ï¨ç‚º22000ï¼Œ
å¯èƒ½çš„å‹•ä½œï¼ˆswitchï¼‰ä¹‹Cellçš„ï¥©ç›®å³ç´„ç‚º22000X4=88000ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œ
åŒæ™‚å‹•ä½œä¹‹Cellï¥©ç´„ä½”æ•´é«”die Cellï¥©ç´„10%å·¦å³ï¼Œå› æ­¤ï¼Œæ¯ä¸€æ¬¡clock
è§¸ç™¼å¾Œè©²dieç”¢ç”Ÿä¹‹RFé›œè¨Šé›»ï§ŠIbç´„ç­‰æ–¼22000X4x10% gate 
x0.3mA/gate=2640mAã€‚ 
(b)å‡è¨­æˆ‘å€‘æœ‰ä¸€é¡†32bits RISC micro-controllerï¼Œæ¡ç”¨0.18Î¼ mè£½ç¨‹æŠ€
è¡“ã€‚ç¶“æŸ¥è¡¨3.2ï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“å…¶ç´„æœ‰40000gatesï¼Œå› æ­¤ï¼Œæ¯ä¸€æ¬¡clock
è§¸ç™¼å¾Œè©²CPU dieç”¢ç”Ÿä¹‹RFé›œè¨Šé›»ï§ŠIbç´„ç­‰æ–¼40000 x 10%gates 
x0.3mA/gate=1200mA (å¦‚åœ–3.2æ‰€ç¤º) 
I b
R v d d
V D D  o f  th e  IC
V S S  o f  t h e  IC
C d
L v d d
R v s s L v s s
C b
R  P a c k V d d
R  P a c k V s s L  P a c k V s s
L  P a c k V d d
  
åœ–3.3 ç¤ºæ³¢å™¨ï¥¾æ¸¬ICé›»æºVddæ³¢å½¢  
 
åœ–3.4 ç¤ºæ³¢å™¨ï¥¾æ¸¬ICé›»æºVssæ³¢å½¢   
 
3.2.2 Passive elements extraction 
  é€™ç¯€å°‡ï¥¯æ˜ï¼ŒIC-EMEé›»æºç­‰æ•ˆæ¨¡å‹ä¸­R ,L, M, Cï¥«ï¥©å»ºï§·ä¹‹æ–¹æ³•ï¼Œï¥¯æ˜å¦‚ä¸‹ï¼š 
ï¼ˆ1ï¼‰ å…§å®šå€¼ä¼°è¨ˆæ³• 
ï¼ˆaï¼‰ ï¤…ï¦šä¹‹é›»é˜»ã€é›»æ„Ÿèˆ‡äº’æ„Ÿå€¼ï¼ˆLpackVddã€LpackVssã€RpackVddã€    
RpackVssã€Rvddã€Rvssã€Lvddã€Lvssï¼‰ï¼š 
Vddé›»å£“æ¥è…³è‡³bondingé–“ä¹‹ç­‰æ•ˆé›»æ„Ÿèˆ‡ äº’æ„Ÿå€¼LpackVddã€Vssæ¥åœ°
æ¥è…³è‡³bondingé–“ä¹‹ç­‰æ•ˆé›»æ„ŸLpackVss ã€Vddé›»å£“æ¥è…³è‡³bonding
é–“ä¹‹ç­‰æ•ˆé›»é˜»RpackVddã€Vssæ¥åœ°æ¥è…³è‡³bondingé–“ä¹‹ç­‰æ•ˆé›»é˜»
RpackVssã€Vdd bonding èˆ‡dieé–“ä¹‹ç­‰æ•ˆé›»é˜»Rvddã€Vss bonding èˆ‡
dieé–“ä¹‹ç­‰æ•ˆé›»é˜»Rvssã€Vdd bonding èˆ‡dieé–“ä¹‹ç­‰æ•ˆé›»æ„ŸLvddã€Vss 
bonding èˆ‡dieé–“ä¹‹ç­‰æ•ˆé›»æ„ŸLvssï¼Œå¯ä½¿ç”¨ä¸‹é¢è¡¨3.3ï¼Œç´„ï¥¶ä¼°è¨ˆå‡º
ï¤­ã€‚è¡¨3.3 ICè¢«å‹•å…ƒä»¶å€¼ç¯„åœè¡¨ 
å…ƒä»¶ æœ€å°å€¼ æœ€å¤§å€¼ 
LpackVdd, LpackVss 1nH 10nH 
äº’æ„ŸM 0 10nH 
RVdd,RVss 0.1 Ohm 10 Ohm 
LVdd, LVss 1nH 20nH 
Zsub DC value 0 100 Ohm 
Volt 
Sec 
Sec 
Volt 
çŸ¥ï¼Œä¸€èˆ¬è€Œè¨€ï¼ŒCdç‚º10pfè‡³100pfï¼Œé å°æ–¼Cb(ç‚º440pfè‡³1000pfç­‰ç´š)ï¼Œå› æ­¤ç‚º
ç°¡åŒ–è¨ˆç®—æ¨¡å‹ï¼Œæˆ‘å€‘å¿½ï¥¶Cdï¼Œåœ¨ï¤…ï¦—è«§æŒ¯ç™¼ç”Ÿæ™‚ï¼Œé›»ï¤·ç‚ºç´”é›»é˜»æ€§ï¼Œä¸”é˜»æŠ—ç‚º
æœ€å°å€¼ï¼Œå› æ­¤ï¼Œæˆ‘å€‘çœ‹åœ–3.7ï¼Œå¯ç”±å¾—åˆ°ï¥¾æ¸¬æ›²ç·šæœ€ä½é»ä¹‹é˜»æŠ—å€¼R tatal ï¼Œå³
R tatal =R1+R2ï¼Œç”±é›»ï¤·å­¸åŸï§¤æˆ‘å€‘çŸ¥é“ï¼Œä½æ–¼ï¤…ï¦—è«§æŒ¯é »ï¥¡ç‚ºé›»å®¹æ€§é˜»æŠ—ï¼Œæˆ‘å€‘
å–ä½æ–¼10å€è«§æŒ¯é »ï¥¡æ‰€å°æ‡‰åˆ°ä¹‹é˜»æŠ—ç‚ºZ C ï¼Œå³ 
C tatal =
cfZÎ 2
1 ï¼Œå…¶ä¸­ =Î  3.14ï¼Œfï¼šå–ä½æ–¼10å€è«§æŒ¯é »ï¥¡ï¼ŒZ C ï¼šå–ä½æ–¼10å€è«§
æŒ¯é »ï¥¡æ‰€å°æ‡‰åˆ°ä¹‹é˜»æŠ—ã€‚C=C tatal ï¼ŒåŒï§¤ï¼Œç”±é›»ï¤·å­¸åŸï§¤æˆ‘å€‘çŸ¥é“ï¼Œé«˜æ–¼ï¤…ï¦—è«§
æŒ¯é »ï¥¡ç‚ºé›»æ„Ÿæ€§é˜»æŠ—ï¼Œæˆ‘å€‘å–é«˜æ–¼10å€è«§æŒ¯é »ï¥¡æ‰€å°æ‡‰åˆ°ä¹‹é˜»æŠ—ç‚ºZ L ï¼Œå³ 
L tatal = f
Z L
Î 2 ï¼Œå…¶ä¸­ =Î  3.14ï¼Œfï¼šå–é«˜æ–¼10å€è«§æŒ¯é »ï¥¡ï¼ŒZ L ï¼šå–é«˜æ–¼10å€è«§
æŒ¯é »ï¥¡æ‰€å°æ‡‰åˆ°ä¹‹é˜»æŠ—ã€‚L tatal =L1+L2ï¼Œæˆ‘å€‘å‡è¨­VDD èˆ‡ VSS é–“ä¹‹ç­‰æ•ˆé˜»æŠ—æ¨¡
å‹ç‚ºå°ç¨±çš„ï¼Œä¹Ÿå°±æ˜¯L1=L2ï¼Œå› æ­¤ï¼Œæˆ‘å€‘å¯ä»¥å°‡é›»æ„Ÿå€¼ä»¥2ï¼Œï§ç”¨ä¸Šè¿°ï¥¾æ¸¬èˆ‡ä½¿
ç”¨é›»ï¤·åŸï§¤ï¼Œç¶“ï¥©å­¸é‹ç®—å¾Œæ‰€å»ºï§·ä¹‹IC-EMEé›»æºç­‰æ•ˆæ¨¡å‹å¦‚åœ–3.7æ‰€ç¤ºã€‚ 
 
 
V D D
V S SP a c k a g e
D ie
V e c to r
N e tw o rk
A n a ly z e r
p c
V D D
V S SP a c k a g e
S o ld ie r in g  to  
G N D  p la n e
P C B
S M A  c o n n e c to r
 
 
åœ–3.5è¢«å‹•ï¥«ï¥©æŠ½å–ï¥¾æ¸¬æ¥ç·šåœ– 
 
 
åœ– 3.8 æ¨¡æ“¬ç”¢ç”Ÿçš„é˜»æŠ—ï¥¾æ¸¬çµæœ 
 
åœ– 3.9 æ¨¡æ“¬ç”¢ç”Ÿçš„é˜»æŠ—ï¥¾æ¸¬çµæœ 
4.ç©é«”é›»ï¤·é›»ç£ç›¸å®¹åœ‹éš›ç›®å‰ç™¼å±•è¿‘æ³ 
æœ‰é‘‘æ–¼ç©é«”é›»ï¤·é›»ç£ç›¸å®¹çš„é‡è¦æ€§åŠç‚ºå»ºï§·ä¸€å¥—æ¨™æº–åŒ–çš„ï¥¾æ¸¬åŠæ¨¡å‹å»ºï§·
çš„ç¨‹åºèˆ‡æ–¹æ³•ï¼Œåœ‹éš›é›»å·¥å§”å“¡æœƒ(International Electrotechnical Commission)(ç°¡ç¨±
IEC)é€²ï¨ˆä¸€ç³»ï¦œæœ‰é—œç©é«”é›»ï¤·é›»ç£ç›¸å®¹ï¥¾æ¸¬åŠæ¨¡å‹çš„æ¨™æº–çš„è£½è¨‚å·¥ä½œï¼Œå…¶ç›®å‰
çš„æ¨™æº–çš„ç·¨è™Ÿã€åç¨±åŠå‡ºç‰ˆçš„ï§ºæ…‹å¦‚è¡¨ 4.1-è¡¨ 4.7 æ‰€ç¤º[1]ï¼Œç›®å‰é™¤ï¦ºç©é«”é›»ï¤·
é›»ç£å¹²æ“¾çš„ï¥¾æ¸¬å¤§éƒ¨ä»½å·²å‡ºç‰ˆï¼Œç©é«”é›»ï¤·é›»ç£è€å—å‡ºç‰ˆ 3 ä»½æ¨™æº–ï¼Œå¤§éƒ¨ä»½çš„æ¨™
æº–ï¨¦å°šåœ¨è‰æ¡ˆéšæ®µæˆ–å°šæœªæå‡ºã€‚ 
è¡¨ 4.1 ç©é«”é›»ï¤·é›»ç£å¹²æ“¾ï¥¾æ¸¬æ¨™æº– 
æ¨™æº–ç·¨è™Ÿ æ¨™æº–åç¨± å‡ºç‰ˆçš„ï§ºæ…‹ 
IEC 61967-1 Integrated circuits - Measurement of 
electromagnetic emissions, 150 kHz to 1 
GHz - Part 1: General conditions and 
definitions 
2002-03 å‡ºç‰ˆ 
IEC/TS 61967-3 Integrated circuits - Measurement of 
electromagnetic emissions, 150 KHz to 1 
GHz - Part 3: Measurement of radiated 
2005-06 å‡ºç‰ˆ 
IEC 62132-2 Integrated Circuits - Measurement of 
Electromagnetic Immunity, 150 kHz to 1 
GHz - Part 2: Measurement of Radiated 
Immunity - Tem-Cell and Wideband 
Tem-Cell Method 
æœªå‡ºç‰ˆ(A2CD) 
IEC 62132-3 Integrated circuits - Measurement of 
electromagnetic immunity, 150 kHz to 1 GHz 
- Part 3: Bulk Current Injection (BCI) method
æœªå‡ºç‰ˆ(ADIS) 
IEC 62132-4 Integrated circuits - Measurement of 
electromagnetic immunity 150 kHz to 1 GHz 
- Part 4: Direct RF power injection method 
2006-02 å‡ºç‰ˆ 
IEC 62132-5 Integrated circuits - Measurement of 
electromagnetic immunity, 150 kHz to 1 GHz 
- Part 5: Workbench Faraday cage method 
2005-10 å‡ºç‰ˆ 
IEC 62132-6 Integrated circuits-stirred chamber æœªå‡ºç‰ˆ(NP) 
 
è¡¨ 4.3 ç©é«”é›»ï¤·æš«æ…‹é›»ç£è€å—æ¸¬è©¦ 
IEC 62215-1 General and definitions è¨ˆç•«ä¸­å°šæœªæå‡º
IEC 62215-2 Integrated circuits - Measurement of impulse 
immunity - Part 2: Synchronous transient 
injection method 
æœªå‡ºç‰ˆ(CDTS) 
IEC 62215-3 Integrated circuits â€“Part 3:Random Transient 
injection 
æœªå‡ºç‰ˆ(NP) 
 
è¡¨ 4.4 ç©é«”é›»ï¤·é›»ç£å¹²æ“¾è©•ä¼° 
æ¨™æº–ç·¨è™Ÿ æ¨™æº–åç¨± å‡ºç‰ˆçš„ï§ºæ…‹ 
IEC 62228 Integrated circuits - EMC evaluation of CAN 
transceivers 
æœªå‡ºç‰ˆ(BPUB) 
 
è¡¨4.5ç©é«”é›»ï¤·I/Oæ¨¡å‹ 
æ¨™æº–ç·¨è™Ÿ æ¨™æº–åç¨± å‡ºç‰ˆçš„ï§ºæ…‹ 
IEC 62404 Logic digital integrated circuits - 
Specification for I/O Interface Model for 
Integrated Circuit (IMIC version 1.3) 
æœªå‡ºç‰ˆ(BPUB) 
æ­¤å¤–ï¼Œæ—¥æœ¬ Voluntary Control Council for Interference by Information 
Technology Equipment(VCCI)ï¼Œåœ¨ 2005 ï¦ 4 æœˆ 1 æ—¥é–‹å§‹æ¨å‹•æ¨¡çµ„ EMC èªè­‰ï¼Œæ¡
ç”¨çš„ï¥¾æ¸¬æ–¹æ³•ç›®å‰æ˜¯æ¡ç”¨ NEC å…¬å¸ç™¼å±•ç£å ´æ¢é‡ï¥¾æ¸¬æ³•(Magnetic Probe 
method)ã€‚ 
   VCCI ç›®å‰æ“¬å®šï§‘å€‹ç­‰ç´šçš„å¹²æ“¾é™åˆ¶å€¼(å¦‚è¡¨ 4.8-4.9)ï¼Œä»¥å€åˆ¥æ¨¡çµ„çš„å¹²æ“¾ç¾
è±¡ï¼Œä¸¦æ¨™ç¤ºæ–¼æ¨¡çµ„ä¸Šé¢ï¼Œä»¥ï¥¥ä½¿è²·è³£é›™æ–¹å½¼æ­¤ï¦ºè§£ç”¢å“çš„ EMI ç‰¹æ€§, VCCI é‡å°
æ¨¡çµ„çš„æ¨™ç¤ºå¦‚åœ– 4.1 æ‰€ç¤ºã€‚ 
è¡¨ 4.8æ¨¡çµ„å¹²æ“¾é™åˆ¶å€¼ 
æ“¾å‹•ä½æº– é™åˆ¶å€¼(dBuA) 
 10MHz 100MHz 1000MHz 
æ“¾å‹•ä½æº– A 115 95 75 
æ“¾å‹•ä½æº– B 110 80 60 
æ“¾å‹•ä½æº– C 85 65 45 
æ“¾å‹•ä½æº– D 70 50 30 
æ“¾å‹•ä½æº– E 55 35 15 
æ“¾å‹•ä½æº– F 40 20 0 
è¡¨ 4.9 ï§‘å€‹æ¨¡çµ„å¹²æ“¾é™åˆ¶å€¼ç­‰ç´šåŠç¬¦è™Ÿ 
ç·¨è™Ÿ æ“¾å‹•ä½æº– ç¬¦è™Ÿ 
1 A KA 
2 B KB 
3 C KC 
4 D KD 
5 E KE 
6 F KF 
  
 
åœ–4.1 VCCIé‡å°æ¨¡çµ„çš„æ¨™ç¤º  
ä¸€äº›åœ‹éš›å¤§å» ç›®å‰è³£å‡ºçš„ IC ï¨¦æœƒæ¨™ç¤º IC çš„é›»ç£å¹²æ“¾åŠé›»ç£è€å—ç‰¹æ€§çµ¦å®¢æˆ¶ï¥«
è€ƒï¼Œåœ– 4.4 ç‚º Infineon çš„ IC è³‡ï¦¾ï¥¯æ˜æ›¸ã€‚ 
 
 
 
 
åœ– 4.2 ç‚º Infineon çš„ IC è³‡ï¦¾ï¥¯æ˜æ›¸ã€‚ 
Faraday Cage method 
[7] IEC 61967-6,Integrated circuits - Measurement of electromagnetic emissions, 150 
kHz to 1 GHz - Part 6: Measurement of conducted emissions - Magnetic probe 
method 
[8] IEC/TR 62014-3 ,Electronic design automation libraries - Part 3: Models of 
integrated circuits for EMI behavioural simulation. 
[9] Initiation of VCCI Kit Module Program , http://www.vcci.or.jp 
Microcontroller instruction set simulator for EMI 
prediction
Shih-Yi Yuan*, Jia-Wen Luo, Ming-Yuh Lin, Shry-Sann Liao 
Communications Engineering Department Feng Chia University
E-mail: *syyuan@fcu.edu.tw
Abstract  â€”  This paper predicts the EMI time-domain 
behavior when applying different program on a simple 
microcontroller. Using instruction current [1] concept and 
an instruction set simulator (ISS), this work can predict, in 
time domain, accurate EMI behavior of conduct emission 
behavior up to 20X clock frequency. 
1. INTRODUCTION 
Microcontrollers are widely used in products such as 
consumer electronics and automotive electronics. These 
devices and products demand severe electromagnetic 
compatibility (EMC) constraints. Technology and market 
trends lead to smaller electronic devices and demand 
much more functions in these products. ITRS roadmap [2] 
predicts, by the year of 2010, 18nm CMOS process will 
be made available and the operating frequency will be 
near 15GHz in an EMC-confirmed system. 
It is well known that dynamic switching currents of 
supply lines on the silicon die are the main sources for 
conducted electromagnetic emission (EM). It is also 
trivial that the conducted EMI from chips cause the 
system application board to radiate parasitic emission. In 
high performance microcontrollers, clock rates are 
steadily increasing, forcing rise and fall times to decrease. 
Data transmissions are made strongly synchronous all 
over the chip. Besides the clock frequency, high-driving-
capacity and high-frequency output pins, clock-gating 
structures for power saving, functional block power 
supply controls, among other issues all play important 
roles on the VDD dynamic currents considerations. 
Several EM reduction techniques have been proposed, 
for example, the inductor cancellation [3], data encoding 
for cross-take suppression [4], shielding [5][6], dynamic 
voltage scaling [7] and core supply reduction. Although 
the reduction of core supply voltage can reduce emission, 
the benefit is compensated by a drastically increased 
number of simultaneously switching transistors per die 
and faster rising/falling edges due to increasing clock 
rates. The peak transient currents for current chips may 
be as high as 100A [8]. 
Generally, a digital system needs certain components 
to complete specific functionalities. These components 
include microcontroller(s), memories, I/O channels and 
external/internal crystal. 
Traditional EMI measurement requires long time to do 
a detail analysis on a simple-testing-code-loop basis. 
However, in the modern world, varieties of applications 
are usually implemented by the same kind of hardware 
only with different software(s). It is obvious that software 
will change the total digital circuit EMI behavior due to 
techniques such as: output signal switching frequencies 
of different applications; different programmable I/O 
driving capacities; programmable clock rate control by 
clock-gating schemes [9]; programmable crystal input 
driving capacity for jitter reduction; PLL controlling 
schemes; different component power-line controls [10] 
and various power saving strategies [11]. Thus, it is clear 
that, by adapting different techniques mentioned above, 
the EMI behavior will change even in the same hardware 
with different software running on it. 
If a system platform is designed for multi-purpose, 
which is common at present, the software applications 
running on it may switching from one another in a matter 
of milliseconds or even faster. It means the EMI 
behaviors are heavily dependent on the combination and 
execution sequence of a group of applications on the 
system. 
It also means that the current EMI behavior analysis 
standards should conduct numerous application 
combinations and sequences (IEC 61967 [12]). Even 
these analyses are theoretically doable, they will be 
highly impractical. The analysis results would not be 
accurate if the application combinations or execution 
sequences are not similar. To make things worse, the 
trend of hardware reusing is increasing, from 34% (year 
2006), 50% (year 2010), to 90% (year 2020), according 
to ITRS, which means the accurate EMI behavior 
prediction will be more dependent on software behavior 
pattern as time goes by. To make things even worst, by 
the invention of time-sharing operating system (OS), the 
EMI behavior of the total system can be very tricky for 
estimation not to mention how to do an EMI 
modelization. 
In this paper, EMI behaviors of different instructions 
were measured and logged into an instruction current 
database (ICDB). We will use a modified ISS to simulate 
EMI behavior of a system. This modified ISS can use 
ICDB to predict EMI behavior of an embedded system 
which includes microprocessor, memory, interrupt 
controller, simple peripherals and very complex program 
running on it. This work can be extended to practically 
more complex program EMI prediction (ex. OS kernel) 
on any digital or mix-mode system. 
Based on this work, some software design approaches 
overcoming or at least partially compensating the 
parasitic emission noise effects caused by fast 
simultaneous switching can be principally estimated. To 
the best of our knowledge, this work is the first 
observation and prediction of EMI behavior for a 
complex program behavior on embedded system. 
Fig. 4(a). â€œNOP+GOTOâ€ ICM testing program. 
Fig. 4(b). ICM of 4(a). 
Fig. 4. ICM model of PIC code â€œNOP+GOTOâ€ building 
setups.
Fig. 5. Target instruction code testing. 
Fig. 6. ICM building flow. 
Steps 3 and 4 of the ICM building flow are done by a 
curve fitting algorithm between what is measured and 
simulated. 
As we estimated the ICM of each instruction, we found 
each of the instruction current behavior is accurate 
enough if using 8 triangle-shaped periodical current 
waveforms with different amplitude and durations (Fig. 
8). We build each ICM according to the information of 
every current source and named it by the target 
instruction name. All of this information is put into an 
instruction current database (ICDB) for a modified ISS. 
This modified ISS will be detailed in following section. 
Fig. 7. A curve fitting MSE calculation (MOVF, single 
instruction).
Fig. 8. ICM modeling for PIC MOVF instruction.
3.2 ISS Simulation Preparation For PIC System 
SID [16] is an open source ISS engine including a 
script language, which can configure target machine very 
conveniently. SID is a system-level simulator. The 
system can include microcontroller, memory, monitor, 
disk, and other â€œvirtual hardwareâ€. Every â€œvirtual 
hardwareâ€ is a hardware behavior description coded by 
C++ and is defined as a â€œcomponentâ€ by SID. All of 
these SID components are in public domain and are 
freely distributed for academic usages.
3.2.1 ISS Architecture 
Fig. 9 shows the modified SID ISS architecture. There 
is an instruction set simulator engine at bottom. It accepts 
three input sources: PIC ICDB, program code and HW 
configuration. The program code is written by PIC C and 
PIC assembly. All program codes are compiled and 
assembled by industrial compiler and assembler; then, 
transform to binary image. The image is loaded into the 
memory component for SID simulation. 
During the execution, SID simulation engine produces 
a sequence of dynamically generated clock-based 
waveform according to: 
1. What is the target instruction drawn form memory 
component, 
2.What is the target instructionâ€™s ICM drawn from ICDB, 
and
3. What is the pipeline sequence effect according to PIC 
timing specification. 
0. ICM for specific. 
1. Adjust for ICM. 
3. Match with MSE
analyzer program. 
2. Measurement. 
4. MSE
threshold? 
Yes
No
For another Instructionâ€™s 
(each cycle takes 2 clock periods). After searching ICDB, 
PIC ISS will fill each cycle by fetching the proper ICM. 
Using the same procedure, the modified ISS fills 
MOVWF, MOVLW, ADDWF and GOTO instructions in 
the same way. Each cycleâ€™s current waveform is then 
summed up and outputted by cycle. 
Fig. 12. A more complex code for EMI estimation. 
Fig. 13. To compute instruction current during each cycle.
4. EXPERIMENT RESULTS 
4.1 Single Instruction ICM Approximation 
We design each of the instruction current model (ICM) 
based on the ICEM model according to Fig. 6. One of the 
instructions ICM (ADDWF, one of the PIC machine 
instruction) is shown in Fig. 14. 
MSE of all instructions are show in Table 1. All of the 
MSE between measurement and simulation are close to 
the same range (0.19% ~ 0.03%) and justifies the 
prediction to a certain range. 
TIME
Fig. 14. Single instruction ICM for PIC instruction ADDWF. 
Table 1 
MSE of each instruction 
Instruction MSE Instruction MSE 
addwf 0.000255 bcf 0.001612
andwf 0.00019 bsf 0.001176
clrf 0.000372 btfsz no jump 0.001068
clrw 0.00025 btfsc 0.000645
comf 0.000558 btfss 0.000354
decf 0.000384 btfss 0.000519
decfsz no jump 0.001446 addlw 0.001141
decfsz 0.000883 andlw 0.00019 
incf 0.000407 call 0.000553
incfsz no jump 0.001135 clrwdt 0.001328
incfsz 0.001591 goto 0.000411
iorwf 0.001596 iorlw 0.000381
movf 0.000502 movlw 0.000909
nop 0.000193 retfie 0.000543
rlf 0.001064 retlw 0.000544
rrf 0.001546 return 0.000889
subwf 0.00187 sublw 0.001348
swapf 0.001151 xorlw 0.001483
xorwf 0.001517  
4.2 ISS Correctness 
The correctness of PIC ISS is exam by running the ISS 
to see the simulation result and check the input/output 
responses are what we have designed. The simulation of 
Fig. 12 is shown in Fig. 15. The simulation result is 100% 
functionally exact as the physical PIC counterpart, at 
about 100X slower, which is normal or better than 
general functional simulation cases. The reasons may be 
the simplicity of PIC hardware architecture, the 
efficiency code design, or the SID engine optimization. 
Fig. 15. Predicted Output response of Fig. 12 combined with 
other virtual components.
4.3 ISS EMI Correctness 
The modified PIC ISS produces the instruction current 
waveform which is immediately put into WINSPICE 
simulation to find the target system EMI responses. The 
simple loop program timing responses comparison 
between simulation and measurement is shown in Fig. 16. 
The MSE is (0.08%) which is within the MSE range as 
Table 1. However, the frequency responses are not so 
good at high frequency (over estimated). This may be the 
high-order high-frequency response which is not 
considered in ICM and should conduct deeper study into 
the problem. 
		

ï€ 	
	ï€ ï€ ï€ 	
ï€ 
	


ï€ ï€ 	ï€ 


Preliminary Program
Nov. 28, 2007 Paper ID
8.00 10.00 Registration
10.00 10.10 Welcome note
Franco Fiori Â– Politecnico di Torino
10.10 10.40 I_1 Invited talk
Chip level EMC: the role of silicon makers
Ing. M.Monti STMicroelectronics
10.40 11.00 Coffee break
11.00 13.00 IC Modeling for EMC
I_2 Invited Talk
Prof. Tod Hubing Â– Clemson University
05 Estimation of the conducted emissions of high side switches
by using behavior models
B.Deutschmann, F.Camarero, M.Guersoy
Infineon Technologies AG
42 Efficient substrate coupling analysis in smart power
integrated circuits
P.S.Crovetti, F.Fiori Â– Politecnico di Torino
37 Determination of effective parasitic capacitors around IC
package for EMC modeling
K.Iokibe, A.Takahashi, U.Paoloetti, O.Wada Okayama
University
04 Modelling of a direct injection aggression on a 16 bit
microcontroller input buffer
A. Boyer, E.Sicard INSA
52 High accuracy emission simulation models for VLSI chips
T.Steinecke, M.Goekcen, D.Hesidenz, A.Gstoettner
Infineon Technologies AG
13.00 14.00 Lunch
14.00 15.30 Poster session 1
15.30 17.30 EMC Issues in SoC design (I)
03 Estimation of current profiles for large digital VLSI modules
in early design phases
A. Gstottner, M.Huemer University of Erlangen
36 Characterization and suppression of simultaneous switching
output noise for high speed single ended signaling
J.Lee, J.Lee, J.kang, K.Park Hynix Semiconductor
19 Binary inter chip communication based on the transmission
of electric charge pulses
F.Fiori Â– Politecnico di Torino
Nov. 29, 2007 Paper
ID
8.30 9.00 I_3 Invited Talk
Kevin Slattery Â– Intel
9.00 10.40 EMC Measurements
06 IC stripline: a new proposal for susceptibility and emission
testing of ICs
B.Koerber, M.Trebeck, F.Klotz
Zwickau University of Applied Sciences
53 New test method for the pulse immunity of microcontrollers
T.Su, M.Unger, T.Steinecke, R.Weigel
Infineon Technologies AG
01 On choosing the right immunity test for IC's applied as modules
F.Vanhee, J.Catrysse KHBO
20 From IC characterization to system simulation
F.Lafon, D.De Daran VALEO
43 Pulse length and power dependency of the failure threshold of a
low noise amplifier
R.Jonsson, M.Hoijer Swedish defence research agency, FOI
10.40 11.00 Coffee break
11.00 12.40 EMC Measurements
27 An application of frequency domain probe calibration and
compensation procedures in near field measurements over an
integrated circuit
H. Weng, J.Shi, D.G.Beetner, R.E.DuBroff
University of Missouri Rolla
51 Using electric and magnetic moments to characterize
IC coupling to cables and enclosures
T.Hubing, S.Deng, D.Beetner
Clemson University
23 EFT immunity characterization of ICs
F.Musolino Â– Politecnico di Torino
24 Novel measurement method to analyse susceptibility of VLSI's if
DUT gets injected with sinusoidal/EFT signals
G. Auderer Freescale
21 ESD Analysis methodology From IC behavior to PCB prediction
F.Lafon, F.de Daran, S.Lecointre
VALEO
13.00 14.00 Lunch
14.00 15.30 Poster session 2
15.30 18.00 IC design for EMC Compliance
35 Design of an on chip EMI suppressing regulator for automotive
electronics applications
J.Zhou, W.Dehaene ESAT MICAS, Katholieke Universiteit Leuven
26 IC charge pump effect on conducted and radiated emissions in
automotive application
F.Galtie, C.Marot SIEMENS VDO
39 Design guidelines for improvement of EME of Switching circuits,
like charge pump
M.Amighini, V.Poletto STMicroelectronics
46 Power multichip module design regarding EMC
S.Mandray, J.M.Guichon, J.L.Schanen, J.,Roudet G2ELab
Nov. 30, 2007 Paper ID
8.30 10.10 EMC Issue in SoC design (II)
17 Towards an EMC roadmap for Integrated Circuit
E. Sicard, S. Ben Dhia, M. Ramdani INSA
28 System on chip signal integrity enhancement to power
supply disturbances
J.Semiao,M.Rodriguez Irago,M.Moraes,
F.Vargas,M.B.Santos,I.C.Teixeira, J.J. Rodriguea Andina,
J.P.Teixeira
Catholic University PUCRS
48 Microcontroller instruction set simulator for EMI prediction
S.Yuan, J.Luo,M.Lin Feng Chia University
09 Susceptibility to EMI of Sigma Delta Converters
D. Musumeci, P.S.Crovetti, F.Fiori Â– Politecnico di Torino
59 Chip package circuit co modeling for analysis of digital
power and ground noise coupling effect on CMOS negative
feedback amplifier
Y.Shim, J.Park, J.Kim KAIST
10.10 10.30 Coffee break
10.30 11.50 Tools to handle EMC at IC and PCB level
54 Evaluation of different steady state simulation methods for
EMI analyses of ICs
U.Sturmer,G.Thomas, S.Ritzmann, O.Jovic, W.Wilkening,
W.John
Fraunhofer IZM Berlin / Paderborn ASE
13 Full wave analysis of a large IC package using parallel
computing
E.Gjonaj, T.Weiland, I. Munteanu, P.Thoma
Technische Universitaet Darmstadt
02 A methodology for predicting by near field chip to chip
coupling
A.Boyer, A.Boulingui, E.Sicard, S.Ben Dhia, S.Baffreau
INSA
32 Early prediction of immunity problems in integrated circuit
susceptibility testing
J.Loeckx, G.Gielen
11.50 Â– 12.30 Best paper awards & conclusions
