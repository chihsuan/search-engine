verse to only the unstable zeros of the system. This sec-
ond tracking controller requires a d-step preview with d
the number of system delay. The second tracking con-
troller achieves tracking over a wider frequency range
than the first one, and is less sensitive to measurement
noise. The tracking performance of the proposed two
tracking controllers, together with the zero phase error
tracking controller in the literature, are compared in the
frequency domain.
2 FIR Tracking Controller I
Consider a linear discrete-time system
x(k + 1) = Ax(k) +Bu(k) (1)
y(k) = Cx(k) +Du(k)
where x(k) âˆˆ Rn is the system state, y(k) âˆˆ Rm the
system output, and u(k) âˆˆ Rm the control input. For
the tracking control problem to be feasible, the number
of control must be no less than the number of output.
For simplicity, it is assumed in this note that they are
equal. Further, it is assumed that the system matrix A
is already stabilized by a state feedback control; hence,
A is a stable matrix. The system delay is defined to be
the relative degree of the transfer function from u(k) to
y(k).
The transfer function from the control input u(k) to
the system output y(k) is H(z) = C(zI âˆ’ A)âˆ’1B +D.
The purpose of this note is to present a feedforward
tracking controller F (z) in Figure 1 so that the system
output y(k) asymptotically tracks the reference output
ym(k) approximately. In other words, F (z) is to achieve
F (z)H(z) â‰ˆ I, for z = ejÏ‰T , Ï‰ âˆˆ [0,â„¦], (2)
where the frequency Ï‰ is within some range of interest
[0,â„¦].
When H(z) has no unstable zeros, one can simply set
F (z) = Hâˆ’1(z) to achieve exact tracking in (2) for all
frequency range. But when H(z) has unstable zeros (is
non-minimum phase), direct inversion of H(z) is pro-
hibited. In this case, one can use an infinite/finite-order
non-causal F (z) to achieve exact/approximate tracking
as in [2] [3]. However, in many control applications,
it is difficult to obtain preview of the reference output
ym(k), hence, non-causal feedforward compensator F (z)
is not practical in these applications. The objective of
this section is then to come up with a causal feedfor-
ward controller F (z) in Figure 1. In particular, F (z)
presented in this note will have the following form,
F (z) = (f0 + f1zâˆ’1 + Â· Â· Â·+ fNzâˆ’N ), (3)
for some finite positive integer N . In other words, F (z)
is an N â€²th-order causal FIR filter for the reference out-
put ym(k). Notice that a causal F (z) can at best achieve
approximate tracking, as suggested in (2), over certain
frequency range instead of exact tracking over all fre-
quencies.
To start the design, one now shows how to derive
an approximate FIR inverse for a system in the state
space form (1). Given a desired reference output ym(k),
assume that there exist a bounded (unknown) control
input um(k) and bounded (unknown) reference state
xm(k) satisfying (1),
xm(k + 1) = Axm(k) +Bum(k) (4)
ym(k) = Cxm(k) +Dum(k).
To find out the unknown control input um(k) from the
given reference output ym(k), one can re-parameterize
the system dynamics in the following way. Let the
present time instant be k. It follows from (4) that the
previous time reference state xm(j), j âˆˆ [kâˆ’N, kâˆ’1], re-
lates to the present time reference state xm(k) through
the following relationship:
xm(j) = Ajâˆ’kxm(k)âˆ’
kâˆ’1âˆ‘
i=j
Ajâˆ’iâˆ’1Bum(i), j âˆˆ [k âˆ’N, k âˆ’ 1].
The above equation is a backward evolution (j < k)
of the system dynamics (4). From this, the previous
time reference output ym(j) relates to the present time
reference state xm(k) as follows,
ym(j) = CAjâˆ’kxm(k)âˆ’
ï£«ï£­kâˆ’1âˆ‘
i=j
CAjâˆ’iâˆ’1B âˆ’D
ï£¶ï£¸um(i),
j âˆˆ [k âˆ’N, k âˆ’ 1]. (5)
Note that in the above equations, one need to inverse
the system matrix A (j < k). Hence, the following
assumption is required.
A1. The open-loop system matrix A is nonsingular;
that is, detA 6= 0.
Further, assume that the control input over a local
time interval [kâˆ’N, k] can be approximately curve-fitted
by a polynomial of order p.
A2. The control input um(i) in (5) can be locally ex-
pressed as
um(i) = hp(k)(iâˆ’ k)p + . . .+ h1(k)(iâˆ’ k) + h0(k) + (i),
i âˆˆ [k âˆ’N, k], (6)
with almost zero polynomial fitting error (i) â‰ˆ 0.
2
ï£«ï£­ kâˆ‘
j=kâˆ’N
Î¦(j)T 1(j)
ï£¶ï£¸ . (14)
Equation (13) gives an estimate of the present time state
xm(k), and the coefficients hi(k) in the polynomial fit-
ting (6) of the control input um(i). An estimate of the
present time control input um(k) is then obtained by
setting i = k in (6), yielding
uË†m(k) = hË†0(k). (15)
The above results are summarized in the theorem be-
low.
Theorem 2: Consider the linear system (4) subject to
assumptions A1, A2 and A3. The reference input um(k)
can be recovered from past reference outputs ym(j), j âˆˆ
[k âˆ’N, k], from (13) and (15) with an estimation error
2(k).
Remark 3 : A careful examination of (13) and (15)
shows that both the state estimate and input estimate in
Theorem 2 are in fact causal FIR filters of the reference
output; that is,
xË†m(k) = (g0 + g1zâˆ’1 + Â· Â· Â·+ gNzâˆ’N )ym(k),
uË†m(k) = (f0 + f1zâˆ’1 + Â· Â· Â·+ fNzâˆ’N )ym(k) def= F1(z)ym(k),(16)
for some constant matrices gi âˆˆ RnÃ—m and fi âˆˆ RmÃ—m.
Notice that both gi and fi can be computed off-line
before the operation of the FIR inverse algorithm. F1(z)
in (16) is called a causal FIR inverse of the system H(z),
and F1(z) can serve as an FIR tracking controller for
H(z) in Figure 1. Finally, it is noted that the order
of the FIR tracking controller N must satisfies N â‰¥
n/m+p according to Remark 1, where n is the dimension
of the system H(z), m is the number of input (=that of
output), and p is the order of the fitting polynomial for
um(k).
Remark 4 : According to assumption A2 and equa-
tion (8), the error 1(j) in (14) is close to zero. If the
matrix P =
âˆ‘k
j=kâˆ’N Î¦(j)
TÎ¦(j) is not ill-conditioned
(having a large condition number), the estimation error
2(k) will also be close to zero, suggesting that the FIR
filter F1(z) in (16) is a good inverse of the system H(z)
over a reasonable frequency range. However, simulation
studies reveal that as the relative degree of the system
H(z) increases, or as the order p of fitting polynomial
for um(k) increases, the condition number of P grows
rapidly. As a result, the estimation error 2(k) becomes
large even though the polynomial fitting error 1(j) in
(14) is small. In this case, the FIR filter F1(z) in Theo-
rem 2 tends to be an inverse of the system (1) only over
a very narrow frequency range.
3 FIR Tracking Controller II
In the previous section, an approximate FIR in-
verse is constructed to function as a tracking controller
for non-minimum phase systems. However, as shown in
Example 1, such design has a disadvantage that the FIR
tracking controller may amplify the measurement noise
in the reference output ym(k), deteriorating the tracking
performance. Hence, in this section, a different tracking
controller will be presented to avoid such disadvantage.
The idea is to use FIR inverse only for the unstable-
zero part of the system, and inverse the stable-zero part
and system delay directly. To do so, one factors the
system transfer function H(z) in Figure 1 as
H(z) =
B+(z)Bâˆ’(z)
A(z)
=
(
B+(z)(z + Î±)nâˆ’
A(z)
)(
Bâˆ’(z)
(z + Î±)nâˆ’
)
, (17)
where A(z) is a polynomial containing poles of the sys-
tem, B+(z) a polynomial with stable zeros, Bâˆ’(z) with
unstable zeros, Î± any real number with |Î±| < 1, and nâˆ’
the degree of polynomial Bâˆ’(z). In the above equation,
the system H(z) is decomposed into two sub-systems.
The sub-system in the first parenthesis contains the sys-
tem delay and is minimum-phase; hence, it can be di-
rectly inversed. The sub-system in the second parenthe-
sis is non-minimum phase and causal, and can not be
directly inversed.
The tracking control design is to directly inverse the
first sub-system in (17), and apply the FIR inverse in
Theorem 2 to the second sub-system Bâˆ’(z)/(z + Î±)nâˆ’ .
Hence, the proposed second tracking controller is given
by
F2(z) =
A(z)
B+(z)(z + Î±)nâˆ’
R(z),
R(z) = (r0 + r1zâˆ’1 + Â· Â· Â·+ rNzâˆ’N ) (18)
where R(z) is the FIR inverse of Bâˆ’(z)/(z+Î±)nâˆ’ . No-
tice that F2(z) is non-causal, and hence requires d steps
preview of the reference output, with d the number of
system delay in H(z).
4 Conclusions
This note introduces an approximate FIR inverse
algorithm for discrete-time linear dynamic systems.
Two feedforward tracking controllers are constructed for
non-minimum phase systems based on the FIR inverse
algorithm. The first tracking controller applies the FIR
inverse to the whole system. The second tracking con-
troller applies the FIR inverse to the unstable zeros of
4
[8] S. Devasia, D. Chen, and B. Paden, â€Nonlinear
inversion-based output trackingâ€, IEEE Trans. Au-
tomatic Control, Vol. 41. No. 7, pp. 930-942, 1996.
[9] L. Marconi, G. Marro, and C. Melchiorri, â€A solu-
tion technique for almost perfect tracking of non-
minimum-phase, discrete-time linear systemsâ€, Int.
J. Control, Vol. 74. No. 5, pp. 496-506, 2001.
[10] G. C. Goodwin, and K. S. Sin, Adaptive Filtering:
Prediction, and Control, Prentice-Hall, 1984.
[11] T. Kailath, Linear Systems, Prentice-Hall, page
655, 1998.
[12] J. Tokarzewski, K. Latawiec, and L. Sokalski, â€A
note on physical interpretation of zeros in discrete-
time MIMO LTI systemsâ€, Proceedings of IEEE
International Symposium on Industrial Electronics,
vol. 3, pp. 1099-1104, 1999.
6
98ï¦Žï¨å°ˆé¡Œç ”ç©¶è¨ˆç•«ç ”ç©¶æˆæžœå½™æ•´è¡¨ 
è¨ˆç•«ä¸»æŒäººï¼šé™³æ˜Žæ–° è¨ˆç•«ç·¨è™Ÿï¼š98-2221-E-002-147- 
è¨ˆç•«åç¨±ï¼šç·šæ€§éžæ¥µå°ç›¸ä½ç³»çµ±ä¹‹ FIR å¾ªè»ŒæŽ§åˆ¶å™¨è¨­è¨ˆ 
ï¥¾åŒ– 
æˆæžœé …ç›® å¯¦éš›å·²é”æˆ
ï¥©ï¼ˆè¢«æŽ¥å—
æˆ–å·²ç™¼è¡¨ï¼‰
é æœŸç¸½é”æˆ
ï¥©(å«å¯¦éš›å·²
é”æˆï¥©) 
æœ¬è¨ˆç•«å¯¦
éš›è²¢ç»ç™¾
åˆ†æ¯” 
å–®ä½ 
å‚™ è¨» ï¼ˆ è³ª åŒ– ï¥¯
æ˜Žï¼šå¦‚ï¥©å€‹è¨ˆç•«
å…±åŒæˆæžœã€æˆæžœ
ï¦œ ç‚º è©² æœŸ åˆŠ ä¹‹
å° é¢ æ•… äº‹ ...
ç­‰ï¼‰ 
æœŸåˆŠï¥æ–‡ 0 0 100%  
ç ”ç©¶å ±å‘Š/æŠ€è¡“å ±å‘Š 0 0 100%  
ç ”è¨Žæœƒï¥æ–‡ 0 0 100% 
ç¯‡ 
 
ï¥æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100%   
ç”³è«‹ä¸­ä»¶ï¥© 0 0 100%  å°ˆï§ å·²ç²å¾—ä»¶ï¥© 0 0 100% ä»¶  
ä»¶ï¥© 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šï§ï¤Š 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 2 0 100%  
åšå£«ç”Ÿ 0 0 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å…§ 
ï¥«èˆ‡è¨ˆç•«äººï¦Š 
ï¼ˆæœ¬åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ï§¤ 0 0 100% 
äººæ¬¡ 
 
æœŸåˆŠï¥æ–‡ 0 0 100%  
ç ”ç©¶å ±å‘Š/æŠ€è¡“å ±å‘Š 0 0 100%  
ç ”è¨Žæœƒï¥æ–‡ 0 0 100% 
ç¯‡ 
 
ï¥æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100% ç« /æœ¬  
ç”³è«‹ä¸­ä»¶ï¥© 0 0 100%  å°ˆï§ å·²ç²å¾—ä»¶ï¥© 0 0 100% ä»¶  
ä»¶ï¥© 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šï§ï¤Š 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 0 0 100%  
åšå£«ç”Ÿ 0 0 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å¤– 
ï¥«èˆ‡è¨ˆç•«äººï¦Š 
ï¼ˆå¤–åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ï§¤ 0 0 100% 
äººæ¬¡ 
 
 
