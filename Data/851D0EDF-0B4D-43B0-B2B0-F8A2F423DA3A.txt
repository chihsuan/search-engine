 i
ç›®ï¤¿ 
ç›®ï¤¿ ................................................................................................................................ iÂ 
æ‘˜è¦ ............................................................................................................................. iiiÂ 
Abstract ........................................................................................................................ ivÂ 
I. Introduction .............................................................................................................. 1Â 
II. System Model .......................................................................................................... 4Â 
A. Power Allocation Problem ................................................................................ 5Â 
B. Joint Subcarrier and Power Allocation Problem ............................................... 6Â 
C. Power Allocation under Primary User Activity ................................................. 7 
 
III. Power Allocation for Multiuser OFDM-Based CR Systems.............................. 9Â 
A. Optimal Power Allocation Algorithm for OFDM-Based CR systems .............. 9Â 
B. The Update of the Common Water Level ........................................................ 10Â 
C. The Proposed Suboptimal Power Allocation Algorithm for OFDM-Based CR   
Systems ........................................................................................................... 13Â 
D. Complexity Analysis of Power Allocation Algorithms ................................... 15Â 
E. Simulation Results of Power Allocation Algorithms....................................... 17 
 
IV. Subcarrier and Power Allocation for MU-OFDM CR Systems ....................... 18Â 
A. A Rule for Subcarrier Allocation ..................................................................... 18Â 
B. Joint Subcarrier and Power Allocation with the IPWF Algorithms ................ 20Â 
C. Approximation of Water Level ........................................................................ 20Â 
D. A Suboptimal Joint Subcarrier and Power Allocation Algorithm ................... 21Â 
E. Complexity Analysis of Joint Subcarrier and Power Allocation Algorithms .. 24Â 
F. Simulation Results of Joint Subcarrier and Power Allocation Algorithms ...... 25 
 
V. Power Allocation for OFDM-Based CR Systems under Primary User Activity
...................................................................................................................................... 26Â 
 iii
æ‘˜è¦ 
åœ¨æœ¬è¨ˆç•«ä¸­ï¼Œæˆ‘å€‘é‡å°å¤šç”¨æˆ¶æ­£äº¤åˆ†é »å¤šå·¥ä¹‹æ„ŸçŸ¥ç„¡ç·šé›»ç³»çµ±ç™¼å±•é«˜æ•ˆï¥¡è³‡
æºåˆ†é…æŠ€è¡“ï¼Œå…¶ä¸­åŠŸï¥¡å³°å€¼å°‡è¢«é©ç•¶é™åˆ¶ä»¥ä¿è­·ä¸»è¦ä½¿ç”¨è€…ã€‚åœ¨åŠŸï¥¡å³°å€¼é™åˆ¶æƒ…
æ³ä¸‹ï¼Œç¾æœ‰ä½œæ³•é€šå¸¸æœƒä½¿ç”¨ä¸€å¥—å…·æœ‰é«˜è¤‡é›œï¨çš„æœ€ä½³åŠŸï¥¡åˆ†é…æ¼”ç®—æ³•ï¼ˆå³è¿­ä»£å¼
åˆ†å€æ³¨æ°´æ¼”ç®—æ³•ï¼‰ï¤­åè¦†åŸ·ï¨ˆæ³¨æ°´æ¼”ç®—ï¼Œä»¥æ±ºå®šæ¯å€‹å­è¼‰æ³¢ä¸Šçš„åŠŸï¥¡æ˜¯å¦æ¯”åŠŸï¥¡
å³°å€¼é‚„å¤§ï¼Œè€Œé€™æ¨£æœƒè®“åŠŸï¥¡åˆ†é…è®Šå¾—æ²’æœ‰æ•ˆï¥¡ã€‚ç‚ºï¦ºæ”¹å–„åŠŸï¥¡åˆ†é…æ•ˆï¥¡ï¼Œæˆ‘å€‘æŠ€
å·§åœ°ï§ç”¨ä¸€äº›è¦é”æˆæœ€ä½³åŠŸï¥¡åˆ†é…æ™‚æ‰€å¿…é ˆæ»¿è¶³çš„æ¢ä»¶ï¼Œè¨­è¨ˆå‡ºä¸€å€‹å…·æœ‰ä½è¤‡é›œ
ï¨çš„æ¼”ç®—æ³•ï¼Œï¤­æ»¿è¶³æ¯å€‹å­è¼‰æ³¢ä¸Šçš„åŠŸï¥¡å³°å€¼é™åˆ¶ï¼Œä¸¦æŒçºŒï¤æ–°å­è¼‰æ³¢ä¸Šçš„åŠŸï¥¡
åˆ†é…å€¼ä»¥æœ€å¤§åŒ–é€šè¨Šå®¹ï¥¾ç¸½å’Œï¼ˆSum Capacityï¼‰ã€‚é›»è…¦æ¨¡æ“¬çµæœé¡¯ç¤ºï¼Œæˆ‘å€‘æ‰€æ
å‡ºä¹‹é«˜æ•ˆï¥¡åŠŸï¥¡åˆ†é…æ¼”ç®—æ³•çš„æ•ˆèƒ½å¯é€¼è¿‘æœ€ä½³é€šè¨Šå®¹ï¥¾ç¸½å’Œã€‚ 
ç‚ºï¦ºé€²ä¸€æ­¥æ”¹å–„ç³»çµ±æ•ˆèƒ½ï¼Œæˆ‘å€‘é¦–å…ˆåœ¨åŠŸï¥¡åˆ†é…å·²çŸ¥çš„å‰æä¸‹ï¼Œæ¨å°å‡ºä¸€å€‹
ä½¿é€šè¨Šå®¹ï¥¾ç¸½å’Œæœ€å¤§åŒ–çš„å­è¼‰æ³¢åˆ†é…è¦å‰‡ã€‚æ ¹æ“šé€™å€‹è¦å‰‡ï¼Œæˆ‘å€‘æ¥è‘—ç™¼å±•å‡ºä¸€ï¦—
åˆå­è¼‰æ³¢èˆ‡åŠŸï¥¡åˆ†é…æ¼”ç®—æ³•ï¼Œä½¿å¾—é€šè¨Šå®¹ï¥¾ç¸½å’Œæœ€å¤§åŒ–å¯ç¶“ç”±å­è¼‰æ³¢åˆ†é…èˆ‡åŠŸï¥¡
åˆ†é…ä¹‹äº¤äº’åŸ·ï¨ˆè€Œé”æˆï¼›æ­¤ä¸€ï¦—åˆå­è¼‰æ³¢èˆ‡åŠŸï¥¡åˆ†é…æ¼”ç®—æ³•å¯æ¡ç”¨æˆ‘å€‘æ‰€æå‡ºä¹‹
é«˜æ•ˆï¥¡åŠŸï¥¡åˆ†é…æ¼”ç®—æ³•ï¼Œä»¥åŒæ™‚é”åˆ°ï¥¼å¥½æ•ˆèƒ½èˆ‡ï¨‰ä½è¤‡é›œï¨çš„ç›®æ¨™ã€‚ 
ç‚ºï¦ºå› æ‡‰ä¸»è¦ä½¿ç”¨è€…åœ¨å­è¼‰æ³¢ä¸Šçš„æ´»å‹•ï¼Œæˆ‘å€‘ä¹Ÿç™¼å±•ï¦ºå°æ‡‰çš„é«˜æ•ˆï¥¡åŠŸï¥¡åˆ†
é…æ¼”ç®—æ³•ã€‚æˆ‘å€‘é¦–å…ˆå°‡è‚‡å› æ–¼ä¸»è¦ä½¿ç”¨è€…æ´»å‹•çš„é€šè¨Šå®¹ï¥¾æœŸæœ›å€¼æå¤±è½‰æ›æˆç­‰æ•ˆ
çš„åŠŸï¥¡å³°å€¼é™åˆ¶ï¼Œå†é…åˆæˆ‘å€‘æ‰€æå‡ºä¹‹é«˜æ•ˆï¥¡åŠŸï¥¡åˆ†é…æ¼”ç®—æ³•ï¤­é”æˆé€šè¨Šå®¹ï¥¾æœŸ
æœ›å€¼ç¸½å’Œï¼ˆSum Expected Capacityï¼‰æœ€å¤§åŒ–çš„ç›®æ¨™ã€‚é›»è…¦æ¨¡æ“¬çµæœé¡¯ç¤ºï¼Œæˆ‘å€‘æ‰€
æä½œæ³•çš„æ•ˆèƒ½å¯é€¼è¿‘æœ€ä½³é€šè¨Šå®¹ï¥¾æœŸæœ›å€¼ç¸½å’Œã€‚ 
é™¤ï¦ºé‡å°å¤šç”¨æˆ¶æ­£äº¤åˆ†é »å¤šå·¥ä¹‹æ„ŸçŸ¥ç„¡ç·šé›»ç³»çµ±ç™¼å±•é«˜æ•ˆï¥¡è³‡æºåˆ†é…æŠ€è¡“
ä¹‹å¤–ï¼Œæˆ‘å€‘äº¦å°±æ­£äº¤åˆ†é »å¤šå·¥ç³»çµ±ä»¥åŠå¤šè¼¸å…¥å¤šè¼¸å‡ºç³»çµ±ç™¼å±•ï¦ºä¸€äº›å‰ç»åŸºé »è™•
ï§¤æ¼”ç®—æ³•ï¼ŒåŒ…æ‹¬åŠŸï¥¡å³°å‡æ¯”ï¨‰ä½æŠ€è¡“ã€è¼‰æ³¢é–“å¹²æ“¾æ¶ˆé™¤æŠ€è¡“ã€ï¦—åˆåŒæ­¥èˆ‡é€šé“ä¼°
æ¸¬æŠ€è¡“ç­‰ï¼Œé€™äº›ä½œæ³•å…¼å…·é«˜æ•ˆèƒ½èˆ‡ä½è¤‡é›œï¨çš„ç‰¹é»ï¼Œç›¸ç•¶å…·æœ‰æ‡‰ç”¨æ½›ï¦Šã€‚ 
 
é—œéµè©ï¼šé€šé“ä¼°æ¸¬ã€æ„ŸçŸ¥ç„¡ç·šé›»ã€è¼‰æ³¢é–“å¹²æ“¾æ¶ˆé™¤ã€ï¦—åˆå­è¼‰æ³¢èˆ‡åŠŸï¥¡åˆ†é…ã€å¤š
è¼¸å…¥å¤šè¼¸å‡ºã€å¤šç”¨æˆ¶æ­£äº¤åˆ†é »å¤šå·¥ã€æ­£äº¤åˆ†é »å¤šå·¥ã€åŠŸï¥¡å³°å‡æ¯”ï¨‰ä½ã€è³‡æºåˆ†é…ã€
åŒæ­¥ã€‚ 
 
 
 
 v
In addition to the resource allocation schemes for MU-OFDM CR systems, we 
have also developed some new baseband algorithms for OFDM and multiple-input 
multiple-output systems, including peak-to-average power ratio reduction, intercarrier 
interference cancellation, as well as joint synchronization and channel estimation. 
These algorithms have both good-performance and low-complexity features, and are 
useful for practical applications. 
 
Keywords: channel estimation, cognitive radio (CR), intercarrier interference (ICI) 
cancellation, joint subcarrier and power allocation, multiple-input multiple-output 
(MIMO), multiuser orthogonal frequency division multiplexing (MU-OFDM), OFDM, 
peak-to-average power ratio (PAPR) reduction, resource allocation, synchronization. 
 
 2
the power constraint on each subchannel (a group of subcarriers), the optimal power 
allocation algorithm in single-user OFDM-based CR systems was studied in [8], 
where the iterative partitioned water-filling (IPWF) algorithm was proposed to realize 
the optimal power allocation. Although the complexity of the IPWF is less than that of 
the exhaustive search algorithm, it may need to perform the water-filling (WF) 
algorithm many times for a fixed number of subcarriers. Moreover, when the IPWF 
algorithm is used to support the subcarrier assignment (i.e., joint subcarrier and power 
allocation), it must recalculate the water level to determine the power for each 
subcarrier, which would cause joint subcarrier and power allocation to have very high 
complexity. In [9], a low-complexity joint subcarrier and power allocation algorithm 
for MU-OFDM CR systems was proposed. However, its power allocation part does 
not consider the peak power constraint of CR systems in the optimization process, and 
this makes the algorithm less than optimal. 
In addition to the peak power constraint, the availability of the subcarriers also has 
a great impact on the transmitted power of SUs because some PUs use some 
subcarriers frequently. In [11], the power allocation algorithm based on PU activity 
was studied. The concept of PU activity or the reliability of the subcarriers is 
formulated by using a risk-return model or a rate loss function. Using a linear rate loss 
function, the original power allocation problem for maximizing the sum capacity 
becomes increasing the sum expected capacity (subtracting the expected rate loss 
from the sum capacity) to its maximum value. Since numerical methods must be used 
to obtain the optimal power distribution based on the linear rate loss, two suboptimal 
algorithms were also proposed in [11], but first it is necessary to predetermine some 
design parameters on the basis of the environment. 
In this report, we present the proposed resource allocation schemes for 
 4
Considering the PU activity, we use the conditions for promising the expected 
capacity to be a positive and increasing function [11]. Specifically, we transform the 
factor of the expected rate loss into a peak power constraint on each subcarrier to 
eliminate the need to execute some numerical methods. Moreover, this transformation 
also excludes the need to calculate some design parameters that are used to avoid a 
negative expected capacity. Using this conversion, the power allocation problem for 
maximizing the sum expected capacity becomes maximizing the sum capacity under 
the peak power constraint in [8], [9], [12]. It means that the optimal IPWF algorithm 
can be used to allocate power and thus the proposed efficient algorithm simplifying 
the IPWF algorithm can support practical implementation of the power allocation 
under PU activity. Simulation results show that the proposed algorithm decreases the 
transmitted power dramatically as the probability that a PU will reoccupy the 
subcarrier increases, and ensures that the expected capacity is not negative despite the 
change in the probability. Furthermore, the proposed suboptimal algorithm with lower 
complexity achieves an expected capacity close to that of the optimal one. 
The rest of this report is organized as follows. Section II introduces the 
MU-OFDM CR system model and formulates the resource allocation problem. In 
Section III, the optimal power allocation and the proposed efficient power allocation 
algorithms are presented. In Section IV, the rule for the subcarrier allocation and the 
proposed joint subcarrier and power allocation algorithm are developed. In Section V, 
we reformulate the excepted capacity loss under PU activity as an equivalent peak 
power constraint and propose a low-complexity suboptimal power allocation 
algorithm. Finally, conclusions are drawn in Section VI. 
II. System Model 
Consider a multiuser OFDM CR uplink system with M PUs and K SUs in Fig. 1, 
 6
,
2 , , 1
,1
, ,max
,
1 2
max  log (1 )
subject to:  
                  , 
                 0 , 
                  are disjoint for all .
                 {1
k n
k
K
k n k np k n
N
k n kn
k n k
k n
k
K
B p H
N
p P k
p P k n
p k n
k
= âˆˆÎ©
=
+
â‰¤ âˆ€
â‰¤ âˆ€
â‰¥ âˆ€
Î©
Î© âˆªÎ© âˆª âˆªÎ© âŠ†
âˆ‘ âˆ‘
âˆ‘
â€¦ ,2,..., }N
    (3) 
where Pk is the overall available power of SU k; Hk,n = |hk,n|2/(N0BNâˆ’1) is the CNR for 
SU k in subcarrier n; hk,n is the channel gain for SU k in subcarrier n; Î©k is the set of 
subcarriers for SU k and Î©1, Î©2, â€¦, Î©K are mutually exclusive. When the subcarrier 
allocation is jointly considered with the power allocation, we can define the 
optimization problem in next subsection. 
B. Joint Subcarrier and Power Allocation Problem 
Using the peak power constraint in (2), the optimization problem of subcarrier and 
power allocation considered in this report is formulated as 
, ,
1
, 2 , ,1 1,  
,1
,1
, ,max
,
,
max  log (1 )
subject to:  
                 1 
                  , 
                 0 , 
                {0,  1} ,
k n k n
K N
k n k n k nk np
N
k n kn
K
k nk
k n k
k n
k n
BN p H
p P k
n
p P k n
p k n
k
Î± Î±
Î±
Î±
âˆ’
= =
=
=
+
â‰¤ âˆ€
= âˆ€
â‰¤ âˆ€
â‰¥ âˆ€
= âˆ€
âˆ‘ âˆ‘
âˆ‘
âˆ‘
 n
   (4) 
where Î±k,n indicates whether or not the subcarrier n is used by SU k. To make it easier 
to solve the problem, (4) can be transformed into a convex optimization problem, as 
follows [13] 
 8
subchannels is available. 
3) A slow fading channel is assumed; that is, a channel gain remains constant for 
several time frames. 
Suppose that Î±j is the probability that the jth PU reoccupies the subchannel during 
the current time period and that the subchannel was available for an SU in the 
previous time period. A mapping function Ï•: +Z  â†’ +Z  is used to indicate that a 
subcarrier belongs to a specific PU, where +Z  is the set of positive integers. That is, 
( )i jÏ• =  if the ith subcarrier is licensed to the PU j.   (6) 
Therefore, the expected rate loss function for the ith subcarrier is given by ( ) ( )i ipÏ•Î± L , 
where pi is the assigned power in subcarrier i, and the expected capacity of the ith 
subcarrier is expressed as 
( ){ } ln(1 ) ( )i i i i iE R p H pÏ•Î±= + âˆ’ L      (7) 
where Hi is the CNR in subcarrier i. 
With the above results, our objective is to optimize the power allocation for 
achieving the maximum sum error-free expected capacity under the total power 
constraint. The optimization problem is formulated as 
( )1 
1
max  [ln(1 ) ( )]
subject to: 
                  0
i
N
i i i iip
N
i totali
i
p H p
p P
p i
Ï•Î±=
=
+ âˆ’
â‰¤
â‰¥ âˆ€ âˆˆÎ©
âˆ‘
âˆ‘
L
    (8) 
where Ptotal denotes the total available power and Î© = {1, 2, â€¦, N}. Because the 
optimization problem contains the rate loss function, the conditions on L  must be 
given to make the expected capacity E{Ri} not only satisfy the concave property, but 
also be a positive and increasing function of power within the total available power. 
That is [11], 
 10
1) Initialization 
(a) Some parameters are defined first: 
{1,2,..., }k kA N= ; kB Ï†= ; {1}kD = ; 1Ë† kP P= ; 1m = . 
2) while |Dk| â‰  0 
(a) Perform the traditional water-filling on the subcarriers in Ak with power mË†P  
and obtain all the power pk,n, nâˆˆ Ak. The resulting water level is Ë†mw . 
(b) Dk = {n| pk,n â‰¥ Pk,max, nâˆˆAk}. 
(c) 1 ,maxË† Ë†\ ,  ,  | |k k k k k k m m k kA A D B B D P P D P+= = âˆª = âˆ’ . 
(d) m = m + 1. 
3) pk,n = Pk,max, nâˆˆBk. 
The \ in Step 2(c) denotes the set subtraction. 
The IPWF algorithm determines each subcarrierâ€™s assigned power by classifying 
the subcarriers according to the definitions of Ak and Bk. These steps are repeated 
iteratively until the assigned power of the subcarriers in Ak is less than the peak power, 
at which time the optimal power allocation with the peak power constraint is finished. 
Although the IPWF algorithm is simpler than the exhaustive search algorithm, it may 
need to execute the WF algorithm many times. Therefore, it is useful to apply an 
efficient power allocation algorithm to solve the resource allocation problem. 
B. The Update of the Common Water Level 
In the following, instead of using the WF algorithm to classify the two sets, we 
propose a method to update the common water level for determining the subcarriers in 
Ak and Bk. Before describing the steps for updating the common water level in Ak, we 
describe the lemma about the traditional WF algorithm. 
 12
water level of the set Ak = {i| pk,i < Pk,max, iâˆˆÎ¨k}. Then, the jth subcarrier (jâˆ‰Î¨k but 
jâˆˆÎ©k) will be assigned to Bk = {i| pk,i = Pk,max, iâˆˆÎ¨k} if 
, ,maxË† 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
âˆ’ â‰¥+       (14) 
Otherwise, the subcarrier will be in Ak. The new common water level of Ak is 
Ë† min(max( , 0), )k k kw a bâˆ’ . In addition, when jâˆˆBk, |Bk| must satisfy Pk > (|Bk|+1)Pk,max 
to ensure the total power allocated to Ak is positive. 
Proof: If jâˆˆBk, the assigned power in the jth subcarrier is Pk,max and the common 
water level of Ak becomes ,maxË† | |k k kw P Aâˆ’  and the new common water level must 
be greater than or equal to the unique water level in the jth subcarrier; that is, 
,max
, ,max
,
1Ë†
| |
k
k k j k
k k j
P
w w P
A H
âˆ’ â‰¥ = +  or 
, ,maxË† 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
âˆ’ â‰¥+       (15) 
Otherwise, the jth subcarrier is assigned to Ak. Using the above-mentioned lemma, the 
new common water level becomes 
,Ë† 1Ë† Ë†max( , 0) max( , 0).
| | 1
k k j
k k k
k
w H
w w a
A
âˆ’âˆ’ = âˆ’+     (16) 
With (15) and (16), the new common water level depends on the minimum between 
max( , 0)ka  and bk; that is, 
Ë† min(max( , 0), )k k kw a bâˆ’       (17) 
Moreover, when jâˆˆBk, the total power of Ak is 
1 1
, ,
,max ,max
Ë† Ë†( ) ( )
| | 0.
k k k
k k k i k k i ki A i A i A
k k k k
w b H w H b
P B P P
âˆ’ âˆ’
âˆˆ âˆˆ âˆˆâˆ’ âˆ’ = âˆ’ âˆ’
= âˆ’ âˆ’ >
âˆ‘ âˆ‘ âˆ‘
   (18) 
That is, Pk > (|Bk| + 1)Pk,max.                      â–  
 14
and 
0 0,1 , 0,1 0,| | 0,1 ,| |
[ ,..., ] [ , ..., , , ..., ].
k k kk k k N k k B k k A
v v b b a a= =v  
2) while n â‰¤ Nk 
(a) ,k nm v= . 
(b) if |Ak| = 0 
(1) Evaluate the water level with 1 1,max{( 1) ( ), 0}k k k k mw w n w H
âˆ’ âˆ’= âˆ’ + âˆ’ , but 
1
,k k k mw P H
âˆ’= +  when n = 1. 
(2) if 1,max ,k k k mw P H
âˆ’â‰¥ +  and ,max(| | 1)k k kP B P> +  
{ }k kB B m= âˆª . 
else 
{ }k kA A m= âˆª ; ,max| |Ak k k kP P B P= âˆ’ ; 
1
,Ak Ak k mw P H
âˆ’= + . 
(c) else 
(1) 1, ,max( ) (| | 1); | |.k Ak k m k k k ka w H A b P A
âˆ’= âˆ’ + =  
(2) if bk â‰¤ ak and Pk > (|Bk|+1)Pk,max 
wAk = wAk âˆ’ bk;  
Bk = Bk âˆª{m}. 
else 
wAk = wAk âˆ’ max(ak, 0); 
Ak = Ak âˆª {m}. 
(d) 1n n= + . 
3)   
(a) 1,max ,{ | , }k Ak k k i kA i w P H i B
âˆ— âˆ’= < + âˆˆ ;  
1
,max ,{ | , }k Ak k k i kB i w P H i B
âˆ— âˆ’= â‰¥ + âˆˆ . 
 16
subcarrier; Step 2(c) requires 7 additions and 3 multiplications for each subcarrier. 
Step 2(d) requires 1 additions and the while loop needs 1 addition as well. Thus, there 
are in total 21Nk additions and 6Nk multiplications for all Nk subcarriers in Step 2. Step 
3 requires Nk+3|Ak|+1 additions and 2|Ak|+2 multiplications. Therefore, the proposed 
algorithm in total requires ( )kNO  additions and ( )kNO  multiplications for the kth 
SU because |Ak| < Nk. For all SUs, the proposed algorithm needs ( )NO  additions and 
( )NO  multiplications because 
1
K
kk
N N= =âˆ‘ . 
For the IPWF algorithm in Section III.A, Step 2(a) requires 
Nkilog2(Nki)+5Nkiâˆ’3Mki additions and 2Nkiâˆ’Mki multiplications when the WF algorithm 
in [14] is used, where Nki is the total number of subcarriers for the ith iteration and Mki 
is the number of subcarriers with positive power. Steps 2(b)âˆ’(d) require Nki+2 
additions. The IPWF algorithm requires 21( log 6 3 3)
kI
ki ki ki kii
N N N M= + âˆ’ +âˆ‘   
additions and 
1
(2 )kI ki kii N M= âˆ’âˆ‘  multiplications in total, where Ik is the number of 
iterations for the kth user. When Ik = 1 for all k (i.e., the lower bound of the 
computational complexity), the IPWF algorithm needs 21( log )
K
k kk
N N=âˆ‘O  additions 
and ( )NO  multiplications. Using the log sum inequality [15], 
1
2 2 21 1
1
log ( )log log ( ),
1
K
K K kk
k k k Kk k
k
N
N N N N N K== =
=
â‰¥ =âˆ‘âˆ‘ âˆ‘ âˆ‘    (19) 
the lower bound of the addition is 2( log ( ))N N KO . Table I summarizes the 
computational complexity of the proposed method and the IPWF algorithm. Fig. 3 
shows a comparison of the computational complexity of the proposed method and the 
IPWF algorithm for different values of N, where K = 8 and the lower bound of the 
IPWF algorithmâ€™s complexity is regarded as 100%. 
 18
The noise enhances the effect of the peak power constraint so that the normalized sum 
capacity cannot saturate at a lower peak power constraint. Although the performance 
of the proposed algorithm degrades slighter more than that of the IPWF algorithm, 
they saturate at the same peak power. The performance gap in Fig. 4(b) results from 
the difference between the estimated water level and the true water level evaluated by 
the WF algorithm in the high noise environment. 
In Fig. 5, the normalized sum capacity is drawn for several different values of the 
number of users (i.e., K = 8, 12, 16, â€¦, 32). It is clear that the capacity increases as 
the number of users increases, thus confirming the effect of the multiuser diversity. 
Fig. 6 illustrates the normalized sum capacity for various values of the path loss 
difference. The increase in the capacity also results from the multiuser diversity 
because some SUsâ€™ channel gains are better than those of other SUs. This result 
indicates that the peak power constraint may not be fixed for all subcarriers because 
an SU with better channel gain may cause significant interference to the PU even 
though the transmitted power of the SU is small. 
IV. Subcarrier and Power Allocation for MU-OFDM CR 
Systems 
In the following, we first propose a rule for assigning the subcarriers and then 
introduce the optimal power allocation algorithm for MU-OFDM CR uplink systems. 
A. A Rule for Subcarrier Allocation 
The optimization problem in (5) is equivalent to finding the minimum of the 
Lagrangian function 
1
, 2 , , ,1 1
, , , ,max1 1
log (1 )
( ) ( 1) ( )
K N
k n k n k n k nk n
N K
k k n k n k n n k n kn k
L BN p H
p P u v p P
Î± Î±
Î» Î±
âˆ’
= =
= =
= âˆ’ +
+ âˆ’ + âˆ’ + âˆ’
âˆ‘ âˆ‘
âˆ‘ âˆ‘    (20) 
 20
designing the subcarrier allocation algorithm must decide pk,n or wk âˆ€k first. This 
means that the optimization is implemented by alternating between the subcarrier and 
power allocation; that is, joint subcarrier and power allocation. Therefore, an 
appropriate power allocation algorithm for MU-OFDM CR systems plays a crucial 
role in the joint subcarrier and power allocation algorithm.  
B. Joint Subcarrier and Power Allocation with the IPWF Algorithm 
In Sections III.A and IV.A, the joint subcarrier and power allocation algorithm 
with optimal power allocation is carried out using the rule in (24) to assign the 
subcarrier with the water level from the IPWF algorithm. When the number of 
subcarriers is changed, the IPWF algorithm must recalculate the water level for 
substituting into (24) to determine which user can use the additional subcarrier, which 
in turn increases the computational complexity of the joint subcarrier and power 
allocation algorithm. That is, the complexity of the joint subcarrier and power 
allocation algorithm depends on two factors: 1) for the power allocation, the IPWF 
algorithm may need to perform the water-filling algorithm many times, and 2) for the 
subcarrier allocation, the IPWF algorithm must recategorize all subcarriers into the 
two sets Ak and Bk. 
C. Approximation of Water Level 
To simplify the process for calculating the water level with a fixed number of 
subcarriers, we use a simple method to estimate its value. First, the initial water level 
for the kth user is given by 
1 ,( 1 )
k
k k k i ki
w P H NâˆˆÎ©= +âˆ‘       (25) 
where Pk and Î©k are the total power as well as the set of subcarriers assigned to user k, 
 22
Details of the proposed algorithm for a channel realization are described as 
follows (Note: the following numbers do not correspond exactly with the numbers 
above.): 
1) Initialization 
(a) The following parameters are defined first: A = {1, 2, â€¦, N}; â„¦k = Ï†,  
Ak = Bk = Ï†, wk = wtk = 0, wAk = wtAk = 0, 0kw = , Pk,max, and Pk, k = 1, â€¦, K; 
n = 1. 
2)  while |A| â‰  0 
for k = 1 to K 
(a) â„¦k = â„¦k âˆª {n}; Nk = |â„¦k|. 
(b) if |Ak| = 0 
(1) Evaluate the water level with wk = wk âˆ’ max{(Nk + 1)âˆ’1(wk âˆ’ 1,k nH âˆ’ ), 0}, but 
 1,k k k nw P H
âˆ’= +  when Nk = 1. 
(2) Perform the steps in Section IV.C and obtain the approximated water level 
 kwâ€² . k kw wâ€²= . 
(3) 1,max ,{ | ,  }k k k k i kA i w P H i
âˆ’= < + âˆˆÎ© ; k kB A= . 
(4) if nâˆˆAk 
(i) Find the approximated water level Akwâ€²  with PAk = Pk âˆ’ |Bk|Pk,max. 
Ak Akw wâ€²= ; k Akw wâ€²= . 
else 
(i) 1,max ,k k k nw P H
âˆ’= + . 
(c) elseif |Ak| â‰  0 
(1) 1, ,max( ) (| | 1); | |k Ak k n k k k ka w H A b P A
âˆ’= âˆ’ + = . 
 24
evaluated until Ak is not empty. Step 2(c) updates the common water level in Ak when 
Step 2(b) finds that Ak is not null. After all subcarriers are assigned, Step 3 allocates 
the power according to the common water level. Steps 3(a)âˆ’(b) move the subcarriers 
in Bk with unique water levels that are greater than the common water level to Ak. The 
power of each subcarrier in kB
âˆ—  is Pk,max; Steps 3(d)âˆ’(f) determine the power of the 
subcarriers in Ak. Because the common water level is not from the water-filling 
algorithm, Step 3(f) is used to satisfy the total power constraint for all SUs. 
E. Complexity Analysis of Joint Subcarrier and Power Allocation Algorithms 
The complexity of the proposed algorithm results mainly from Step 2. Steps 
2(b)âˆ’(c) are used to calculate the water level and they are disjoint for each other, so 
the required additions and multiplications in Step 2 after all subcarriers are assigned 
are 2( )NO  because 
1 1 1
( 1) 2N K Nknn k nN n N N= = == = +âˆ‘ âˆ‘ âˆ‘ , where Nkn is the number 
of subcarriers for the kth SU when the nth subcarrier is assigned. 
The algorithm in [9] also is used to find the water level, so its complexity is 
2( )NO  rather than ( )NKO . On the other hand, when the water-filling algorithm in 
[14] is used, the IPWF algorithm in Section III.A requires 2( log )kni kniN NO  
additions and ( )kniNO  multiplications for the ith iteration, where Nkni is the total 
number of subcarriers for the ith iteration when the nth subcarrier is assigned to SU k. 
For all SUs and subcarriers, the joint subcarrier and power allocation algorithm with 
the IPWF algorithm needs 21 1( log )
N K
kn knn k
N N= =âˆ‘ âˆ‘O  additions and 2( )NO  
multiplications, where we assume that the number of iterations when the nth 
subcarrier is assigned to the kth SU is one (i.e., the lower bound of the computational 
complexity). 
 26
proposed method increases as the peak power increases and saturates at Pk,max = âˆ’4 dB; 
moreover, the proposed algorithm alleviates the losses of capacity when ,max 4kP â‰¥ âˆ’  
dB with different PSDs of AWGN. This advantage is attributed to its better power 
allocation mechanism. 
V. Power Allocation for OFDM-Based CR Systems under 
Primary User Activity 
A. Optimal Power Allocation for OFDM-Based CR Systems with a Linear Rate Loss 
In [11], a simple linear rate loss function ( )p p=L C  was studied to show the 
impact of PU activity on a power allocation algorithm, where C  is the average rate 
loss per unit power (units bits/s/W). With this rate loss function, the solution to the 
optimization problem in (8) is given by 
( )
1 1( )i
i i
p i
HÏ•Î» Î±
+= âˆ’ âˆ€ âˆˆÎ©+ C      (27) 
where (x)+ â‰¡ max{x, 0} and Î» is the Lagrangian multiplier for the total power 
constraint. Although the power in the ith subcarrier can be evaluated by the water 
level (Î» + Î±Ï•(i)C )âˆ’1, Î» must be determined using numerical methods to satisfy the 
total power constraint because Î» is coupled to Î±Ï•(i) C . Therefore, suboptimal 
algorithms also were proposed in [11] to approximate the optimal solution. 
To avoid using numerical methods to find the power in (27), we exploit the 
condition in (9) to make the optimal power distribution with a linear rate loss function 
easier to solve. When ( )i ip p=L C , (9) is rewritten as 
1
( ) ( )
1 1 1or .
( ) ii i i i i
p i
p H HÏ• Ï•Î± Î±âˆ’â‰¤ â‰¤ âˆ’ âˆ€ âˆˆÎ©+C C    (28) 
Because this condition ensures that E{Ri} is positive and increases with pi, we can 
rewrite the optimization in (8) as 
 28
and n = 1. 
(b) 1( )total iiw P H N
âˆ’
âˆˆÎ©= +âˆ‘ ; 
A0 = {i| w < Pi,max + Hiâˆ’1, iâˆˆÎ©} = 
00,1 0,| |
{ , ..., }Aa a ; 
B0 = {i| w â‰¥ Pi,max + Hiâˆ’1, iâˆˆÎ©} = 
00,1 0,| |
{ , ..., }Bb b ; and 
v = [v1, â€¦, vN] = [
0 00,1 0,| | 0,1 0,| |
, ..., , , ...,B Ab b a a ]. 
2) while n â‰¤ N 
(a)  m = vn. 
(b) if |A| = 0 
(1) Evaluate the water level with w = w âˆ’ max{(n+1)âˆ’1 1( )mw H âˆ’âˆ’ , 0}, but 
1
total mw P H
âˆ’= +  when n = 1. 
(2) if 1,maxm mw P H
âˆ’â‰¥ +  and Ptotal > âˆ‘iâˆˆBPi,max + Pm,max 
B = B âˆª {m}. 
else  
A = A âˆª {m}; PA = Ptotal âˆ’ âˆ‘iâˆˆBPi,max; 
1
A A mw P H
âˆ’= + . 
(c) else  
(1) 1 ,max( ) (| | 1); | |A m ma w H A b P A
âˆ’= âˆ’ + = . 
(2) if b â‰¤ a and Ptotal > âˆ‘iâˆˆBPi,max + Pm,max 
wA = wA âˆ’ b; B = B âˆª {m}. 
else 
wA = wA âˆ’ max(a, 0); A = A âˆª {m}. 
(d) 1n n= + . 
3)   
 30
multiplication, respectively. Step 1 of the proposed method uses ( )NO  additions and 
( )NO  multiplications to roughly divide all subcarriers into A0 and B0. The processes 
in Steps 2(b)âˆ’(c) do not intersect with each other and are used to update the water 
level or the common water level; therefore, the required additions and multiplications 
in Step 2 after all subcarriers are assigned are ( )NO . Step 3 also needs ( )NO  
additions and ( )NO  multiplications because |A| < N. Therefore, the proposed 
algorithm altogether requires ( )NO  additions and ( )NO  multiplications. 
The complexity of the IPWF algorithm in Section III is mainly from the second 
step. When the WF algorithm in [14] is used, Step 2(a) requires 2( log )i iN NO  
additions and ( )iNO  multiplications, where Ni is the total number of subcarriers for 
the ith iteration. Steps 2(b)âˆ’(d) require ( )iNO  additions. Therefore, the IPWF 
algorithm requires 21( log )
I
i ii
N N=âˆ‘O  additions and 1( )I ii N=âˆ‘O  multiplications in 
total, where I is the number of iterations. When I = 1 (i.e., the lower bound of the 
computational complexity), the IPWF algorithm needs 2( log )N NO  additions and 
( )NO  multiplications. 
According the above analyses, the computational complexity of the proposed 
algorithm is less than the lower bound of the computational complexity of the IPWF 
algorithm. 
D. Simulation Results of Power Allocation Algorithms under PU Activity 
In this section, we demonstrate the proposed power allocation algorithm using 
simulation results. In all simulations, the channel gains hn âˆ€n were assumed to be i.i.d. 
with distribution (0, 1)CN  (i.e., E{|hn|2} = 1). The PSD of AWGN was âˆ’110 
dBW/Hz, B = 1 MHz, and N = 16 as in [11]. Subcarriers 1 through 8 belong to PU1 
 32
VI. Conclusions 
In this project, we have developed some resource allocation algorithms for 
MU-OFDM CR uplink systems, including a suboptimal power allocation algorithm, a 
suboptimal joint subcarrier and power allocation algorithm, as well as a suboptimal 
power allocation algorithm under PU activity. For power allocation, we have 
developed a method to simplify the procedure to determine whether the power in each 
assigned subcarrier satisfies the peak power constraint or not. Based on this method, 
we first develop a suboptimal power allocation algorithm for MU-OFDM CR uplink 
systems, which reduces the computational complexity of determining the water level 
to allocate the power for each subcarrier. Moreover, we have also proposed a rule to 
design a suboptimal joint subcarrier and power allocation algorithm under peak power 
constraint. Instead of applying the IPWF algorithm to aid the subcarrier assignment 
for joint subcarrier and power allocation, the proposed simple yet effective method is 
used to calculate the common water level when the number of subcarriers is changed. 
It not only reduces the complexity that arises from iteratively performing the WF 
algorithm, but also updates the common water level to satisfy the conditions of the 
optimal power distribution. Finally, we have reformulated a power allocation 
optimization problem to investigate the effects of PU activity on the system capacity. 
Based on this problem reformulation, we can obtain the optimal solution by using the 
IPWF algorithm rather than numerical methods. Without adjusting predetermined 
parameters, the solution ensures that the final power distribution leads to a positive 
expected capacity. Using the proposed method to evaluate the common water level, 
we have also developed a suboptimal algorithm whose performance approaches that 
of the optimal one. 
Simulation results have shown that the performance of the proposed power 
 34
References 
[1] Federal Communications Commission (FCC), â€œSpectrum policy task force,â€ ET 
Docket no. 02â€“135, Nov. 15, 2002. 
[2] J. Mitola III and G. Q. Maguire, Jr., â€œCognitive radio: Making software radios 
more personal,â€ IEEE Pers. Commun., vol. 6, no. 4, pp. 13â€“18, Aug. 1999. 
[3] T. S. Rappaport, A. Annamalai, R. M. Buehrer, and W. H. Tranter, â€œWireless 
communications: Past events and a future perspective,â€ IEEE Commun. Mag., 
vol. 40, no. 5, pp. 148â€“161, May 2002. 
[4] IEEE Standard for Local and metropolitan area networks Part 16: Air Interface 
for Broadband Wireless Access Systems, IEEE Standard 802.16, May 2009. 
[5] T. A. Weiss and F. K. Jondral, â€œSpectrum pooling: An innovative strategy for the 
enhancement of spectrum efficiency,â€ IEEE Commun. Mag., vol. 42, pp. S8â€“S14, 
Mar. 2004. 
[6] U. Berthold and J. K. Jondral, â€œGuidelines for designing OFDM overlay 
systems,â€ in Proc. 2005 IEEE 1st Int. Symposium on New Frontiers in Dynamic 
Spectrum Access Networks (DySPAN 2005), Baltimore, MD, Nov. 2005, pp. 
626â€“629. 
[7] Z. Han and K. J. R. Liu, Resource Allocation for Wireless Networks: Basics, 
Techniques, and Applications. Cambridge University Press, Cambridge, U.K., 
2008. 
[8] P. Wang, M. Zhao, L. Xiao, S. Zhou, and J. Wang, â€œPower allocation in 
OFDM-based cognitive radio systems,â€ in Proc. IEEE Global Telecommun. Conf. 
(Globecom 2007), Washington, DC, Nov. 2007, pp. 4061â€“4065. 
 36
åœ–è¡¨ 
 
 
Fig. 1. A multiuser OFDM CR uplink system. 
 
 
 

 
Fig. 2. Opportunistic spectrum in an OFDM-based CR. 
 
 
 
 
 38
-20 -10 0 10 20
6
6.5
7
7.5
8
8.5
9
Peak Power (dB)
(a)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -60 dBW/Hz
-20 -10 0 10 20
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
0.55
0.6
Peak Power (dB)
(b)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -20 dBW/Hz
 
 
IPWF
Proposed
 
Fig. 4. Normalized sum capacity versus the peak power with different PSDs of 
AWGN. 
0 10 20 30 40
8.5
9
9.5
10
10.5
11
Number of Users, K
(a)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -60 dBW/Hz; Pk,max = -4 dB
0 10 20 30 40
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
Number of Users, K
(b)
N
or
m
al
iz
ed
 S
um
 C
ap
ac
ity
 (b
its
/s
/H
z)
N0 = -20 dBW/Hz; Pk,max = -4 dB
 
 
IPWF
Proposed
 
Fig. 5. Normalized sum capacity versus the number of users with different PSDs of 
AWGN. 
 40
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
x 10-5
Probability (Î±1)
P
ow
er
 A
llo
ca
te
d
 
 
Proposed Optimal
Proposed Suboptimal
Proportional Water Level [11]
Traditional Water-filling
 
Fig. 8. Power allocated to the subcarriers of the 1st PU versus the probability that the 
PU will reoccupy these subcarriers (or PU activity). 
 
0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
-15
-10
-5
0
5
10
Probability (Î±1)
E
xp
ec
te
d 
N
or
m
al
iz
ed
 C
ap
ac
ity
 (b
its
/s
/H
z)
 
 
Proposed Optimal
Proposed Suboptimal
Proportional Water Level [11]
Traditional Water-filling
 
Fig. 9. Expected capacity of the 1st PU versus the probability of PU activity. 
 42
ï¥æ–‡ç™¼è¡¨æˆæœ 
â–  åœ‹éš›æœŸåˆŠï¥æ–‡ 
 
1. Chin-Liang Wang and Hung-Chin Wang, "Optimized joint fine timing 
synchronization and channel estimation for MIMO systems," accepted for 
publication in IEEE Transactions on Communications. 
2. Sheng-Ju Ku, Chin-Liang Wang, and Chiuan-Hsu Chen, "A reduced-complexity 
PTS-based PAPR reduction scheme for OFDM systems," IEEE Transactions on 
Wireless Communications, vol. 9, pp. 2455-2460, Aug. 2010. 
3. Chin-Liang Wang, Sheng-Ju Ku, and Chun-Ju Yang, "A low-complexity PAPR 
estimation scheme for OFDM signals and its application to SLM-based PAPR 
reduction," IEEE Journal of Selected Topics in Signal Processing, vol. 4, pp. 
637-645, June 2010. 
4. Chin-Liang Wang and Yu-Chih Huang, "Intercarrier interference cancellation 
using general phase rotated conjugate transmission for OFDM systems," IEEE 
Transactions on Communications, vol. 58, pp. 812-819, March 2010. 
5. Chin-Liang Wang and Hung-Chin Wang, "On joint fine time adjustment and 
channel estimation for OFDM systems," IEEE Transactions on Wireless 
Communications, vol. 8, pp. 4940-4944, Oct. 2009. 
 
 
 
â–  åœ‹éš›æœƒè­°ï¥æ–‡ 
 
1. Chiuan-Hsu Chen and Chin-Liang Wang, "Joint subcarrier and power allocation 
in multiuser OFDM-based cognitive radio systems," in Proceedings of the 2010 
IEEE International Conference on Communications (ICC 2010), Cape Town, 
South Africa, May 2010. 
2. Chin-Liang Wang and Po-Chung Shen, "An energy-efficient cooperative 
SFBC-OFDM system using subcarrier permutation," in Proceedings of the 2010 
IEEE Vehicular Technology Conference - Spring (VTC 2010-Spring), Taipei, 
Taiwan, May 2010. 
3. Chiuan-Hsu Chen and Chin-Liang Wang, "Power allocation for OFDM-Based 
cognitive radio systems under primary user activity," in Proceedings of the 2010 
IEEE Vehicular Technology Conference - Spring (VTC 2010-Spring), Taipei, 
Taiwan, May 2010. 
4. Chin-Liang Wang, Ying-Chang Lin, and Po-Chung Shen, "Design of an adaptive 
receiver for OFDM systems using conjugate transmission," in Proceedings of the 
2010 IEEE Wireless Communications and Networking Conference (WCNC 2010), 
Sydney, Australia, April 2010. 
5. Chiuan-Hsu Chen and Chin-Liang Wang, "An efficient power allocation 
algorithm for multiuser OFDM-based cognitive radio systems," in Proceedings of 
the 2010 IEEE Wireless Communications and Networking Conference (WCNC 
2010), Sydney, Australia, April 2010. 
6. Han-Wei Chen, Xianbin Wang, Chin-Liang Wang, and Hai Lin, "Spectrum 
sensing of unsynchronized OFDM signals for cognitive radio communications," 
in Proceedings of the 2009 IEEE Vehicular Technology Conference - Fall (VTC 
2009-Fall), Anchorage, Alaska, Sept. 2009. 
åœ‹ç§‘æœƒè£œåŠ©å°ˆé¡Œç ”ç©¶è¨ˆç•«é …ä¸‹èµ´åœ‹å¤–(æˆ–å¤§ï§“åœ°å€)å‡ºå·®æˆ–ç ”ç¿’å¿ƒå¾—å ±å‘Š 
                                æ—¥æœŸï¼š 98 ï¦ 10 æœˆ 20 æ—¥ 
ä¸€ã€ç¶“é 
ç¹¼æœ¬å¯¦é©—å®¤çš„ä¸€ä½åšå£«ç­ç ”ç©¶ç”Ÿå‰å¾€åŠ æ‹¿å¤§ Dr. Xianbin Wang ä¹‹å¯¦é©—å®¤åšçŸ­æœŸç ”ç¿’ä¹‹å¾Œï¼Œæœ¬äººæ–¼
2009ï¦6æœˆ15æ—¥è‡³9æœˆ14æ—¥äº¦ï¥«èˆ‡æ­¤è¨ˆç•«ï¼Œå±•é–‹ç‚ºæœŸä¸‰å€‹æœˆä¹‹çŸ­æœŸç ”ç¿’ã€‚æœ¬äººç ”ç©¶çš„é‡é»ï¼Œæ˜¯é‡å°æ­£äº¤
åˆ†é »å¤šå·¥ï¼ˆOrthogonal Frequency Division Multiplexing, OFDMï¼‰æŠ€è¡“çš„æ€§èƒ½åšæ”¹å–„ï¼Œæ­¤æŠ€è¡“ç›®å‰è¢«å»£æ³›
çš„æ‡‰ç”¨åœ¨ç„¡ç·šé€šè¨Šï¦´åŸŸï¼Œè€Œå…¶æ‰€è¡ç”Ÿçš„ç›¸é—œæ‡‰ç”¨åŒ…å«æœ‰ï¼šOFDMAï¼ˆOrthogonal Frequency Division 
Multiplexing Accessï¼‰ï¼ŒMultiple-Input Multiple-Output OFDMï¼ˆMIMO OFDMï¼‰ï¼ŒCooperative OFDMâ€¦ç­‰ã€‚
åœ¨å‡ºåœ‹ä¹‹å‰ï¼Œæœ¬äººå·²ç ”ï¥šéä¸€äº›ç›¸é—œçš„ï¥«è€ƒæ–‡ç»ï¼Œä¸¦ä¸”è‘—é‡æ–¼æ­£äº¤åˆ†é »å¤šå·¥æŠ€è¡“ä¸­åŒæ­¥çš„ç ”ç©¶ã€‚æ­¤æŠ€
è¡“ç›¸å°æ–¼å‚³çµ±çš„å–®è¼‰æ³¢æŠ€è¡“å…·æœ‰è¼ƒé«˜çš„é »å¯¬ä½¿ç”¨æ•ˆï¥¡ï¼Œè€Œä¸”å°æ–¼ç„¡ç·šé€šè¨Šç’°å¢ƒä¸­çš„å¤šï¤·å¾‘è¡°æ¸›å…·æœ‰é«˜
æŠµæŠ—ï¦Šï¼›ç„¶è€Œï¼Œå®ƒåœ¨æ¥æ”¶ç«¯å°æ–¼åŒæ­¥çš„æº–ç¢ºï¨éå¸¸æ•æ„Ÿã€‚åœ¨ç›¸é—œçš„æ–‡ç»[1]-[2]å·²ç¶“æŒ‡å‡ºï¼Œæ¥æ”¶ç«¯çš„æ™‚é–“
åç§»æœƒé€ æˆç¬¦å…ƒé–“å¹²æ“¾ï¼ˆInter-Symbol Interference, ISIï¼‰ï¼Œæ¥æ”¶ç«¯çš„é »ï¥¡åç§»æœƒä½¿å¾—å­è¼‰æ³¢é–“æ­£äº¤æ€§çš„å¤±
å»è€Œç”¢ç”Ÿå­è¼‰æ³¢é–“å¹²æ“¾ï¼ˆInter-Carrier Interference, ICIï¼‰ã€‚å¦‚æœç³»çµ±ä¸­æœ‰å¤šå€‹ç”¨æˆ¶å­˜åœ¨çš„è©±ï¼Œä¸Šï¨ˆç«¯çš„åŸº
åœ°å°é‚„æœƒé¢ï§¶å¤šç”¨æˆ¶é–“å¹²æ“¾ï¼ˆMultiple Access Interference, MAIï¼‰çš„å•é¡Œã€‚ 
åœ¨æŠµé”åŠ æ‹¿å¤§è¥¿å®‰å¤§ï¥¶å¤§å­¸å¾Œï¼Œé¦–å…ˆå’Œç•¶åœ°çš„æŒ‡å°æ•™æˆï¼ˆDr. Xianbin Wangï¼‰ï¨Šé¢ï¼ŒDr. Wang å’Œå¦
ä¸€ä½æ•™æˆå…±ç”¨ä¸€é–“å¤§ç ”ç©¶å®¤ï¼Œå¦å¤–é‚„æœ‰ä¸€é–“ç¨ï§·çš„å°ç ”ç©¶å®¤ï¼Œä»–å€‘çš„ç ”ç©¶æ–¹å‘ä¹Ÿæ˜¯ä»¥ç„¡ç·šé€šè¨Šç‚ºä¸»ï¼Œ
å…¶ä¸­æœ‰äº›ç ”ç©¶ä¸»é¡Œæ˜¯è·Ÿæœ¬å¯¦é©—å®¤ï¥‰åŒçš„ã€‚åœ¨ç¨å¾Œå’ŒDr. Wangè¨ï¥å¾Œï¼Œæˆ‘å€‘æ±ºå®šæœè‘—è§£æ±ºOFDMAä¸Šï¨ˆç«¯
ä¸­åŸºåœ°å°åŒæ­¥çš„å•é¡Œå‰é€²ã€‚åœ¨é€™æ¬¡çŸ­æœŸç ”ç¿’çš„å‰ä¸€å€‹åŠæœˆä¸­ï¼Œæœ¬äººåœ¨å¤§ï¥¾æœå°‹çš„ä¸¦ç ”ï¥šç›¸é—œè­°é¡Œçš„æ–‡
ç»å¾Œç™¼ç¾ï¼Œåœ¨OFDMAä¸Šï¨ˆç«¯ä¸­åŸºåœ°å°çš„åŒæ­¥å­˜åœ¨è‘—ï¥¸å€‹å•é¡Œï¼šä¼°æ¸¬èˆ‡è£œå„Ÿ(æ¶ˆé™¤å¹²æ“¾)ã€‚ç›¸è¼ƒæ–¼å‚³çµ±çš„
OFDMç³»çµ±ï¼ŒOFDMAä¸Šï¨ˆç«¯çš„æ¥æ”¶è¨Šè™Ÿå› ç‚ºï¤­è‡ªæ–¼åˆ†æ•£åœ¨å„åœ°çš„ï¥§åŒä½¿ç”¨è€…ï¼Œå…¶ä¼°æ¸¬å™¨çš„è¤‡é›œï¨è¼ƒé«˜ï¼Œ
è€Œæº–ç¢ºï¨å»æ¯”è¼ƒä½ï¼›åœ¨è£œå„Ÿçš„æ™‚å€™ä¹Ÿå› ç‚ºæ‰€æœ‰ä½¿ç”¨è€…çš„è¨Šè™Ÿï¨¦ç–ŠåŠ åœ¨ä¸€èµ·è€Œéœ€è¦è€ƒæ…®å¤šç”¨æˆ¶é–“å¹²æ“¾çš„
æ¶ˆé™¤ã€‚å¦å¤–åœ¨å¤§éƒ¨åˆ†æ–‡ç»ä¸­ï¥§æœƒåŒæ™‚è€ƒæ…®é€™ï¥¸å€‹å•é¡Œï¼Œå› ç‚ºç”¨ï¤­è§£æ±ºé€™ï¥¸å€‹å•é¡Œçš„æ–¹æ³•ï¼Œå…¶æ•ˆèƒ½å½¼æ­¤
é–“äº’ç›¸å½±éŸ¿ï¼šä¼°æ¸¬å™¨çš„æº–ç¢ºï¨æœƒå› ç‚ºå¤šç”¨æˆ¶é–“å¹²æ“¾è€Œï¨‰ä½æº–ç¢ºï¨ï¼Œè€Œæ¶ˆé™¤å¹²æ“¾çš„æ•ˆæœåˆå–æ±ºæ–¼ä¼°æ¸¬å™¨
çš„æº–ç¢ºï¨ã€‚ 
åœ¨èˆ‡Dr. Wangè¨ï¥éç›¸é—œè­°é¡Œå¾Œï¼Œæˆ‘å€‘å°‡ç›®æ¨™å®šåœ¨æå‡å¹²æ“¾æ¶ˆé™¤çš„æ•ˆèƒ½ï¼Œæœ¬äººé–‹å§‹è€ƒæ…®å¹²æ“¾æ¶ˆé™¤
çš„æ–¹å¼ã€‚å‚³çµ±ä¸Šæ¶ˆé™¤å¤šç”¨æˆ¶é–“å¹²æ“¾çš„æ¼”ç®—æ³•å¤šåŠæ˜¯ç”¨ï¦šçºŒå¹²æ“¾æ¶ˆé™¤æ³•ï¼ˆSuccessive Interference 
Cancellation, SICï¼‰[3]-[4]æˆ–æ˜¯å¹³ï¨ˆå¹²æ“¾æ¶ˆé™¤æ³•ï¼ˆParallel Interference Cancellation, PICï¼‰[5]-[6]ï¼Œç„¶è€Œï¼Œ
é€™ï¥¸å€‹æ–¹æ³•åœ¨é‹ç®—è¤‡é›œï¨ã€é‹ç®—é€Ÿï¨å’Œå¹²æ“¾æ¶ˆé™¤çš„èƒ½ï¦Šä¸Šå„æœ‰å„ªï¦ã€‚åœ¨é€™æ¬¡çŸ­æœŸç ”ç¿’çš„å¾Œä¸€å€‹åŠæœˆä¸­ï¼Œ
æœ¬äººè©¦è‘—å°‡æ•´å€‹å¹²æ“¾æ¶ˆé™¤çš„æ¼”ç®—æ³•åˆ†æˆï¥¸å€‹éšæ®µâ€”ç¬¬ä¸€éšæ®µä½¿ç”¨é€Ÿï¨è¼ƒå¿«çš„å¹³ï¨ˆå¹²æ“¾æ¶ˆé™¤æ³•ï¼Œç¬¬äºŒéš
æ®µä½¿ç”¨æ•ˆèƒ½è¼ƒé«˜çš„ï¦šçºŒå¹²æ“¾æ¶ˆé™¤æ³•â€”ï¤­å–å¾—é€Ÿï¨èˆ‡æ•ˆèƒ½ä¸Šçš„å¹³è¡¡é»ã€‚ç¶“ç”±ï¥©å­¸æ¨å°èˆ‡é›»è…¦æ¨¡æ“¬é©—è­‰å¾Œï¼Œ
æˆ‘å€‘å°‡å…¶çµæœæ•´ï§¤æˆï¥æ–‡æ ¼å¼ä¸¦é è¨ˆæŠ•ç¨¿åˆ°åœ‹éš›ç ”è¨æœƒã€‚ 
  
è¨ˆç•«ç·¨è™Ÿ NSC96-2628-E-007-005-MY3 
è¨ˆç•«åç¨± ï¨ˆå‹•æ­£äº¤åˆ†é »å¤šå·¥ç³»çµ±ä¹‹å‰ç»åŸºé »è™•ï§¤æŠ€è¡“ç ”ç©¶ 
å‡ºåœ‹äººå“¡
å§“å ç‹é †ç”Ÿ æœå‹™æ©Ÿæ§‹åŠè·ç¨± 
åœ‹ï§·æ¸…è¯å¤§å­¸é€šè¨Šå·¥ç¨‹ç ”ç©¶æ‰€ 
åšå£«ç­ç ”ç©¶ç”Ÿ 
å‡ºåœ‹æ™‚é–“ 99 ï¦ 6 æœˆ 15 æ—¥è‡³ 99 ï¦ 9 æœˆ 14 æ—¥ å‡ºåœ‹åœ°é» 
åŠ æ‹¿å¤§è¥¿å®‰å¤§ï¥¶å¤§å­¸ 
(The University of Western Ontario)
  
åœ‹ç§‘æœƒè£œåŠ©å°ˆé¡Œç ”ç©¶è¨ˆç•«é …ä¸‹èµ´åœ‹å¤–(æˆ–å¤§ï§“åœ°å€)å‡ºå·®æˆ–ç ”ç¿’å¿ƒå¾—å ±å‘Š 
                                  æ—¥æœŸï¼š 99 ï¦ 05 æœˆ 25 æ—¥ 
ä¸€ã€ç¶“é 
ç¹¼æœ¬å¯¦é©—å®¤çš„ï¥¸ä½åšå£«ç­ç ”ç©¶ç”Ÿ(é™³ç¿°ç·¯ã€ç‹é †ç”Ÿ)å‰å¾€åŠ æ‹¿å¤§ Dr. Xianbin Wang ä¹‹å¯¦é©—å®¤åšçŸ­æœŸ
ç ”ç¿’ä¹‹å¾Œï¼Œæœ¬äººæ–¼2010ï¦2æœˆè‡³4æœˆäº¦ï¥«èˆ‡æ­¤è¨ˆç•«ï¼Œå±•é–‹ç‚ºæœŸä¸‰å€‹æœˆä¹‹çŸ­æœŸç ”ç¿’ã€‚ 
æœ¬äººç ”ç©¶çš„é‡é»ï¼Œæ˜¯å°åˆä½œå¼é€šè¨Šçš„æ€§èƒ½åšæ”¹é€²ã€‚å› æ­¤ï¼Œåœ¨å‡ºåœ‹ä¹‹å‰ï¼Œæœ¬äººå·²è’é›†ç›¸é—œçš„ï¥«è€ƒæ–‡
ç»ï¼Œä¸¦ä¸”è‘—é‡æ–¼é›™ï¤·å¾‘äº¤äº’ä¸­ç¹¼ç«™ç³»çµ±(Two-Path Successive Relay System, TPSRS)çš„ç ”ç©¶ï¼Œæ­¤ç³»çµ±çš„å‚³
è¼¸éç¨‹æ˜¯ä»¥ï¥¸å€‹ä¸­ç¹¼ç«™ï¤­äº¤äº’æ”¾å¤§è¨Šè™Ÿæºå‚³é€çš„è¨Šè™Ÿï¼Œç„¶å¾Œå†å°‡æ­¤æ”¾å¤§å¾Œçš„è¨Šè™Ÿå‚³é€åˆ°ç›®çš„ç«¯ã€‚ç›¸é—œ
çš„æ–‡ç»[1], [2]å·²ç¶“æŒ‡å‡ºï¼Œæ­¤ç³»çµ±æœ‰ä¸­ç¹¼ç«™é–“å¹²æ“¾(Inter-Relay Interference, IRI)çš„å•é¡Œï¼Œç°¡å–®åœ°ï¥¯ï¼ŒæŸå€‹
ä¸­ç¹¼ç«™æ¥æ”¶è¨Šè™Ÿæºçš„è¨Šè™Ÿæ™‚ï¼Œæ­¤ä¸­ç¹¼ç«™ä¹ŸåŒæ™‚æœƒæ”¶åˆ°å¦ä¸€å€‹ä¸­ç¹¼ç«™æ”¾å¤§è¨Šè™Ÿæºçš„è¨Šè™Ÿå¾Œæ‰€å‚³é€çš„è¨Šè™Ÿï¼Œ
ç”±æ–¼æ­¤è¨Šè™Ÿæ˜¯éå»æ‰€æœ‰ç¬¦å…ƒçš„ç·šæ€§çµ„åˆï¼Œå› æ­¤å°æ–¼ç›®çš„ç«¯çš„è§£èª¿æœƒé€ æˆå¹²æ“¾ï¼Œé€™å€‹å¹²æ“¾å°±è¢«ç¨±ä¹‹ç‚ºIRIã€‚
æ•…æœ¬äººåœ¨é€™æ¬¡çš„å‡ºåœ‹ç ”ç¿’ä¸­å°‡è©¦åœ–è§£æ±ºæ­¤å•é¡Œã€‚ 
åœ¨æŠµé”åŠ æ‹¿å¤§è¥¿å®‰å¤§ï¥¶å¤§å­¸å¾Œï¼Œé¦–å…ˆå’Œç•¶åœ°çš„æŒ‡å°æ•™æˆ(Dr. Xianbin Wang)æœƒé¢ï¼Œä»–å‘æˆ‘ä»‹ç´¹ï¦ºè©²
å¯¦é©—å®¤çš„æˆå“¡åŠå„è‡ªçš„ç ”ç©¶æ–¹å‘ï¼Œå…¶ä¸­çš„ç¢ºæœ‰å¾ˆå¤šç ”ç©¶çš„é‡é»æ˜¯è·Ÿæœ¬å¯¦é©—å®¤äº’è£œï¼Œï¦µå¦‚ï¼šç”¨FPGAï¤­é©—
è­‰ç ”ç©¶çš„æˆæœæ˜¯å¦çœŸçš„å¯ï¨ˆã€‚åœ¨æŠµé”å¾Œçš„ç¬¬ä¸€å€‹æœˆï¼Œæœ¬äººä»¥æ–‡ç»[2](Full Interference Cancellation, FIC)
çš„ï§¤ï¥åŸºç¤åšé›»è…¦æ¨¡æ“¬ï¼Œåœ¨æ¨¡æ“¬ä¸­ï¼Œä¹Ÿç¢ºå¯¦é©—è­‰ï¦ºIRIæœƒï¨‰ä½æ•´å€‹ç³»çµ±çš„æ€§èƒ½ã€‚å¦ä¸€æ–¹é¢ï¼Œæœ¬äººä¹Ÿç™¼ç¾
æ–‡ç»[2]çš„æ–¹æ³•éœ€è¦éå¸¸ï¨æº–çš„é€šé“è³‡è¨Šï¼Œï¥´ä¸­ç¹¼ç«™ä¹‹é–“çš„é€šé“ä¼°æ¸¬æœ‰èª¤å·®(ï¦µå¦‚ï¼šé€šé“ä¿‚ï¥©çš„å¯¦éƒ¨å’Œè™›
éƒ¨åˆ†åˆ¥æœ‰Â±5%çš„èª¤å·®)æ™‚ï¼Œç³»çµ±çš„æ€§èƒ½æœƒæ˜é¡¯åœ°è®Šå·®ã€‚å› æ­¤ï¼Œæœ¬äººä¹Ÿå˜—è©¦ç ”ç©¶ä¸€äº›æ–¹æ³•ï¼Œè®“ç³»çµ±çš„æ€§èƒ½
å°æ­¤é€šé“ä¼°æ¸¬çš„èª¤å·®ï¥§æ•æ„Ÿã€‚ 
åœ¨ç¬¬äºŒå€‹æœˆæ™‚ï¼Œæœ¬äººé–‹å§‹è€ƒæ…®ä¸­ç¹¼ç«™é¸æ“‡çš„å•é¡Œï¼Œä¹Ÿå°±æ˜¯ï¥¯ï¼Œå¾å¤šå€‹ä¸­ç¹¼ç«™ï§¨é¸ï¥¸å€‹ï¼Œè—‰ä»¥äº¤äº’
æ”¾å¤§è¨Šè™Ÿæºçš„è¨Šè™Ÿåˆ°ç›®çš„ç«¯ã€‚æœ¬äººæ‰€æå‡ºçš„æ–¹æ³•æ˜¯ï¼Œé¸å‡ºçš„ï¥¸å€‹ä¸­ç¹¼ç«™ä¹‹é–“çš„é€šé“å¢ï¨—å¿…é ˆæ˜¯æœ€å°çš„ã€‚
å¦‚æ­¤ä¸€ï¤­ï¼Œç•¶æŸå€‹ä¸­ç¹¼ç«™åœ¨æ¥æ”¶è¨Šè™Ÿæºçš„è¨Šè™Ÿæ™‚ï¼Œæ‰€å—åˆ°å¦ä¸€å€‹ä¸­ç¹¼ç«™çš„å¹²æ“¾å°±æœƒæœ€å°ï¼Œä¹Ÿå› ç‚ºæ­¤å¹²
æ“¾ç›¸ç•¶å°ï¼Œç›®çš„ç«¯åœ¨åšFICæ™‚ï¼Œå°±ç®—é€šé“è³‡è¨Šï¥§ï¨æº–ï¼Œæ‰€éºï§ä¸‹çš„å¹²æ“¾ä¹Ÿï¥§å¤§ã€‚æ­¤æ¯”è¼ƒæ˜¯è·Ÿå®Œå…¨æ²’æœ‰åš
ä¸­ç¹¼ç«™é¸æ“‡æ™‚ç›¸æ¯”ã€‚ 
ç¬¬ä¸‰å€‹æœˆæ™‚ï¼Œæœ¬äººå°‡ä¸Šè¿°çš„ï§¤ï¥åŸºç¤åšé›»è…¦æ¨¡æ“¬ã€‚åœ¨æ¨¡æ“¬çš„çµæœï§¨ï¼Œæœ¬äººç™¼ç¾ï¼ŒFICåœ¨ä½¿ç”¨æ‰€æå‡º
çš„ä¸­ç¹¼ç«™é¸æ“‡æ³•æ™‚ï¼Œä¸”ç•¶ä¸­ç¹¼ç«™ä¹‹é–“çš„é€šé“ä¿‚ï¥©çš„å¯¦éƒ¨å’Œè™›éƒ¨åˆ†åˆ¥æœ‰Â±5%çš„èª¤å·®ä¸‹ï¼Œç³»çµ±çš„æ€§èƒ½ä¹Ÿï¥§
è‡³æ–¼æœ‰å¤ªå¤§çš„è¡°é€€ï¼›ä½†ï¥´ï¥§åšä¸­ç¹¼ç«™é¸æ“‡ä¸”èª¤å·®è·Ÿä¸Šè¿°ç›¸åŒæ™‚ï¼Œç³»çµ±çš„æ€§èƒ½æœƒæ˜é¡¯åœ°è¡°é€€ï¼›å¦å¤–ï¼Œï¥´
é¸æ“‡çš„ä¸­ç¹¼ç«™ä¹‹é–“çš„é€šé“å¢ï¨—ç‚ºæœ€å¤§ï¼Œä¸”èª¤å·®è·Ÿä¸Šè¿°ç›¸åŒæ™‚ï¼Œæ•´å€‹ç³»çµ±çš„æ€§èƒ½å°‡è®Šæˆéå¸¸å·®ã€‚ç”±é›»è…¦
æ¨¡æ“¬ä¸­ï¼Œå¯é©—è­‰æ­¤æ–¹æ³•çš„ç¢ºå¯ä»¥è®“ç³»çµ±å®¹å¿äº›è¨±ä¸­ç¹¼ç«™ä¹‹é–“çš„é€šé“ä¼°æ¸¬èª¤å·®ã€‚ 
  
è¨ˆç•«ç·¨è™Ÿ NSC96-2628-E-007-005-MY3 
è¨ˆç•«åç¨± ï¨ˆå‹•æ­£äº¤åˆ†é »å¤šå·¥ç³»çµ±ä¹‹å‰ç»åŸºé »è™•ï§¤æŠ€è¡“ç ”ç©¶ 
å‡ºåœ‹äººå“¡
å§“å æœ±æ˜Œéœ‡ æœå‹™æ©Ÿæ§‹åŠè·ç¨± 
åœ‹ï§·æ¸…è¯å¤§å­¸é€šè¨Šå·¥ç¨‹ç ”ç©¶æ‰€ 
åšå£«ç­ç ”ç©¶ç”Ÿ 
å‡ºåœ‹æ™‚é–“ 99 ï¦ 2 æœˆ  1 æ—¥è‡³ 99 ï¦ 4 æœˆ 30 æ—¥ å‡ºåœ‹åœ°é» 
åŠ æ‹¿å¤§è¥¿å®‰å¤§ï¥¶å¤§å­¸ 
(The University of Western Ontario)
åœ‹ç§‘æœƒè£œåŠ©å°ˆé¡Œç ”ç©¶è¨ˆç•«é …ä¸‹å‡ºå¸­åœ‹éš›å­¸è¡“æœƒè­°å¿ƒå¾—å ±å‘Š 
                               æ—¥æœŸï¼š 99 ï¦ 05 æœˆ 08 æ—¥ 
                 
2010 IEEE ç„¡ç·šé€šè¨Šèˆ‡ç¶²ï¤·æœƒè­° (2010 IEEE Wireless Communications and Networking Conferenceï¼›
ç°¡ç¨± WCNC 2010) åœ¨æ¾³æ´²é›ªï§¢èˆ‰ï¨ˆï¼Œæœƒè­°å§‹æ–¼ 2010 ï¦ 4 æœˆ 18 æ—¥ï¼Œæ­¢æ–¼ 4 æœˆ 21 æ—¥ï¼Œï¦Œæ™‚å››æ—¥ã€‚WCNC
æ˜¯ IEEE é€šè¨Šåˆ†æœƒçš„ï¦ï¨ç››æœƒä¹‹ä¸€ï¼Œè­°ç¨‹å…§å®¹æ¶µè“‹å„ï§ç„¡ç·šé€šè¨Šã€ï¨ˆå‹•é€šè¨Šçš„å¯¦é«”å±¤ã€åª’é«”æ¥å–æ§åˆ¶å±¤
èˆ‡ç¶²ï¤·å±¤ä¹‹è¨­è¨ˆã€åˆ†æåŠæ‡‰ç”¨ï¼Œæ˜¯é€šè¨Šï¦´åŸŸç›¸ç•¶é‡è¦ã€å…·æŒ‡æ¨™æ€§æ„ç¾©çš„å¤§å‹å­¸è¡“æœƒè­°ï¼Œå°æ–°ä¸€ä»£ç„¡ç·š
é€šè¨Šèˆ‡ç¶²ï¤·æŠ€è¡“ä¹‹ç™¼å±•å…·æœ‰é‡è¦å½±éŸ¿ï¦Šã€‚ 
WCNC 2010 å…±æœ‰ 1474 ç¯‡ï¥æ–‡æŠ•ç¨¿ï¼Œå…¶ä¸­ 1313 ç¯‡ï¥æ–‡é€²å…¥å¯©æŸ¥éšæ®µï¼Œä¸”æ¯ç¯‡ï¥æ–‡è‡³å°‘æœ‰ä¸‰ä½å°ˆå®¶
å­¸è€…é€²ï¨ˆå¯©æŸ¥ï¼›ç¶“éåš´è¬¹å¯©æŸ¥å¾Œï¼Œç¸½è¨ˆæœ‰ 548 ç¯‡ï¥æ–‡è¢«æ¥å—ç™¼è¡¨ (å…¶ä¸­ï¤­è‡ªåœ‹å…§æœ‰ 40 é¤˜ç¯‡)ï¼Œå¹³å‡ï¥æ–‡
æ¥å—ï¥¡ç´„ç‚º 37%ï¼›é€™äº›è¢«æ¥å—çš„ï¥æ–‡æ¶µè“‹ PHYã€MACã€Networkingã€Services and Applications ç­‰å››å€‹
ä¸»é¡Œï§åˆ¥ (Tracks)ï¼Œä¸”è¢«åˆ†æˆ 110 å ´æŠ€è¡“è­°ç¨‹ (Technical Sessions)ï¼Œä»¥å£é ­å ±å‘Šæ–¹å¼ (Oral Presentation) 
ç™¼è¡¨ã€‚é™¤ï¦ºæ­£è¦æ€§çš„ï¥æ–‡ç™¼è¡¨ä¹‹å¤–ï¼Œå¤§æœƒé‚„å®‰æ’ï¦ºä¸‰å ´ Keynote Speechesã€ä¸‰å ´ Technology/Business 
Application Panels åŠä¸‹ï¦œ 8 å€‹çŸ­æœŸèª²ç¨‹ (Tutorials)ï¼š 
z Biologically-inspired and Nano-scale Communication and Networking 
z Building Tomorrowâ€™s Internet of Things: Latest Standardization Trends and Hands-on 
Programming 
z Aspects of Multiuser MIMO - Principles and Standardization in LTE-Advanced 
z Coalitional Game Theory in Wireless Networks 
z Cognitive Radios and Enabling Technologies: UWB for Cognitive Radios, Aspects of Spectrum 
Sensing and Detection, Co-existence and Interference Mitigation Techniques, and Localizing and 
Tracking Interferers 
z Congestion Control in Heterogeneous Networks 
z Localization and Tracking for Smart Devices and the Internet of Things 
z Towards 4G - Technical Overview of LTE and WiMAX 
æ•´é«”è€Œè¨€ï¼Œæœ¬æ¬¡ WCNC ä¹‹è­°ç¨‹å…§å®¹è±å¯Œï¼Œå¸å¼•ï¦ºï¥©ç™¾äººèˆ‡æœƒï¼Œç„¶è€Œæœƒè­°æœŸé–“é©é€¢å†°å³¶ç«å±±åŠ‡ï¦Ÿå™´ç™¼ï¼Œ
é€ æˆï¥§å°‘æ­æ´²åœ‹å®¶çš„å°ˆå®¶å­¸è€…å› ç­æ©Ÿç„¡æ³•èµ·é£›è€Œç¼ºå¸­ï¼Œä¹Ÿå½¢æˆå¤šç¯‡è¢«æ¥å—ï¥æ–‡ç„¡äººåˆ°å ´ç™¼è¡¨æƒ…æ³ï¼Œç›¸
ç•¶å¯æƒœã€‚ 
æœ¬äººèˆ‡åšå£«ç­å­¸ç”Ÿåœ¨ WCNC 2010 æœƒè­°ä¸­å…±ç™¼è¡¨ä¸‰ç¯‡ï¥æ–‡ï¼Œåˆ†åˆ¥æ˜¯ An Efficient Power Allocation 
Algorithm for Multiuser OFDM-Based Cognitive Radio Systemsã€Design of an Adaptive Receiver for OFDM 
Systems Using Conjugate TransmissionåŠ Design and Implementation of a Decentralized Positioning System 
for Wireless Sensor Networksã€‚é¦–ç¯‡ï¥æ–‡é‡å°å¤šç”¨æˆ¶ OFDM æ„ŸçŸ¥ç„¡ç·šé›»ç³»çµ±ï¼Œæå‡ºä¸€å…·æœ‰é«˜æ•ˆèƒ½çš„åŠŸï¥¡
åˆ†é…æ¼”ç®—æ³•ï¼›æ­¤æ–¹æ³•çš„è¤‡é›œï¨ä½ï¼Œä½†å»èƒ½é€¼è¿‘æœ€ä½³æ¼”ç®—æ³•æ‰€èƒ½æä¾›çš„ç³»çµ±å®¹ï¥¾ï¼Œé —å…·å¯¦ç”¨åƒ¹å€¼ã€‚ç¬¬äºŒ
è¨ˆç•«ç·¨è™Ÿ NSC96-2628-E-007-005-MY3 
è¨ˆç•«åç¨± ï¨ˆå‹•æ­£äº¤åˆ†é »å¤šå·¥ç³»çµ±ä¹‹å‰ç»åŸºé »è™•ï§¤æŠ€è¡“ç ”ç©¶ 
å‡ºåœ‹äººå“¡
å§“å ç‹æ™‰ï¥¼ æœå‹™æ©Ÿæ§‹åŠè·ç¨± 
åœ‹ï§·æ¸…è¯å¤§å­¸é€šè¨Šå·¥ç¨‹ç ”ç©¶æ‰€  
æ•™æˆ 
æœƒè­°æ™‚é–“ 2010 ï¦ 4 æœˆ 18 æ—¥è‡³ 2010 ï¦ 4 æœˆ 21 æ—¥ æœƒè­°åœ°é» æ¾³æ´²ã€é›ªï§¢ 
æœƒè­°åç¨± (ä¸­æ–‡) 2010 IEEE ç„¡ç·šé€šè¨Šèˆ‡ç¶²ï¤·æœƒè­° (è‹±æ–‡) 2010 IEEE Wireless Communications and Networking Conference 
ç™¼è¡¨ï¥æ–‡
é¡Œç›® 
1. An Efficient Power Allocation Algorithm for Multiuser OFDM-Based Cognitive Radio 
Systems 
2. Design of an Adaptive Receiver for OFDM Systems Using Conjugate Transmission 
3. Design and Implementation of a Decentralized Positioning System for Wireless Sensor 
Networks 
An Efficient Power Allocation Algorithm for 
Multiuser OFDM-Based Cognitive Radio Systems 
Chiuan-Hsu Chen 
Institute of Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
Chin-Liang Wang 
Department of Electrical Engineering and Institute of  
Communications Engineering 
National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
E-mail: clwang@ee.nthu.edu.tw
 
 
Abstractâ€”This paper aims to investigate an efficient power 
allocation algorithm for multiuser orthogonal frequency division 
multiplexing (MU-OFDM) cognitive radio (CR) systems that uses 
the peak power constraint to protect the primary users. Under 
this constraint, the high-complexity optimal power allocation 
algorithm for OFDM-based CR systems is not suited to 
determine the power distribution because the algorithm must 
iteratively perform the standard water-filling (WF) to determine 
whether or not the power in each assigned subcarrier is greater 
than the peak power. Instead of using the WF algorithm, we use 
the conditions that the optimal power distribution should be 
satisfied to design a simple method for fulfilling the peak power 
constraint in each assigned subcarrier and then updating the 
water level. Simulation results indicate that using the proposed 
efficient method to update the water level achieves a system 
capacity close to that of the optimal power allocation algorithm. 
Keywords-cognitive radio (CR); multiuser orthogonal frequency 
division multiplexing (MU-OFDM); peak power constraint; power 
allocation 
I.  INTRODUCTION 
In wireless networks, frequency spectrum is a limited 
resource and its efficient usage plays an important role in next-
generation wireless communication systems. From the report of 
the Federal Communications Commission (FCC) of the United 
States in 2002 [1], however, the efficiency of use of the 
licensed spectrums is less than 15%. Spectrum opportunities 
are generated that enable unlicensed users to access these 
spectrums temporally as well as spatially and thus to improve 
overall spectrum efficiency, under acceptable interference to 
the licensed users. Cognitive radio (CR) [2] is a suitable 
technology for achieving this goal because it is flexible and 
intelligent in spectrum use. 
Multiuser orthogonal frequency division multiplexing (MU-
OFDM) provides a scalable and adaptive technology for an air 
interface and has been used successfully in many wireless 
communication systems such as the IEEE 802.16 standard [3]; 
thus, MU-OFDM is a promising technique for next-generation 
wireless broadband networks [4]. Using this technique, 
different subcarriers of an OFDM symbol are able to 
simultaneously transmit different usersâ€™ data, so MU-OFDM is 
a candidate for multiple access scheme in CR systems [5], [6]. 
Recently, the resource allocation algorithm has been widely 
studied [7] because of the internal flexibility of OFDM in 
power loading across the subcarriers. An efficient resource 
algorithm for OFDM systems can dynamically assign limited 
resources (subcarriers and power) to maximize the 
performance. For MU-OFDM systems, exploiting the multiuser 
diversity, a dynamic resource allocation algorithm can assign 
the available resources to the user who has the best channel 
state information (CSI) for improving the spectrum efficiency. 
To protect the licensed users (or primary users [PUs]), the 
resource allocation problem in MU-OFDM CR systems usually 
includes a peak power constraint to limit the transmitted power 
of unlicensed users (or secondary users [SUs]) [8]-[10]. With 
the power constraint on each subchannel (a group of 
subcarriers), the optimal power allocation algorithm in single-
user OFDM-based CR systems was studied in [8], where the 
iterative partitioned water-filling (IPWF) algorithm was 
proposed to realize the optimal power allocation. Although the 
complexity of the IPWF is less than that of the exhaustive 
search algorithm, it may need to perform the water-filling (WF) 
algorithm many times for a fixed number of subcarriers. 
Moreover, when the IPWF algorithm is used to support the 
subcarrier assignment (i.e., joint subcarrier and power 
allocation), it must recalculate the water level to determine the 
power for each subcarrier, which would cause joint subcarrier 
and power allocation to have very high complexity. In [9], a 
low-complexity joint subcarrier and power allocation algorithm 
for MU-OFDM CR systems was proposed. However, its power 
allocation part does not consider the peak power constraint of 
CR systems in the optimization process, and this makes the 
algorithm less than optimal. 
In this paper, using a specified subcarrier allocation, we 
propose an efficient power allocation algorithm for MU-OFDM 
CR systems. We use the theorem in [8] to develop a simple 
method for determining whether or not the power in each 
assigned subcarrier is greater than the peak power constraint. 
Using this classification, the water level can be updated 
sequentially until all assigned subcarriers are checked. The 
proposed method not only reduces the complexity of executing 
the IPWF algorithm, but also achieves the results of the 
theorem in [8] for power allocation in MU-OFDM CR systems. 
Simulation results show that the proposed low-complexity 
algorithm achieves a system capacity close to that of the IPWF 
This work was supported by the National Science Council of the Republic 
of China under Grants NSC 96-2628-E-007-005-MY3. 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
978-1-4244-6398-5/10/$26.00 Â©2010 IEEE
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 09,2010 at 04:48:07 UTC from IEEE Xplore.  Restrictions apply. 
IV. A SUBOPTIMAL POWER ALLOCATION ALGORITHM 
In the following, instead of using the WF algorithm to 
classify the two sets, we propose a method to update the 
common water level for determining the subcarriers in Ak and 
Bk. Before describing the steps for updating the common water 
level in Ak, we describe the lemma about the traditional WF 
algorithm. 
Lemma: Assume that the WF algorithm is performed on N 
subcarriers with power P and that the corresponding water 
level is w. If a new subcarrier with CNR, H, is added, the new 
water level becomes 
1max( ,0)
1
w Hw w
N
âˆ’
= âˆ’
+
    (4) 
when w  is also greater than or equal to the inversions of the 
CNRs of the original N subcarriers. 
Proof: When a new subcarrier with CNR, H, is added, the 
assigned power of the new subcarrier is 1w H âˆ’âˆ’ , where w  is 
the new water level. This value is derived from the power that 
is allocated to the original N subcarriers; that is, 
1 ( )w w w N
H
âˆ’ = âˆ’           (5) 
when 1w H âˆ’>  (or w w>  ). Eq. (5) can be rewritten as 
1 1
1 1
Nw H w Hw w
N N
+ âˆ’
= = âˆ’
+ +
 .  (6) 
If w < Hâˆ’1, there is no additional power can be assigned; 
therefore, the power on Hâˆ’1 is zero and the water level w is still 
the original value.                â–  
A. The Update of the Common Water Level 
In Section III, the IPWF algorithm may need to perform the 
WF algorithm many times to categorize the assigned 
subcarriers into two different sets. To reduce the computational 
burden of this categorization, we use the results of the theorem 
in [8]â€”that is, the common water level in Ak is greater than or 
equal to the unique water levels in Bk (wk,n â‰¤ wË†  âˆ€nâˆˆBk)â€”to 
design a method for updating the common water level. Using 
the common water level, the power of the subcarriers in Ak can 
be assigned immediately. The power of each subcarrier in Bk is 
Pk,max. 
Proposition: Assume that the sets Î©k = {1, 2, â€¦, Nk} and 
Î¨k = {1, 2, â€¦, kN }, where Î¨k âŠ† Î©k and kN  â‰¤ Nk. From 
Section III, suppose that Ë† kw  is the common water level of the 
set Ak = {i| pk,i < Pk,max, iâˆˆÎ¨k}. Then, the jth subcarrier (jâˆ‰Î¨k 
but jâˆˆÎ©k) will be assigned to Bk = {i| pk,i = Pk,max, iâˆˆÎ¨k} if 
, ,maxË† 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
âˆ’
â‰¥
+
        (7) 
Otherwise, the subcarrier will be in Ak. The new common water 
level of Ak is Ë† min(max( , 0), )k k kw a bâˆ’ . In addition, when jâˆˆBk, 
|Bk| must satisfy Pk > (|Bk|+1)Pk,max to ensure the total power 
allocated to Ak is positive. 
Proof: If jâˆˆBk, the assigned power in the jth subcarrier is 
Pk,max and the common water level of Ak becomes 
,maxË† | |k k kw P Aâˆ’  and the new common water level must be 
greater than or equal to the unique water level in the jth 
subcarrier; that is, 
,max
, ,max
,
1Ë†
| |
k
k k j k
k k j
P
w w P
A H
âˆ’ â‰¥ = +  or 
, ,maxË† 1 .
| | 1 | |
k k j k
k k
k k
w H P
a b
A A
âˆ’
â‰¥
+
     (8) 
Otherwise, the jth subcarrier is assigned to Ak. Using the above-
mentioned lemma, the new common water level becomes 
,Ë† 1Ë† Ë†max( , 0) max( , 0).
| | 1
k k j
k k k
k
w H
w w a
A
âˆ’
âˆ’ = âˆ’
+
  (9) 
With (8) and (9), the new common water level depends on the 
minimum between max( , 0)ka  and bk; that is, 
Ë† min(max( , 0), )k k kw a bâˆ’ .              (10) 
Moreover, when jâˆˆBk, the total power of Ak is 
1 1
, ,
,max ,max
Ë† Ë†( ) ( )
| | 0.
k k k
k k k i k k i ki A i A i A
k k k k
w b H w H b
P B P P
âˆ’ âˆ’
âˆˆ âˆˆ âˆˆ
âˆ’ âˆ’ = âˆ’ âˆ’
= âˆ’ âˆ’ >
âˆ‘ âˆ‘ âˆ‘  (11) 
That is, Pk > (|Bk| + 1)Pk,max.                â–  
B. The Proposed Power Allocation Algorithm 
To determine the kth SUâ€™s common water level of the 
assigned subcarriers, we sequentially classify each subcarrier 
into the set Ak or set Bk by comparing the water level with each 
subcarrierâ€™s unique water level, determining whether or not the 
assigned power is greater than Pk,max. In the initialization step, 
we roughly divide the assigned subcarriers into Ak0 and Bk0, 
which are the initial divisions among all subcarriers to reduce 
the complexity for the following steps. With Ak0 and Bk0, vk is 
defined as a vector that contains Ak0â€™s elements, which follows 
the elements of Bk0. The power allocation is performed on the 
subcarriers according to the elements of vk in sequence. 
In the power assignment step, when the set Ak is null, the 
water level is updated by the rule of the lemma and the current 
subcarrier also is determined to assign it to either Ak or Bk. If 
Ak is not empty, the initial common water level is evaluated 
and then updated when the next assigned subcarrier is 
concerned. The proposition provides a method for renewing 
the common water level. Details of the proposed power 
allocation algorithm of the kth SU for a channel realization are 
summarized as follows: 
1) Initialization 
(a) The following parameters are defined first: 
{1,2,..., }k kNÎ© = , k kA B Ï†= = , 0Akw = , 1n = , Pk,max, 
and Pk. 
(b) 1
,( )
k
k k k i ki
w P H Nâˆ’
âˆˆÎ©
= +âˆ‘ ; 
0
1
0 ,max , 0,1 0,| |{ | , } { , ..., }kk k k k i k k k AA i w P H i a a
âˆ’
= < + âˆˆÎ© = ; 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 09,2010 at 04:48:07 UTC from IEEE Xplore.  Restrictions apply. 
transmitted power for each SU was 0 dB. All simulation results 
shown in all figures are averaged over 10,000 channel 
realizations.  
For a multiuser OFDM CR system with N = 128 and K = 8, 
the subcarrier allocation is that SU k uses subcarriers 
16(kâˆ’1)+1 through 16k. That is, subcarriers 1 through 16 
belong to SU 1, subcarriers 17 through 32 belong to SU 2, and 
so on. The maximum path loss difference was 40 dB and the 
SU locations were assumed to be uniformly distributed. Fig. 3 
shows that the performance of the proposed algorithm is close 
to that of the IPWF algorithm for two different noise powers. In 
the low noise power case, the normalized sum capacity quickly 
saturates at Pk,max = âˆ’12 dB. That is, the capacity experiences 
no loss even though the peak power constraint is imposed on 
each subcarrier. In the high noise power case, the saturation 
point is at Pk,max = âˆ’8 dB. The noise enhances the effect of the 
peak power constraint so that the normalized sum capacity 
cannot saturate at a lower peak power constraint. Although the 
performance of the proposed algorithm degrades slighter more 
than that of the IPWF algorithm, they saturate at the same peak 
power. The performance gap in Fig. 3(b) results from the 
difference between the estimated water level and the true water 
level evaluated by the WF algorithm in the high noise 
environment. 
In Fig. 4, the normalized sum capacity is drawn for several 
different values of the number of users (i.e., K = 8, 12, 16, â€¦, 
32). It is clear that the capacity increases as the number of users 
increases, thus confirming the effect of the multiuser diversity. 
Fig. 5 illustrates the normalized sum capacity for various 
values of the path loss difference. The increase in the capacity 
also results from the multiuser diversity because some SUsâ€™ 
channel gains are better than those of other SUs. This result 
indicates that the peak power constraint may not be fixed for all 
subcarriers because an SU with better channel gain may cause 
significant interference to the PU even though the transmitted 
power of the SU is small. 
VI. CONCLUSION 
In this paper, we have proposed a suboptimal power 
allocation algorithm for MU-OFDM CR uplink systems that 
reduces the computational complexity of determining the water 
level to allocate the power for each subcarrier. The proposed 
method simplifies the procedure to determine whether or not 
the power in each assigned subcarrier is more than the peak 
power constraint. It not only involves lower complexity than 
the optimal power allocation algorithm in [8], but also can 
easily be combined with a subcarrier allocation algorithm for 
joint subcarrier and power allocation. Simulation results have 
shown that the performance of the proposed method is close to 
that of the optimal power allocation algorithm. The low-
complexity and excellent-performance feature makes it 
attractive for use in MU-OFDM CR systems. 
REFERENCES 
[1] Federal Communications Commission (FCC), â€œSpectrum policy task 
force,â€ ET Docket no. 02â€“135, Nov. 15, 2002. 
[2] J. Mitola III and G. Q. Maguire, Jr., â€œCognitive radio: Making software 
radios more personal,â€ IEEE Pers. Commun., vol. 6, no. 4, pp. 13â€“18, 
Aug. 1999. 
[3] IEEE Standard for Local and metropolitan area networks Part 16: Air 
Interface for Broadband Wireless Access Systems, IEEE Standard 
802.16, May 2009. 
[4] T. S. Rappaport, A. Annamalai, R. M. Buehrer, and W. H. Tranter, 
â€œWireless communications: Past events and a future perspective,â€ IEEE 
Commun. Mag., vol. 40, no. 5, pp. 148â€“161, May 2002. 
[5] T. A. Weiss and F. K. Jondral, â€œSpectrum pooling: An innovative 
strategy for the enhancement of spectrum efficiency,â€ IEEE Commun. 
Mag., vol. 42, pp. S8â€“S14, Mar. 2004. 
[6] U. Berthold and J. K. Jondral, â€œGuidelines for designing OFDM overlay 
systems,â€ in Proc. IEEE 1st Int. Symposium on New Frontiers in 
Dynamic Spectrum Access Networks (DySPAN â€˜05), Baltimore, MD, 
Nov. 2005, pp. 626â€“629. 
[7] Z. Han and K. J. R. Liu, Resource Allocation for Wireless Networks: 
Basics, Techniques, and Applications. Cambridge University Press, 
Cambridge, U.K., 2008. 
[8] P. Wang, M. Zhao, L. Xiao, S. Zhou, and J. Wang, â€œPower allocation in 
OFDM-based cognitive radio systems,â€ in Proc. IEEE Global 
Telecommun. Conf. (Globecom 2007), Washington, DC, Nov. 2007, pp. 
4061â€“4065. 
[9] F. F. Digham, â€œJoint power and channel allocation for cognitive radios,â€ 
in Proc. IEEE Wireless Commun. and Networking Conf. (WCNC 2008), 
Las Vegas, NV, Mar. 2008, pp. 882â€“887. 
[10] X. Kang, Y.-C. Liang, and A. Nallanathan, â€œOptimal power allocation 
for fading channels in cognitive radio networks under transmit and 
interference power constraints,â€ in Proc. IEEE Int. Conf. Commun. (ICC 
2008), Beijing, China, May 2008, pp. 3568â€“3572. 
[11] J. M. Cioffi. (2008) EE379C Advanced Digital Communications 
[Online]. Available: http://www.stanford.edu/class/ee379c 
[12] T. M. Cover and J. A. Thomas, Elements of Information Theory. 2nd Ed. 
New York: Wiley, 2006. 
 
 
Figure 1.  A multiuser OFDM CR uplink system. 
 
TABLE I.  Comparison of Computational Complexity 
 
Proposed 
Algorithm IPWF Algorithm 
Multiplications O(N)  O(N) (Lower Bound) 
Additions O(N) O(Nlog2(N/K))  (Lower Bound) 
 
Method
Complexity
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 09,2010 at 04:48:07 UTC from IEEE Xplore.  Restrictions apply. 
  Design of an Adaptive Receiver for OFDM     
Systems Using Conjugate Transmission 
 
Chin-Liang Wangâ€ â€¡, Ying-Chang Linâ€¡, and Po-Chung Shenâ€¡ 
â€ Department of Electrical Engineering, National Tsing Hua University 
â€¡Institute of Communications Engineering, National Tsing Hua University 
Hsinchu, Taiwan 30013, Republic of China 
E-mail: clwang@ee.nthu.edu.tw 
 
 
Abstractâ€”In this paper, we first investigate two efficient inter-
carrier interference (ICI) self-cancellation schemes for 
orthogonal frequency division multiplexing (OFDM) systems, 
conjugate cancellation (CC) and phase-rotated conjugate 
cancellation (PRCC), by examining their system structures and 
performances. Then, we propose an adaptive receiver design 
based on conjugate transmission for ICI self-cancellation in 
OFDM systems. Compared to PRCC, the proposed receiver not 
only saves the signaling overhead by omitting the need to feed the 
frequency offset estimate back to the transmitter, but also has the 
frequency tracking capability by adopting the normalized block 
least mean-squared algorithm in the update process for the 
artificial phase rotation factor. Computer simulations show that 
the proposed scheme can provide better bit-error-rate 
performance over both CC and PRCC. Besides, even if the 
frequency offset estimation error is considered, the proposed 
scheme is shown to be more robust than the other methods. 
Keywords-block least mean-squared (BLMS) algorithm; 
frequency offset; inter-carrier interference (ICI); ICI self-
cancellation; orthogonal frequency division multiplexing (OFDM)  
I. INTRODUCTION 
Orthogonal frequency division multiplexing (OFDM) [1] is 
a wideband transmission technique suitable for high-rate 
multimedia services. The attractive properties such as high 
bandwidth efficiency and the immunity to multipath fading 
channels make OFDM become popular in modern wireless 
communication systems. Nevertheless, the performance of 
OFDM is highly sensitive to the carrier frequency offset which 
might arise from the Doppler effect in mobile environments or 
the mismatch between local oscillators at the transmitter and 
receiver.  
To solve the frequency offset problem, the most intuitive 
way is to synchronize the carrier frequency of the received 
signal to that of the transmitted signal. In this case, both 
frequency offset estimation and compensation need to be 
performed [2], [3]. In [4], an inter-carrier interference (ICI) 
self-cancellation scheme was proposed that typically uses 
polynomial coding on the transmitted symbols in the 
frequency domain such that the ICI induced from distinct 
subcarriers can be suppressed by one another. A notable 
expense of this approach is that the bandwidth efficiency 
would be halved. Moreover, the corresponding bit-error-rate 
(BER) performance may be limited due to the phase error 
generated in the coherent detection process. Although the 
method proposed in [5] can mitigate the phase error problem, 
it still cannot provide satisfactory performance under 
environments with high frequency offsets. Recently, two-path 
conjugate transmission was introduced and two ICI self-
cancellation alternatives, called conjugate cancellation (CC) 
[6] and phase-rotated conjugate cancellation (PRCC) [7], were 
proposed. In CC, an OFDM symbol is transmitted through the 
first path, while its conjugate replica is transmitted through the 
second path. After combining the received signals from the 
two paths, the ICI in one path could be suppressed by that in 
the other path. In PRCC, an artificial phase rotation factor is 
introduced to the transmitter in CC such that the ICI 
cancellation capability becomes more generic and flexible. 
Although CC and PRCC work well for time-invariant 
channels, they might not provide satisfactory performance for 
time-variant channels where the frequency offset changes with 
time. Besides, the receiver in PRCC needs to feed the 
frequency offset estimate back to the transmitter for 
determination of the optimal phase rotation factor, which 
induces an additional signaling overhead in OFDM systems.  
In this paper, we propose an ICI self-cancellation scheme 
which employs the concept of conjugate transmission at the 
receiver. In contrast to PRCC, an artificial phase rotation is 
introduced at the receiver instead of the transmitter for the 
proposed approach. Moreover, the phase rotation factor is 
tuned adaptively with frequency offset variations by means of 
the normalized block least mean-squared (BLMS) algorithm. 
It is shown that the proposed receiver structure can provide 
better ICI cancellation performance than CC and PRCC, 
especially under environments with time-variant frequency 
offsets. 
The rest of the paper is organized as follows. Section II 
describes the system model and derives the carrier-to-
interference ratios (CIR) of the original OFDM, CC, and PRCC 
schemes. In Section III, the proposed receiver structure for ICI 
cancellation is introduced. Section IV gives performance 
comparisons of the proposed scheme and other methods. 
Finally, conclusions are given in section V. 
This work was supported by the National Science Council of the Republic
of China under Grants NSC 96-2628-E-007-005-MY3 and NSC 97-2219-E-
007-007. 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
978-1-4244-6398-5/10/$26.00 Â©2010 IEEE
the proposed scheme can work well in time-variant channels, 
where accurate frequency offset estimation is hardly provided. 
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35
0
10
20
30
40
50
60
70
80
Normalized frequency offset Îµ
CI
R 
(dB
)
 
 
Standard OFDM
CC
PRCC Ï† = -0.1565
PRCC Ï† = -0.4694
PRCC Ï† = Ï†opt
Fig. 2. CIR comparison of the original OFDM system, CC, and PRCC using 
different phase rotations.  
III. THE PROPOSED SCHEME 
In order to inherit the ICI cancellation capability of PRCC 
and omit feeding back the information of frequency offset 
estimate, we design a similar structure at the receiver, rather 
than at the transmitter. Therefore, the transmitter structure in 
the proposed scheme is the same as in CC, as shown in Fig. 1. 
A. Signal Model 
In the proposed scheme, the two-path transmission is 
carried out by sending the OFDM symbol and its conjugate 
replica in two consecutive time slots. Assuming a time-
invariant and uncorrelated-scattering (US) channel model, the 
time-domain received signals from the two transmission paths 
can be expressed as 
 
1
2 /
0
,  0,  1,  ,  1
L
j n N
n n l l n
l
y x h e w n NÏ€ Îµ
âˆ’
âˆ’
=
â› â
= + = âˆ’âœ âŸâ â âˆ‘ "         (9) 
and 
1
* 2 /
0
,  0,  1,  ,  1,
L
j n N
n n l l n
l
y x h e w n NÏ€ Îµ
âˆ’
âˆ’
=
â› â
= + = âˆ’âœ âŸâ â âˆ‘  "       (10) 
where L is the number of channel taps, and nw  and nw  are 
independent zero-mean additive noise samples. By applying 
FFT to (9) and (10), we obtain the demodulated symbols at the 
mth subcarrier 
1
0
( ) ,  0,  1,  ,  1,
N
m k k m
k
Y X H S m k W m NÎµ
âˆ’
=
= âˆ’ âˆ’ + = âˆ’âˆ‘ "      (11) 
 
1
0
( ) ,  0,  1,  ,  1,
N
m k k m
k
Y X H S m k W m NÎµ
âˆ’
=
= âˆ’ + + = âˆ’âˆ‘   "      (12) 
 
where mW  and mW  are the discrete Fourier transform of nw  
and nw , respectively. It can be derived that the channel gains 
at the kth subcarrier in the two paths have the following 
relationship 
( )
*1 1
* 2 / 2 ( ) / *
0 0
,
L L
j kl N j k l N
k l l k
l l
H h e h e HÏ€ Ï€
âˆ’ âˆ’
âˆ’ âˆ’ âˆ’
âˆ’
= =
â› â
= = =âœ âŸâ â âˆ‘ âˆ‘         (13) 
which means that due to conjugate transmission, the channel 
gains at the same subcarrier but in different paths would be 
made highly uncorrelated. Hence, maximum ratio combining 
(MRC) can be applied to the received symbols from both 
paths to take advantage of two-path diversity. To employ 
MRC in the proposed receiver scheme, the symbols in (11) 
and (12) would firstly be weighted by their individual channel 
gains, such as *m m mZ H Y=  and 
*
m m mZ H Y=   . Then, opposite 
phase rotations will be applied to the signals in different paths, 
i.e., multiplying the first pathâ€™s signal with nje Ï†  and the 
second pathâ€™s signal with nje Ï†âˆ’ , where nÏ†  is the phase rotation 
factor applied at the OFDM symbols in the (2n-1)th and the 
2nth time slot. As a result, the final MRC output can be written 
as 
( )
1
* *
0
* *
   ( ) ( )
       ,  0,  1,  ,  1, (14)       
n n
n n
n n
j j
m m m
N
j j
k m k n m k n
k
j j
m m m m
R e Z e Z
X e H H S m k e H H S m k
e H W e H W m N
Ï† Ï†
Ï† Ï†
Ï† Ï†
Îµ Îµ
âˆ’
âˆ’
âˆ’
=
âˆ’
= +
â¡ â¤= âˆ’ âˆ’ + âˆ’ +â£ â¦
+ + = âˆ’
âˆ‘

 
  "
je Ï†
je Ï†âˆ’
Y
Y
*H
*H
2
H
XË†
*( )â‹…
Z
Z
R
âˆ‡
DË†
2H
Ë†
1d
Ë†
2d
 
Fig. 3. Block diagram of the proposed adaptive receiver. 
Fig. 3 shows the block diagram of the proposed receiver, 
which comprises an upper branch and a lower branch. The 
upper branch consists of diversity combining, signal 
equalization and detection blocks; the lower branch involves 
signal reconstruction and adaptive phase rotation blocks. 
Assume that the symbol at the mth subcarrier has been 
detected and denoted by Ë† mX  in the decision-directed mode, it 
is utilized with the channel state information (CSI) to produce 
  21Ë† Ë†m m md H X=                                    (15) 
and 
22Ë† Ë† .m m md H X=                                    (16) 
Then, we use 1Ë†md  and 
2Ë†
md  to reconstruct the first term in (14) 
with k m= ,  which is written as 
 
1 2
22
Ë† Ë† Ë†Ë† Ë†(- ) ( )
Ë†Ë† Ë†   (- ) ( ) .
n n
n n
j j
m n m n m
j j
n m n m m
d e S d e S d
e S H e S H X
Ï† Ï†
Ï† Ï†
Îµ Îµ
Îµ Îµ
âˆ’
âˆ’
= +
â¡ â¤
= +â¢ â¥â£ â¦
       (17) 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
degrades with the increase of estimation error, especially at 
large frequency offsets. However, the BER performance 
degradation of the proposed scheme is very slight 
comparatively. This is due to the correction of phase rotation 
factor in the proposed scheme, which makes it more robust 
against the frequency offset estimation error. Fig. 5 depicts 
another BER comparison in a time-variant channel, i.e. 
0DÎµ â‰  . Similarly, the BER curves of the proposed scheme 
still degrade more slightly than the PRCC scheme with the 
increase of frequency offset variation.  
0 5 10 15 20 25 30 35
10-6
10-5
10-4
10-3
10-2
10-1
100
Eb / N0 (dB)
BE
R
Multipath fading channel ÎµD = 0.1 , Îµ = 0.05 , Perfect CSI
 
 
Compensation ( | Îµ| / Îµ =   0 % )
Compensation ( | Îµ| / Îµ = 20 % )
CC
PRCC            ( | Îµ| / Îµ =   0 % )
PRCC            ( | Îµ| / Îµ = 20 % )
Proposed       ( | Îµ| / Îµ =   0 % )
Proposed       ( | Îµ| / Îµ = 20 % )
Fig. 6. BER comparison of different schemes over a multipath fading channel 
with Îµ = 0.05 and ÎµD = 0.1 under perfect and imperfect synchronization 
conditions. 
0 5 10 15 20 25 30 35
10-5
10-4
10-3
10-2
10-1
100
Eb / N0 (dB)
BE
R
Multipath fading channel ÎµD = 0.1 , Îµ = 0.15 , Perfect CSI
 
 
Compensation ( | Îµ| / Îµ =   0 % )
Compensation ( | Îµ| / Îµ = 20 % )
CC
PRCC            ( | Îµ| / Îµ =   0 % )
PRCC            ( | Îµ| / Îµ = 20 % )
Proposed       ( | Îµ| / Îµ =   0 % )
Proposed       ( | Îµ| / Îµ = 20 % )
 
Fig. 7. BER comparison of different schemes over a multipath fading channel 
with Îµ = 0.15 and ÎµD = 0.1 under perfect and imperfect synchronization 
conditions. 
Figs. 6 and 7 show the BER comparison of different 
schemes over a multipath fading channel with ÎµD = 0.1 under 
different synchronization conditions for Îµ = 0.05 and Îµ= 0.15, 
respectively. Since CC doesn't need to know the frequency 
offset information, the frequency offset estimation errors would 
not affect its performance. We can observe that the two-path 
transmission schemes can offer better performance than the 
conventional frequency compensation scheme due to the two-
path diversity in Fig. 6. Moreover, the proposed scheme 
outperforms CC and PRCC while error floors can be seen in 
both the other schemes at high SNR. It implies that the 
proposed scheme can provide a wider range of tolerable 
frequency offsets than the others. By observing Fig. 7, we can 
see that error floors rise up in all two-path transmission 
schemes with a larger frequency offset. Nevertheless, the 
proposed scheme can still offer satisfactory performance than 
the other schemes. Besides, the BER performance of the 
proposed scheme almost stays fine even with frequency offset 
estimation errors. 
V. CONCLUSIONS 
In this paper, we have proposed an adaptive receiver design 
based on conjugate transmission for ICI cancellation in 
OFDM systems. We utilize the normalized BLMS algorithm 
to adjust the phase rotation factor at the receiver to maintain 
ICI self-cancellation effectiveness with the variation of 
frequency offset under time-varying channels. Compared to 
the PRCC scheme in [7], the proposed receiver does not need 
to feed the frequency offset estimate back to the transmitter, 
hence the signaling overhead in the PRCC scheme can be 
eliminated. Computer simulations have shown that the 
proposed scheme can provide better robustness against the 
frequency offset estimation error than the PRCC scheme. 
Under time-varying channels, the proposed adaptive receiver 
can also provide better CIR performance than existing ICI 
self-cancellation schemes. 
REFERENCES 
[1] R. van Nee and R. Prasad, OFDM for Wireless Multimedia 
Communications. Norwood, MA: Artech House, 2000. 
[2] J. J. van de Beek, M. Sandell, and P. O. Borjesson, â€œML estimation of 
time and frequency offset in OFDM systems,â€ IEEE Trans. Signal 
Process., vol. 45, no. 7, pp. 1800-1805, July 1997. 
[3] U. Tureli, D. Kivanc, and H. Liu, â€œExperimental and analytical studies 
on a high-resolution OFDM carrier frequency offset estimator,â€ IEEE 
Trans. Veh. Technol., vol. 50, no. 2, pp. 629-643, Mar. 2001. 
[4] Y. Zhao and S.-G. HÃ¤ggman, â€œIntercarrier interference self-cancellation 
scheme for OFDM mobile communication systems,â€ IEEE Trans. 
Commun., vol. 49, no. 7, pp. 1185-1191, July 2001. 
[5] K. Sathananthan, C. R. N. Athaudage, and B. Qiu, â€œA novel ICI 
cancellation scheme to reduce both frequency offset and IQ imbalabce 
effects in OFDM,â€ in Proc. IEEE 9th Int. Symp. Comput. Commun., July 
2004, pp. 708-713. 
[6] H.-G. Yeh, Y.-K. Chang, and B. Hassibi, â€œA scheme for cancelling 
intercarrier interference using conjugate transmission in multicarrier 
communication systems,â€ IEEE Trans. Wireless Commun., vol. 6, no. 1, 
pp. 3-7, Jan. 2007.  
[7] C.-L. Wang and Y.-C. Huang, â€œIntercarrier interference cancellation 
using general phase rotated conjugate transmission for OFDM systems,â€ 
IEEE Trans. Commun., vol. 58, no. 3, March 2010. 
[8] S. Haykin, Adaptive Filter Theory. 4th ed., Upper Saddle River, NJ: 
Prentice-Hall, 2002. 
[9] B. Oâ€™Hara and A. Petrick, The IEEE 802.11 Handbook: A Designerâ€™s 
Companion. IEEE Press, 1999. 
 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the WCNC 2010 proceedings.
  
ç”±æ–¼é€™æ¬¡æœƒè­°æœ‰è¨±å¤šç¯‡ï¥æ–‡ç™¼è¡¨ï¼Œæ‰€ä»¥è­°ç¨‹çš„ä¸»é¡Œåˆ†çš„å¾ˆç´°ï¼Œå¾è­°ç¨‹çš„å®‰æ’å¯ä»¥çœ‹å‡ºé€šè¨Šç³»çµ±é™¤
ï¦ºåŸæœ¬çš„æ­£äº¤åˆ†é »å¤šå·¥èˆ‡å¤šè¼¸å…¥å¤šè¼¸å…¥(MIMO)æŠ€è¡“ä»ç„¶æœ‰è¨±å¤šç¯‡ï¥æ–‡ç™¼è¡¨ä¹‹å¤–ï¼Œç›®å‰æœ€ç†±é–€çš„ç ”ç©¶é¡Œ
ç›®æ˜¯æ„ŸçŸ¥ç„¡ç·šé›»(cognitive radio)ã€åˆä½œå¼é€šè¨Š(cooperative communications)ã€éš¨æ„ç¶²(Ad Hoc)èˆ‡ mesh 
networksï¼Œå› ç‚ºé€™äº›ä¸»é¡Œçš„å ´æ¬¡æ¯”å…¶ä»–é¡Œç›®å¤šï¼Œåˆ°å ´ï¦°è½çš„äººï¥©ä¹Ÿæ¯”è¼ƒå¤šã€‚åœ¨æ„ŸçŸ¥ç„¡ç·šé›»éƒ¨åˆ†ï¼Œé™¤ï¦º 
spectrum sensing èˆ‡ resource allocation ä¹‹å¤–ï¼Œé‚„æœ‰åŠ å…¥ï¦º MIMO çš„æŠ€è¡“ã€åˆä½œå¼é€šè¨ŠæŠ€è¡“ç­‰æ–¹é¢çš„
ï¥æ–‡ï¼Œä¹Ÿè®“èˆ‡æ„ŸçŸ¥ç„¡ç·šé›»ç›¸é—œçš„ç ”ç©¶ä¸»é¡Œæœ‰ï¤å¤šï¥§ä¸€æ¨£çš„æ–¹å‘ï¤­è¨ï¥ï¦ºã€‚å¦å¤–ï¼Œé€™æ¬¡æœƒè­°åœ¨æ¯å ´å ±å‘Š
ä¹‹å‰æœƒæœ‰å·¥ä½œäººå“¡ç™»è¨˜å‡ºå¸­çš„å ±å‘Šè€…ï¼Œå ±å‘Šä¹‹å¾Œä¹Ÿæœƒæœ‰å·¥ä½œäººå“¡ï¤­è¦å ±å‘Šè€…ç°½åï¼Œç®—æ˜¯ç®¡æ§æœƒè­°å ±å‘Š
è€…å‡ºå¸­ï¥¡çš„ä¸€é …æªæ–½ã€‚ 
ç”±æ–¼é€™æ¬¡çš„åœ‹éš›é€šè¨Šæœƒè­°æ˜¯ç¬¬ä¸€æ¬¡åœ¨éæ´²å¤§ï§“èˆ‰è¾¦ï¼Œæ‰€ä»¥å¯ä»¥æ„Ÿå—åˆ°ç•¶åœ°ä¸»è¾¦å–®ä½çš„ç”¨å¿ƒï¼Œé™¤ï¦º
åœ¨ç•¶åœ°æ–°å»ºå¥½ï¥§ä¹…çš„é–‹æ™®æ•¦åœ‹éš›æœƒè­°ä¸­å¿ƒèˆ‰è¾¦ä¹‹å¤–ï¼Œæ­¡è¿æœƒä¸¦å®‰æ’å¸¶æœ‰éæ´²é¢¨æ ¼çš„è¡¨æ¼”èˆ‡è¦åŠƒç•¶åœ°ç›¸
é—œï¦ƒéŠï¨ˆç¨‹ï¼Œï¨¦æ˜¯æƒ³è®“èˆ‡æœƒå­¸è€…é«”æœƒåˆ°ä¸»è¾¦å–®ä½çš„ç†±æƒ…ã€‚å¦å¤–ï¼Œå¯èƒ½é–‹æ™®æ•¦æ˜¯å—éæ²»å®‰é‚„ç®—ï¥§éŒ¯çš„åŸ
å¸‚ï¼Œç™½å¤©åœ¨ç•¶åœ°æ´»å‹•ä¸¦æ²’æœ‰åƒæ–°èæ‰€å ±å°ï¥¯å—éæ²»å®‰å¾ˆå·®çš„æ„Ÿè¦ºï¼Œé™¤ï¦ºå¶è€Œæœƒæœ‰äººï¤­è¦æ±è¥¿åƒä¹‹å¤–ï¼Œ
æ‰€æ¥è§¸åˆ°çš„ç•¶åœ°æ°‘çœ¾ï¨¦é‚„è »å‹å–„çš„ã€‚ 
ä¸‰ã€è€ƒå¯Ÿï¥«è§€æ´»å‹•(ç„¡æ˜¯é …æ´»å‹•è€…ï¥­ï¥¶) 
ç„¡ã€‚ 
å››ã€å»ºè­° 
ç›®å‰æ¯ï¦æ‰€èˆ‰è¾¦çš„å¤§å¤§å°å°åœ‹éš›æœƒè­°æœ‰å¾ˆå¤šï¼Œå»ºè­°ç ”ç©¶ç”Ÿè‡³å°‘è¦ï¥«èˆ‡åƒåœ‹éš›é€šè¨Šæœƒè­°é€™ç¨®å¤§å‹æœƒ
è­°ä¸€æ¬¡ï¼Œé›–ç„¶å ±å‘Šçš„å ´é¢å„å€‹æœƒè­°å¤§åŒå°ï¥¢ï¼Œä½†çœ‹åˆ°æœƒå ´é€™éº¼å¤šï¥«èˆ‡äººï¥©çš„å ´é¢ï¼Œå¤šå°‘æœƒè®“è‡ªå·±çš„çœ¼
ç•Œï¤é–‹é—Šï¼Œè€Œä¸”åœ‹éš›çŸ¥åå­¸è€…é€šå¸¸æœƒï¥«åŠ é€™ç¨®å¤§å‹åœ‹éš›æœƒè­°ï¼Œæœ‰æ©Ÿæœƒäº’å‹•çš„è©±ä¹Ÿè®“è‡ªå·±ç¤¾äº¤ï¦´åŸŸï¤æ“´
å……ã€‚ 
äº”ã€æ”œå›è³‡ï¦¾åç¨±åŠå…§å®¹ 
æœƒè­°å…‰ç¢Ÿèˆ‡è­°ç¨‹ç´™æœ¬ã€‚ 
ï§‘ã€å…¶ä»– 
ç„¡ã€‚ 
 
joint scheme in [8], even though it sorts all of the SUsâ€™ 
channels in each subcarrier. 
This paper is organized as follows. Section II introduces the 
MU-OFDM CR system model and formulates the resource 
allocation problem. In Section III, the rule for the subcarrier 
allocation and the optimal power allocation algorithm are given. 
In Section IV, the method to update the water level is 
developed. In Section V, the proposed joint subcarrier and 
power allocation algorithm is presented. Simulation results are 
shown in Section VI, and conclusions are drawn in Section VII. 
II. SYSTEM MODEL 
Consider a multiuser OFDM CR uplink system with M PUs 
and K SUs in Fig. 1, where all SUs are controlled by an SU 
base station (BS) [8]. Based on the spectrum sensing 
techniques, SUs are allowed to access the idle licensed 
spectrum where the PUs are absent. When the SU BS, PUs, and 
SUs have full knowledge of the CSI, the subcarrier and power 
(bit) data of each SU are given for forming an OFDM symbol 
at the transmitter by a resource allocation algorithm. 
In a CR system, the transmitted power of SUs may cause 
unexpected interference to the PUs, whether or not the PUs are 
starting to communicate on a channel that is currently being by 
some SUs. Thus, an additional mechanism is needed to ensure 
that on the communication links of PUs the received signal-to- 
interference-plus-noise ratio (SINR) on each PU is larger than a 
threshold [8]. The SINR constraint on the power allocated for 
user k in subcarrier n (i.e., pk,n) is given by [8] 
0 0
, ,max
,
1 ( )T uk n k
k u
P d N Bp P
d N
Î²
Î² Î¶
âˆ’
âˆ’
â‰¤ âˆ’    (1) 
where PT is the transmitted power of the PU, d0u is the distance 
between the PU (transmitter) and the uth PU (receiver), dk,u is 
the distance between the kth SU and the uth PU, Î² is the path-
loss exponent, N0 is the power spectrum density (PSD) of 
additive white Gaussian noise (AWGN), B is the overall 
available bandwidth, N is the total number of subcarriers, Î¶ is 
the minimum SINR required at each PU for correct decoding, 
and Pk,max is the maximum allocated power for all subcarriers of 
the kth SU. 
Using the peak power constraint in (1), the optimization 
problem considered in this paper is formulated as 
, ,
1
, 2 , ,1 1,  
,1
,1
, ,max
,
,
max  log (1 )
subject to:  
                 1 
                  , 
                 0 , 
                {0,  1} ,
k n k n
K N
k n k n k nk np
N
k n kn
K
k nk
k n k
k n
k n
BN p H
p P k
n
p P k n
p k n
k
Î±
Î±
Î±
Î±
âˆ’
= =
=
=
+
â‰¤ âˆ€
= âˆ€
â‰¤ âˆ€
â‰¥ âˆ€
= âˆ€
âˆ‘ âˆ‘
âˆ‘
âˆ‘
 n
  (2) 
where Î±k,n indicates whether or not the subcarrier n is used by 
SU k; Pk is the overall available power of SU k; Hk,n = 
|hk,n|2/(N0BNâˆ’1) is the CNR for SU k in subcarrier n; and hk,n is 
the channel gain for SU k in subcarrier n. To make it easier to 
solve the problem, (2) can be transformed into a convex 
optimization problem, as follows [10] 
, ,
1
, 2 , , ,1 1,  
,1
,1
, ,max
,
,
min  log (1 )
subject to:  
                 1 
                  , 
                 0 , 
                (0,  1
k n k n
K N
k n k n k n k nk np
N
k n kn
K
k nk
k n k
k n
k n
BN p H
p P k
n
p P k n
p k n
Î±
Î± Î±
Î±
Î±
âˆ’
= =
=
=
âˆ’ +
â‰¤ âˆ€
= âˆ€
â‰¤ âˆ€
â‰¥ âˆ€
âˆˆ
âˆ‘ âˆ‘
âˆ‘
âˆ‘
] ,  k nâˆ€
 (3) 
That is, the original maximization problem is transformed into 
a minimization problem. The last constraint in (2) is relaxed 
and its value is on the half-open interval of (0, 1]. 
III. SUBCARRIER AND POWER ALLOCATION FOR MU-
OFDM CR SYSTEMS 
In the following, we first propose a rule for assigning the 
subcarriers and then introduce the optimal power allocation 
algorithm for MU-OFDM CR uplink systems. 
A. A Rule for Subcarrier Allocation 
The optimization problem in (3) is equivalent to finding the 
minimum of the Lagrangian function 
1
, 2 , , ,1 1
, , , ,max1 1
log (1 )
( ) ( 1) ( )
K N
k n k n k n k nk n
N K
k k n k n k n n k n kn k
L BN p H
p P u v p P
Î± Î±
Î» Î±
âˆ’
= =
= =
= âˆ’ +
+ âˆ’ + âˆ’ + âˆ’
âˆ‘ âˆ‘
âˆ‘ âˆ‘
   (4) 
where Î»k, un, and vn are the Lagrangian multipliers for the first 
three constraints in (3), respectively. 
Proposition 1: For the optimization problem in (3), the 
subcarrier n is allocated to the user whose pi,nHi,n or wiHi,n is 
maximum, where wi is the water level for the ith user when the 
power allocation is performed by the water-filling algorithm. 
Proof: Differentiating (4) with respect to Î±k,n and setting the 
derivative to zero, we obtain 
, , , , ,
, , , , ,
, , , , ,
, , , ,
[ln(1 ) ] 0
ln 2 1
ln 2ln(1 ) .
1
k n k n k n k n k n
n
k n k n k n k n k n
k n k n k n k n k n n
k n k n k n k n
p H p HL B u
N p H
p H p H u N
p H B
Î±
Î± Î± Î±
Î±
Î± Î±
âˆ‚ âˆ’
= + âˆ’ + =
âˆ‚ +
â‡’ + = +
+
 (5) 
Let 1
, , ,1 k n k n k nx p H Î±
âˆ’
= +  and 1 ln 2nc u NB
âˆ’
= . Eq. (5) can be 
expressed as 1 11 1x c x cx e e e
âˆ’ âˆ’
âˆ’ + âˆ’ +
= =  
11 (1 ).x cx e e
âˆ’
âˆ’ âˆ’ âˆ’ +
âˆ’ = âˆ’   (6) 
Because (6) is written in a form such as Y = XeX, where Y = 
âˆ’eâˆ’(1+c) and X = âˆ’xâˆ’1, its solution is âˆ’xâˆ’1 = W(âˆ’eâˆ’(1+c)), where 
W(â‹…) is the Lambert W function [11]. Substituting this solution 
into (6), we find that x = exp{1+ W(âˆ’eâˆ’(1+c))+c} or 
(1 )
, , , exp{1 ( ) } 1.
c
k n k n k np H W e cÎ±
âˆ’ +
= + âˆ’ + âˆ’    (7) 
That is, 1
, , ,k n k n k np H Î±
âˆ’  is a constant for all users. To maximize Î±k,n, 
the subcarrier n should be allocated to user k selected by 
k = arg maxk(pk,nHk,n) or k = arg maxk(wkHk,n)  (8) 
where wk is the water level for user k when the water-filling 
algorithm is performed; that is, pk,n = max(wk âˆ’ 1/Hk,n, 0).        â–  
Although the results of the subcarrier allocation in [8] 
arrive at the same conclusion as (8), uncertainties remain in the 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2010 proceedings
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 02,2010 at 05:02:52 UTC from IEEE Xplore.  Restrictions apply. 
V. A SUBOPTIMAL JOINT SUBCARRIER AND POWER 
ALLOCATION ALGORITHM 
A. The Proposed Algorithm 
From Section IV and (8), the steps of the proposed joint 
subcarrier and power allocation algorithm are summarized as 
follows: 
1) When Ak is empty, calculate the water level to assign the 
subcarriers to the sets Ak and Bk.  
2) If Ak is not empty, evaluate the initial value of the 
common water level with power PAk = Pk âˆ’ |Bk|Pk,max. The 
unique water levels in Bk are Pk,max + 1/Hk,n âˆ€nâˆˆBk.  
3) Update the common water level if Ak is not null. 
4) Assign the subcarrier with the rule in (8). Repeat 1)âˆ’4) 
for all subcarriers. 
5) Finally, for Bk, move the subcarriers to Ak if their unique 
water levels are greater than the common water level. 
Determine the power for all subcarriers with common or 
unique water levels. 
Details of the proposed algorithm for a channel realization 
are described as follows (Note: the following numbers do not 
correspond exactly with the numbers above.): 
1) Initialization 
(a) The following parameters are defined first: A = {1, 
2, â€¦, N}; â„¦k = Ï†, Ak = Bk = Ï†, wk = wtk = 0, wAk = wtAk = 
0, 0kw = , Pk,max, and Pk, k = 1, â€¦, K; n = 1. 
2) while |A| â‰  0 
for k = 1 to K 
(a) â„¦k = â„¦k âˆª {n}; Nk = |â„¦k|. 
(b) if |Ak| = 0 
(1) Evaluate the water level with wk = wk âˆ’ max{(Nk + 
1)âˆ’1(wk âˆ’ 1,k nH
âˆ’ ), 0}, but 1
,k k k nw P H
âˆ’
= +  when Nk = 1. 
(2) Perform the steps in Section IV.A and obtain the 
approximated water level kwâ€² . k kw wâ€²= . 
(3) 1
,max ,{ | ,  }k k k k i kA i w P H i
âˆ’
= < + âˆˆ Î© ; k kB A= . 
(4) if nâˆˆAk 
(i) Find the approximated water level Akwâ€²  with 
PAk = Pk âˆ’ |Bk|Pk,max. Ak Akw wâ€²= ; k Akw wâ€²= . 
else 
(i) 1
,max ,k k k nw P H
âˆ’
= + . 
(c) elseif |Ak| â‰  0 
(1) 1
, ,max( ) (| | 1); | |k Ak k n k k k ka w H A b P A
âˆ’
= âˆ’ + = . 
(2) if bk â‰¤ ak and Pk > (|Bk|+1)Pk,max 
(i) 
tAk Akw w= ; Ak Ak kw w b= âˆ’ ; 1,max ,k k k nw P H
âˆ’
= + . 
Obtain the approximated water level Akwâ€² . 
Ak Akw wâ€²= ; { }k kB B n= âˆª . 
else 
(i) wtAk = wAk. wAk = wAk âˆ’ max(ak, 0). Find the 
approximated water level Akwâ€² . Akw = Akwâ€² ; 
k Akw w= ; { }k kA A n= âˆª . 
(d) â„¦k = â„¦k \ {n}. 
,arg max ( ); { }; ;k k k n k k tk k tAk Akk w H n w w w w= Î© = Î© âˆª = = . 
Ai = Ai \ {n}, Bi = Bi \ {n} âˆ€i â‰  k; A = A \ {n}; n = n + 1. 
3) for k = 1 to K 
(a) 1
,max ,{ | , }k Ak k k i kA i w P H i B
âˆ— âˆ’
= < + âˆˆ ; k kB A
âˆ— âˆ—
= . 
(b) k k kA A A
âˆ—
= âˆª .  
(c) 
, ,maxk i k kp P i B
âˆ—
= âˆ€ âˆˆ ; ,max| |Ak k k kP P B Pâˆ—= âˆ’ . 
(d) 1
,( ) | |
k
Ak Ak k i ki A
w P H Aâˆ’
âˆˆ
= +âˆ‘ . 
(e) 1
, ,max( ,0) Ak i Ak k i kp w H i A
âˆ’
= âˆ’ âˆ€ âˆˆ ; ,
k
Ak Ak ii A
P p
âˆˆ
=âˆ‘ . 
(f) if 0AkP â‰  , 1, , ,maxmin( , ) Ak i Ak i Ak Ak k kp p P P P i A
âˆ’
= âˆ€ âˆˆ . 
The first step of the algorithm is to initialize all the 
variables, where wk is the water level of user k and wtk is its 
temporary value; wAk is the common water level of user k and 
its temporary value is wtAk; and the water level or common 
water level is saved to kw  for assigning each subcarrier. The 
second step assigns the nth subcarrier to the user k. Step 2(b) 
calculates the water level used to categorize the subcarriers into 
sets Ak or Bk, where Bk = kA  is the complement of Ak. The 
common water level is also evaluated until Ak is not empty. 
Step 2(c) updates the common water level in Ak when Step 2(b) 
finds that Ak is not null. After all subcarriers are assigned, Step 
3 allocates the power according to the common water level. 
Steps 3(a)âˆ’(b) move the subcarriers in Bk with unique water 
levels that are greater than the common water level to Ak. The 
power of each subcarrier in kB
âˆ—  is Pk,max; Steps 3(d)âˆ’(f) 
determine the power of the subcarriers in Ak. Because the 
common water level is not from the water-filling algorithm, 
Step 3(f) is used to satisfy the total power constraint for all SUs. 
B. Complexity Analysis 
The complexity of the proposed algorithm results mainly 
from Step 2. Steps 2(b)âˆ’(c) are used to calculate the water level 
and they are disjoint for each other, so the required additions 
and multiplications in Step 2 after all subcarriers are assigned 
are 2( )NO  because 
1 1 1
( 1) 2N K Nknn k nN n N N= = == = +âˆ‘ âˆ‘ âˆ‘ , 
where Nkn is the number of subcarriers for the kth SU when the 
nth subcarrier is assigned. 
The algorithm in [8] also is used to find the water level, so 
its complexity is 2( )NO  rather than ( )NKO . On the other hand, 
when the water-filling algorithm in [12] is used, the IPWF 
algorithm in Section III.B requires 
2( log )kni kniN NO  additions 
and ( )kniNO  multiplications for the ith iteration, where Nkni is 
the total number of subcarriers for the ith iteration when the nth 
subcarrier is assigned to SU k. For all SUs and subcarriers, the 
joint subcarrier and power allocation algorithm with the IPWF 
algorithm needs 
21 1
( log )N K kn knn k N N= =âˆ‘ âˆ‘O  additions and O(N2) 
multiplications, where we assume that the number of iterations 
when the nth subcarrier is assigned to the kth SU is one (i.e., 
the lower bound of the computational complexity). 
From the above analyses, the complexity of the proposed 
algorithm is the same as that of the algorithm in [8] and less 
than that of the lower bound of the computational complexity 
of the joint subcarrier and power allocation with the IPWF 
algorithm. 
VI. SIMULATION RESULTS 
In this section, we demonstrate the proposed joint 
subcarrier and power allocation algorithm using simulation 
This full text paper was peer reviewed at the direction of IEEE Communications Society subject matter experts for publication in the IEEE ICC 2010 proceedings
Authorized licensed use limited to: National Tsing Hua University. Downloaded on July 02,2010 at 05:02:52 UTC from IEEE Xplore.  Restrictions apply. 
åœ‹ç§‘æœƒè£œåŠ©è¨ˆç•«è¡ç”Ÿç ”ç™¼æˆæœæ¨å»£è³‡æ–™è¡¨
æ—¥æœŸ:2010/11/02
åœ‹ç§‘æœƒè£œåŠ©è¨ˆç•«
è¨ˆç•«åç¨±: è¡Œå‹•æ­£äº¤åˆ†é »å¤šå·¥ç³»çµ±ä¹‹å‰ç»åŸºé »è™•ç†æŠ€è¡“ç ”ç©¶ 
è¨ˆç•«ä¸»æŒäºº: ç‹æ™‰è‰¯ 
è¨ˆç•«ç·¨è™Ÿ: 96-2628-E-007-005-MY3 å­¸é–€é ˜åŸŸ: é€šè¨Š
ç„¡ç ”ç™¼æˆæœæ¨å»£è³‡æ–™
å…¶ä»–æˆæœ 
(ç„¡æ³•ä»¥é‡åŒ–è¡¨é”ä¹‹
æˆæœå¦‚è¾¦ç†å­¸è¡“æ´»
å‹•ã€ç²å¾—çé …ã€é‡è¦
åœ‹éš›åˆä½œã€ç ”ç©¶æˆæœ
åœ‹éš›å½±éŸ¿åŠ›åŠå…¶ä»–å”
åŠ©ç”¢æ¥­æŠ€è¡“ç™¼å±•ä¹‹å…·
é«”æ•ˆç›Šäº‹é …ç­‰ï¼Œè«‹ä»¥
æ–‡å­—æ•˜è¿°å¡«åˆ—ã€‚) 
æœ¬è¨ˆç•«è´ŠåŠ©ä¸‰ä½åšå£«ç­ç ”ç©¶ç”Ÿèµ´åŠ æ‹¿å¤§è¥¿å®‰å¤§ç•¥å¤§å­¸ (The University of 
Western Ontario, London, Ontario)ï¼Œèˆ‡è©²æ ¡é›»æ©Ÿèˆ‡é›»è…¦å·¥ç¨‹å­¸ç³»çš„ Prof. 
Xianbin Wang é€²è¡Œç‚ºæœŸä¸‰å€‹æœˆçš„ç ”ç©¶ã€‚æ­¤ä¸€åœ‹éš›åˆä½œç ”ç©¶å°é€™ä¸‰ä½åšå£«ç­ç ”ç©¶
ç”Ÿåœ‹éš›è¦–é‡ä¹‹æ‹“å±•åŠç ”ç©¶èƒ½åŠ›ä¹‹æå‡ï¼Œç›¸ç•¶æœ‰åŠ©ç›Šã€‚ 
 æˆæœé …ç›® é‡åŒ– åç¨±æˆ–å…§å®¹æ€§è³ªç°¡è¿° 
æ¸¬é©—å·¥å…·(å«è³ªæ€§èˆ‡é‡æ€§) 0  
èª²ç¨‹/æ¨¡çµ„ 0  
é›»è…¦åŠç¶²è·¯ç³»çµ±æˆ–å·¥å…· 0  
æ•™æ 0  
èˆ‰è¾¦ä¹‹æ´»å‹•/ç«¶è³½ 0  
ç ”è¨æœƒ/å·¥ä½œåŠ 0  
é›»å­å ±ã€ç¶²ç«™ 0  
ç§‘ 
æ•™ 
è™• 
è¨ˆ 
ç•« 
åŠ  
å¡« 
é … 
ç›® è¨ˆç•«æˆæœæ¨å»£ä¹‹åƒèˆ‡ï¼ˆé–±è½ï¼‰äººæ•¸ 0  
 
