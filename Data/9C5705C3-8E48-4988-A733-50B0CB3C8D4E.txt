  
	


       	 
        	 
        	 
        	 
  
                               !                                !                                !                                !  
     	         	
   ^        !  _  `  a   	
" # $ % & ' 			> S T U V W I X 	Y Z [ \ X ] 	
( ) $ * + , - 			> S T U V W I X 	Y Z [ \ X ] 	
 
 
 
         	 
          
          !" # $ % & ' ( ) $
% * + ,-$ % . / 0 1234 5 6 $ 7 8$ 9
:8; < 8=     > ? @ A $ % . / * + B C
	 DE F G [1],H I 1J K L M N O P 23$ % 0 1Q
R > S T U V W H !X Y Z   8[ \ ] G ^_
`,ab c d  ADSP-21065L EZ-Kit efW H $ % 0
11J g hfi jk g hab c lm n $ % 0 1o
p q r 	 s r t u v M N  s r u v w x j 
SHARC-21065L DSP y z   { j| }~(Fast Fourier 
Transform, FFT) q r 	 s r }~Â€ ÂÂ‚s r  Âƒ
hfÂ„ Â…Â† Â‡   Âˆ	 =     ,
:     	 
         
Abstract
Currently, the use of large loads and nonlinear loads 
has been increasing rapidly and it will produce harmonic 
distortion and other power pollution affecting the power 
quality. By measuring parameters of power lines such as 
effective voltage, current, power, THD, etc, we can tell 
whether the power quality is good or poor. Nowadays 
digital signal processing method used for power parameter 
measurement provides high-speed and accurate 
calculations as well as the advantage of easy 
implementation. In this paper, ADSP-21065L EZ-Kit board 
is employed to implement the digital algorithm. In order to 
calculate these parameters conveniently, these parameters 
are processed in two different domains: time and frequency 
domains. The parameters related to harmonic were 
calculated in frequency domain in which the FFT is used to 
calculate each harmonic component and THD.  
Keywords: power quality, harmonic, FFT (Fast Fourier 
Transform) 
1.       
$ % * + Â‰ ÂŠ Â‹ ÂŒ Â  Â $ 7 8$ 9 	 s < Â
Â !" # $ % . / Â‘ Â’ Â“Â” Z Â• Â Â– S 	 Âƒ 18Âƒ q
Â— Â˜ " # Â• Â™ ^^Â‰ ÂŠ  $ % * + Â‰ ÂŠ   >
op Âš $ %   4 $ Â› Âœ 8Â Â Â” Z 8[ ÂŸ  Â  Â¡
Âœ ^	 
     4 Â¢ 9 Â” Z 8Â£ Â¤ Â¥ 8Â 7 Â˜ 
Â¥ Â¦ $ 9 ^[2],Â‚H I Â§ Â¨   Â” Z Â© Âª Â« Â¬ Â­
Â® S 	 Â¯ Â° i j!  Â” Z   " #   & '
( ) $ % * + B C ,  F Â± p$ % . / $ 7 $
9 Â² Â³ Â´ s (f1) oÂµ Â¶ Â· Â¸ 5 2f183f184f18
5f1 ^ oÂ¹Â´ s Â¢ 1Âº $ 7 Â“$ 9 Â»p$ %   ,
$ % 0 123> Â¼ Â½ Â° Â¾ Â¿ ? @ $ % . / B C 2
3O Ã€> opÃ / Ã‚ Ãƒ O Ã€23S 	 Ã„ Ã… 1J O
Ã€23!1J O Ã€23Ã† > S oÃ‡ Â‚q r 	 s r Âƒ
h,s r Ãˆ Ã‰ lÃŠ Ã‹ ÂÃŒ Ã Ã Ã ÃÃ‘ DFT(Discrete 
Fourier Transform)[3]Â“FFT(Fast Fourier Transform)[4]Â
Ã’Â…s Ã“ Ã” 3Ã• , 
-k > lÃŠ Ã‹ Ã’Â…Ã–ÃŒ Ã Ã Ã Â­ z s r oÃ— H Ã˜
Ã™ Â‹ Â¡  Â‚$ % . /   32oÃ— Ãš ,Ã /   F
Â± R Ã› Ãœ Ã H k Ã F ÃŒ Ã s < Ãš 	 Â´ s ÃŸ Â¢ 1Âº Â´
s J Ã    Ã¡ $ % . / Ã¢ # Ã£ Ã¤ H Ã¥ q ÃDFT}
~Âs Ã“ Ã¦ Q R R Â‚Â´ s 	 Â¢ 1Âº Â´ s J Ã  " # D
Ã§ s < Ã¨ 5 Ã© Ãª s Ã“ 3Ã’" # ,
  DSP Ã« Ã¬ Ã­ Ã” Ã® Ã¯ y z   { j| }~
Ã°FFT)fÂ  q r 	 s r Ã–Ã± }~FFT > S Ã² Ã³DFT
g h3S i   g h G [4],aÃ´Ãµ  ADI(Analog 
Device)Ã¶Ã· Ã " ADSP 21065L EZ-KitDDSP chipp
SHARC 21065L DSPfW H $ % 0 1q r 	 s r 2
3!s r 23Ã¸ Ã¹ Ã‰ g  Â‚ Ãº oÃ— u v ,
2.    	   	   	   	 
      
    aÃ´Ã» k Â† Ã¼ $ % 0 1Âƒ hÂ² Â³   u oÂµ D
  
 
Ã• 3s rÂƒ h 9  Ã• 
 
 
3. 	                       
Âƒ h $% * + 0 1Â® $ Ã‰xl % & $7 8$9
' 7 8' 9 ( ÂÂ­ z Ã‚ Ãƒ -1J} ~ Â¤ ) * l1JÃ
Ã + Ã‘ ADSP-21065L EZ-Kit , u  - . / 1 Ã 0 1
DSP  Ã Ã M N , Ã‚ Ãƒ -1J1J } ~ Â˜Ã‰ Ãµ 
AD1819ADp 16J2ÃŠ Ã‹ < p 48KHzT 	 % &
3 4 p 2.83Vp-pÃ‚ Ãƒ -1J} ~ Â˜[7]5DSPu v Ã‰
Ãµ  SHARC 21065L DSPSHARC 21065LÃ‰Ã¼ 32J
28Â« Â– s < p 60MHz 6 `11JK LM N Â˜4
Ã• 4Ã’  [7],Â¹ Âµ pÂ³ 7 8 Ã’ 9 ÃŠ $9 K L : ;  Âƒ h
Ã–  Ã¯ < = Ã Ã > ?   Ã Ã 9 ÃŠ Q ; Â¢    Ã¢
#DSP Ã« Ã¬ , u @ A B C D 5 4 Ã¼ x & xÃ Ã Ã E
F G H  (FIFO data buffers):Buffer_I1 Buffer_I2
Buffer_V1 Buffer_V2Ã¡ DSP Âƒ h Buffer_I1$9 
I qADCÃ Ã % Ã w J F k Buffer_I2K Ã– L I 
4Â¹ Ã¯ > 7 8 Ã’ 9 ÃŠ $9 K LÂ‚ : ;  Âƒ h Ã– Ã¯ <
= Ã Ã > ? , 
 
   Ã• 4$% * + 0 12 3 M Âš N O 
 
4.            
4.1                           
$7 )(tv 8$9 )(ti p 60Hz K LÂ P  ÃŠ Ã‹
800`4Ã• 5(a)	(b)Ã’  DQ Ã€ 4  
)sin(54.155)( ttv Ï‰=  (10) 
 )3/(3sin2)3/sin(10)( piÏ‰piÏ‰ âˆ’+âˆ’= ttti 
 )3/(7sin7.0)3/(5sin2.1 piÏ‰piÏ‰ âˆ’+âˆ’+ tt (11) 
  
 
DFT/FFT 
Re V(k), Im V(k)5Re I(k), Im I(k) 
  	   
   
V(k)  I(k) 
Â„ =     Âˆ 
1
2/
2
2
(%)
I
I
THD
N
k
k
I
âˆ‘
=
=
  
1
2/
2
2
(%)
V
V
THD
N
k
k
V
âˆ‘
=
=
 
V(n) I(n)  
Ã• 5 (a) $7 M R    
  
      
       
      
 
 
          
ADSP- Voltech
EZ-Kit PM100
Vrms 102.28 103.15 0.84
Irms 1.667 1.66 0.42
Real Power
P (watt)
Reactive
Power
Q(var)
11.379 12.93 12
Apparent
Power
S(va)
Power Factor 0.9977 0.999 0.13
Total Current
Harmonic
Distortion
Frequency(I) 59 59.96 1.6
0.0455 0.0475 4.2
170.577 170.69 0.062
Measured
Parameters
170.197 170.2 0.002
Error(%)
 
ADSP- Voltech
EZ-Kit PM100
Vrms 100.173 100.55 0.375
Irms 6.0587 6.038 0.343
Reactive
Power
Q(var)
8.78 8.94 1.8
Power Factor 0.99 1 1
Frequency(I) 60 59.98 0.033
0.043 0.0445 3.4
607 606.5 0.082
Measured
Parameters
606.9 606.6 0.05
Error(%)
Real Power
P(watt)
Apparent
Power
S(va)
Total Current
Harmonic
Distortion
 
4.3  	 
  	 
  	 
  	 
        
" 9 Â Â 3 2  c Ã•4Ã• 8Ã’  j  Â  2 Â˜f
9 ÃŠ $7 8$9 K L Âª DSP  gh fÃŠ Â… $% 0 1
Ã¦ ÃŸ$% * + oÃ— Â— (Voltec PM100)  Ãƒ X , 
 

D N U 4Ã• 9(a)8(b)oÃ‡ p AD1819A Ã’1J^Â"
9 Â Â $ 7 8$9    ÃŠ Ã‹ < p 48KHz g} k
600rpmÃ• 9(c)p9 Â Â $9   ÃÃ‘ FFTÂs Ã“ Ã•, 
 
Ã• 7 (a) _  $7    
Ã• 7 (b) _  $9    
Ã• 7 (c) _  $9 s Ã“  
Ã• 9 (a) " 9 Â Â $7    
Ã• 8 " 9 Â Â 3 2  c Ã• 
Q 2 _  qÃ–3 2 N U  
Q 3 
  qÃ–3 2 N U  
  
7.  
	

            
   
!"  # $ % & ' ( ) * + 
!
, - . / 0 1 !2 3  DSP 4 5 *
+ 
    6  7 * + 
  8 9 :
;<= > ? @ A B C < 
D E F G D H I J K L DSP M N O !6 
5 P Q R S T !U V W D E X Y Z 	 DSP
[ \ ] ^ _ ` 
a b !c I 
d e 

  f ' < 
g ] ^ h i !j Z k M N O l m n
o p q !r 4 5 s t u v !w x y 2 z !{ |
2 z } ~  Â€  < 
 
  
 
n   Â‡ k Â› Â³    
	6 Â› 
   
 Â¨  Â» Â¢ Â£    Ã‰   Â„ G      E !6      <UÃ¯ ,  Â†    ÂŸ
    !   " # Ã® $ D H  % Â <Â¶ 4 Ã¦ n & Â '  ( ) * Ã· + , - 6 Â 
'! . / 0 m & 1 2 Â° 3 Â› 4 Ã’ !Â ' Ãµ Â² 5 Ã° Ã· 6 7 ! 8 9 ': Â¶ 4 ;  <  =  +
 * Y  l Ã° Ã· <Â¢ Â£  > ? @ Â” ! A y Â„ > ! B Â‡  C <Ã¢ Â¨ 0 D M 0  I E F ÂŠ
G E H W I - Â„ G <Ã† Â› Â Â Ã‰ W Â¼ Â½ Â¾ Â¿Â¡ J K Ãˆ ! L M Ã‰ Â¢ Â£ Â¿! N Ã¬ 8 O <
P + Â© Â† 7 Ã† Â› Q R !Ã¯ Â‡ S 9 | 	F G T U Â† V ÃŠ Ã” ÂŒ W Âœ Â§ 9 J ! X Y Z 8 [ Â† Ã•
V  \ ] \ ^ Â \ ] Â„ _ ` !m Q a b |  c Â§ B !I Z l Z 6 Â† 7 ÂŒ W Âœ Â§ Ã , <
 ÂŒ Ã— Ã˜ Ã™ ] ^ W * Ãš Ã› Â„ Ã´  d e ! f U  Ã Ã“ Ãº Ã® l Ã½ Â¨ g X h Ã™  S i Ã— Ã˜
Ã™ ] ^ W * Ãš Ã› | Z j Y Ã— Â˜ k Ãœ!UÃ‰ Ã® $ Â† Ã• k l m Z Ã­ n o [ Ã² s !Ã¡ Ã’
[ c Z Ã­ !l ] p ^ q I J r " Z Ã­ Ã£ s  t Z Ã¬ T < 
  Ã† Â› u V  v ~  Â£ w 6 G  x y * z { !Â£ w Ã‰ Â¢ Â£  Â¨ y * z { | Ã‰
} ~  Â¨ y !B  Â¢ Â£ { , x y * z { Â€ ] * ! x Â : Â‚ Âƒ !Â© Â„  Â… 6 m o !#
 'Â† Â‡ Âˆ <Â…
Â…
Â‰ ÂŠ Â‹ ÂŒ Â  
Ã† Â› Â¥ Â¦ Â Â„ Â Â Â‘ Â£ w (HK Electric)* z { p Â’ G * z { p Â’ < 
 
  
DSP-based Power Quality Analysis Using Discrete Wavelet Transform
 
 
  
 
 
Abstract 
Wavelet transform is one of the most frequently used 
algorithms to analyze the power voltage signal. This paper 
presents a design of discrete wavelet transform suitable 
for DSP-based implementation. This approach has the 
advantages of low cost, real-time calculation, and possible 
hand-held device implementation. In addition, the 
experimental results demonstrate accurate disturbance 
time localization and clear decomposition of power 
disturbance signals. 
 
Keywords 
Discrete wavelet transform, power quality, DSP 
 
1. Introduction 
 
In general, power disturbances can be categorized as 
stationary or non-stationary signals according to their 
periodicity. The stationary signals, e.g. harmonics and 
voltage flicker, are typically analyzed by Fourier 
transform or FFT algorithm. Practical measurements using 
FFT algorithm assume infinite periodicity of the signal to 
be transformed. Furthermore, the time-domain information 
in the signal would be spread out on the whole frequency 
axis and become unobservable following the 
transformation. Therefore, this manner alone is not 
suitable for analyzing non-stationary signals [1]. A 
modification to the Fourier transform, called short-time 
Fourier transform (STFT), uses a time-frequency window 
to localize transients. If the STFT uses a wide time 
window, then the transient frequencies can be well 
distinguished by the high resolution of the spectrum 
domain while the transient locations are not resolvable. As 
the time window gets smaller, the transient locations 
become clear while the frequency resolution progressively 
worsens. Therefore, to localize the transient precisely, we 
must compute the STFT every time we change the 
window size, leading to a serious issue of computation 
load [2].  
 
Wavelet transform has advantages over FFT and STFT for 
the analysis of signals with transients. Wavelet transform 
is based on the decomposition of signals according to a set 
of adaptable scaled and shifted wavelets. This manner of 
analysis is generally termed â€˜multiresolution analysisâ€™. 
The wavelet transform expands signals not in terms of sine 
or cosine functions but by wavelets, generated using the 
translation and dilation of a mother wavelet [3,4]. 
 
Over the last years numerous approaches to power quality 
automatic detection and classification have been suggested 
[5-9]. However, due to the difficulty in realizing the 
wavelet transform on a microchip with low-level coding 
language, most of the studies regarding the wavelet 
transform are implemented on a PC-based hardware 
structure with commercial application software, such as 
MATLAB. Fortunately, Huang et al. [10] successfully 
accomplished the FPGA realization of wavelet transform 
for power disturbance detection. Furthermore, Sarkar and 
Sengupta [11] employed a digital signal processor (DSP) 
to implement wavelet transform for power factor 
measurement.  
 
This paper provides a design of discrete wavelet transform 
(DWT) applied to analyzing power quality events. 
Moreover, in order to enhance the potential 
implementation of a hand-held device for this work, the 
DWT is implemented with Texas Instruments (TI) 32-bit 
TMS320C6711 DSP along with the TLC320AD535 16-bit 
analog to digital converter. The experimental results show 
that the DSP-based implementation of the DWT can 
accurately detect power transients. 
 
2. Wavelet Theory 
 
A main feature of wavelets is the oscillating and rapid 
decay to zero. Generally, smooth wavelets indicate higher 
frequency resolution than wavelets with sharp steps such 
as the Haar wavelet; the opposite applies to time 
resolution. Another important consideration is the fast 
computation of the dilated daughter wavelets. From this 
point of view, the orthogonal wavelets calculated 
recursively have more efficient computation than 
non-orthogonal wavelets. One of the most widely used 
mother wavelets suitable for power quality analysis is the 
Daubechies wavelet. This wavelet is particularly suitable 
for detecting low amplitude, short duration, fast decaying 
and oscillating type of signals, encountered frequently in 
power systems [12,13]. 
 
Multiresolution analysis is the most important concept for 
constructing scaling functions and wavelets. A signal, in 
the Multiresolution analysis, is viewed at various levels of 
resolutions [14,15]. By the multiresolution analysis, this 
signal is first divided into slowly varying and rapidly 
varying segments through the discretization of the signal 
using a step size of two. Then, the slowly varying segment 
is discretized again to form next-level segments. After 
performing several discretizations, the signal can be 
decomposed into a series of detail segments and one 
approximation segment. These discretizations are also 
Chau-Shing Wang  
 Department of Electrical Engineering 
National Changhua University of Education, 
 Changhua, Taiwan 
cswang@cc.ncue.edu.tw 
Xi-Long Yang  
 Department of Electrical Engineering 
National Changhua University of Education, 
Changhua, Taiwan 
silung.tw@yahoo.com.tw 
3 Â® 2007 ICEE Â„ Ã† Â› Â¥ Â¦  
 5.2. Hardware Structure  
 
The power voltage signal prior to the analog-to-digital 
conversion (ADC) must be lowered to an acceptable level 
for ADC by a potential transform (PT), and the current is 
also converted to an appropriate voltage signal by a 
current transform (CT). In order to produce the 
controllable power disturbances, an arbitrary function 
generator is utilized in this study to directly generate the 
power disturbances, such as voltage sag, swell, and 
interrupt. A number of real power disturbance waveforms 
captured from a power plant are coded on a PC and then 
sent to the arbitrary function generator through a GPIB 
interface to output the simulated power quality events. The 
experimental setup is shown in figure 2. 
 
5.2. Software Structure  
 
The algorithm presented as a flow chart for the power 
disturbance analysis using DWT is shown in figure 3. The 
power signal is first converted to a digital format and then 
put through the power quality event detection. The 
detection is conducted by comparing the sampled signal 
v(k) with a perfect sinusoidal waveform d(k) point by 
point. If the difference between both exceeds a threshold 
value eT, the alarm of power quality events is triggered. 
Then, the system starts the analysis of DWT on this 
captured power quality event.  
 
Since this system is implemented on a DSP board and the 
memory space is limited, the DWT analysis is launched 
only at the occurrence of power disturbances. Such 
implementation could reduce the total required 
computation and realize real-time analysis. The purpose of 
DWT initialization is to configure the levels to be 
decomposed and the order of Daubechies wavelet. The 
DWT would decompose the power disturbance signal 
based on these configurations. The whole algorithm shown 
in figure 3 is coded in C language associating some 
assembly-language subroutines.  
 
6. Experimental Results 
 
6.1. Determination of Occurrence Time for Power 
Disturbances 
 
Wavelet transform provides an excellent time-localization 
feature when a transient or high-frequency disturbance 
occurs in a normal signal. In order to calculate the 
occurrence time of disturbance, the system searches for 
the impulses in the decomposed level cD1, cD2, and cD3, 
in which the impulses location means the point that the 
disturbance appears. The DSP stores the clock time every 
1024 sample points, denoted as Tn. If the disturbance 
occurs in the kth point at the level of cDi (i=1,2,3â€¦), then 
the occurrence time can be calculated by  
8000
12)1( +âˆ’
+=
i
nd
kTT           (7) 
where 8000 is the sampling rate (Hz). For example, figure 
4 illustrates a power interrupt signal and its DWT results 
in the cD1 level. The impulse in the cD1 level appears at 
the 369th point, and Tn is stored as 9.088 seconds which is 
counted from the time at which the system turned on. 
Therefore, the occurrence time is determined as 9.088+ 
((369-1)Ã—21+1)/8000 = 9.180 seconds.  
 
 
6.2.  Decomposition Results of Power Disturbances 
 
A number of power disturbances have been analyzed by 
the DWT implemented in the DSP board, such as perfect 
sine waveform, power sag, swell, interrupt, and oscillation 
transient. All of these experimental results show that the 
proposed DWT implementation is able to decompose 
these disturbance waveforms into several frequency bands. 
The disturbance occurrence time can be immediately 
localized in the corresponding bands. 
 
One of the tested waveforms is presented here for 
Fig. 2. The hardware structure of experimental 
setup  
Parallel port 
 
GPIB  
 
Oscilloscope 
 
Function Generator 
 
DSP board 
 
Fig. 3 The flow chart of the software structure 
Power signal 
A to D 
v(t) â†’ v(k) 
|v(k)-d(k)|>eT 
? No 
k=k+1 
Yes 
Alarms: 
Power quality 
events detected 
Remove the 
captured event data 
to buffers for DWT 
DWT initialization 
1. DWT levels: L 
2. Order of Daub.: n 
Load filter 
coefficients 
LP HP 
â†“2 â†“2 
cD1 
cD2 
cD3 
L= 1 ? 
No 
cAL 
Yes 
DWT analysis Events detection 
L=L-1 
(a) 
p.u.. 
(b) 
Fig. 4. (a) The interrupt signal and (b) its first level 
of decomposition result cD1 
Time (s) 
  
	
 
                                                             
 95-2221-E-018-029- 
    	 
       
       
        
    ! " #   (  $ % 	 & ' ( )  
  * + ) , ) 
- . / 0 1 2  20073 74 8-12567 8 Hotel Nikko 
- .    The International Conference on Electrical Engineering 2007 (ICEE 2007) 
9 : ; < = >  DSP-based Power Quality Analysis Using Discrete Wavelet Transform 
 
?@A B - . C D  
E  F 7 4 8 5G 0 H I 7 8 6   J K L  M N O P Q R 30 S T U V I W X Y
Z6[ K L \ ] ^ _ `  a-  b c dICEE2007  a- e f The Hong Kong Institution of 
Engineers g h 6. = i :Intellignet, Clean, Efficient, Electricity for the 21st Century with focus 
on Sustainability and Reliabilitjd- . F 95k l 6m = n o f The Hong Kong University of 
Science and Technology p Paul Chu " # q r 6g = i â€High Temperature Superconductivity 
and Sustainable Economic Development of Chinaâ€ 6g s t u i v w x y z F 
  { |  }
~6f F  Â€ 
 Â pÂ‚ Âƒ 6Â„ Â… Â† Â‡ { Âˆ 
  O { |  
  Â‰ ÂŠ 6t u Â‹  ( ÂŒ 1 Â Â 3
Â 
  { | Â‰ ÂŠ R Â 500-600 Â‘ Â’ Â“ 6Â” Â• Â– Â— Â… v w x 
  O { | Â˜ Â„ Â™ Âš Â„ Â› pÂ— Âœ d
Â Â  p; < 9 : ÂŸ Â  Â Â¡ Â¢Â£ Â¤ Â¥ P1 session6= > i â€DSP-based Power Quality Analysis 
Using Discrete Wavelet Transformâ€  DSP  	 
               
      ! " # $ % & ' () * ( + * , - . / 0 1 2 3 4 5 6 *  Jean Kowal 7
8 3 9 :; 2 # Electric Power Supply-The Engineering Challenges#   < = > $ ? @ A  B
C:D E   F G  H I (J K L M 20%Â Â¦ i   N O 1 Â @Â§ Â¨ Â© 	 } y 6t u Âª  Â« Â¬
Â­ Â® 6Â¯  Â° - ) Â± Â‹ Â² a; dÂ³  F 74 105G 0 K  Â´ q 7 8 d 
  
\@ ] .  
f F ^ _ ` G Ã¤ Ã· R % Ãœ a Â¢ b c d e 6 f A B  a- ) Â± Ã” Â g h p a i j 6k
l p2 Â» m n 6 o p p( q 6 r V p- M   Â° Ãµ s 6Ã¼  Â Ã— S t u pÂ¿ Ã€ 6Â„ E Â³ 
Â” Â• g h G   a-  A v d w Â›  t x h   a- p y Â Ã† Â¯ 3 ) Ã™ p1  d
 z Â³ Â¾  a- 6Â° Â¯  Â• { 5Â³ Â° |  p) Â± a; / 6[ Â¾ x  } Ã < } e Â Ã˜ Â°
  \ Ã¢ p ~ s * * 6  Â€ Â³  Â¸ Â’ Â 36 Â‚ Â³ Ã < Âƒ Â„ Â—  Â… Â„ 6 ( s Â… Ã < Â† Â‡  
a. = Âˆ e Â G Ã¤ Â‰  p6  Ã† Â” Â• Â¯ A ÂŠ    a- Â„ Â… Â‹ ÂŒ { Â p Â  6  ] $ { Â
p  ) Â  Â 6Ã e Â 	 { Â p Â‘ Ã† d


 termed the decomposition of a signal. To understand 
multiresolution analysis deeply, two-scale relations must 
be introduced, which relate the scaling function (t) and 
the wavelet function Ïˆ(t) at a given scale with the scaling 
function at the next-higher scale. In other words, (t) and 
Ïˆ(t) can be expressed in terms of a series of 
time-shifted(2t). The two-scale relations can be written 
as  
 
âˆ‘ âˆ’=
k
R ktkLt )2()()( Ï†Ï†      (1) 
âˆ‘ âˆ’=
k
R ktkHt )2()()( Ï†Ïˆ     (2) 
where LR(k) and HR(k) are two sequences, which are the 
coefficients of lowpass and highpass filters for 
reconstructing the decomposed signal respectively. If we 
reverse the order of the sequence LR(k), and then multiply 
every even element by -1, we obtain the high pass filter 
coefficients, i.e. HR(k), for reconstruction. Furthermore, 
the low pass and high pass filter coefficients for 
decomposition, i.e. LD(k) and HD(k), could be determined 
by reversing the order of the sequences of LR(k) and HR(k) 
respectively. 
 
3. Design of the DWT Filter Banks 
 
The DWT can be realized using a multi-stage filter with 
the mother wavelet function as the low pass filter LD(k) 
and the scaling function as the high pass filter HD(k). The 
high pass and low pass filters are not independent of each 
other, but are related by  
)()1()1( kLkKH DkD âˆ’=âˆ’âˆ’     (3) 
where K is the filter length or the number of filter 
coefficients. Filters satisfying this condition are commonly 
applied to signal processing and termed â€œquadrature 
mirror filtersâ€[12]. 
 
The output of the high pass filter gives the detailed version 
of the high-frequency component of the signal. In contrast, 
the low pass filter provides the approximate version of the 
low-frequency component, which is then further split to go 
through other high pass and low pass filters to obtain the 
next level of the detail and approximation versions. By 
conducting this process, the DWT can be implemented.  
 
If the original signal is sampled at fs Hz, then the highest 
frequency that the sampled signal could faithfully 
represent is fs/2 Hz. Therefore, the first detail version 
would cover the band of frequencies between fs/2 and fs/4 
Hz. Thus, the first approximation version would include 
the rest of bandwidth [0, fs/4] Hz. In the next level, the 
second detail would capture the band of frequencies 
between fs/4 and fs/8 Hz, and the third detail would cover 
the band of frequencies between fs/8 and fs/16 Hz as  
 
shown in figure 1. Namely, the bandwidth of the detail 
version in the ith-level can be expressed as [fs/(2i+1), fs/(2i)]. 
In the experiment, fs is set at 8000Hz, thus decomposing it 
three-times would divide the band into[0, 500, 1000, 2000, 
4000] Hz. The maximum level that an N-point signal can 
be decomposed relies on the number of signal points and 
the order of Daubechies wavelets used for DWT. This 
relationship is expressed as 
 
mNL 2loglog 22max âˆ’=    (4) 
 
where m is the order of used Daubechies wavelets. Since 
the process of down-sampling by two follows the 
convolution in each decomposition level, log2N represents 
the times that an N-point signal can be decimated by two. 
However, the length of decimated signal must be longer 
than the length of filter coefficients to ensure a meaningful 
convolution. Therefore, the length of filter coefficients, i.e. 
2m, must be considered in this equation.  
 
4. Implementation of the Decomposition Algorithm 
 
In the first-level decomposition, the sequences LD(k) and 
HD(k) are utilized to convolve with the original signal v(k) 
to realize the low/high pass filtering process. The 
convolution result is then followed by decimation by a 
factor of two. The convolution and decimation can be 
combined and expressed mathematically as  
 
âˆ‘
âˆ‘
â‹…âˆ’=
â†“â‹…âˆ’=
â†“âˆ—=
k
D
k
D
D
nvnkL
nvnkL
kvkLkcA
)()2(
2})()({
2)}()({)(1
   (5) 
âˆ‘ â‹…âˆ’=
k
D nvnkHkcD )()2()(1   (6) 
where cA1(k)/cD1(k) are the approximation/detail 
coefficients of discrete wavelet transformation results of 
the 1st-level decomposition. Since the decimation would 
disregard every even point of the convolved sequence, the 
calculation of convolution is conducted by shifting the 
coefficients of filters with step size of two for each inner 
product such that the calculation load can be cut in half. 
Such a modification can remove the redundant calculation, 
thus saving time for other processes.  
 
5. Experimental Setup 
 
In this study, a high-performance, low-cost, and 
floating-point DSP chip TMS320C6711 mounted on the 
TMS320C6711 DSK board is utilized as the core of the 
hardware implementation. It features eight 32-bit 
instructions per cycle, 150 MHz clock rates, and 900 
MFLOPS, and is very suitable for realization of the 
instrument.  
 
v 
cD1 cA1 
cD2 cA2 
cD3 cA3 
0    fs/16  fs/8     fs/4  fs/2  
Fig. 1. Bandwidth division of the DWT 
Level 3 
Level 2 
Level 1 
