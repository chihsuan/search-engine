ä¸­æ–‡æ‘˜è¦ 
æœ¬è¨ˆç•«ä¹‹åŸ·ï¨ˆæˆæœå·²é”æˆä¸»è¦ä¹‹é æœŸç›®æ¨™ï¼Œå¾å¯¦å‹™æ‡‰ç”¨çš„è§’ï¨ï¼Œæå‡ºä¸€å€‹å®Œæ•´çš„
åŠ é€Ÿå…¬é–‹ï¤Šé‘°å¯†ç¢¼ç³»çµ±å°å†—é•·è¨Šæ¯åŠ è§£å¯†å®‰å…¨æ©Ÿåˆ¶ï¼Œä¸¦èƒ½æœ‰æ•ˆæŠµæ“‹é¸æ“‡å¯†æ–‡æ”»
æ“Šã€‚ä½¿ï§¤ï¥èˆ‡ç¾ï¨ˆç¤¾æœƒç’°å¢ƒèƒ½ï¤ç›¸ï¤‰åˆï¼Œæœ¬è¨ˆç•«è’é›†ä¸¦ï¦ºè§£ç›®å‰å­˜åœ¨çš„æ··åˆå¼å…¬
é–‹ï¤Šé‘°åŠ å¯†ç³»çµ±çš„æ¶æ§‹èˆ‡ï§Šç¨‹ç´°ç¯€ï¼Œæ”¹å–„é‡å°å†—é•·è¨Šæ¯ä¹‹åŠ è§£å¯†é€Ÿï¨ï¼Œç›¸è¼ƒæ–¼é
å»çš„åŠ è§£å¯†ç³»çµ±ï¼Œæœ‰æ•ˆçš„å¤§ï¥¾æå‡å…¶é€Ÿï¨ã€‚æ‰€è¨­è¨ˆå‡ºçš„åŠ è§£å¯†ç³»çµ±å…·å‚™çš„æ¢ä»¶åŒ…
æ‹¬æ¼”ç®—æ³•åŠå…¶åŸ·ï¨ˆç¨‹åºæ‰€éœ€çš„é‹ç®—ï¥¾åŠè¤‡é›œï¨éå¸¸ç°¡å–®ã€å¯†æ–‡çš„æ“´å……ï¥¡æ¥µå°‘ã€‚å¯¦
å‹™ä¸Šè©•ä¼°ï¨ï¥¾ç‚ºæ‰€èƒ½æ‰¿å—çš„å®‰å…¨å¨è„…ï¼Œå·²é”åˆ°æœ€é«˜çŸ¥å®‰å…¨ç­‰ç´šï¼é¸æ“‡å¯†æ–‡æ”»æ“Šã€‚ 
 
é—œéµå­—ï¼šå…¬é–‹ï¤Šé‘°åŠ å¯†ç³»çµ±ã€éå°ç¨±å‹ï¤Šé‘°åŠ å¯†ç³»çµ±ã€å°ç¨±å‹ï¤Šé‘°åŠ å¯†ç³»çµ±ã€æ··
åˆå¼å…¬é–‹ï¤Šé‘°åŠ å¯†ç³»çµ±ã€ç¾¤é«”å°å‘å¯†ç¢¼ç³»çµ±ã€å¯è­‰æ˜å®‰å…¨ã€éš¨æ©Ÿï¨™è«­ã€ï¥§å¯è¾¨ï§¼
-é©æ‡‰æ€§é¸æ“‡å¯†æ–‡æ”»æ“Š 
 
è‹±æ–‡æ‘˜è¦ 
Public-key encryption schemes limit the plaintext space to a particular group, which 
can be restrictive when one wants to encrypt arbitrary message. In this project, an 
efficient conversion from the IND-CPA secure ElGamal encryption scheme to a 
IND-CCA2 secure extension of the ElGamal encryption scheme in the random oracle 
model is presented. In the encryption algorithm of the converted scheme, no matter 
what the length of plaintext space is, only two random numbers are generated for each 
encryption. The result of the converted version of the ElGamal encryption scheme not 
only provides a higher security level but also is more efficient in terms of 
computational complexity and ciphertext expansion than those of the ElGamal 
encryption scheme when encrypting a lengthy plaintext space. An analysis of the 
modified encryption scheme is given to demonstrate its enhanced security. The 
proposed scheme can be also used in the HPKE: KEM/DEM frameworks, make them 
more efficient. 
 
Keywords: asymmetric-key encryption, adaptive chosen-ciphertext attack, 
authenticated encryption, group-oriented cryptographic, hybrid public-key encryption, 
indistinguishablitity, reduction proof, symmetric-key encryption, provably secure, 
public-key encryption, random oracle. 
I 
the security, this scheme is said to be provably secure in the standard model. If
there is, this scheme is provably secure in the random oracle model. Although
security in the random oracle model cannot guaranteed formally when a prac-
tical random-like function (such as SHA-2 [21]) replaces the random oracle, an
random oracle-based technique for security proof is a useful test-bed. They
often outperform the standard model schemes in terms of eï¬ƒciency.
Another special goal is plaintext-awareness (PA). A PKE scheme is PA if
for any ciphertext the adversary produces, she must know the corresponding
plaintext. The notation of PA was ï¬rst suggested by Bellare and Rogaway
[4], and then formalized by Bellare, Desai, Pointcheval and Rogaway [2]. The
diï¬€erence is that the later gives the adversary the ability to obtain ciphertexts
via eavesdropping on communications made to the receiver. Bellare, Desai,
Pointcheval and Rogaway [2] proves the following result.
Proposition 1. PAâˆ’â†’IND-CCA2 (NM-CCA2) in the random oracle model.
That is, if a PKE scheme is secure in the PA sense, then it is secure in
the IND-CCA2 (or NM-CCA2) sense in the random oracle model. However, PA
as per [4, 2] is designed for the random oracle model and they leave an open
question as to whether a PA exists in the standard model. After that, Herzog
et al. [16] solved the question via a key registration method. Later, Bellare
and Palacio [3] introduced a new version of PA and removed the need for the
key registration authority in the standard model. Recently, Dent [10] proved
the Cramer-Shoup PKE scheme [7] is secure in the PA sense in the standard
model.
1.2 Relative Works
The pair of models, GOAL-ATK, represent a very important security notation
that captures the security level of PKE schemes. Tsiouns and Yung [30] ï¬rst
showed that IND-CPA of the ElGamal encryption is actually equivalent to the
Decisional Diï¬ƒe-Hellman (DDH) problem. Until now, all proposed schemes [4,
7, 13, 14, 23, 24, 29, 30] strive toward the strongest security protocol IND-CCA2.
Fujisaki-Okamotoâ€™s conversion [13] of probabilistic trap-door one-way func-
tions deserves to be mentioned. They proposed a method to convert existing
probabilistic trap-door one-way functions such as ElGamal, Blum-Goldwasser
[5], and Okamoto-Uchiyama [22] schemes by requiring only one additional ran-
dom function operation. Via Proposition 1, they proved that the converted
schemes are secure in the IND-CCA2 sense in the random oracle model. In all
schemes which meet IND-CCA2, Fujisaki-Okamotoâ€™s scheme is more eï¬ƒcient
than others without considering the hybrid public-key encryption scheme (We
will introduce it below).
However, no matter whether the PKE schemes are deterministic or proba-
bilistic. The plaintext space should be smaller than its group. For example, in
the RSA encryption scheme, the public key e is the exponent of the plaintext
x and x is smaller than the modulus N = p Â· q where p and q are large primes
(x < N).
y = xe mod N
We can see that each encryption needs one modular exponentiation. There is
no way to reduce the computational complexity.
The ElGamal encryption scheme provides a means of dealing with a plain-
text x that is larger the modulus p. Of course, it should be divided into several
smaller xiâ€™s where each xi is less than p. Then each xi is fed into the encryption
algorithm one by one. For each xi, a random number must be generated as the
exponent of generator and the public key for each encryption. For x1, . . . , xn,
2
bit key size to meet the current demanded security level and provide lower
computational cost.
Hwang et al. [17] proposed an ElGamal-like PKE for encrypting a large
message without any one-time secure DEM. Though their scheme is designed
for encrypting a large message by directly applying ElGamal-like encryption,
we can combine the advantages of hybrid schemes with their scheme. That is,
their scheme is treated as a KEM to eï¬ƒciently encrypt a large SKE key K varies
depending on the length of unrestricted message x and a MAC key mk in the
Cramer-Shoup framework, or treated as a Tag-KEM to encrypt a SKE key K
together with the message x in the Abe-Gennaro-Kurosawa-Shoup framework.
No matter what K is generated by a PRBG or stretched by the block cipher
method, since K is large enough, the one-time secure SKE in the DEM can
encrypt the whole message x as Ï‡ â† x âŠ• K. In both frameworks, when the
receiver decrypts the ciphertext of K and then she can directly decrypt the
message x as x â† Ï‡âŠ•K without applying any PRBG or block cipher method.
Unfortunately, Hwang et al. didnâ€™t give a formal security proof of their scheme.
1.3 Our Results
The extended version of the ElGamal encryption scheme, referred to as ElGamal-
extended, presented here has the following advantages.
â€¢ It is only necessary to generate two random numbers. The total number
of modular exponentiations is 4/2 in the encryption/decryption, which
is not be increased by the number of xiâ€™s. Only some low computational
complexity operations such as random function operations and modular
multiplications are needed.
â€¢ The ciphtertext expansion is smaller when the plaintext is large enough.
â€¢ It is secure in the IND-CCA2 sense, which provides a higher security level
than that of IND-CPA achieved by the ElGamal encryption scheme.
Combining the above advantages, the ElGamal-extended encryption scheme
can be a CCA2-secure KEM in the HPKE: KEM/DEM frameworks [1, 8] which
applications will be presented in Section 6. Furthermore, it is trivial to con-
struct a elliptic curve version of ElGamal-extended encryption scheme. We
omit the construction in this paper.
To demonstrate that the ElGamal-extended scheme is secure using only two
random numbers, a new pair GOAL and ATK is constructed called IND-CPAPAIR.
The diï¬€erence from IND-CPA is that, we also provide the adversary with the
knowledge of a pair of plaintext-ciphertext from the encryption oracle. Intu-
itively, this pair does not provide any help for the adversary, since the adversary
has ability to generate any pair she wants by herself in the PKE scheme. This
is the reï¬nement presented here and its purpose is explained later.
1.4 Outline of the Paper
The remainder of our paper is organized as follows. In Section 2, we shall
give some basic deï¬nitions about encryption scheme security. In Section 3, we
shall give a brief review of the ElGmal encryption scheme. At the same time,
the ElGamal-extended encryption scheme is presented. In Section 4, we shall
ï¬rst prove the ElGamal-extended encryption scheme is secure in the IND-CCA2
sense via Proposition 1 when the plaintext is smaller than its group. Then the
reï¬nement of IND-CPAPAIR is explained and, at the same time, we prove the
the ElGamal-extended encryption scheme is secure in the IND-CPAPAIR sense,
4
Deï¬nition 5 (Random Oracle Model). Let Î© be the set of all maps from
the set {0, 1}âˆ— of finite strings to the set {0, 1}âˆ of infinite strings. H â† Î©
denotes as we chose map H from a set of an appropriate finite length {0, 1}a to
a set of an appropriate finite length of {0, 1}b, from Î© at random and uniformly,
restricting the domain to {0, 1}a and the range to the first b bits of output. By
the assumption made in the random oracle model, for fix x âˆˆ {0, 1}a and
y âˆˆ {0, 1}b, then Pr[H(x) = y] = 1
2b
. PKE = (Gen,EncH,DecH) denotes the
Enc and Dec in public-key scheme are allowed to access such identical map H,
and we call this encryption scheme is defined in the random oracle model.
Deï¬nition 6 (IND-ATK). Let A = (A1,A2) be a pair of probabilistic algo-
rithms for adversary, PKE = (Gen,Enc,Dec). For ATK={CPA, CCA1, CCA2}
and Îº âˆˆ N, denote the success event of A for PKE by
SuccINDâˆ’ATKA,PKE (Îº) = [(pk, sk)â† Gen(1Îº); (x0, x1, Ï‰)â† AO11 (pk); bâ†R {0, 1};
y â† Encpk(xb) : AO22 (x0, x1, Ï‰, y) = b],
where the first two components of a triple (x0, x1, Ï‰) are the plaintexts with the
same length |x0| = |x1|, and the last is state information (including the public
key pk) and some information to be preserved. Here, O1(Â·),O2(Â·) are defined
as follows:
- If ATK=CPA then O1(Â·)=null and O2(Â·)=null;
- If ATK=CCA1 then O1(Â·) = Decsk(Â·) and O2(Â·)=null;
- If ATK=CCA2 then O1(Â·) = Decsk(Â·) and O2(Â·) = Decsk(Â·).
In the case of CCA2, we insist that A2 does not ask its oracle to decrypt y.
The advantage of A for PKE is denoted as
AdvINDâˆ’ATKA,PKE (Îº) = 2 Â· Pr[SuccINDâˆ’ATKA,PKE (Îº)]âˆ’ 1.
We say that PKE is secure in the IND-ATK sense if for any adversary A being
polynomial-time in Îº, AdvINDâˆ’ATKA,PKE (Îº) is negligible in Îº.
Deï¬nition 7 (PA). Let PKE = (Gen,Enc,Dec) be a public-key encryption
scheme, let B be an adversary, let P be an polynomial-time plaintext extractor.
For any Îº âˆˆ N define
SuccPAP,B,PKE(Îº) = Pr[H â† Î©; (pk, sk) â† Gen(1Îº); (hH,C, y)â† run BH,Enc
H
pk(pk) :
P(hH,C, y, pk) = DecHsk(y)],
where hH = {(h1, H1), . . . , (hqH , HqH)}, C = {y1, . . . , yqE}, and y âˆˆ C.
(hH,C, y) â† run BH,EncHpk(pk) denotes run B on input pk, oracles H, and
EncHpk, recording Bâ€™s interaction with its oracles. hH denotes the set of all Bâ€™s
queries and the corresponding answers of H. C denotes the set of all answers
received as the result of EncHpk. Here, C does not include the the corresponding
queries from B. Finally, B outputs y.
We say that P is a (t, Î»(Îº))-plaintext extractor if SuccPAP,B,PKE(Îº) â‰¥ Î»(Îº)
and P runs within at most running time t.
We say that PKE is secure in the sense of PA if PKE is secure in the
sense of IND-CPA and there exists a (t, Î»(Îº))-plaintext extractor P where t is
polynomial in Îº and Î»(Îº) is overwhelming in Îº.
6
- Hash functions H and J :
H : {0, 1}Îº0+2Îº1 â†’ {0, 1}Î¹, J : {0, 1}Îº â†’ {0, 1}Îº.
- Encryption algorithm PKE.Enc:
A large plaintext x is divided into x1, x2, Â· Â· Â· , xn subtexts.
(yâ€²1, y
â€²
2, y
â€²
3,i) = Encpk(xi, r1, r2),
1. Concatenate Xi = xi||r1||r2, where xi âˆˆ {0, 1}Îº0, r1, r2 âˆˆR {0, 1}Îº1 âˆˆ
Zq, and || denotes concatenation.
2. Compute Ji = J(i Â· Y r2 mod p).
3. Compute (y1, y3,i) = Enc
â€ 
pk(Xi||H(Xi), r1) = (gr1 mod p, (Xi||H(Xi))Â·
Y r1 mod p).
4. Compute (yâ€²1, y
â€²
2, y
â€²
3,i) = (y1, g
r2 mod p, y3,i Â· Ji mod p).
- Decryption algorithm PKE.Dec:
xi = Decsk(y
â€²
1, y
â€²
2, y
â€²
3,i),
1. Compute Ji = J(i Â· yâ€²s2 mod p).
2. Compute Wi = Dec
â€ 
sk(y
â€²
1, y
â€²
3,i Â· Jâˆ’1i mod p).
3. Output {
[Wi]
Îº0, if H([Wi]
Îº0+2Îº1) = [Wi]Î¹
null, otherwise
The notations of [Wi]
a and [Wi]b denote the ï¬rst a-bit and the last
b-bit of Wi, respectively
Finally, the whole plaintext x can be concatenated as x1|| Â· Â· Â· ||xn.
To understand what the ElGamal-extended encryption scheme can achieve
consider the following. The ElGamal encryption scheme is long and involved
and there is an additional random value Ji for each xi. Even if there are
only two random numbers r1 and r2, the hash value Ji still makes the en-
cryption scheme probabilistic. If the adversary can obtain the hash value
J(i Â·Y r2 mod p), she is still faced with the of breaking the ElGamal encryption
scheme, i.e. Decsk(y
â€²
1, y
â€²
3,i Â· Jâˆ’1i mod p) = Wi. It already knows the ElGamal
encryption scheme is IND-CPA secure [30] under the DDH assumption, in which
the adversary cannot obtain any bit about the plaintext Wi = Xi||H(Xi).
Furthermore, to compute the hash value Ji = J(i Â· gsr2 mod p) with the
knowledge of the public key Y = gs mod p and the value yâ€²2 = g
r2 mod p
is equivalent to solve the CDH assumption in Deï¬nition 2, which is weaker
than the DDH assumption in the same group [27]. If the DDH assumption
is held in the group, then the CDH assumption must be held in that group.
Therefore, the security of the proposed scheme can be solely based on the DDH
assumption.
To reveal other plaintext xj â€™s, the adversary cannot compute Jj (âˆ€j = i)
under the assumption of hash function J(Â·), since the values of Ji and Jj are
nonlinearly related. To meet IND-CCA2, the plaintext xi is protected under
the hash function H(Â·) to ensure the data integrity and has a data integrity
validating step in the decryption algorithm. Without this validating step,
the adversary could trivially generate ciphertext for which the corresponding
plaintext is unknown. To do this, she just outputs the random strings. In the
next section, we give the analyses of the reduction for proving its securities.
8
Then, the ciphertexts (yâˆ—1, y
âˆ—
3) = PKE
â€ .Encâ€ pk(x
âˆ—, r) and (y1, y3) = Enc
â€ 
pk(xb, r)
computed by the encryption oracle Oen, where b âˆˆ {0, 1} is a random bit and
r âˆˆ Zq is a random string.
Encryption oracle: Oen(xâˆ—, x0, x1, pk)
r â†R Zq
(yâˆ—1, y
âˆ—
3) â† PKEâ€ .Encâ€ pk(xâˆ—, r)
b â†R {0, 1}
(y1, y3) â† PKEâ€ .Encâ€ pk(xb, r)
Return (xâˆ—  (yâˆ—1, yâˆ—3), (y1, y3))
End.
Finally, (x0, x1, Ï‰, x
âˆ—  (yâˆ—1, yâˆ—3), (y1, y3)) are inputted to A2. The aim ofA2 is to output the correct b.
Adversary: A2(x0, x1, Ï‰, xâˆ—  (yâˆ—1, yâˆ—3), (y1, y3))
Y r â† yâˆ—3 Â· (xâˆ—)âˆ’1 mod p
If y3 Â· (Y r)âˆ’1 mod p == x0
Return 0
Else
Return 1
End.
From the speciï¬cation ofA2, since yâˆ—3 = xâˆ— Â·Y r mod p and xâˆ—  (yâˆ—1, yâˆ—3), the
value of Y r is easily revealed by computing yâˆ—3 Â· (xâˆ—)âˆ’1 mod p. Then, since y3 =
xb Â·Y r mod p, A2 can determine if y3 Â· (Y r)âˆ’1 mod p is equal to x0. If it is then
outputs 0 otherwise output 1. Thus, A2 always correctly outputs b, that is,
Pr[SuccINDâˆ’CPAPAIRA,PKEâ€  (Îº)] = 1 and Adv
INDâˆ’CPAPAIR
A,PKEâ€  (Îº) = 2 Â· Pr[Succ
INDâˆ’CPAPAIR
A,PKEâ€  (Îº)]âˆ’
1 = 1.
The pair of plaintext-ciphertext xâˆ—  (yâˆ—1, yâˆ—3) is the â€œcryptanalysis train-
ingâ€ for the adversary. Here, the reason for giving the pair xâˆ—  (yâˆ—1, yâˆ—3) fromOen not generated by the adversary herself is that the adversary cannot gen-
erate the pair xâˆ—  (yâˆ—1, yâˆ—3) using the same random number r. The adversary
also can query its decryption oracle in the IND-CCA or IND-CCA2 sense to
obtain ciphertext-plaintext pairs. However, those queries still cannot capture
the value Y r that the encryption oracle uses to encrypt xb. Hence, the training
is provided by the encryption oracle rather than the decryption oracle.
Obviously, if the encryption oracle chooses a diï¬€erent r, this training does
not give any help to the adversary and the scheme is secure in the IND-CPAPAIR
sense. In the following theorem, we show only two random numbers r1, r2 in
the ElGamal-extended encryption scheme is secure in the IND-CPAPAIR sense.
Theorem 4 (PKE: IND-CPAPAIR). If there exists a (t, qH , qJ , )-breaker A =
(A1,A2) for PKE in the IND-CPAPAIR sense in the random oracle model and
the probability Pr[Â¬SuccPAIRA,PKE(Îº)] is non-negligible, then there exists a constant
c and a (tâ€², 0, 0, â€²)-breaker Aâ€² = (Aâ€²1,Aâ€²2) for PKEâ€  in the IND-CPA sense in
the standard model, where
tâ€² = t + qH Â· c + qJ Â· c and â€² = (âˆ’ qH
22Îº1âˆ’2
) Â· Pr[Â¬SuccPAIRA,PKE(Îº)]âˆ’ Pr[SuccPAIRA,PKE(Îº)].
Proof. The event SuccPAIRA,PKE(Îº) will be deï¬ned later. Basically, Aâ€²1 calls A1 as
a subroutine. The answers for H-query and J-query are the same as in Theo-
rem 2. WhenA1 halts and outputs (xâˆ—, x0, x1, Ï‰),Aâ€²1 outputs (x0||Î³0||Î²0, x1||Î³1||Î²1, Ï‰)
10
Adversary: Aâ€²2(x0||Î³0||Î²0, x1||Î³1||Î²1, Ï‰, (y1, y3))
r2 â†R Zq; Jâˆ— â†R {0, 1}Îº
yâˆ—1, y
â€²
1 â† y1; yâˆ—2, yâ€²2 â† gr2 mod p; yâ€²3 â† y3 Â· Jâˆ— mod p
Î± â†R {0, 1}Îº; yâˆ—3 â† Î±
Run A2(x0, x1, xâˆ—  (yâˆ—1, yâˆ—2, yâˆ—3), Ï‰, (yâ€²1, yâ€²2, yâ€²3))
Do while A2 does not make H-query h and J-query j
Askj â†false
If A2 makes J-query j
If j = 2 Â· Y r2 mod p
Answer Jâˆ— to A2
Put (j, Jâˆ—) on jJ
Askj â†true
Else if j âˆˆ jJ
J â†R {0, 1}Îº
Answer J to A2
Else j âˆˆ jJ
Answer J to A2 such that (j, J) âˆˆ jJ
Else if A2 makes H-query h
If Askj =true and h = xb||Î³b
Stop A2 and output b
Else if h âˆˆ hH
H â†R {0, 1}Î¹
Put (h,H) on hH
Answer H to A2
Else h âˆˆ hH
Answer H to A2 such that (h,H) âˆˆ hH
A2 outputs b
Return b
End.
From the speciï¬cation of Aâ€²2, it simulates the encryption oracle Oen to
generate a pair xâˆ—  (yâˆ—1, yâˆ—2, yâˆ—3) for the cryptanalysis training. If A2 detects
that pair is not valid, the simulation fails. Thus, Aâ€²2 cannot make full use of the
A2â€™s ability to get non-negligible advantage. Let SuccPAIRA,PKE be the event thatA2
detects that pair is not valid. We can rewrite the probability of SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº)
in the inequality (A.3) as the conditional probability of SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº) given
Â¬SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº).
Pr[SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº)|Â¬SuccPAIRA,PKE(Îº)] â‰¥
 + 1
2
âˆ’ qH
22Îº1âˆ’1
. (1)
By the law of total probability,
Pr[SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº)] = Pr[Succ
INDâˆ’CPA
Aâ€²,PKEâ€  (Îº)|SuccPAIRA,PKE(Îº)] Â· Pr[SuccPAIRA,PKE(Îº)] +
Pr[SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº)|Â¬SuccPAIRA,PKE(Îº)] Â· Pr[Â¬SuccPAIRA,PKE(Îº)].
From the speciï¬cation of Aâ€², we know that
Pr[SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº)|SuccPAIRA,PKE(Îº)] = 0 (2)
12
The following theorem shows that PAIR in the PKEâ€  is at least as hard as the
DDH problem.
Theorem 5 (PAIR of PKEâ€  at least as hard as the DDH). If there exists a
(t, )-breaker Aâ€² = (Aâ€²1,Aâ€²2) for PKEâ€  in the PAIR sense in the standard model,
then there exists constants c and a (tâ€², â€²)-breaker T solves the DDH problem
with overwhelming probability, where
â€² >  and tâ€² = t + c.
c denotes the time of a coin flipping and some over head.
Proof. We construct a translator T to solve an instance (g,X, Y, Z) of the
DDH problem in Deï¬nition 2 as follows.
Translator: T (g,X, Y, Z)
Run Aâ€²1(pk)
Aâ€²1 outputs xâˆ—
c0 â† xâˆ— Â· Z
c1 â†R {0, 1}Îº
b â†R {0, 1}
Output 1 if Aâ€²2(xâˆ—  (X, cb), Ï‰) =Yes
End.
Let p1 = Pr[T (g, gr, gs, grs) = 1] and p2 = Pr[T (g, gr, gs, gz) = 1]. By the
assumption of Aâ€², p1 â‰¥ 1
2
+

2
. If z â†R Zq, xâˆ— Â· gz and c1 are both uniformly
distributed over Zp, then we have p2 =
1
2
. Thus, T solves the DDH problem
with advantage
â€²
2
= |p1âˆ’ p2| > 
2
. From the speciï¬cation of T , it runs within
time t + c.
Diï¬€erent from IND-CPA, IND-CPAPAIR additionally provides a plaintext-
ciphertext for cryptanalysis training. One can well know that the following
proposition.
Proposition 2. IND-CPAPAIRâˆ’â†’IND-CPA.
That is, if a public-key encryption scheme is secure in the IND-CPAPAIR
sense, then it is secure in the IND-CPA in the standard model (or random
oracle model). Obviously, we can construct a plaintext extractor P to extract
a correct plaintext xi from any ciphertext using the same r1, r2 in Theorem 1.
By the Proposition 1 and Proposition 2, we can know that ElGamal-extended
scheme using r1 and r2 for a large plaintext space is secure in the IND-CCA2
sense in the random oracle model.
5 Performance Analysis
In this section, we shall compare the computational complexity and ciphertext
size of the ElGamal-extended encryption scheme with those of the ElGamal
encryption scheme and Fujisaki-Okamotoâ€™s conversion of the ElGamal encryp-
tion scheme [13]. We ï¬rst deï¬ne the following notations.
14
T
ab
le
1:
C
om
p
u
ta
ti
on
al
co
m
p
le
x
it
y,
ci
p
h
er
te
x
t
ex
p
an
si
on
am
on
g
th
re
e
en
cr
y
p
ti
on
sc
h
em
es
E
n
cr
y
p
ti
on
D
ec
ry
p
ti
on
C
ip
h
er
te
x
t
ex
p
an
si
on
G
O
A
L
-A
T
K
E
lG
am
al
sc
h
em
e
n
Â·(
2T
E
X
P
+
T
M
U
L
)
n
Â·(
T
E
X
P
+
T
M
U
L
+
T
IN
V
)
2
IN
D
-C
P
A
F
u
ji
sa
k
i-
O
ka
m
ot
o
sc
h
em
e
n
â€²â€²
Â·(
2T
E
X
P
+
T
M
U
L
+
T
J
)
n
â€²â€²
Â·(
T
E
X
P
+
T
M
U
L
+
T
IN
V
2
Â·(
1
+

Îº
1
Îº
0
+
Îº
1
+
Î¹
)
IN
D
-C
C
A
2
+
T
J
+
T
E
Q
U
)
E
lG
am
al
-e
x
te
n
d
ed
sc
h
em
e
2T
E
X
P
+
n
â€² Â·
(3
T
M
U
L
+
T
H
+
T
J
)
2T
E
X
P
+
n
â€² Â·
(3
T
M
U
L
+
T
H
2 n
+
1
+

Îº
1
Îº
0
+
Îº
1
+
Î¹
IN
D
-C
C
A
2
+
T
J
+
T
IN
V
+
T
E
Q
U
)
âˆ—
w
it
h
th
e
sa
m
e
si
ze
n
Â·Îº
of
a
p
la
in
te
x
t
x
,
n
â€² =
n
+
n
Â·(
2Îº
1
+
Î¹)
Îº
0
,
n
â€²â€²
=
n
+

n
Â·Îº
0
Îº
0
+
Îº
1
+
Î¹
.
16
be compressed by a collision-free hash function or K||x is divided into several
smaller blocks to conform the space restriction, and then each block is fed
into the encryption algorithm one by one. Our proposed PKE scheme gets the
advantages in this situation, not only G is removed in the HPKEAGKS.Dec but
also the PKE.Enc encrypts a lengthy K||x eï¬ƒciently.
7 Conclusions
In this paper, we have proposed an eï¬ƒcient ElGamal-extended encryption
scheme and showed it is secure in the IND-CCA2 sense in the random oracle
model. Not only does the proposed scheme provides higher secure level, but
also the computational complexities of encryption and decryption in the pro-
posed scheme are more eï¬ƒcient than those in the ElGamal encryption scheme
and Fujisaki-Okamotoâ€™s scheme when the plaintext is large enough. On the
other hand, the ElGamal-extended scheme can be used as a KEM for encrypt-
ing a large DEM key (or together with the message) in the HPKE: KEM/DEM
frameworks. Since a DEM key is large enough, the decryption of HPKE can
remove the use of a pseudo-random bit generator or a block cipher method
from a smaller DEM key.
References
[1] M. Abe, R. Gennaro, K. Kurosawa, and V. Shoup, â€œTag-KEM/DEM: A
new framewrok for hybrid encryption and a new analysis of Kurosawa-
Desmedt KEM,â€ in Advances in Cryptology, EUROCRYPTâ€™05, pp. 128â€“
146, Lecture Notes in Computer Science 3494, 2005.
[2] M. Bellare, A. Desai, D. Pointcheval, and P. Rogaway, â€œRelations among
notations of security for public-key encryption schemes,â€ in Advances in
Cryptology, CRYPTOâ€™98, pp. 26â€“45, Lecture Notes in Computer Science
1462, 1998.
[3] M. Bellare and A. Palacio, â€œTowards plaintext-aware public-key en-
cryption without random oracles,â€ in Advances in Cryptology, ASI-
ACRYPTâ€™04, pp. 48â€“62, Lecture Notes in Computer Science 3329, 1998.
[4] M. Bellare and P. Rogaway, â€œOptimal asymmetric encryption,â€ in Ad-
vances in Cryptology, EUROCRYPTâ€™94, pp. 92â€“111, Lecture Notes in
Computer Science 950, 1994.
[5] M. Blum and S. Goldwasser, â€œAn eï¬ƒcient probabilistic public-key encryp-
tion scheme which hides all partial information,â€ in Advances in Cryptol-
ogy, CRYPTOâ€™84, pp. 289â€“299, Lecture Notes in Computer Science 196,
1984.
[6] J. S. Coron, H. Handschuh, M. Joye, P. Pailier, D. Pointcheval, and C. Ty-
men, â€œOptimal chosen-ciphertext secure encryption of arbitrary-length
messages,â€ in PKC 2002, pp. 17â€“33, Lecture Notes in Computer Science
2274, 2002.
[7] R. Cramer and V. Shoup, â€œA practical public key cryptosystem provably
secure against adaptive chosen ciphertext attack,â€ in Advances in Cryp-
tology, CRYPTOâ€™98, pp. 13â€“25, Lecture Notes in Computer Science 1462,
1998.
18
[23] P. Paillier and David Pointcheval, â€œEï¬ƒcient public-key cryptosystems
provaly secure against active adversaries,â€ in Advances in Cryptology,
ASIACRYPTâ€™99, pp. 165â€“179, Lecture Notes in Computer Science 1716,
1999.
[24] D. Pointcheval, â€œNew public key cryptosystems based on the dependent-
RSA problems,â€ in Advances in Cryptology, EUROCRYPTâ€™99, pp. 239â€“
254, Lecture Notes in Computer Science 1592, 1999.
[25] C. Rackoï¬€ and D. Simon, â€œNon-interactive zero-knowledge proof of
knowledge and chosen ciphertext attack,â€ in Advances in Cryptology,
CRYPTOâ€™91, pp. 433â€“444, Lecture Notes in Computer Science 576, 1991.
[26] R. L. Rivest, A. Shamir, and L. Adleman, â€œA method for obtaining digital
signatures and public key cryptosystems,â€ Communications of the ACM,
vol. 21, pp. 120â€“126, Feb. 1978.
[27] V. Shoup, â€œLower bounds for discrete logarithms and related problems,â€
in Advances in Cryptology, EUROCRYPTâ€™97, pp. 256â€“266, Lecture Notes
in Computer Science 1233, 1997.
[28] V. Shoup, â€œISO 18033-2: An emerging standard for public-key encryption
(committee draft),â€ Abaiable at http://shoup.net/iso, June 3 2004.
[29] V. Shoup and R. Gennaro, â€œSecuring threhshold cryptosystem against
chosen ciphertext attack,â€ in Advances in Cryptology, EUROCRYPTâ€™98,
pp. 1â€“16, Lecture Notes in Computer Science 1403, 1998.
[30] Y. Tsiounis and M. Yung, â€œOn the security of ElGamal based encryption,â€
in PKCâ€™98, pp. 117â€“134, Lecture Notes in Computer Science, 1998.
20
Deï¬nition 5, the probability of such Ju is 2
âˆ’Îº. The conditional probability
Pr[Con1|Â¬Con2] is qJ Â· 2âˆ’Îº.
For Pr[Fail|Â¬Con1], Â¬Con1 is true and P outputs null. That is, it guesses
(yâ€²1, y
â€²
2, y
â€²
3) is a invalid ciphertext. Therefore, Fail is true implies B outputs the
valid ciphertext (yâ€²1, y
â€²
2, y
â€²
3). For a ï¬xed (y
â€²
1, y
â€²
2, y
â€²
3) and J = J(Y
[[hv]2Îº1 ]Îº1 mod
p), let Hs be the set of (h,Hv) such that (y
â€²
1, y
â€²
3Â·Jâˆ’1 mod p) = PKEâ€ .Encâ€ pk(h||Hv,
[[h]2Îº1 ]
Îº1). Then since (yâ€²1, y
â€²
2, y
â€²
3) âˆˆ C = {(yâ€²1, yâ€²2, yâ€²3)1, Â· Â· Â· , (yâ€²1, yâ€²2, yâ€²3)qE} and
hence PKEâ€ .Decâ€ sk((y
â€²
1, y
â€²
3 Â· Jâˆ’1 mod p)i) = h||H(h) for every (yâ€²1, yâ€²2, yâ€²3)i âˆˆ C.
For a ï¬xed (yâ€²1, y
â€²
2, y
â€²
3) and a ï¬xed h, since B doesnâ€™t ask query h to oracle H(Â·),
Pr[Fail|Â¬Con1] = Pr
Hâ†Î©
[H(h) âˆˆ Hs] = |Hs| Â· 2âˆ’Î¹,
where |Hs| denotes the number of pairs in Hs. Obviously, |Hs| is small.
We conclude that Pr[Fail] â‰¤ qJ Â·2âˆ’Îº+|Hs|Â·2âˆ’Î¹. Hence, Î»(Îº) = 1âˆ’Pr[Fail] =
1âˆ’ (qJ Â· 2âˆ’Îº + |Hs| Â· 2âˆ’Î¹).
A.2 Proof of Theorem 2
Proof. We construct a breaking algorithm Aâ€² = (Aâ€²1,Aâ€²2) in the IND-CPA and
standard model setting by using A = (A1,A2) as an oracle.
Firstly, Aâ€² initiates two lists hH and jJ , to empty. Basically, when A asks
query h and j, Aâ€² simulates two random oracles H(Â·) and J(Â·) as follows: If h
has not been asked in the list hH , Aâ€² provides a random string H of length Î¹-
bit, and adds an entry (h,H) to the list hH . Similarly, if j has not been asked
in the list jJ , Aâ€² provides a random string J of length Îº-bit, and adds an
entry (j, J) to the list jJ . When A1 halts and outputs (x0, x1, Ï‰), Aâ€²1 outputs
(x0||Î³0||Î²0, x1||Î³1||Î²1, Ï‰) where Î³0, Î³1 are (2Îº1)-bit random strings and Î²0, Î²1
are Î¹-bit random strings.
22
Adversary: Aâ€²2(x0||Î³0||Î²0, x1||Î³1||Î²1, Ï‰, (y1, y3))
r2 â†R Zq; Jâˆ— â†R {0, 1}Îº
yâ€²1 â† y1; yâ€²2 â† gr2 mod p; yâ€²3 â† y3 Â· Jâˆ— mod p
Run A2(x0, x1, Ï‰, (yâ€²1, yâ€²2, yâ€²3))
Do while A2 does not make H-query h and J-query j
Askj â†false
If A2 makes J-query j
If j = Y r2 mod p
Answer Jâˆ— to A2
Put (j, Jâˆ—) on jJ
Askj â†true
Else if j âˆˆ jJ
J â†R {0, 1}Îº
Answer J to A2
Else j âˆˆ jJ
Answer J to A2 such that (j, J) âˆˆ jJ
Else if A2 makes H-query h
If Askj =true and h = xb||Î³b
Stop A2 and output b
Else if h âˆˆ hH
H â†R {0, 1}Î¹
Put (h,H) on hH
Answer H to A2
Else h âˆˆ hH
Answer H to A2 such that (h,H) âˆˆ hH
A2 outputs b
Return b
End.
The argument behind the proof is as follows: When A2 asks the query
j = Y r2 mod p, Aâ€²2 answers Jâˆ— and Askj is set be true. Since the random
string r2 is chosen by Aâ€²2, it has the ability to check whether the query j is
equal to Y r2 mod p or not. Once Askj is true and A2 asks a query h = xb||Î³b, it
is almost equivalent to PKEâ€ .Decâ€ sk(y1, y3) = PKE
â€ .Decâ€ sk(y
â€²
1, y
â€²
3 Â· (Jâˆ—)âˆ’1 mod p),
since A2 has no clue to Î³bÂ¯ where bÂ¯ is the complement of bit b. The probability
to ask h = xbÂ¯||Î³bÂ¯ is 2âˆ’(2Îº1) which is negligible. Under the condition Askj=true,Aâ€²2 can expect that it will output a correct bit b if A2 asks either h = x0||Î³0
or h = x1||Î³1. If A2 asks neither of them, Aâ€²2 can expect that A2 cannot
distinguish (yâ€²1, y
â€²
2, y
â€²
3) from a correct ciphertext.
To analyze the success probability ofAâ€² = (Aâ€²1,Aâ€²2), we recall the deï¬nitions
of success probabilities of Aâ€² = (Aâ€²1,Aâ€²2) and A = (A1,A2) in Deï¬nition 6.
Consider the follows events to capture the success probabilities ofA = (A1,A2)
and Aâ€² = (Aâ€²1,Aâ€²2)
Askj: is true if a J-query j = Y r2 mod p was made by A2.
Askb: is true if a H-query h = xb||Î³b was made by A2.
AskbÂ¯: is true if a H-query h = xbÂ¯||Î³bÂ¯ was made by A2.
The probability of SuccINDâˆ’CPAAâ€²,PKEâ€  (Îº) can be obtained by considering the con-
24
A.3 Proof of Theorem 3
Proof. From the result of Theorem 3, it is found out that the encryption scheme
PKE is secure in the IND-CCA2. The proof is omitted since it is clear from the
following speciï¬cation of adversary Aâ€² combined with the proofs in Theorem 1
and Theorem 2.
Adversary: Aâ€²1(pk)
hH , jJâ†empty
Run ADec
â€ 
sk,H,J
1 (pk)
Do while A1 does not make H-query h, J-query j,
D-query (y1, y2, y3)
â€²
If A1 makes J-query j
If j âˆˆ jJ
J â†R {0, 1}Îº
Put (j, J) on jJ
Answer J to A1
Else j âˆˆ jJ
Answer J to A1 such that (j, J) âˆˆ jJ
Else if A1 makes H-query h
If h âˆˆ hH
H â†R {0, 1}Î¹
Put (h,H) on hH
Answer H to A1
Else h âˆˆ hH
Answer H to A1 such that (h,H) âˆˆ hH
Else if A1 makes D-query (y1, y2, y3)â€²
Run P(hH, jJ, C, (y1, y2, y3)â€², pk)
P outputs xâ€²
Answer xâ€² to A1
A1 outputs (x0, x1, Ï‰)
Î³0, Î³1 â†R {0, 1}2Îº1
Î²0, Î²1 â†R {0, 1}Î¹
Return (x0||Î³0||Î²0, x1||Î³1||Î²1, Ï‰)
End.
Encryption oracle: Oen(x0||Î³0||Î²0, x1||Î³1||Î²1, pk)
b â†R {0, 1}
(y1, y3)â† PKEâ€ .Encâ€ pk(xb||Î³b||Î²b, R)
Return (y1, y3)
End.
26
è¨ˆç•«æˆæœè‡ªè©• 
æœ¬è¨ˆç•«ä¹‹åŸ·ï¨ˆæˆæœå·²é”æˆä¸»è¦ä¹‹é æœŸç›®æ¨™ï¼Œå¾å¯¦å‹™æ‡‰ç”¨çš„è§’ï¨ï¼Œæå‡ºä¸€å€‹å®Œæ•´çš„
åŠ é€Ÿå…¬é–‹ï¤Šé‘°å¯†ç¢¼ç³»çµ±å°å†—é•·è¨Šæ¯åŠ è§£å¯†å®‰å…¨æ©Ÿåˆ¶ï¼Œä¸¦èƒ½æœ‰æ•ˆæŠµæ“‹é¸æ“‡å¯†æ–‡æ”»
æ“Šã€‚ä½¿ï§¤ï¥èˆ‡ç¾ï¨ˆç¤¾æœƒç’°å¢ƒèƒ½ï¤ç›¸ï¤‰åˆï¼Œæœ¬è¨ˆç•«è’é›†ä¸¦ï¦ºè§£ç›®å‰å­˜åœ¨çš„æ··åˆå¼å…¬
é–‹ï¤Šé‘°åŠ å¯†ç³»çµ±çš„æ¶æ§‹èˆ‡ï§Šç¨‹ç´°ç¯€ï¼Œæ”¹å–„é‡å°å†—é•·è¨Šæ¯ä¹‹åŠ è§£å¯†é€Ÿï¨ï¼Œç›¸è¼ƒæ–¼é
å»çš„åŠ è§£å¯†ç³»çµ±ï¼Œæœ‰æ•ˆçš„å¤§ï¥¾æå‡å…¶é€Ÿï¨ã€‚æ‰€è¨­è¨ˆå‡ºçš„åŠ è§£å¯†ç³»çµ±å…·å‚™çš„æ¢ä»¶åŒ…
æ‹¬æ¼”ç®—æ³•åŠå…¶åŸ·ï¨ˆç¨‹åºæ‰€éœ€çš„é‹ç®—ï¥¾åŠè¤‡é›œï¨éå¸¸ç°¡å–®ã€å¯†æ–‡çš„æ“´å……ï¥¡æ¥µå°‘ã€‚å¯¦
å‹™ä¸Šè©•ä¼°ï¨ï¥¾ç‚ºæ‰€èƒ½æ‰¿å—çš„å®‰å…¨å¨è„…ï¼Œå·²é”åˆ°æœ€é«˜çŸ¥å®‰å…¨ç­‰ç´šï¼é¸æ“‡å¯†æ–‡æ”»æ“Šã€‚ 
è‡ªè©•é …ç›® è‡ªè©•å…§å®¹ 
ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹ï¨ æœ¬ç ”ç©¶çš„å…§å®¹èˆ‡åŸè¨ˆç•«å®Œå…¨ç›¸ç¬¦ã€‚åœ¨åŸè¨ˆ
åŠƒä¸­æˆ‘å€‘é‡å°å‚³çµ±å…¬é–‹ï¤Šé‘°åŠ è§£å¯†é€Ÿï¨
ä¹‹æå‡ï¼Œå¸Œæœ›æå‡ºä¸€å€‹æ–°çš„å…¬é–‹ï¤Šé‘°åŠ å¯†
ç³»çµ±æ¼”ç®—æ³•ï¼Œå¯ä»¥é”æˆæœ¬è¨ˆåŠƒä¹‹ç›®çš„ã€‚è€Œ
æœ¬ç ”ç©¶æ‰€æå‡ºçš„ElGamal-Extendedï¼Œæ˜¯ä¸€
å€‹å¯ä»¥é©ç”¨æ–¼æ··åˆå¼åŠ è§£å¯†çš„æ©Ÿåˆ¶ã€‚é…åˆ
å°ç¨±å¼å¯†ç¢¼ç³»çµ±ï¼Œæœ‰æ•ˆçš„åŠ å¯†å†—é•·è¨Šæ¯ï¼Œ
å…¶å¯†æ–‡æ“´å……ï¥¡ä¹Ÿé”åˆ°å…¶æ°´æº–ã€‚å¦å¤–ï¼Œåœ¨ç³»
çµ±å®‰å…¨æ€§æ–¹é¢ï¼Œäº¦é”åˆ°æœ€é«˜å®‰å…¨ç­‰ç´šï¼ŒæŠµ
æ“‹é¸æ“‡å¯†æ–‡æ”»æ“Šã€‚ 
é”æˆé æœŸç›®æ¨™æƒ…æ³ æ”¹å–„é‡å°å†—é•·è¨Šæ¯ä¹‹åŠ è§£å¯†é€Ÿï¨åŠæ”¹å–„
å¯†æ–‡çš„æ“´å……ï¥¡ï¼Œå…¶çµæœå¦‚Table 1æ‰€ç¤ºã€‚ 
ç ”ç©¶æˆæœä¹‹å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹å€¼ æœ¬ç ”ç©¶æˆæœä¹‹å­¸è¡“åƒ¹å€¼åœ¨æ–¼å°åŠ è§£å¯†å®‰
å…¨ã€é‹ç®—è¤‡é›œï¨åŠå¯†æ–‡æ“´å……ï¥¡çš„ç ”ç©¶ä¸Šï¼Œ
ä½¿ç”¨é›œæ¹Šå‡½ï¥©ï¼Œç‰¹åˆ¥å°å†—é•·è¨Šæ¯çš„åŠ è§£
å¯†ï¼Œå¯å¤§ï¥¾ï¨‰ä½åŠ è§£å¯†è¨ˆç®—çš„æŒ‡ï¥©é‹ç®—ã€‚
è€Œå…¶æ‡‰ç”¨åƒ¹å€¼åœ¨æ–¼å†—é•·è³‡ï¦¾ï¼Œå¦‚å½±åƒã€èª
éŸ³ç­‰è³‡ï¦¾ï¼Œå› æ­¤éå¸¸é©åˆå¯¦éš›çš„æ‡‰ç”¨ï¼Œå¯
ä»¥å¤§ï¥¾ç”Ÿç”¢ï¼Œï¨‰ä½æˆæœ¬ã€‚ 
æ˜¯å¦é©åˆåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨æˆ–ç”³è«‹å°ˆï§ é©åˆåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨ã€‚ 
ä¸»è¦ç™¼ç¾æˆ–å…¶ä»–æœ‰é—œåƒ¹å€¼ç­‰ æœ¬ç ”ç©¶æœ€ä¸»è¦çš„ç™¼ç¾ä¹ƒæ˜¯é‡å°åœ¨å†—é•·è¨Š
æ¯ï¼ŒåŠ é€ŸåŠ è§£å¯†éç¨‹ï¼Œé”åˆ°æ©Ÿå¯†æ€§ã€è¨Šæ¯
å®Œæ•´æ€§ã€‚ç ”ç©¶éç¨‹ä¸­ç™¼ç¾ï¼ŒHwangç­‰äººåŠ
Zhaoç­‰äººæ‰€æçš„æ–¹æ³•å…·æœ‰å®‰å…¨ä¸Šçš„ç–‘
æ…®ï¼Œä¸¦å°‡çµæœæŠ•ç¨¿è‡³åœ‹éš›æœŸåˆŠåŠIJICICæ¥
æ”¶ã€‚å¦å¤–ï¼Œæœ¬è¨ˆåŠƒç™¼å±•ä¹‹ç³»çµ±ï¼Œå¯ç°¡å–®å»¶
ä¼¸è‡³å¯è½‰æ›å¤šé‡èªè­‰åŠ å¯†ç³»çµ±ï¼Œå…¶æˆæœå·²
åˆŠç™»åœ¨æœŸåˆŠInformation Sciencesã€‚ 
28 
Keywords:
reviewing the concepts of group-oriented encryption schemes and the merits of Wu
RSA
ipien
ature
Since themessagemust be recovered from the ciphertext, the hash function cannot be used for reducing the size of themes-
sage. If the message is large, the message should be divided into sequence message blocks, with each message individually
signed and encrypted as an authenticated ciphertext block. To efï¬ciently generate authenticated ciphertext blocks
containing a large message, Zheng [33] proposed another scheme called signcryption. It employs both asymmetric and
0020-0255/$ - see front matter  2008 Elsevier Inc. All rights reserved.
q This research was partially supported by the National Science Council, Taiwan, ROC, under contract no.: NSC96-2218-E-018-002.
* Fax: +886 4 7211290.
E-mail address: tychang@cc.ncue.edu.tw
Information Sciences 178 (2008) 3426â€“3434
Contents lists available at ScienceDirect
Information Sciencesdoi:10.1016/j.ins.2008.05.008of the associated message (unforgeability). Furthermore, in order to protect the conï¬dentiality of the message, Authenticated
Encryption (AE) schemes are proposed, which allow a message transmission to conï¬dential as well as authenticated. In these
schemes, a signer generates an authenticated ciphertext signature on the chosen message so that only a designed veriï¬er can
recover and verify the message from the signature. Fundamentally, the AE schemes should satisfy the secure requirements of
unforgeability, conï¬dentiality, and non-repudiation.
Nyberg and Rueppel [20] ï¬rst proposed a signature scheme with message recovery based on the Discrete Logarithm (DL)
problem. In their scheme, the original message does not need to be sent, and any veriï¬er can recover the message from the
signature. Combining the ElGamal encryption scheme with the signature scheme plus message recovery can satisfy the
requirements of AE schemes. Following this ï¬rst proposal, a number of AE schemes and explanations have been proposed
to further reduce the computation and communication costs [9,12,14,21,30,31].Authenticated Encryption
Cryptography
Difï¬eâ€“Hellman problem
Group-oriented encryption
Message recovery signature
Multi-signature
1. Introduction
Digital signature schemes such as
using a secret (private) key. Any rec
signerâ€™s public key. To be exact, signet al.â€™s scheme. This shows that not only can a multi-authenticated ciphertext signature
be generated by a signing group, but also the message can be recovered and veriï¬ed by
a verifying group with multiple veriï¬ers. The security of the proposed scheme is based
solely on the DDH problem, which provides higher security conï¬dence than using the
CDH problem in Wu et al.â€™s CMAE scheme.
 2008 Elsevier Inc. All rights reserved.
[23] and DSA [19] allow a signer to generate a signature on a chosen message by
t can be a veriï¬er to verify the signature together with the message by using the
schemes are used to ensure the authenticity, and prevent forgery of the signatureA Convertible Multi-Authenticated Encryption scheme
for group communicationsq
Ting-Yi Chang *
Department of Business Education, Graduate Institute of e-Learning, National Changhua University of Education, No. 1, Jin-De Road, Changhua City, Taiwan, ROC
a r t i c l e i n f o
Article history:
Received 29 November 2007
Received in revised form 16 April 2008
Accepted 7 May 2008
a b s t r a c t
Recently, Wu et al. proposed a Convertible Multi-Authenticated Encryption (CMAE) scheme,
which allows a signing group with multiple signers to generate a multi-authenticated
ciphertext signature on the chosen message so that only a designated veriï¬er can recover
and verify the message. In case of later dispute, the veriï¬er can convert the multi-authen-
ticated ciphertext signature into an ordinary one that can be veriï¬ed by anyone. In this
study, a CMAE scheme for group communications is proposed. This is presented by ï¬rst
journal homepage: www.elsevier .com/locate / ins
2.1. System Initialization Phase
The notation SG Â¼ fU ;U ; . . . ;U g is deï¬ned as the signing group of n signers and VG Â¼ fU ;U ; . . . ;U g is deï¬ned as
1 v1 v2 v4
f2 Â¼ U
cipher
Uv7 a
Ã°xvi2R
2.2. Si
Wi
struct
Step 1
Step 2
Step 3
Step 4
3428 T.-Y. Chang / Information Sciences 178 (2008) 3426â€“3434S Â¼
X
Usj2SG
sj modq Ã°5Ã
and chooses an integer d2RZq to compute
C1 Â¼ gd modp; Ã°6Ã
C2;k Â¼ R
Y
Uvi2fk
yvi
0
@
1
A
d
modp;
0
B@
1
CA; Ã°7Ã
where  denotes the bit-wise exclusive-or operation.
The multi-authenticated ciphertext signature of the message m for the instance fk is Ã°S;C1;C2;kÃ.
2.3. Message Recovery and Veriï¬cation Phase
After receiving Ã°S;C1;C2;kÃ, the Uviâ€™s2 fk can cooperate to recover the messagem and verify the signature. Each Uvi 2 fk per-
forms the following steps:
Step 1. Uvi computes
ti Â¼ Cxvi1 modp Ã°8Ãj sj
If Eq. (4) holds, proceed to Step 4; otherwise Usi requests Usj 2 SG n fUsig to resend sj.
. When all Ã°rj; sjÃâ€™s are collected and veriï¬ed, the clerk who can be any signer in SG, computesgsj9r
rj yR modp: Ã°4ÃR Â¼ m
Usj2SG
r
rj
j
@ A modp; Ã°2Ã
si Â¼ wiri Ã¾ xsiR modq Ã°3Ã
and then sends si to Usj 2 SG n fUsig.
. After receiving Ã°rj; sjÃ from Usj 2 SG n fUsig, Usi veriï¬esY0 1ri Â¼ g modp Ã°1Ã
and then broadcasts ri to Usj 2 SG n fUsig.
. After receiving rj from Usj 2 SG n fUsig, Usi computeswiv3Uv5, f3 Â¼ Uv7. The access structure can be represented as F Â¼ Uv1Uv2Uv4 Ã¾ Uv3Uv5 Ã¾ Uv7. The multi-authenticated
text signature can only be decrypted and veriï¬ed with the cooperation of either Uv1;Uv2 and Uv4, or Uv3 and Uv5, or
lone. The secret key and public key pairs of Usi 2 SG and Uvi 2 VG are Ã°xsi2RZq; ysi Â¼ gxsi modpÃ and
Zq; yvi Â¼ gxvi modpÃ, respectively.
gnature Encryption Phase
thout loss of generality, assume that SG wants to sign the message m 2 G with redundancy embedded to the access
ure F Â¼ f1 Ã¾ f2 Ã¾    Ã¾ fk in VG, each Usi 2 SG performs the following steps:
. Usi chooses an integer wi2RZq to computes1 s2 sn v1 v2 vl
the verifying group of l veriï¬ers. The following system parameters and notations are used throughout the paper.
q a large prime,
p a large prime such that qjÃ°p 1Ã,
G a subgroup of quadratic residue in Zp, that is G Â¼ fi2ji 2 Zpg,
g a generator for the subgroup G,
F the access structure F Â¼ f1 Ã¾ f2 Ã¾    Ã¾ fk denoted in the disjunctive normal form, where fi is an access instance.
F is used for determining who in the verifying group can cooperatively recover and verify the message, e.g., f Â¼ U U U ,
Assum
Consid
â€“ the 0 a1 a2 al b Ã°a1Ã¾a2Ã¾Ã¾alÃb
Th
for an
Th
Theor
Proof
and R
efï¬cie
B1. W
3430 T.-Y. Chang / Information Sciences 178 (2008) 3426â€“3434distribution D of Ã°g ; g ; . . . ; g ; g ; g Ã.
e VDDH problem is hard if there is no polynomial-time algorithm A that satisï¬es
jPrÂ½AÃ°D0Ã Â¼ true  PrÂ½AÃ°R0Ã Â¼ truej > 1
PÃ°jqjÃ
y polynomial P, where the probability is over the random choice of aiâ€™s; b and c.
e following theorem shows that the VDDH problem is at least as hard as the DDH problem.
em 3. The VDDH problem is at least as hard as the DDH problem.
. Proof by contradiction: assume that there exists an algorithm A that can efï¬ciently distinguish the distributions D0
0, where aiâ€™s;b2RZq and c2RG. We demonstrate that an algorithm B1 can be constructed by using the algorithm A to
ntly distinguish the distributions D and R, where a; b2RZq and c2RG. First, either D or R is the input of algorithm
ithout loss of generality, let ga1 Â¼ ga and gb Â¼ gb. Then, algorithm B1 computes the following values:jPrÂ½AÃ°DÃ Â¼ true  PrÂ½AÃ°RÃ Â¼ truej > 1
PÃ°jqjÃ
for any polynomial P, where the probability is over the random choice of a; b and c.
In order to prove the proposed scheme is secure against chosen-ciphertext attacks under the DDH problem, a variance of
the decisional Difï¬eâ€“Hellman problem (VDDH) is introduced. Then, we shall prove that a polynomial-time reduction from
the DDH problem to the VDDH problem and in the reverse direction are both easily known.
Assumption 2 (VDDH problem). There are several domain parameters p; q; g and G that are the same as those in Section 2.1.
Consider the following two distributions: aiâ€™s; b2RZq for i Â¼ 1 to l and c2RG,
â€“ the distribution R0 of Ã°ga1 ; ga2 ; . . . ; gal ; gb; cÃ;â€“ the distribution R of Ã°ga; gb; cÃ;
â€“ the distribution D of Ã°ga; gb; gabÃ.
The DDH problem is hard if there is no polynomial-time algorithm A that satisï¬esption 1 (DDH problem). There are several domain parameters p; q; g and G that are the same as those in Section 2.1.
er the following two distributions: a; b2RZq and c2RG,In this section, the security assumptions and models for the proposed convertible multi-authenticated encryption scheme
for group communications are deï¬ned and its performance is evaluated.
3.1. Security analysis
Using the assumptions of the DDH problem and the Nybergâ€“Rueppel signature scheme, the proposed scheme is demon-
strated to be secure against chosen-ciphertext attacks and existential forgery under the chosen-message attacks.Usj2SG
sj
Usj2SG
sj
Â¼ m: 
3. Security analysis and performance evaluationUsj2SG Usj2SG
Â¼ m gS
Y
y
0
@
1
A
R0
@
1
A  gS Y y
0
@
1
A
R0
@
1
AR  gS
Y
Usj2SG
ysj
0
@
1
A
R0
@
1
A
Â¼ m
Y
Usj2SG
r
rj
j
0
@
1
A  gS Y
Usj2SG
ysj
0
@
1
A
R0
@
1
A; by Eq: Ã°2Ã
Â¼ m
Y
gsj yRsj
0
@
1
A  gS Y ysj
0
@
1
A
R0
@
1
A; by Eq: Ã°4Ã
3432 T.-Y. Chang / Information Sciences 178 (2008) 3426â€“3434â€“ SE query: For an SE query on a message m chosen by A, B2 chooses an integer wi2RZq and computes ri Â¼ gwi modp,
R Â¼ m QUsi2SGrrii
 
modp, si Â¼ wiri Ã¾ xsiR modq for i Â¼ 1 to n, S Â¼
P
Usi2SGsi modq. Then, B2 chooses an integer d2RZ

q
and computes C1 Â¼ gd modp, C2 Â¼ R
Q
Uvi2f yvi
 d
modp
 
. The multi-authenticated ciphertext signature
r Â¼ Ã°S;C1;C2Ã is returned as the result of this query.
â€“ MRV query: For an MRV query on a multi-authenticated ciphertext signature r Â¼ Ã°S;C1;C2Ã, B2 computes
R Â¼ C2 
Q
Uvi2f  ti modp
 
where ti Â¼ Cx

vi
1 modp, and recovers the message m Â¼ R  gS
Q
Usj2SGysj
 R 
modp. If the
redundancy of m is valid, B2 returns the result; otherwise, B2 returns the symbol ?.
â€“ SC query: For an SC query on a multi-authenticated ciphertext signature r Â¼ Ã°S;C1;C2Ã, B2 computes
R Â¼ C2 
Q
Uvi2f C
x
vi
1 modp
 
and recovers the message m Â¼ R  gS QUsj2SGysj
 R 
modp. If Ã°R; SÃ and its corresponding
m are valid, B2 returns the result; otherwise, B2 returns the symbol ?.
Challenge phase: A chooses two equal-length messages m0 and m1. B2 chooses a bit h 2 f0;1g at random and computes
the challenge multi-authenticated ciphertext signature r Â¼ Ã°S;C1;C2Ã as follows. B2 chooses an integer wi2RZq and com-
putes ri Â¼ gwi modp, R Â¼ mh
Q
Usi2SGr
ri
i
 
modp, si Â¼ wiri Ã¾ xsiR modq for i Â¼ 1 to n, and S Â¼
P
Usi2SGsi modq. With the dis-
tribution either from R0 or D0,B2 treats C1 as the Ã°lÃ¾ 1Ãth element gb of the distribution and computes C2 Â¼ R Z, where Z
is the last element of the distribution. Finally, r Â¼ Ã°S;C1;C2Ã is sent to A.
Attack phase 2: The simulated results for SE queries, MRV queries, and SC queries as the same those in the Attack phase 1
with the only restriction being that A cannot issue an MRV query or SC query on the challenge multi-authenticated
ciphertext signature r.
If the input comes from D0 Ã°Z Â¼ gÃ°a1Ã¾a2Ã¾Ã¾alÃb modpÃ, the simulation ofB2 will be nearly perfect, and soAwill have a non-
negligible advantage in guessing the hidden bit h. Hence, PrÂ½B2Ã°D0Ã Â¼ true Â¼ PrÂ½h Â¼ h0. If the input comes from R0Ã°Z Â¼ cÃ,
then Aâ€™s view is essentially independent of h, and hence the probability of it outputs h Â¼ h0 is at most 1=2. Therefore, B2â€™s
advantage AdvÃ°B2Ã Â¼ 2 P PrÂ½h Â¼ h0  1=2P 1. Obviously, the running time t2 counts can be in the polynomial-time. Since
the DDH problem and the VDDH problem are equal, it said that the proposed CMAE scheme for group communications is
secure against chosen-ciphertext attacks under the DDH assumption. h
Deï¬nition 2 (Unforgeability). Consider the following game in which the forger F interacts with the challenger C.
Setup phase: C does the same works as those in the Setup phase of Deï¬nition 1. After receiving those parameters,A out-
puts a target Usiâ€™s 2 SG with the public keys ysiâ€™s.
Attack phase: F issues SE queries, MRV queries, and SC queries adaptively to the oracle O.
At the end of the game,F outputs a multi-authenticated ciphertext signature r Â¼ Ã°S;C1;C2Ã that cannot be the result of
previous SE queries.F wins the game if r can be decrypted to a valid multi-signature Ã°R; SÃ on the message m under the
secret keys of Uviâ€™s 2 f .
The convertible multi-authenticated encryption scheme for group communications is said to be secure against existential
unforgeability of multi-signature under the chosen-message attacks if there is no polynomial-time adversary with a non-
negligible in the above game.
Theorem 5. The proposed CMAE scheme for group communications is Ã°t; Ã-secure against existential forgery under the chosen-
message attacks if there is no polynomial-time algorithm that forges a Nybergâ€“Rueppel signature with Ã°t3; 3Ã.
Proof. Proof by the reduction to contradiction: assume that there exists an Ã°t; Ã-forgerF that can break the CMAE scheme
for group communications in the game of Deï¬nition 2, where t is the running time and  is the advantage thatF succeeds.
We demonstrate that an Ã°t3; 3Ã-algorithm B3 can be constructed by using A to efï¬ciently derive a valid Nybergâ€“Rueppel
signature. The following gives the details of B3â€™s simulation.
Setup phase: Simulate C in the game of Deï¬nition 2. After receiving those parameters,A outputs a target Usiâ€™s 2 SG with
the public keys ysiâ€™s.
Attack phase: The simulated results for SE queries,MRV queries, and SC queries are the same those in the Attack phase 1 of
Deï¬nition 1.
Finally,F outputs an authenticated ciphertext r Â¼ Ã°S;C1;C2Ã that can be decrypted to a valid multi-signature Ã°R; SÃ on
the message m with a non-negligible advantage  and a polynomial-time t. B3 has the ability to output a valid Nybergâ€“
Rueppel signature Ã°R; SÃ on the message m with respect to the public keyQUsi2SGysi modp. Therefore, B3â€™s advantage 3 is
at leastFâ€™s advantage , AdvÃ°B3Ã Â¼ 3 P . Furthermore, the converted signature Ã°R; SÃ on messagem can be done only by
the veriï¬er without any computations. It is obvious that the unforgeability implies the non-repudiation. h
[12] P. Horster, M. Michels, H. Petersen, Authenticated encryption schemes with low communication costs, Electronics Letters 30 (15) (1994) 1212â€“1213.
[13] S.J. Hwang, C.C. Chang, W.P. Yang, Authenticated encryption schemes with message linkages, Information Processing Letters 58 (4) (1996) 189â€“194.
[14] W.B. Lee, C.C. Chang, Authenticated encryption schemes without using a one way function, Electronics Letters 31 (19) (1995) 1656â€“1657.
[15] C.M. Li, T. Hwang, N.Y. Lee, Security ï¬‚aw in simple generalized group-oriented cryptosystems using ElGamal cryptosystem, International Journal of
Informatics 18 (1) (2007) 61â€“62.
[16] C. Ma, K. Chen, Publicly veriï¬able authenticated encryption, Electronics Letters 39 (3) (2003) 281â€“282.
[17] W. Mao, Modern Cryptography: Theory and Practice, Prentice-Hall, 2004.
[18] M. Naor, O. Reingold, Number-theoretic constructions of efï¬cient pseudo-random functions, Journal of the ACM 51 (2) (2004) 231â€“262.
[19] National Institute of Standards and Technology (NIST), The digital signature standard proposed by NIST, Communications of the ACM 35 (7) (1992)
36â€“40.
[20] K. Nyberg, R.A. Rueppel, Message recovery for signature schemes based on the discrete logarithm, in: Advances in Cryptology, EUROCRYPTâ€™94, 1994,
pp. 175â€“190.
[21] K. Nyberg, R.A. Rueppel, Message recovery for signature schemes based on the discrete logarithm, Designs, Codes and Cryptography 7 (1â€“2) (1996) 61â€“
81.
[22] H. Petersen, M. Michels, Cryptanalysis and improvement of signcryption schemes, IEE Proceedings â€“ Computers and Digital Techniques 145 (2) (1998)
149â€“151.
[23] R.L. Rivest, A. Shamir, L. Adleman, A method for obtaining digital signatures and public key cryptosystems, Communications of the ACM 21 (1978)
120â€“126.
[24] J. Shin, K. Lee, K. Shim, New DSA-veriï¬able signcryption schemes, in: ISISCâ€™2002, Springer-Verlag, 2003, pp. 35â€“47.
[25] Y.M. Tseng, J.K. Jan, H.Y. Chien, Authenticated encryption schemes with message linkages for message ï¬‚ows, Computers and Electrical Engineering 29
(1) (2003) 101â€“109.
[26] T.S. Wu, C.L. Hsu, Convertible authenticated encryption scheme, The Journal of Systems and Software 62 (3) (2002) 205â€“209.
[27] T.S. Wu, C.L. Hsu, K.Y. Tsai, H.Y. Lin, T.C. Wu, Convertible multi-authenticated encryption scheme, Information Sciences 178 (1) (2008) 256â€“263.
[28] Q. Xie, X.Y. Yu, Cryptanalysis of Tseng et al.â€™s authenticated encryption schemes, Applied Mathematics and Computation 158 (1) (2004) 1â€“5.
[29] C.C. Yang, T.Y. Chang, J.W. Li, M.S. Hwang, Simple generalized group-oriented cryptosystems using ElGamal cryptosystem, International Journal of
Informatica 14 (1) (2003) 11â€“120.
[30] J. Zhang, Y. Wang, Method of constructing elliptic curve authenticated encryption scheme, Applied Mathematics and Computation 168 (1) (2005) 146â€“
151.
[31] J. Zhang, Y. Wang, On the security of a convertible authenticated encryption, Applied Mathematics and Computation 169 (2) (2005) 1063â€“1069.
[32] Z. Zhang, S. Araki, G. Xiao, Improvement of Tseng et al.â€™s authenticated encryption scheme with message linkages, Applied Mathematics and
Computation 162 (3) (2005) 1475â€“1483.
[33] Y. Zheng, Digital signcryption or how to achieve cost (signature & encryption) cost (signature) + cost (encryption), in: Advances in Cryptology,
CRYPTOâ€™97, 1997, pp. 165â€“179.
3434 T.-Y. Chang / Information Sciences 178 (2008) 3426â€“3434
2 T. Y. CHANG AND M. L. CHIANG
Araki et al. [2] ï¬rst proposed a convertible limited veriï¬er signature scheme in which
the authenticated encryption signature could be converted into an ordinary one without
revealing veriï¬erâ€™s secret key. However, the conversion of the authenticated encryption
signature requires the signerâ€™s collaboration with the designed veriï¬er. If the signer is
unwilling to cooperate, the situation becomes problematic [5, 24, 25]. To overcome this
concern, Wu and Hsu [21] proposed a convertible AES, in which the veriï¬er can singly
convert the authenticated encryption signature into an ordinary one. A third-party can
then judge the converted signature. Ma and Chen [14] also proposed a convertible AES,
but Chang et al. [5] pointed out that anyone can forge the converted signature for any
message.
On the other hand, since the message is decrypted from the signature in AESs, the
message cannot be hashed to reduce the size of the message. If the message is large,
the message should be divided into a sequence message blocks, so that each message
block is encrypted and signed individually. Therefore, AESs are not eï¬ƒcient when the
message is large. Hwang et al. [12] proposed an AES with message linkages, which allow
authenticated encryption signatures to handle large messages eï¬ƒciently. The messages
blocks can be recovered in the arranged order. Later, Tseng et al. [19] proposed an AES
with message linkages using self-certiï¬ed public keys. Unfortunately, Xie and Yu [23]
showed that Tseng et al.â€™s AES is insecure. A malicious veriï¬er can forge the signature
for any message by substituting his/her secret key into the trusted center. At the same
time, they give a simple method to improve Tseng et al.â€™s scheme. Since an authenticated
encryption signature in Tseng et al.â€™s scheme cannot be converted into an ordinary one,
Zhang et al. [26] proposed an AES based on the Meta-message recovery signature scheme
[11] to satisfy convertibility. It is also eï¬ƒcient, in terms of communication cost and
computational complexity. Recently, Tzeng et al. [20] proposed a convertible AES with
message linkages, which has both properties of â€œconvertibilityâ€ and â€œmessage linkagesâ€
mentioned above.
In this paper, we show that Zhao and Liuâ€™s AES [25] is vulnerable to a universal forgery
attack. That is, any malicious veriï¬er is able to forge the signature of any message. In [25],
their AES is based on the elliptic curve and presents six types of the signature generation
equations, and the corresponding message recovery and veriï¬cation equations. However,
all types in the Zhao-Liu AES are not secure. Two simple methods shall be presented:
one is similar to Xie and Yuâ€™s improvement; another can not only withstand the above
attack but also provide convertibility.
2. Attack and Improve the Zhao-Liu AES. In this section, the Zhao-Liu AES is
brieï¬‚y reviewed. It is divided into three phases: system initialization phase, signature
generation phase, and message recovery and veriï¬cation phase.
System initialization phase
The system chooses an elliptic curve E over a ï¬nite ï¬eld Fq, where the order of group
of points in E(Fq) is divided by a lager prime p. Choose a public hash function h and
a public base point G âˆˆ E with order p such that pG = O, where O denotes an inï¬nite
points. Assume that Aliceâ€™s public key is PA = aG âˆˆ E, where a âˆˆR Zâˆ—p is her secret key,
and Bobâ€™s public key is PB = bG âˆˆ E, where b âˆˆR Zâˆ—p is his secret key.
Signature generation phase
Assume that Alice wants to send a message m âˆˆ Zâˆ—p to Bob in a secure and authentic
way. Alice performs the following steps to create an authenticated encryption signature
for message m.
4 T. Y. CHANG AND M. L. CHIANG
Step 2. Choose an arbitrary message mâ€² âˆˆR Zâˆ—p and satisfy the format of redundancy em-
bedded. Compute
râ€² = h((Râ€²)x)âˆ’1mâ€² mod p,
bâ€² = (rb)râ€²âˆ’1 mod p,
sâ€² = (sb)bâ€²âˆ’1 mod p.
Step 3. Compute his new public key P â€²B = b
â€²G and then asks the trusted center to change
PB as P
â€²
B.
Since the Zhao-Liu AES has no the convertible property, Bob reveals his secret key
bâ€² to a third party such that it can judge at the signature (râ€², sâ€²) via Equation (1) and
Equation (2). The message mâ€² can be recovered as follows.
X = sâ€²Gâˆ’ râ€²PA,
= (sb)bâ€²âˆ’1Gâˆ’ râ€²aG.
mâ€² = h((bâ€²X)x)râ€² mod p,
= h((sbGâˆ’ bâ€²râ€²aG)x)râ€² mod p,
= h((sbGâˆ’ (rb)râ€²âˆ’1râ€²aG)x)râ€² mod p,
= h(((kb + rab)Gâˆ’ rbaG)x)râ€² mod p,
= h((kbG)x)r
â€² mod p,
= h((kbG)x) Â· h((R)x)âˆ’1mâ€² mod p,
= mâ€² mod p.
It can be seen that the message mâ€² is recovered by using Diï¬ƒe-Hellman key exchange
kbG. Hence, the six signature generation equations showed in Table 1 have no thing to
do with the message recovery. Obviously, this attack is successful in the six signature
generation equations.
Here, we provide two simple methods to repair the secure ï¬‚aw as follows.
Method 1 : The signer must send kG together with (r, s) to the veriï¬er in Step 4 of
signature generation phase. In Step 3 of message recovery and veriï¬cation phase, the
veriï¬er (also the third party) additionally checks the following equation.
kG
?
= X. (4)
Since the malicious veriï¬er does not know the value k, he/she cannot compute kâ€² such
that kâ€² = (krâ€²)râˆ’1 to pass Equation (4) as follows.
X = sâ€²Gâˆ’ râ€²PA,
= (sb)bâ€²âˆ’1Gâˆ’ râ€²aG,
= (sb)((rb)râ€²âˆ’1)âˆ’1Gâˆ’ râ€²aG,
= (srâˆ’1râ€²)Gâˆ’ râ€²aG,
= ((k + ra)râˆ’1râ€²)Gâˆ’ râ€²aG,
= (krâˆ’1râ€² + arâ€²)Gâˆ’ râ€²aG,
= krâˆ’1râ€²G.
This repair is similar to Xie and Yuâ€™s improvement in Tseng et al.â€™s AES. However, in
case of a later dispute, Bob still needs to reveals his secret key to prove the signature is
generated by Alice.
Method 2 : From the above Method 1, the signer additionally sends kG to the veriï¬er. In
other words, the authenticated signature is (r, s, kG). On the other hand, the veriï¬er not
