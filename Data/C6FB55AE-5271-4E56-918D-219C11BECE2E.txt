 2
according to the Bank for International 
Settlements, the global notional principal of 
over-the-counter derivatives already stood at 516 
trillion US dollars as of June 2007 (see Fig. 1). 
Research in this area therefore has important 
practical implications and has been extremely 
active. See Haug (1998), Hull (1999), Kwok 
(1998), Lyuu (2002), Nelken (1996), Wystup 
(2006) for surveys of derivatives products. 
Efficient and unbiased numerical algorithms 
play a critical role in derivatives pricing. The 
reason is that it is imperative to obtain accurate 
prices fast for traders and risk managers: The 
former because real-time quotes change fast, the 
latter because they need to know the risk 
exposures of a company in real time. 
Among derivative products, multivariate 
options are particularly hard to price. The payoff 
of a multivariate option depends on several 
underlying assets instead of just one. Hence their 
pricing is a multi-dimensional integration 
problem (equivalently, expectation). Many 
equity-linked structured notes are multivariate 
options. Multivariate options are also called 
rainbow options. The term â€œrainbowâ€ originates 
from Rubinstein (1991), who describes a 
rainbow option as a combination of a variety of 
assets much as rainbow is a combination of a 
variety of colors.  
For deterministic algorithms, the running 
times for such integrations generally grow 
exponentially in the dimension size and are 
clearly impractical (see Boyle et al. (1989, 
1997)). This phenomenon is the well-known 
curse of dimensionality (see Tavella and Randall 
(2000)). The study of multivariate options has 
lagged that of other options precisely because of 
their high dimensionality and the resulting 
computational intractability. In practice, the 
probabilistic Monte Carlo simulation is often the 
only viable computational method for pricing 
such options (see Boyle (1997) and Glasserman 
(2004)).  
Besides a derivativeâ€™s price, its Greeks are 
equally important. Greeks are the priceâ€™s 
sensitivities with respect to certain parameters of 
interest such as the underlying asset's price. 
Mathematically, Greeks are partial derivatives. 
Although an optionâ€™s price can be observed in 
the market, this is not the case with its Greeks, 
which must be calculated. As Greeks are 
important for measuring and managing risk as 
well as executing dynamic trading strategies, 
how to calculate them efficiently and accurately 
is of critical importance both in theory and in 
practice (see Broadie and Glasserman (1996) and 
Fu and Hu (1995)). 
As Greeks are partial derivatives, the 
standard computational method is finite 
difference (FD). See Atkinson (1989). However, 
FDs can be unstable and biased, especially for 
higher-order partial derivatives. This 
phenomenon is sometimes called the curse of 
differentiation. The purpose of this proposal is to 
investigate how to calculate the Greeks of 
multivariate options such that the results are 
unbiased and stable. 
Closed-form pricing formulas are clearly 
mathematically desirable for derivative prices. 
Once formulas are available, one can perform 
differentiation to derive the Greeks in principle. 
But much as closed-form formulas are desirable, 
there are difficulties in the case of multivariate 
options. First, simple closed-form formulas are 
extremely rare. In fact, only very simple 
scenarios enable us to derive such formulas. 
Second, even if such formulas are available, they 
will most likely be multi-dimensional integrals: 
ïƒ²ïƒ² ïƒ²ïƒ² dzfAïŒ . Such integrals cannot be 
computed efficiently because of the curse of 
dimensionality. As a result, formulas like this 
may be interesting theoretically, but their 
evaluation necessarily relies on simulation 
except in very special cases. 
Multivariate optionsâ€™ payoffs depend on 
more than one random variable and are 
inherently high-dimensional. Let T denote the 
time when the option expires and t the current 
time. The payoff of the option occurs at time T. 
The table in Fig. 2 lists a partial sample of 
important multivariate options. 
A few methods deal with the curse of 
dimensionality for certain types of multivariate 
options, such as the closed-form approximation 
formulas of Kirk (1995), Pearson (1995), and 
Carmona and Durrleman (2003) for spread 
options and the method of HÃ¶rfelt (2008) for 
options on the kth ranked asset. However, these 
methods are quite restrictive in their domains of 
applicability and may yield biased Greeks. As a 
 4
said that FDs produce highly inaccurate Greeks. 
See Pelsser and Vorst (1994) and JÃ¤ckel (2002) 
for more information. Although using common 
random numbers in resimulation can reduce the 
estimation error, the above observations remain 
valid even if variance reduction techniques or 
stratified sampling are employed (see Zazanis 
and Suri (1993)). 
To solve this problem, the pathwise method 
has been proposed (see Broadie and Glasserman 
(1996) and Boyle et al. (1997)). The pathwise 
method allows the differentiation of each 
simulated outcome with respect to the parameter 
of interest. Mathematically, it interchanges the 
order of expectation and differentiation, or 
[ ]
ïƒºïƒ»
ïƒ¹ïƒªïƒ«
ïƒ©
âˆ‚
âˆ‚
=
âˆ‚
âˆ‚
x
gE
x
gE  
So the delta becomes 
( ) ( )[ ]{ }
( ) ( )ïƒºïƒ»
ïƒ¹ïƒªïƒ«
ïƒ©
âˆ‚
âˆ‚
=
âˆ‚
âˆ‚
â‰¡Î”
âˆ’âˆ’
âˆ’âˆ’
i
mtTr
i
m
tTr
i
S
SSSPEe
S
SSSPEe
,,,
,,,
21
21
ï‹
ï‹
 
and the gamma becomes 
( ) ( )[ ]{ }
( ) ( )ïƒºïƒ»
ïƒ¹ïƒªïƒ«
ïƒ©
âˆ‚âˆ‚
âˆ‚
=
âˆ‚âˆ‚
âˆ‚
â‰¡Î“
âˆ’âˆ’
âˆ’âˆ’
ji
mtTr
ji
m
tTr
ij
SS
SSSPEe
SS
SSSPEe
,,,
,,,
21
2
21
2
ï‹
ï‹
 
Resimulation with FDs is no longer necessary 
because we will be integrating functions instead. 
Furthermore, the result is correct and unbiased 
under some regularity conditions. 
The above idea is limited by the 
requirement of Lipschitz continuity in the payoff 
function, however. As a result, discontinuity in 
the payoff function invalidates the pathwise 
method as a convergent algorithm. For example, 
the pathwise method is inapplicable to the delta 
of the simple digital option and the gamma of 
most options. 
To be able to differentiate a payoff function 
even if it is not differentiable in the classic sense, 
we need to introduce generalized functions. 
Recall that the dirac function ( )xcÎ´  is such that 
( ) 1=ïƒ²âˆ
âˆâˆ’
dxxcÎ´  and ( ) 0=xcÎ´  for cx â‰  . It has the 
property: 
( ) ( ) ( )cfdxxxf c =ïƒ²âˆ
âˆâˆ’
Î´ . 
The indicator function ( )xI A  is such that 
( )
ïƒ®ïƒ­
ïƒ¬
âˆ‰
âˆˆ
=
Ax
Ax
xI A 0
1
 
The set A is also called the support of the 
indicator function. The dirac function and the 
indicator function are related by 
( )x
x
I
c
cx Î´=
âˆ‚
âˆ‚ >  
(see Schwartz (1973)). Functions such as the 
dirac function and the indicator function are said 
to be differentiable in the sense of distributions. 
Standard calculus applies to such functions such 
as the chain rule, integration by parts, and the 
Leibnitz rule. 
The focus here is to design an unbiased 
method for the calculation of the Greeks of 
multivariate options that do not use FDs. Our 
method must also be more generally applicable 
than the pathwise method. To our best 
knowledge, no work in the literature has tackled 
this problem because multivariate options almost 
without exceptions are priced by simulation (one 
exception is the closed-form formulas for the 
simple 2-asset single-barrier option as in Stulz 
(1982) Johnson (1987)). Extensive computer 
experiments are conducted to compare our 
algorithms to those in the literature. 
We prove that, under some regularity 
conditions, the following identity holds (see 
Lyuu and Teng (2011) for the technical proof): 
( ) ( ){ } ( )
( )
( ){ } ( )
( ) ( )( ) ( )( )( )( )
, 0
, 0
,
,
,,
sgn ,
,
1
1
g s t
g s t
f s t t dt
s
f s t
t dt
s
g s t s sg s t
f s t s
t g s t s t
âˆ
>
âˆ’âˆ
âˆ
>
âˆ’âˆ
âˆ‚
âˆ‚
âˆ‚
=
âˆ‚
âˆ‚ âˆ‚âˆ‚ïƒ¦ ïƒ¶
+ ïƒ§ ïƒ·âˆ‚ âˆ‚ âˆ‚ïƒ¨ ïƒ¸
ïƒ²
ïƒ²
The above is our basic mathematical tool for 
later formulas. Note that we turned a partial 
derivative into an integration, thus avoiding the 
curse of differentiation. Later, this result will be 
applicable to payoff functions which define a 
polyhedron and take the form of a â€œsmoothâ€ 
 6
iÏƒ is the volatility of asset i, idW  is the Wiener 
process, and ijÏ  is the correlation between idW  
and jdW . Let ( )iS T  denote the price of asset i at 
maturity and TS  denote the vector of asset prices 
at maturity, i.e., ( ) ( )( )1 , ,T nS S T S T= ï‹ . By the 
log-normality of TS , 
 ( ) ( )2 / 2i i ir T T xi iS T S e Ïƒ Ïƒâˆ’ += , 
where  ( )0,nx N Î£ï€º , the correlation matrix is 
defined as ijÏïƒ© ïƒ¹Î£ = ïƒ« ïƒ»  with ijÏ  being the 
correlation between idW  and jdW , and x is the 
underlying randomness driving the transition 
from the initial stock prices to the stock prices at 
maturity. 
As the payff function P depends on TS , 
which in turn depends on x, the multivariate 
optionâ€™s price is the integral 
 ( )( ) ( )
,
, ;0,
n
rT
T
rT
TR
C e E P S
e P S f x dx
Î¸
Î¸
âˆ’
âˆ’
= ïƒ© ïƒ¹ïƒ« ïƒ»
= Î£ïƒ²  
Above, Î¸  is the parameter of interest, which we 
make explicit the dependency of P on Î¸ . Note 
that the above equation integrates over the 
domain of x. 
A first-order Greek with respect to Î¸ 
equals  
 [ ]rTe E PÎ¸
âˆ’
âˆ‚
âˆ‚
 
Our methodology will depend on the validity of 
the interchange of the order of expectation and 
differentiation, i.e., 
 [ ]rT rT Pe E P e EÎ¸ Î¸
âˆ’ âˆ’
âˆ‚ âˆ‚ïƒ© ïƒ¹
= ïƒª ïƒºâˆ‚ âˆ‚ïƒ« ïƒ»  
The right-hand side equals the desired Greek, 
which is again an expectation and can often be 
estimated without bias by the standard Monte 
Carlo method. Equally importantly, if the above 
equality holds, then there is no need for FD or 
resimulation. 
If it is valid to interchange the order of 
expectation and differentiation iteratively, we 
have 
 [ ]
2 2
2 2
rT rT Pe E P e E
Î¸ Î¸
âˆ’ âˆ’
ïƒ© ïƒ¹âˆ‚ âˆ‚
= ïƒª ïƒºâˆ‚ âˆ‚ïƒ« ïƒ»
 
In this case, a gamma equals the delta of a delta. 
Exactly the same argument can be repeated for 
cross-gammas and higher-order Greeks. 
Broadie and Glasserman (1996) establish a 
set of conditions on P for such equalities to hold, 
which yield the pathwise method. Loosely 
speaking, the order of differentiation and 
expectation can be interchanged for Lipschitz-
continuous payoff functions. The pathwise 
method, however, may not be applicable when 
the payoff function is not Lipschitz-continuous. 
Indeed, many payoff functions are not Lipschitz-
continuous. The payoff function of a digital 
option, for example, is not Lipschitz-continuous. 
The pathwise method is even less applicable to 
calculating the gammas. 
Recall that, roughly speaking, a payoff 
function is in C, our focus, if it is a sum of 
products of a differentiable function and several 
indicator functions with the right kind of support. 
We remark that Lipschitz-continuity appears to 
be a subset of our C under most circumstances of 
practical importance. 
We prove the following technical theorem 
(the definitions of classes H and G are very 
technical and therefore skipped here). 
Theorem 1 (Lyuu and Teng (2011)) Suppose 
( ),h x HÎ¸ âˆˆ  with pdf ( )f x  for x and 
( ),jg x GÎ¸ âˆˆ  for j Bâˆˆ , a finite set of natural 
numbers. Then  
 
( ) ( ) ( )
( )
{ }
{ ( , ) 0}
{ ( , ) 0}
{ ( , ) 0}
\ ( )
, 1
( , ) 1 ( )
( , ) ( , ) 1 ( ) ( )
j
j
j
g xR
j B
g xR
j B
g x
B j B x
h x x f x dx
h x x f x dx
h x J x x f x
Î¸
Î¸ Î¸
Î¸
Ï‡ Î¸
Î¸
Î¸
Î¸
Î¸ Î¸
>
âˆˆ
>
âˆˆ
>
âˆˆ âˆˆ
=
âˆ‚
âˆ‚
=
ïƒ© ïƒ¹
+ ïƒª ïƒºïƒª ïƒºïƒ« ïƒ»
âˆïƒ²
âˆïƒ²
ïƒ¥ âˆ
ï¬
ï¬
ï¬ ï¬
where 
( ) ( )
( ) xxg
xg
x
xgJ
âˆ‚âˆ‚
âˆ‚âˆ‚ïƒ·ïƒ¸
ïƒ¶ïƒ§ïƒ¨
ïƒ¦
âˆ‚
âˆ‚
=
,
,,sgn
Î¸
Î¸Î¸Î¸
ï¬
ï¬ï¬
ï¬  
for Bâˆˆï¬ . 
We skip the lengthy yet technical proof in 
Lyuu and Teng (2011). In plain language, the 
 8
( )
( )
{ }
( , )
{ ( , ) 0}
{ ( , ) 0}
\
,
( , ) 1
( , ) ( , ) 1 ( ) ( , )
j
j
xk k
g
j B
q g k
B j B
E P
E h
E h J
Ï‡ Î¸
Î¸ Î¸
Î¸
Î¸
Î¸
Î¸
Î¸ Î¸ Î· Î¸
=
>
âˆˆ
>
âˆˆ âˆˆ
âˆ‚ ïƒ© ïƒ¹ïƒ« ïƒ»âˆ‚
ïƒ© ïƒ¹
= ïƒª ïƒºïƒ« ïƒ»
ïƒ© ïƒ¹ïƒ© ïƒ¹ïƒª ïƒº+ ïƒª ïƒºïƒª ïƒºïƒª ïƒºïƒ« ïƒ»ïƒ« ïƒ»
âˆ
ïƒ¥ âˆ
x
x
x
x
x x
x x x x
ï¬
ï¬ï¬
ï¬ ï¬
ï€¥
where 
( ) ( )
( )
( , )
( ; , )
( , )
( )
, ,
sgn
,
xk k
k
k
k k
f
q
g g
J
x g x
Ï‡ Î¸Î· Î¸
Î¸ Î¸ Î¸
Î¸
=
=
âˆ‚ âˆ‚ âˆ‚ïƒ¦ ïƒ¶
= ïƒ§ ïƒ·âˆ‚ âˆ‚ âˆ‚ïƒ¨ ïƒ¸
x
x 0 Î£
x
x
x x
x
ï¬
ï¬
ï¬ ï¬
ï¬
ï¬
ï€¥
 and kx  has pdf ( )kq x  under qE . 
Now, first-order Greeks can be derived if 
the payoff function P belongs in C. To derive 
Greeks like delta, vega, and theta, simply apply 
the corresponding theorem with SÎ¸ = , Î¸ Ïƒ= , 
and TÎ¸ = , respectively. To derive rho, apply the 
corresponding theorem with rÎ¸ =  via 
 [ ] [ ] [ ]rT rT rTe E P Te E P e E P
r r
âˆ’ âˆ’ âˆ’
âˆ‚ âˆ‚
= âˆ’ +
âˆ‚ âˆ‚
 
(see Boyle et al. (1989) and Cox et al. (1985)). 
When a closed-form formula for ( , )kÏ‡ Î¸ xï¬  
exists, we simply plug ( , )kÏ‡ Î¸ xï¬  into kx . If a 
closed-form formula does not exist, we can plug 
into kx  a numerical solution using, e.g., the 
Newtonâ€“Raphson method. As a result, we only 
require the existence of ( , )kÏ‡ Î¸ xï¬  when 
calculating first-order Greeks. Higher-order 
Greeks can be obtained recursively using 
Theorem 2. 
We are now ready to present the Greeks for 
various multivariate options. 
The delta of the spread option equals 
 { }
( )
2 11 ( ) ( ) 0
1
( )rT S T S T Ke E S T T
S
âˆ’
âˆ’ âˆ’ >
ïƒ© ïƒ¹
âˆ’ïƒ« ïƒ»1 S  
The gamma of the spread option equals 
( )( ) ( ) ( )( )2 21 1 1 2 2 22 / 2 / 2 ,
2
2 2
( , )
r T T x r T TrT
qe E e
S T
Ïƒ Ïƒ Ïƒ Ïƒ Ï‡ Î¸ Î· Î¸
Ïƒ
âˆ’ + âˆ’ âˆ’ +
âˆ’
ïƒ© ïƒ¹ïƒª ïƒºïƒ« ïƒ»
x
xï€¥
The cross-gamma of the spread option equals 
  
( )21 1 1/ 2
2
2 2
( , )r T T xrT qe E e
S T
Ïƒ Ïƒ Î· Î¸
Ïƒ
âˆ’ +
âˆ’ ïƒ© ïƒ¹
âˆ’ ïƒª ïƒºïƒ« ïƒ»x
ï€¥
 
The delta, gamma, and cross-gamm of the 
maximum option, the binary maximum option, 
the down-and-out call option, and the Asian 
option are more complicated. The reader is 
referred to Lyuu and Teng (2011) for details. 
We now proceed to cover the numerical 
experiments. We first compare our method with 
other methods for the Greeks of three 
multivariate options and one barrier option.  
A fundamental weakness of the FD 
approach to Greeks is that, so far, there are no 
known hard rules for choosing the right 
perturbed size Îµ  in calculating the Greeks (see 
JÃ¤ckel (2002)). This delicate issue is especially 
damaging for higher-order Greeks like gammas 
and cross-gammas. It also highlights the 
advantage of our method, which does away with 
Îµ  as Îµ  simply does not enter our formulas at all. 
The formulas of Greeks for multivariate options 
using the likelihood ratio method are 
summarized in Appendix G of Lyuu and Teng 
(2001). 
Tables in Fig. 3, 4, 5 and 6 show the results 
of applying our method to spread options, 
maximum options, binary maximum options, and 
barrier options, respectively. For the benchmark 
values, we first compute their option prices, then 
calculate the Greeks by central FD with 0.1Îµ = . 
We use numerical integration to calculate the 
prices of spread and barrier options and follow 
Johnson (1987) in calculating the prices of 
maximum and binary maximum options. These 
tables contain simulation results with 100,000 
paths for deltas, gammas, and cross-gammas so 
that our method can be compared with forward 
and central FD methods under various h (i.e., Îµ ). 
We also use common random numbers for the 
FD estimates. 
Several conclusions can be drawn from 
these tables. The deltas given by our method and 
the FD methods are of similar quality. In 
particular, our method always gives unbiased 
deltas. In comparison, the FD methods may give 
biased deltas when Îµ  is large but they quickly 
converge to the correct values as Îµ  approaches 
 10
allow differentiation of the prices without using 
finite differences. We designed algorithms for 
calculating those Greeks, analyzed them, and 
compared them with alternative methods. The 
comparisons with other methods are favorable in 
terms of convergence and accuracy. Our method 
is general and can be applied to a wide range of 
options. The results are accepted by one of the 
most prestigious journals in finance. 
 
å…­ã€åƒè€ƒæ–‡ç» 
Atkinson, K.E. An Introduction to 
Numerical Analysis. 2nd ed. New York: Wiley, 
1989. 
Benhamou, E. â€œOptimal Malliavin 
Weighting Function for the Computation of the 
Greeks.â€ Mathematical Finance, Vol. 13 (2003), 
pp. 37â€“53.  
Black, Fischer, and Myron Scholes. â€œThe 
Pricing of Options and Corporate Liabilities.â€ 
Journal of Political Economy, 81, No. 3 (Mayâ€“
June 1973), pp. 637â€“654. 
Boyle, P.P. â€œOptions: A Monte Carlo 
Approach.â€ Journal of Financial Economics, 
Vol. 4 (1977), pp. 323â€“338. 
Boyle, P.P., M. Broadie, and P. Glasserman. 
â€œMonte Carlo Methods for Security Pricing.â€ 
Journal of Economic Dynamics & Control, 21 
(1997), pp. 1267â€“1321. 
Boyle, Phelim, Jeremy Evnine, and Stephen 
Gibbs. â€œNumerical Evaluation of Multivariate 
Contingent Claims.â€ The Review of Financial 
Studies, 2, No. 2 (1989), pp. 241â€“250. 
Boyle, Phelim P., and Sok Hoon Lau. 
â€œBumping Up against the Barrier with the 
Binomial Method.â€ Journal of Derivatives, Vol. 
1 (1994), pp. 6â€“14. 
Boyle, P.P., and Y.S. Tian. â€œAn Explicit 
Finite Difference Approach to the Pricing of 
Barrier Options.â€ Applied Mathematical Finance, 
Vol. 5 (1998), pp. 17â€“43. 
Broadie, M., and P. Glasserman. 
â€œEstimating Security Price Derivatives Using 
Simulation.â€ Management Science, 42, No. 2 
(1996), pp. 269â€“285. 
Broadie, Mark, Paul Glasserman, and 
Steven Kou. â€œA Continuity Correction for 
Discrete Barrier Options.â€ Mathematical 
Finance, Vol. 7 (1997), pp. 325â€“349. 
Broadie, M., P. Glasserman, and S. Kou. 
â€œConnecting Discrete and Continuous Path-
Dependent Options.â€ Finance and Stochastics 3, 
No. 2 (1999), pp. 55â€“82. 
Carmona, RenÃ© and Valdo Durrleman. 
â€œPricing and Hedging Spread Options.â€ SIAM 
Review, 45, No. 4 (2003), pp. 627â€“685. 
Cheuk, Terry H.F., and Ton C.F. Vorst. 
â€œComplex Barrier Options.â€ Journal of 
Derivatives, Vol. 4 (1996), pp. 8â€“22. 
Cox, J.C., J.E. Ingersoll, and S.A. Ross. 
â€œAn Intertemporal General Equilibrium Model 
of Asset Prices.â€ Econometrica, Vol. 53 (1985), 
pp. 363â€“384. 
Cox, J.C., S.A. Ross, and M. Rubinstein. 
â€œOption Pricing: A Simplified Approach.â€ 
Journal of Financial Economics 7, (September 
1979), pp. 229â€“263. 
Duffie, Darrell. Dynamic Asset Pricing 
Theory. 2nd ed. Princeton, New Jersey: 
Princeton University Press, 1996. 
FourniÃ©, E., J. Lasry, J. Lebuchoux, P. 
Lions, and N. Touzi. â€œApplications of Malliavin 
Calculus to Monte Carlo Methods in Finance.â€ 
Finance and Stochastics, Vol. 3 (1999), pp. 391â€“
412. 
Fu, M. and Hu, J.-Q. Conditional Monte 
Carlo: Gradient Estimation and Optimization 
Applications. Norwell: Kluwer Academic, 1997. 
Glasserman, P. Monte Carlo Methods in 
Financial Engineering. New York: Springer, 
2004.  
Harrison, J.M. and D. Kreps. â€œMartingale 
and Arbitrage in Multiperiod Securities 
Markets.â€ J. Econ. Theory, Vol. 20 (1979), pp. 
381â€“408.  
Harrison, J.M., and S.R. Pliska. â€œMartingale 
and Stochastic Integrals in the Theory of 
Continuous Trading.â€ Stochastic Process and 
Their Applications, Vol. 11 (1981), pp. 215â€“260. 
 12
Wei, Jason Z. â€œValuation of Discrete 
Barrier Options by Interpolations.â€ Journal of 
Derivatives (Fall 1998), pp. 51â€“73. 
Wystup, U. Foreign Exchange Options and 
Structured Products. Hoboken, NJ: Wiley, 2006. 
Zazanis, M., and R. Suri. â€œConvergence 
Rates of Finite-Difference Sensitivities Estimates 
for Stochastic Systems.â€ Operations Research, 
41, No. 4 (1993), pp. 694â€“703. 
Zvan, Robert, Kenneth Vetzal, and Peter 
Forsyth. â€œPDE Methods for Pricing Barrier 
Options.â€ Journal of Economics Dynamics and 
Control, Vol. 24 (2000), pp. 1563â€“1590. 
 
 
 14
Figure 2: 
Option Payoff function 
Exchange option ( ) ( )[ ]0,max 21 TSTS âˆ’  
Better-off option ( ) ( ) ( )[ ]TSTSTS m,,,max 21 ï‹  
Worse-off option ( ) ( ) ( )[ ]TSTSTS m,,,min 21 ï‹  
Maximum option ( ) ( ) ( )[ ][ ]0,,,,maxmax 21 XTSTSTS m âˆ’ï‹  
Minimum option ( ) ( ) ( )[ ][ ]0,,,,minmax 21 XTSTSTS m âˆ’ï‹  
Spread option ( ) ( )[ ]0,max 21 XTSTS âˆ’âˆ’  
Basket option ( ) ( ) ( )
ïƒºïƒ»
ïƒ¹ïƒªïƒ«
ïƒ©
âˆ’
+++
0,max 21 X
m
TSTSTS mïŒ  
 
 16
Figure 4: 
Greeks of maximum options on two assets. 
 
 18
Figure 6: 
Greeks of down-and-out options with two monitored dates. 
 
 
 
1 23
Your article is protected by copyright and
all rights are held exclusively by Springer-
Verlag. This e-offprint is for personal use only
and shall not be self-archived in electronic
repositories. If you wish to self-archive your
work, please use the accepted authorâ€™s
version for posting to your own website or
your institutionâ€™s repository. You may further
deposit the accepted authorâ€™s version on a
funderâ€™s repository at a funderâ€™s request,
provided it is not made publicly available until
12 months after publication.
142 Y.-D. Lyuu, H.W. Teng
are the first in the literature. Numerical experiments show that our method gives un-
biased Greeks for several popular multi-asset options (also called rainbow options)
and a path-dependent option.
Keywords Option pricing Â· Rainbow options Â· Path-dependent options Â· Monte
Carlo simulation Â· Greeks Â· Importance sampling
Mathematics Subject Classification (2000) 65C05 Â· 65D25 Â· 65L12
JEL Classification C02 Â· C15 Â· G13
1 Introduction
An option is a financial instrument whose payoff is based on other underlying as-
sets such as stocks, indices, currencies, volatilities, commodities, bonds, mortgages,
other derivatives, temperatures, and countless others. Besides an optionâ€™s price, its
Greeks are equally important. Greeks are the priceâ€™s sensitivities with respect to cer-
tain parameters of interest such as the underlying assetâ€™s price, volatility, maturity,
and interest rate. Although an optionâ€™s price can often be observed in the market, this
is not the case for its Greeks, which must be calculated. As Greeks are important for
measuring and managing risk as well as executing dynamic trading strategies, how to
calculate them efficiently and accurately is of critical importance both in theory and
in practice [4].
Let us use C to denote an optionâ€™s price, S the underlying assetâ€™s spot price,
Ïƒ the volatility, T the time to maturity, and r the risk-free interest rate. Com-
mon Greeks are delta (Î” = âˆ‚C/âˆ‚S), gamma (Î“ = âˆ‚2C/âˆ‚S2), vega (Î› = âˆ‚C/âˆ‚Ïƒ ),
theta (Î˜ = âˆ‚C/âˆ‚T ), and rho (Ï = âˆ‚C/âˆ‚r). For multi-asset options (also called rain-
bow options), cross-gammas Î“ij = âˆ‚2C/âˆ‚Siâˆ‚Sj , where Si and Sj are different un-
derlying assets, are also important. Note that some Greeks are first-order partial deriv-
atives, whereas others such as gamma and cross-gamma are second-order ones.
Easy-to-calculate closed-form formulas are rare for rainbow options; as a result,
numerical methods are indispensable for calculating their prices and Greeks. See
Table 1 for a variety of rainbow options in the literature. Deterministic numerical
methods for rainbow options such as numerical integration and PDE-related meth-
ods suffer from the curse of dimensionality in that the computational complexity
grows exponentially with the dimension. They are hence computationally infeasible.
A few methods deal with the curse of dimensionality for a certain type of rainbow
options, such as the closed-form approximation formulas of Kirk [16] and Carmona
and Durrleman [5] for spread options and the method of HÃ¶rfelt [12] for options on
the kth ranked asset. However, these methods are quite restrictive in their domains
of applicability and their Greeks are biased in general. As a result, Monte Carlo sim-
ulation has proved to be the most important general-purpose numerical scheme for
pricing rainbow options [2, 10].
Simulation methods for estimating the Greeks fall into two broad categories: meth-
ods that involve resimulation and those that do not. The first category, based on
Author's personal copy
144 Y.-D. Lyuu, H.W. Teng
Although FD approximations are straightforward, they have one severe weakness
in that deciding on the right h is difficult. If h is too large, the Greek estimate would
be biased because of the nonlinearity of C(Î¸). When C(Î¸) is differentiable, FD ap-
proximations should be expected to converge to the true value with h small enough.
However, this is not the case numerically for simulation methods. In fact, if h is too
small, the variation between the original price C(Î¸) and the perturbed prices C(Î¸ Â±h)
makes the Greek estimates unstable. Although using common random numbers in
resimulation can reduce the estimation error, the above observations remain valid
even if variance reduction techniques or stratified sampling are employed [14, 33].
Higher-order Greek estimates are in most cases numerically unstable. That higher-
order partial derivatives are estimated at a slower rate of convergence is sometimes
referred to as the curse of differentiation.
Methods in the second category produce unbiased estimates but are more elabo-
rate. With the direct method of Broadie and Glasserman [4], the information from a
single simulation is used to estimate multiple Greeks besides the optionâ€™s price. The
direct method does not rely on resimulation in calculating the Greeks. Popular direct
methods include the pathwise method and the likelihood ratio method. The pathwise
method differentiates each simulated outcome with respect to the parameters of in-
terest. The likelihood ratio method, on the other hand, differentiates the probability
density function rather than the outcome.
Although the domains of applicability of the pathwise method and the likelihood
ratio method overlap, no method dominates the other. When both apply, the path-
wise method generally enjoys lower variances. Unfortunately, the applicability of the
pathwise method is limited by the requirement of Lipschitz-continuity in the pay-
off function, which is needed for convergence guarantees. Although the likelihood
ratio method can differentiate discontinuous payoff functions, it needs the explicit
formula of the density function. FourniÃ© et al. [8] apply integration-by-parts formulas
to derive the Greeks using Malliavin calculus. This approach avoids differentiating a
discontinuous payoff function and deriving the densities for the underlying securities.
Greeks are the expectations of the product of the payoff function and the Malliavin
weighting function. Benhamou [1] further bridges the Malliavin weighting method
and the likelihood ratio method. It is shown that the likelihood ratio is the weighting
function with the smallest total variance.
Several approaches have been proposed to extend the pathwise method to lift
the requirement of Lipschitz-continuity. For example, the conditional Monte Carlo
method is a very general scheme to smooth the discontinuous integrand by condi-
tioning on some random variables [9]. However, the conditional Monte Carlo method
is problem-dependent and may be difficult to implement, particularly for higher-order
Greeks. In contrast, we provide a new mathematical formulation so that the Greeks
can be derived systematically as long as the payoff function belongs to the class C
defined later. Recently, Liu and Hong extend the pathwise method to options with
discontinuous payoff functions [18]. However, our Greek estimates are unbiased and
efficient, while their kernel estimates are biased and may suffer from slow conver-
gence rates.
We now briefly summarize our approach as follows. An optionâ€™s price equals the
discounted expected value of its payoff function under the risk-neutral probability
Author's personal copy
146 Y.-D. Lyuu, H.W. Teng
Above, || denotes the determinant of . This paper uses n to denote the number
of underlying assets. Let Î¸ denote a parameter of interest throughout this paper. The
indicator function 1A(x) is a function from n to {1,0} with a subset A âŠ† n such
that
1A(x) =
{
1, for x âˆˆ A,
0, otherwise.
To simplify the presentation, we may simply write down the predicate defining the
set A instead of using the set-theoretical notation as above. The set A is also called
the support of the indicator function.
Let â„˜ denote the payoff function of an option. For the Blackâ€“Scholes model, the
optionâ€™s price is given by C = eâˆ’rT E[â„˜], where E denotes the expectation oper-
ator under the risk-neutral measure throughout this paper [11]. When the expecta-
tion E[â„˜] is intractable to calculate deterministically, we estimate the expected value
eâˆ’rT E[â„˜] by
1
N
eâˆ’rT
Nâˆ‘
n=1
â„˜
(
Ï‰(n)
)
,
where the N sampled paths Ï‰(1), . . . ,Ï‰(n) are drawn from a proper distribution. This
is the standard Monte Carlo method [10]. The strong law of large numbers guarantees
that the estimated number will converge to eâˆ’rT E[â„˜] with probability one when the
sample size N is large enough under very weak regularity conditions.
For a rainbow option in the Blackâ€“Scholes model, the price of each underlying
asset follows a log-normal diffusion process in the risk-neutral economy,
dSi = rSi dt + ÏƒiSi dZi, for i = 1, . . . , n,
where
Si = the current price of asset i,
r = the risk-free interest rate,
Ïƒi = the volatility of asset i,
dZi = the Wiener process,
Ïij = the instantaneous correlation between dZi and dZj .
Let Si(T ) denote the price of asset i at maturity and ST denote the asset prices at
maturity, i.e., ST = (S1(T ), . . . , Sn(T )). By the log-normality of ST ,
Si(T ) = Sie(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi , x âˆ¼ Nn(0,), i = 1, . . . , n, (2.1)
where the correlation matrix is defined as  = [Ïij ] with Ïij being the instantaneous
correlation between dZi and dZj , and x is the underlying randomness driving the
transition from the initial stock prices to the stock prices at maturity. Note that Si(T )
Author's personal copy
148 Y.-D. Lyuu, H.W. Teng
If it is again valid to interchange the order of expectation and differentiation in the
right-hand side of (2.6), we have
âˆ‚2
âˆ‚Î¸2
eâˆ’rT E[â„˜] = eâˆ’rT E
[
âˆ‚2â„˜
âˆ‚Î¸2
]
by (2.5). In this case, a gamma equals the delta of a delta. Exactly the same argument
can be repeated for cross-gammas and higher-order Greeks.
Broadie and Glasserman [4] establish a set of conditions on â„˜ for (2.5) to hold,
which yields the pathwise method. Loosely speaking, the order of differentiation
and expectation can be interchanged for Lipschitz-continuous payoff functions. The
pathwise method, however, may not be applicable when the payoff function is not
Lipschitz-continuous. Indeed, many payoff functions are not Lipschitz-continuous.
The payoff function of a digital option, for example, is not Lipschitz-continuous. The
pathwise method is even less applicable to calculating the gammas [4]. For example,
the European call optionâ€™s price is
eâˆ’rT
âˆ«

(
S(T ) âˆ’ K)1{S(T )>K}(x)f
(
x;0, Ïƒ 2)dx,
where S(T ) = Se(râˆ’Ïƒ 2/2)T +Ïƒ
âˆš
T x with x âˆ¼ N(0, Ïƒ 2). Since the integrand above is
Lipschitz-continuous with respect to S, its delta can be derived by the pathwise
method as
eâˆ’rT
âˆ«

e(râˆ’Ïƒ 2/2)T +Ïƒ
âˆš
T x1{S(T )>K}(x)f
(
x;0, Ïƒ 2)dx.
As the integrand above is no longer Lipschitz-continuous, the pathwise method can-
not be used to derive the gamma of the call option without undergoing some mod-
ifications. In this case, Greeks with the pathwise method do not yield to a simple,
unified treatment.
One salient feature of an optionâ€™s payoff is that a positive cash flow occurs only
when the underlying assetâ€™s prices meet certain conditions, which is the reason it
is called a contingent claim. For example, a vanilla call option pays off only when
the stock price at maturity is higher than the strike price K . As a result, its payoff
function is
max
(
S(T ) âˆ’ K,0) = (S(T ) âˆ’ K) Ã— 1{S(T )âˆ’K>0}(x),
which is a product of a differentiable function and an indicator function. Recall that
S(T ) = Se(râˆ’Ïƒ 2/2)T +Ïƒ
âˆš
T x
, where x âˆ¼ N(0,1). With g(Î¸, x) := S(T ) âˆ’ K , where
Î¸ is the parameter of interest, the support {S(T ) âˆ’ K > 0} of the indicator function
becomes {g(Î¸, x) > 0}. The options studied in this paper will undergo similar trans-
formations.
We now formalize the above-mentioned transformation. Given any function
h(Î¸,x) with pdf f (x) for x, let hÎ¸ (Î¸,x) denote the partial differentiation of h(Î¸,x)
with respect to Î¸ . Recall that xk is the kth component of x. We define a class of
functions called Hk such that h(Î¸,x) âˆˆ Hk if
Author's personal copy
150 Y.-D. Lyuu, H.W. Teng
kind of support. Although we may later refer to a payoff function being in C , it is
merely a looseâ€”albeit convenientâ€”expression because the definition of C involves
not only the payoff function but also the distribution of x as well. For an option with a
payoff function â„˜(Î¸,x) âˆˆ C , we shall show how to differentiate its price with respect
to Î¸ in the next section.
We remark that Lipschitz-continuity appears to be a subset of C under most cir-
cumstances of practical importance. More specifically, the domains of Lipschitz-
continuity and C overlap, but do not have any inclusion relation. Lipschitz-continuity
imposes stronger conditions than C in that it requires a function to be continuous.
On the other hand, C imposes stronger conditions than Lipschitz-continuity in that
it allows a function to be nondifferentiable on a set containing only a finite number
of points, whereas Lipschitz-continuity allows a function to be nondifferentiable on
a set with measure zero. Recall that a set containing only a finite number of points
clearly has measure zero.
Although the focus of this paper is on Greeks under the Blackâ€“Scholes model, our
method is applicable to different underlying models. For instance, if the underlying
asset price follows a general diffusion process dSt = Î¼(t, St ) + Ïƒ(t, St )dZt where
dZt is the Wiener process, then S may need to be simulated using a discretization
scheme, e.g., the Euler scheme
Sti+1 = Sti + Î¼(ti, Sti )
t + Ïƒ(ti , Sti )
âˆš

txi+1, (2.8)
for i = 0,1, . . . , n âˆ’ 1. Replacing Î¼(ti, Sti )
t by Î¼i and Ïƒ(ti , Sti )
âˆš

t by Ïƒi for
brevity, we can write (2.8) as Sti+1 = Sti +Î¼i + Ïƒixi+1. By the recursive formula, we
have that
Stn = Stnâˆ’1 + Î¼nâˆ’1 + Ïƒnâˆ’1xn = S0 + Î¼0 + Â· Â· Â· + Î¼nâˆ’1 + Ïƒ0x1 + Â· Â· Â· + Ïƒnâˆ’1xn
is strictly increasing in xn. For illustration, consider a European call option having
payoff function â„˜(Î¸,x) = h(Î¸,x)1{g(Î¸,x)}(x), where h(Î¸,x) = S(T ) âˆ’ K = Stn âˆ’ K
and g(Î¸,x) = h(Î¸,x) with x = (x1, . . . , xn) having pdf f (x). Clearly, g(Î¸,x) is
strictly monotone in xn; hence, as long as (1) h(Î¸,x) belongs in Hn, (2) g(Î¸,x)
belongs to Gn, and (3)
âˆ«
n
âˆ£âˆ£âˆ£âˆ£h(Î¸,x)
âˆ‚g(Î¸,x)/âˆ‚Î¸
âˆ‚g(Î¸,x)/âˆ‚xn
âˆ£âˆ£âˆ£âˆ£f (x) dx < âˆ,
the payoff function â„˜(Î¸,x) belongs to C . This example shows that our method is
applicable to a general diffusion process, such as the CIR model and the CEV model,
as they are special cases of the general diffusion process [6, 7, 27]. To be sure, our
method is also applicable to path-dependent options if their payoff functions lie in C .
3 Fundamental theorems
In Theorem 3.1, we show how to differentiate an integral whose integrand is a product
of a function h(Î¸, x) âˆˆ H, a pdf f (x) for x, and indicator functions whose supports
are of the form {gj (Î¸, x) > 0}, where gj (Î¸, x) âˆˆ G for j âˆˆ B, a finite set of natural
numbers.
Author's personal copy
152 Y.-D. Lyuu, H.W. Teng
Proof See Appendix B. 
Differentiating an n-dimensional integral in Theorem 3.2 yields an n-dimensional
integral and several (n âˆ’ 1)-dimensional integrals with the component xk removed
(see (3.3)). Since the n-dimensional integral equals
âˆ«
n
hÎ¸ (Î¸,x)
âˆ
jâˆˆB
1{gj (Î¸,x)>0}(x)f (x) dx = E
[
hÎ¸ (Î¸,x)
âˆ
jâˆˆB
1{gj (Î¸,x)>0}(x)
]
, (3.5)
it can in principle be estimated using the Monte Carlo method. Estimating each
âˆ«
nâˆ’1
[
h(Î¸,x)J(Î¸,x)
âˆ
jâˆˆB\{}
1{gj (Î¸,x)>0}(x)f (x)
]
xk=Ï‡(Î¸,xk)
dxk (3.6)
in (3.3) can be a major challenge for the following reasons, however. The crude Monte
Carlo method estimates (3.6) as follows:
1. Draw N sample paths x(1)k , . . . , x
(N)
k uniformly over nâˆ’1.
2. Approximate (3.6) by 1
N
âˆ‘N
n=1 p1(x
(n)
k ), where
p1(xk) :=
[
h(Î¸,x)J(Î¸,x)
âˆ
jâˆˆB\{}
1{gj (Î¸,x)>0}(x)f (x)
]
xk=Ï‡(Î¸,xk)
.
Two difficulties arise with the above procedure. For step one, it is difficult to draw xk
uniformly over nâˆ’1 directly, which is unbounded. For step two, the estimate may be
inefficient in that it may have a very large variance, which demands more replications.
To overcome these difficulties, we next provide an alternative form of (3.6) using a
distribution for xk with pdf q(xk). When q(xk) has support nâˆ’1, (3.6) equals
âˆ«
nâˆ’1
[
h(Î¸,x)J(Î¸,x)
âˆ
jâˆˆB\{}
1{gj (Î¸,x)>0}(x)
f (x)
q(xk)
]
xk=Ï‡(Î¸,xk)
q(xk) dxk
= Eq
[[
h(Î¸,x)J(Î¸,x)
âˆ
jâˆˆB\{}
1{gj (Î¸,x)>0}(x)
f (x)
q(xk)
]
xk=Ï‡(Î¸,xk)
]
= Eq
[[
h(Î¸,x)J(Î¸,x)
âˆ
jâˆˆB\{}
1{gj (Î¸,x)>0}(x)
]
xk=Ï‡(Î¸,xk)
Î·Ëœ(Î¸,xk)
]
, (3.7)
where
Î·Ëœ(Î¸,xk) = f (x)|xk=Ï‡(Î¸,xk)
q(xk)
and xk has pdf q(x) under Eq . Mathematically speaking, the identification of (3.6)
with (3.7) is a change of measure, and it forms the theoretical basis of the importance
sampling method in the following sense: To estimate (3.6), we sample xk from an
easy-to-sample sampling distribution with pdf q(xk). We now estimate (3.6) using
(3.7) as follows:
Author's personal copy
154 Y.-D. Lyuu, H.W. Teng
where
Î·Ëœ(Î¸,xk) = f (x;0,)|xk=Ï‡(Î¸,xk)
q(xk)
,
J(Î¸,x) equals (3.4), and xk has pdf q(xk) under Eq .
Proof Because
E
[
â„˜(Î¸,x)
] =
âˆ«
n
h(Î¸,x)
âˆ
jâˆˆB
1{gj (Î¸,x)>0}(x)f (x;0,) dx,
âˆ‚E[â„˜(Î¸,x)]/âˆ‚Î¸ equals the right-hand side of (3.3) except that x has pdf f (x;0,)
by Theorem 3.2. Applying (3.5) and (3.7), (3.8) is proved. 
Now, first-order Greeks can be derived if the payoff function â„˜ belongs to C . To
derive Greeks like delta, vega, and theta, simply apply the corresponding theorem
with Î¸ = S, Î¸ = Ïƒ , and Î¸ = T , respectively. To derive rho, apply the corresponding
theorem with Î¸ = r via
âˆ‚
âˆ‚r
eâˆ’rT E[â„˜] = âˆ’T eâˆ’rT E[â„˜] + eâˆ’rT âˆ‚
âˆ‚r
E[â„˜].
Alternatively, it is well known that
Î˜ + r
nâˆ‘
i=1
SiÎ”i + 12
nâˆ‘
i=1
nâˆ‘
j=1
ÏijÏƒiÏƒjSiSjÎ“ij = rC,
which provides a numerical approach to deriving theta using deltas, gammas, and
cross-gammas. See Cox et al. [7] and Boyle et al. [3] for details. Note that the right-
hand side of (3.3) is a formula for first-order Greeks. When a closed-form formula
for Ï‡(Î¸,x) exists, we simply plug Ï‡(Î¸,xk) into xk . If a closed-form formula does
not exist, we can plug into xk a numerical solution using, say, the Newtonâ€“Raphson
method. As a result, we only require the existence of Ï‡(Î¸,xk) when calculating first-
order Greeks.
The second-order Greek is obtained by applying our theorems again to the corre-
sponding first-order Greek. A closed-form formula for Ï‡(Î¸,xk) is required to calcu-
late the second-order Greeks for the most general case. However, (3.3) can be much
simplified before applying differentiation to obtain second-order Greeks when its sec-
ond term reduces to zero (as in the deltas of spread options and maximum options
shown later). When this is the case, we only need to differentiate
âˆ«
Rn
hÎ¸ (Î¸,x)
âˆ
jâˆˆB
1{gj (Î¸,x)>0}(x)f (x) dx (3.9)
of (3.3), and this reduces to the case of deriving first-order Greeks and is solved by
applying Theorem 3.2 again. In this case, the existence of Ï‡(Î¸,xk) is sufficient (i.e.,
closed-form formulas for Ï‡(Î¸,xk) are not needed). As a remark, when differentiating
Author's personal copy
156 Y.-D. Lyuu, H.W. Teng
f (x;0,) for x and g(Î¸,x) is increasing in Î¸ and x2. Let
Ï‡(Î¸,x2) =
log S1e
(râˆ’Ïƒ21 /2)T +Ïƒ1
âˆš
T x1+K
S2
âˆ’ (r âˆ’ Ïƒ 22 /2)T
Ïƒ2
âˆš
T
. (4.1)
It is easy to verify that g(Î¸,x)|x2=Ï‡(Î¸,x2) = 0; hence g(Î¸,x) âˆˆ G2. We conclude that
â„˜(Î¸,x) âˆˆ C .
Theorem 4.1 The delta, gamma and cross-gamma of the spread option equal
Î”1 = eâˆ’rT E
[âˆ’S1(T )1{S2(T )âˆ’S1(T )âˆ’K>0}
(
S(T )
)]
/S1,
Î“11 = eâˆ’rT Eq
[
e2((râˆ’Ïƒ 21 /2)T +Ïƒ1
âˆš
T x1)âˆ’((râˆ’Ïƒ 22 /2)T +Ïƒ2
âˆš
T Ï‡(Î¸,x2))Î·Ëœ(Î¸,x2)
]
/(S2Ïƒ2
âˆš
T ),
Î“12 = âˆ’eâˆ’rT Eq
[
e(râˆ’Ïƒ 21 /2)T +Ïƒ1
âˆš
T x1 Î·Ëœ(Î¸,x2)
]
/(S2Ïƒ2
âˆš
T ),
respectively, where Ï‡(Î¸,x2) is defined in (4.1), Î·Ëœ(Î¸,x2) is defined in (9.1), and x2 has
pdf q(xk) = f (x2;0,1) under Eq .
Proof See Appendix C. 
4.2 Greeks of maximum options
We now derive the Greeks of the maximum option. Let B = {1, . . . , n} throughout
this section. By conditioning on which asset ends up as the maximum terminal price,
the payoff function can be decomposed into
â„˜ = max(max(S1(T ), . . . , Sn(T )
) âˆ’ K,0)
=
âˆ‘
iâˆˆB
(
Si(T ) âˆ’ K
)
1{Si(T )>K}(ST )
âˆ
jâˆˆB\{i}
1{Si(T )>Sj (T )}(ST ).
Maximum options depend on the maximum stock price at maturity, and minimum op-
tions depend on the minimum stock price. Stulz [30] derives formulas for maximum
and minimum options on two risky assets and Johnson [15] generalizes these formu-
las to options on several assets. Maximum and minimum options are commonly used
in compensation plans, risk-sharing contracts, collateralized loans and secured debts,
indexed wages and option bonds [30].
Using (2.1) to generate ST and defining
hi(Î¸,x) = Sie(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi âˆ’ K for i âˆˆ B, (4.2)
gii(Î¸,x) = Sie(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi âˆ’ K for i âˆˆ B, (4.3)
gij (Î¸,x) = Sie(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi âˆ’ Sj e(râˆ’Ïƒ 2j /2)T +Ïƒi
âˆš
T xj
for i âˆˆ B, j âˆˆ B\{i}, (4.4)
Author's personal copy
158 Y.-D. Lyuu, H.W. Teng
Proof See Appendix D. 
4.3 Greeks of binary maximum options
To illustrate the applicability of our approach for an option with a non-Lipschitz-
continuous payoff function, we consider the binary maximum option with the pay-
off function â„˜ = 1{max(S1(T ),...,Sn(T ))>K}. Define gii(Î¸,x) for i âˆˆ B as in (4.3) and
gij (Î¸,x) for i âˆˆ B, j âˆˆ B\{i} as in (4.4). The payoff function can be written as
â„˜(Î¸,x) =
âˆ‘
iâˆˆB
âˆ
jâˆˆB
1{gij (Î¸,x)>0}(x).
Define Ï‡ii(Î¸,xi ) for i âˆˆ B as in (4.6) and Ï‡ij (Î¸,xi ) for i âˆˆ B, j âˆˆ B\{i} as
in (4.7). Following similar arguments as in Sect. 4.2, we conclude that gij (Î¸,x) âˆˆ Gi
for i, j âˆˆ B and â„˜(Î¸,x) âˆˆ C . Let vi be an nÃ— 1 vector having 1 in the ith component
and 0 elsewhere, and let xij be the vector x with xi and xj removed.
Theorem 4.3 The delta, gamma and cross-gamma of the binary maximum option on
n assets are
Î”i = eâˆ’rT Eq
[ âˆ
jâˆˆB\{i}
1
{Sj e(râˆ’Ïƒ
2
j
/2)T +Ïƒj
âˆš
T xj <K}
(x)Î·Ëœii (Î¸,xi )
]/(
SiÏƒi
âˆš
T
)
,
Î“ii = eâˆ’rT Eq
[(âˆ’1
Si
+ vi
tâˆ’1xËœi + xËœtiâˆ’1vi
2SiÏƒi
âˆš
T
)
Ã—
âˆ
jâˆˆB\{i}
1
{Sj e(râˆ’Ïƒ
2
j
/2)T +Ïƒj
âˆš
T xj <K}
(xi )Î·Ëœii (xi )
]/(
SiÏƒi
âˆš
T
)
,
Î“ij = âˆ’eâˆ’rT Eq,j
[ âˆ
âˆˆB\{i,j}
1{Se(râˆ’Ïƒ
2

/2)T +Ïƒ
âˆš
T x<K}(xij )
Ã—Î·Ëœii,j (Î¸,xij )f (Ï‡jj (Î¸);0,1)
]/(
SiSjÏƒiÏƒjT
)
,
where xËœi is defined in (11.2), Î·Ëœii,j (Î¸,xij ) is defined in (11.3), Ï‡jj (Î¸) abbreviates
Ï‡ii(Î¸,xi ) in (4.6), xi has pdf f (xi;0, Inâˆ’1) under Eq for i âˆˆ B, and xij has pdf
f (xij ;0, Inâˆ’2) under Eq,j for j âˆˆ B\{i}.
Proof See Appendix E. 
4.4 Greeks of barrier options
There are two broad types of barrier options: the knock-out type, which knocks out
when the barrier is touched, and the knock-in type, which comes to exist only after
the barrier is touched. A barrier option is clearly cheaper than an otherwise identi-
cal vanilla option. Partly because of this property, the barrier feature is frequently
incorporated into derivative contracts.
Author's personal copy
160 Y.-D. Lyuu, H.W. Teng
Ã—
âˆ
iâˆˆB\{}
1{Ï‡(Î¸,x1)>Ï‡i(Î¸,x1)}(x1) Î·Ëœ(Î¸,x1)
]/(
SÏƒ
âˆš

t
)
+ (H âˆ’ K)Eq
[ âˆ
iâˆˆB\{m}
1{Ï‡m(Î¸,x1)>Ï‡i(Î¸,x1)}(x1) Î·Ëœm(Î¸,x1)
]/(
SÏƒ
âˆš

t
)
}
,
Î“ = eâˆ’rT
{
mâˆ’1âˆ‘
=1
Eq
[(
Ï‡(Î¸,x1)(He(râˆ’Ïƒ
2/2)(mâˆ’)
t+Ïƒâˆš
t(x+1+Â·Â·Â·+xm) âˆ’ K)
Ïƒ
âˆš

t
+ K
)
Ã—
âˆ
iâˆˆB\{}
1{Ï‡(Î¸,x1)>Ï‡i(Î¸,x1)}(x)Î·Ëœ(Î¸,x1)
]
+ Eq
[(
Ï‡m(Î¸,x1)(H âˆ’ K)
Ïƒ
âˆš

t
+ K
) âˆ
iâˆˆB\{m}
1{Ï‡m(Î¸,x1)>Ï‡i(Î¸,x1)}(x) Î·Ëœm(Î¸,x1)
]
+ KEq
[ âˆ
iâˆˆB\{m+1}
1{Ï‡m+1(Î¸,x1)>Ï‡i(Î¸,x1)}(x) Î·Ëœm+1(Î¸,x1)
]}/(
S2Ïƒ
âˆš

t
)
,
where Ï‡(Î¸,x1) is defined in (4.8)â€“(4.10), Î·Ëœ(Î¸,x1) is defined in (12.1), and x1 has
pdf f (x1;0, Imâˆ’1) under Eq .
Proof See Appendix F. 
4.5 Greeks of Asian options
The payoff function of the discretely monitored Asian option is
â„˜ = max(SÂ¯ âˆ’ K,0) = (SÂ¯ âˆ’ K)1{SÂ¯âˆ’K>0}(S),
where SÂ¯ = (S(t1) + Â· Â· Â· + S(tm))/m is the average stock price. Let y be a univariate
random variable which has the same distribution as
e(râˆ’Ïƒ 2/2)
t+Ïƒ
âˆš

tx1 + Â· Â· Â· + em(râˆ’Ïƒ 2/2)
t+Ïƒ
âˆš

t(x1+Â·Â·Â·+xm)
m
. (4.11)
Note that the average price SÂ¯ has the same distribution as Sy by (2.4) and the payoff
function of an Asian option can be expressed as
â„˜(Î¸, y) = (Sy âˆ’ K)1{Syâˆ’K>0}(y).
Defining h(Î¸, y) = g(Î¸, y) = Sy âˆ’ K , the payoff function can be rewritten as
â„˜(Î¸, y) = h(Î¸, y)1{g(Î¸,y)>0}(y).
We now proceed to prove that the payoff function belongs to C . Note that h(Î¸, y) âˆˆ H
with pdf f (y) for y and g(y) is increasing in y. Let Ï‡(Î¸) = K/S. It is easy to verify
that g(Î¸, y)|y=Ï‡(Î¸) = 0; hence g(Î¸, y) âˆˆ G . We conclude that â„˜(Î¸, y) âˆˆ C .
Author's personal copy
162 Y.-D. Lyuu, H.W. Teng
compares our method with various FD methods and the likelihood ratio method. Re-
call that Table 2 lists standard formulas for the forward and central FDs. The formulas
of Greeks for rainbow options using the likelihood ratio method are summarized in
Appendix G.
Tables 3, 4, 5 and 6 show the results of applying our method to spread options,
maximum options, binary maximum options, and barrier options, respectively. For
the benchmark values, we first compute their option prices, then calculate the Greeks
by central FD with h = 0.1. We use numerical integration to calculate the prices
of spread and barrier options and follow Johnson [15] in calculating the prices of
maximum and binary maximum options. These tables contain simulation results with
100,000 paths for deltas, gammas, and cross-gammas so that our method can be com-
Table 3 Greeks of spread options on two assets
h Î”1 Î“11 Î“12
Benchmark value
âˆ’0.4340 0.0414 âˆ’0.0419
Our method
âˆ’0.4346 (0.0017) 0.0414 (0.0001) âˆ’0.0419 (0.0001)
Likelihood ratio method
âˆ’0.4308 (0.0033) 0.0407 (0.0007) âˆ’0.0410 (0.0007)
Forward FD
10âˆ’1 âˆ’0.4339 (0.0016) 0.0398 (0.0017) âˆ’0.0422 (0.0017)
10âˆ’2 âˆ’0.4343 (0.0017) 0.0408 (0.0054) âˆ’0.0306 (0.0044)
10âˆ’3 âˆ’0.4349 (0.0017) 0.0476 (0.0185) âˆ’0.0215 (0.0107)
10âˆ’4 âˆ’0.4314 (0.0016) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’5 âˆ’0.4304 (0.0016) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’6 âˆ’0.4355 (0.0017) âˆ’0.0031 (0.0000) 0.0000 (0.0000)
10âˆ’7 âˆ’0.4335 (0.0016) âˆ’0.0011 (0.0012) 0.0000 (0.0000)
10âˆ’8 âˆ’0.4312 (0.0016) âˆ’0.0636 (0.1196) 0.0013 (0.0018)
10âˆ’9 âˆ’0.4338 (0.0016) âˆ’3092.6010 (16.8991) 0.2572 (0.2033)
Central FD
10âˆ’1 âˆ’0.4338 (0.0016) 0.0420 (0.0017) âˆ’0.0448 (0.0018)
10âˆ’2 âˆ’0.4351 (0.0017) 0.0415 (0.0055) âˆ’0.0541 (0.0063)
10âˆ’3 âˆ’0.4343 (0.0016) 0.0405 (0.0182) âˆ’0.0411 (0.0164)
10âˆ’4 âˆ’0.4330 (0.0016) 0.0804 (0.0804) âˆ’0.0432 (0.0432)
10âˆ’5 âˆ’0.4335 (0.0016) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’6 âˆ’0.4344 (0.0016) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’7 âˆ’0.4345 (0.0017) 0.0003 (0.0006) 0.0000 (0.0000)
10âˆ’8 âˆ’0.4321 (0.0016) âˆ’0.0085 (0.0634) 0.0006 (0.0006)
10âˆ’9 âˆ’0.4342 (0.0016) 3.4397 (6.3518) 0.0643 (0.1114)
Parameters: S1 = S2 = 40, K = 0.5, r = 10%, T = 1 year, Ïƒ1 = Ïƒ2 = 0.3, and Ï12 = Ï21 = 0.69. For
benchmark values, we obtain spread optionsâ€™ prices using numerical integrations and then calculate the
Greeks by central FD with h = 0.1. The standard errors are in parentheses. All simulation results are based
on 100,000 trials
Author's personal copy
164 Y.-D. Lyuu, H.W. Teng
Table 5 Greeks of binary maximum options on two assets
h Î”1 Î“11 Î“12
Benchmark value
0.0139 0.0004 âˆ’0.0014
Our method
0.0138 (0.0001) 0.0004 (0.0000) âˆ’0.0014
Likelihood ratio method
0.0138 (0.0003) 0.0004 (0.0000) âˆ’0.0013 (0.0000)
Forward FD
10âˆ’1 0.0147 (0.0012) âˆ’0.0081 (0.0164) 0.0000 (0.0000)
10âˆ’2 0.0190 (0.0041) 0.4524 (0.5198) 0.0000 (0.0000)
10âˆ’3 0.0090 (0.0090) âˆ’9.0484 (9.0484) 0.0000 (0.0000)
10âˆ’4 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’5 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’6 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’7 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’8 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’9 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
Central FD
10âˆ’1 0.0116 (0.0010) âˆ’0.0009 (0.0158) âˆ’0.0018 (0.0013)
10âˆ’2 0.0136 (0.0035) 0.2715 (0.5198) 0.0000 (0.0000)
10âˆ’3 0.0362 (0.0181) âˆ’18.0967 (18.0967) 0.0000 (0.0000)
10âˆ’4 0.0000 (0.0000) âˆ’904.8374 (904.8374) 0.0000 (0.0000)
10âˆ’5 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’6 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’7 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’8 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
10âˆ’9 0.0000 (0.0000) 0.0000 (0.0000) 0.0000 (0.0000)
Parameters: S1 = S2 = 40, K = 40, r = 10%, T = 1 year, Ïƒ1 = Ïƒ2 = 0.3, and Ï12 = Ï21 = 0.69. For
benchmark values, we follow Johnsonâ€™s formula to obtain binary maximum optionsâ€™ prices [15]. We then
calculate the Greeks by central FD with h = 0.1. The standard errors are in parentheses. Simulation results
are based on 100,000 trials. Since the formula for Î“12 reduces to the closed-form formula for the binary
maximum option on two assets, Monte Carlo simulation is not required and no standard error is given
FDs being approximate only. Its effectiveness is clearly demonstrated by the numer-
ical superiority to the FD methods in treating gammas and cross-gammas. Both our
method and the likelihood ratio method produce unbiased Greeks for rainbow op-
tions. However, our method produces estimates with much lower standard errors. It is
also not obvious how to apply the likelihood ratio method for path-dependent options.
5.2 A comparison of sampling distributions
In Sect. 4.2, we derive the Greeks of maximum options using the standard normal
distribution as the sampling distribution. Recall the payoff function of the maximum
Author's personal copy
166 Y.-D. Lyuu, H.W. Teng
Table 7 Comparisons of two sampling distributions
K C Î”1 Î“11 Î“12
Benchmark value
20 25.6660 0.5467 0.0420 âˆ’0.0419
30 16.8012 0.5283 0.0429 âˆ’0.0392
40 9.2682 0.4322 0.0425 âˆ’0.0286
50 4.3395 0.2786 0.0346 âˆ’0.0155
60 1.8012 0.1474 0.0225 âˆ’0.0067
70 0.6924 0.0682 0.0123 âˆ’0.0025
80 0.2547 0.0290 0.0060 âˆ’0.0009
90 0.0917 0.0117 0.0027 âˆ’0.0003
100 0.0328 0.0046 0.0012 âˆ’0.0001
110 0.0118 0.0018 0.0005 0.0000
120 0.0043 0.0007 0.0002 0.0000
Standard normal distribution
20 25.6886 (0.0400) 0.5481 (0.0019) 0.0420 (0.0000) âˆ’0.0419 (0.0000)
30 16.7924 (0.0396) 0.5295 (0.0019) 0.0429 (0.0000) âˆ’0.0391 (0.0001)
40 9.3174 (0.0347) 0.4354 (0.0020) 0.0424 (0.0001) âˆ’0.0286 (0.0001)
50 4.3002 (0.0259) 0.2807 (0.0018) 0.0346 (0.0001) âˆ’0.0154 (0.0001)
60 1.8154 (0.0175) 0.1475 (0.0015) 0.0224 (0.0001) âˆ’0.0067 (0.0001)
70 0.6874 (0.0109) 0.0668 (0.0011) 0.0123 (0.0001) âˆ’0.0025 (0.0000)
80 0.2600 (0.0067) 0.0290 (0.0008) 0.0060 (0.0000) âˆ’0.0009 (0.0000)
90 0.0840 (0.0038) 0.0120 (0.0005) 0.0027 (0.0000) âˆ’0.0003 (0.0000)
100 0.0340 (0.0025) 0.0053 (0.0004) 0.0012 (0.0000) âˆ’0.0001 (0.0000)
110 0.0131 (0.0016) 0.0015 (0.0002) 0.0005 (0.0000) 0.0000 (0.0000)
120 0.0050 (0.0010) 0.0004 (0.0001) 0.0002 (0.0000) 0.0000 (0.0000)
Normal distribution with shifted mean
20 24.6185 (2.2474) 0.5386 (0.0568) 0.0398 (0.0028) âˆ’0.0397 (0.0028)
30 16.9916 (0.2758) 0.5323 (0.0078) 0.0428 (0.0003) âˆ’0.0391 (0.0003)
40 9.2909 (0.0443) 0.4327 (0.0022) 0.0425 (0.0001) âˆ’0.0285 (0.0001)
50 4.3574 (0.0138) 0.2821 (0.0014) 0.0346 (0.0000) âˆ’0.0154 (0.0001)
60 1.7984 (0.0058) 0.1469 (0.0009) 0.0225 (0.0000) âˆ’0.0067 (0.0000)
70 0.6862 (0.0027) 0.0676 (0.0005) 0.0123 (0.0000) âˆ’0.0025 (0.0000)
80 0.2548 (0.0012) 0.0290 (0.0003) 0.0060 (0.0000) âˆ’0.0009 (0.0000)
90 0.0913 (0.0005) 0.0115 (0.0001) 0.0027 (0.0000) âˆ’0.0003 (0.0000)
100 0.0328 (0.0003) 0.0046 (0.0001) 0.0012 (0.0000) âˆ’0.0001 (0.0000)
110 0.0117 (0.0001) 0.0018 (0.0000) 0.0005 (0.0000) 0.0000 (0.0000)
120 0.0043 (0.0001) 0.0007 (0.0000) 0.0002 (0.0000) 0.0000 (0.0000)
Parameters: S1 = S2 = 40, r = 10%, T = 1 year, Ïƒ1 = Ïƒ2 = 0.3, and Ï12 = Ï21 = 0.69. For benchmark
values, we follow Johnsonâ€™s formula to obtain maximum optionsâ€™ prices [15]. We then calculate the Greeks
by central FD with h = 0.1. The standard errors are in parentheses. Simulation results are based on 100,000
trials
Author's personal copy
168 Y.-D. Lyuu, H.W. Teng
Î“ij = âˆ’eâˆ’rT Eqs
[
e
(râˆ’Ïƒ 2j /2)T +Ïƒj
âˆš
T xj 1
{Sj e(râˆ’Ïƒ
2
j
/2)T +Ïƒj
âˆš
T xj >K}
(xi )
Ã—
âˆ
âˆˆB\{j,i}
1
{Sj e(râˆ’Ïƒ
2
j
/2)T +Ïƒj
âˆš
T xj >Se
(râˆ’Ïƒ2

/2)T +Ïƒ
âˆš
T x }
(xi )Î·Ëœ
s
ij (Î¸,xi )
]/(
SiÏƒi
âˆš
T
)
,
where Ï‡ij (Î¸,xi ) is defined in (4.6) and (4.7), Ï‡ii(Î¸) abbreviates Ï‡ii(Î¸,xi ),
Î·s(x) = f (x;0,)
f (x;Î¼,) ,
Î·Ëœsij (x) =
f (x;0,)
f (xi;Î¼i , Inâˆ’1)
âˆ£âˆ£âˆ£âˆ£
xi=Ï‡ij (Î¸,xi )
.
Moreover, Es is the expectation operator of x, under which x has pdf f (x,Î¼,) with
Î¼ = [Ï‡11(Î¸), . . . , Ï‡nn(Î¸)]t . Eqs is the expectation operator of xi , under which xi has
pdf f (xi;Î¼i , Inâˆ’1) with Î¼i = [Ï‡11(Î¸), . . . , Ï‡iâˆ’1,iâˆ’1(Î¸),Ï‡i+1,i+1(Î¸), . . . , Ï‡nn(Î¸)]t
for i âˆˆ B.
Table 7 compares the numerical results of the Greeks of the maximum option using
the standard normal and the shifted normal as the sampling distributions for strike
prices ranging from 20 to 120. The range of strike prices covers deep in-the-money
and deep out-of-the-money options. The Greek formulas from Theorem 4.2 and 5.1
both give unbiased Greek estimates. Numerical results show that using the shifted
normal as the sampling distribution can improve the Greek estimates for deep out-
of-the-money options in terms of accuracy and standard error, whereas the standard
normal works well for at-the-money and in-the-money options.
6 Conclusions
Mathematically, Greeks are partial differentiations of an optionâ€™s price with respect
to a parameter of interest. For complex options such as rainbow and path-dependent
options, there are usually no analytic formulas for their prices; hence Monte Carlo
simulation is often the only available method to estimate them. The FD method is
subsequently used to approximate the Greeks. But FD as an approximate differen-
tiation operator can be rather unstable and biased. Two direct methods, the path-
wise method and the likelihood ratio method, have been proposed to overcome the
drawbacks of FD. However, the Greeks of options whose payoff functions are not
Lipschitz-continuous cannot be obtained using the pathwise method without modifi-
cations if convergence is to be guaranteed.
The major theoretical advantage of our method over the pathwise method is a
new mathematical formulation so that the Lipschitz-continuity restriction on the pay-
off function is lifted. We present a rule to interchange the order of integration and
differentiation when the integrand can be decomposed into a sum of products of dif-
ferentiable functions and certain indicator functions. As a result, the Greek formulas
of a wide variety of options can be derived systematically. For practical purposes,
we propose a useful importance sampling method to estimate these Greeks using the
Author's personal copy
170 Y.-D. Lyuu, H.W. Teng
On the other hand, when  is R or L, it is clear that
âˆ
jâˆˆB\{j} {x : gj (Î¸, x) > 0} dom-
inates IR âˆ© IL, and hence
[ âˆ
jâˆˆB\{j}
1{gj (Î¸,x)>0}
]
x=Ï‡(Î¸)
= 1.
As a result, we only need to prove the reduced formula for (3.1),
âˆ‚
âˆ‚Î¸
âˆ«

f (Î¸, x)1{gR(Î¸,x)>0}(x)1{gL(Î¸,x)>0}(x) dx
=
âˆ«

fÎ¸ (Î¸, x)1{gR(Î¸,x)>0}(x)1{gL(Î¸,x)>0}(x) dx
+ [f (Î¸, x)JL(Î¸, x)
]
x=Ï‡L(Î¸) +
[
f (Î¸, x)JR(Î¸, x)
]
x=Ï‡R(Î¸). (7.1)
Note that the left-hand side of (7.1) equals
âˆ‚
âˆ‚Î¸
âˆ« Ï‡L(Î¸)
Ï‡R(Î¸)
f (Î¸, x) dx =
âˆ« Ï‡L(Î¸)
Ï‡R(Î¸)
fÎ¸ (Î¸, x)dx + f
(
Î¸,Ï‡L(Î¸)
)âˆ‚Ï‡L(Î¸)
âˆ‚Î¸
âˆ’ f (Î¸,Ï‡R(Î¸)
)âˆ‚Ï‡R(Î¸)
âˆ‚Î¸
(7.2)
by the Leibniz rule, where the partial differentiation of Ï‡(Î¸) with respect to Î¸ can be
calculated alternatively as
âˆ‚Ï‡(Î¸)
âˆ‚Î¸
= âˆ’
[
âˆ‚gj (Î¸, x)/âˆ‚Î¸
âˆ‚gj (Î¸, x)/âˆ‚x
]
x=Ï‡(Î¸)
,  âˆˆ B,
by the implicit function theorem. Recall that (3.2) defines
J(Î¸, x) = sign
(
âˆ‚g(Î¸, x)
âˆ‚x
)
âˆ‚g(Î¸, x)/âˆ‚Î¸
âˆ‚g(Î¸, x)/âˆ‚x
,  âˆˆ B.
Now, it is clear that (7.2) equals
âˆ« Ï‡L(Î¸)
Ï‡R(Î¸)
fÎ¸ (Î¸, x) dx âˆ’ f
(
Î¸,Ï‡L(Î¸)
)âˆ‚gL(Î¸, x)/âˆ‚Î¸
âˆ‚gL(Î¸, x)/âˆ‚x
+ f (Î¸,Ï‡R(Î¸)
)âˆ‚gR(Î¸, x)/âˆ‚Î¸
âˆ‚gR(Î¸, x)/âˆ‚x
=
âˆ«

fÎ¸ (Î¸, x)1
{
gR(Î¸, x) > 0
}
(x)1
{
gL(Î¸, x) > 0
}
(x) dx
âˆ’ f (Î¸,Ï‡L(Î¸)
)âˆ‚gL(Î¸, x)/âˆ‚Î¸
âˆ‚gL(Î¸, x)/âˆ‚x
+ f (Î¸,Ï‡R(Î¸)
)âˆ‚gR(Î¸, x)/âˆ‚Î¸
âˆ‚gR(Î¸, x)/âˆ‚x
=
âˆ«

fÎ¸ (Î¸, x)1{gR(Î¸,x)>0}(x)1{gL(Î¸,x)>0}(x) dx
+ [f (Î¸, x)JL(Î¸, x)
]
x=Ï‡L(Î¸) +
[
f (Î¸, x)JR(Î¸, x)
]
x=Ï‡R(Î¸)
which is exactly the right-hand side of (7.1). Hence, the proof of (3.1) for case 1 is
done. The proofs for cases 2, 3, and 4 are similar and therefore omitted. 
Author's personal copy
172 Y.-D. Lyuu, H.W. Teng
= lim
mâ†’âˆ
âˆ«
nâˆ’1
qm(xk) dxk =
âˆ«
nâˆ’1
q(xk) dx = RHS of (3.3).
We now prove that there exists an integrable function p(xk) such that
|qm(xk)| â‰¤ p(xk) for all m. We only need to prove the case when B contains only one
member; the proofs for other cases are similar. Without loss of generality, assume
âˆ‚g(Î¸,x)/âˆ‚Î¸ > 0 and âˆ‚g(Î¸,x)/âˆ‚xk > 0. Also assume that h(Î¸,x) and hÎ¸ (Î¸,x) are
increasing in Î¸ and xk . Let a = Ï‡(Î¸,xk) and bm = Ï‡(Î¸ + hm,xk). Since hm â†’ 0,
|hm| < 1 for m large enough. Note that f (Î¸,x) and fÎ¸ (Î¸,x) are nondecreasing in Î¸
and we may assume that f (Î¸,x) is nondecreasing in xk for xk âˆˆ [bm,a] without loss
of generality. For sufficiently large m,
âˆ£âˆ£qm(xk)
âˆ£âˆ£ =
âˆ£âˆ£âˆ£âˆ£
âˆ« a
bm
f (Î¸ + hm,x)
hm
dxk +
âˆ« âˆ
a
f (Î¸ + hm,x) âˆ’ f (Î¸,x)
hm
dxk
âˆ£âˆ£âˆ£âˆ£
â‰¤
âˆ£âˆ£âˆ£âˆ£
âˆ« a
bm
f (Î¸ + hm,x)
hm
dxk
âˆ£âˆ£âˆ£âˆ£ +
âˆ£âˆ£âˆ£âˆ£
âˆ« âˆ
a
f (Î¸ + hm,x) âˆ’ f (Î¸,x)
hm
dxk
âˆ£âˆ£âˆ£âˆ£
â‰¤
âˆ£âˆ£âˆ£âˆ£f (Î¸ + 1, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
(
a âˆ’ bm
hm
)âˆ£âˆ£âˆ£âˆ£
+
âˆ£âˆ£âˆ£âˆ£
âˆ« âˆ
a
fÎ¸ (Î¸ + 1,x) dxk
âˆ£âˆ£âˆ£âˆ£.
Taylor expansion gives
a âˆ’ bm = gÎ¸ (Î¸, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
gxk (Î¸, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
hm + O
(
h2m
)
.
As a result, if m is large enough,
âˆ£âˆ£âˆ£âˆ£
a âˆ’ bm
hm
âˆ£âˆ£âˆ£âˆ£ â‰¤
âˆ£âˆ£âˆ£âˆ£
gÎ¸ (Î¸, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
gxk (Î¸, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
âˆ£âˆ£âˆ£âˆ£ + 1.
To bound qm(xk), we choose p(xk) as
p(xk) =
âˆ£âˆ£f (Î¸ + 1, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
âˆ£âˆ£
Ã—
(âˆ£âˆ£âˆ£âˆ£
gÎ¸ (Î¸, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
gxk (Î¸, x1, . . . , xkâˆ’1, a, xk+1, . . . , xn)
âˆ£âˆ£âˆ£âˆ£ + 1
)
+
âˆ£âˆ£âˆ£âˆ£
âˆ« âˆ
Ï‡(Î¸,xk)
fÎ¸ (Î¸ + 1,x) dxk
âˆ£âˆ£âˆ£âˆ£,
which is integrable by the assumptions on f (Î¸,x) and g(Î¸,x). 
Author's personal copy
174 Y.-D. Lyuu, H.W. Teng
Note that gij (Î¸,x) âˆˆ Gi , gli(Î¸,x) âˆˆ Gi ,
sign
(
âˆ‚gij (Î¸,x)
âˆ‚xi
)
âˆ‚gij (Î¸,x)/âˆ‚Si
âˆ‚gij (Î¸,x)/âˆ‚xi
= 1
SiÏƒi
âˆš
T
for i, j âˆˆ B, (10.2)
sign
(
âˆ‚gi(Î¸,x)
âˆ‚xi
)
âˆ‚gi(Î¸,x)/âˆ‚Si
âˆ‚gi(Î¸,x)/âˆ‚xi
= âˆ’ 1
SiÏƒi
âˆš
T
for  âˆˆ B\{i}. (10.3)
Let
Î·i(Î¸,x) = f (x;0,)/f (xi;0, Inâˆ’1) for i âˆˆ B. (10.4)
Apply Theorem 3.3 to obtain
Î”i = eâˆ’rT
{
E
[
e(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi
âˆ
jâˆˆB
1{gij (Î¸,x)>0}(x)
]
+ Eq
[
hi(Î¸,x)
1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{i}
1{gij (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡ii (Î¸,xi )
+
âˆ‘
âˆˆB\{i}
Eq
[
hi(Î¸,x)
1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{}
1{gij (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡i(Î¸,xi )
+
âˆ‘
âˆˆB\{i}
Eq
[
h(Î¸,x)
âˆ’1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{i}
1{gj (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡i(Î¸,xi )
}
,
= eâˆ’rT {(I) + (II) + (III) + (IV)},
where (I), (II) and (III) result from differentiating the first term in (10.1) and (IV) re-
sults from differentiating the second term in (10.1). Notice that hi(Î¸,x)|x1=Ï‡ii (Î¸,x1) = 0,
so (II) = 0. For (III), hi(Î¸,x)|xi=Ï‡i(Î¸,xi ) = Se(râˆ’Ïƒ
2
 /2)T +Ïƒ
âˆš
T x âˆ’ K and
âˆ
jâˆˆB\{}
1{gij (Î¸,x)>0}(x)
âˆ£âˆ£âˆ£
xi=Ï‡i(Î¸,xi )
=
( âˆ
jâˆˆB\{,i}
1{gij (Î¸,x)>0}(x)|xi=Ï‡i(Î¸,xi )
)(
1{gii (Î¸,x)>0}(x)|xi=Ï‡i(Î¸,xi )
)
=
( âˆ
jâˆˆB\{,i}
1{gj (Î¸,x)>0}(x)
)
1{g(Î¸,x)>0}(x)
=
âˆ
jâˆˆB\{i}
1{gj (Î¸,x)>0}(x). (10.5)
Therefore, for each term in (III),
Eq
[
hi(Î¸,x)
1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{}
1{gij (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡i(Î¸,xi )
Author's personal copy
176 Y.-D. Lyuu, H.W. Teng
Ã—
âˆ
jâˆˆB\{}
1{gj (Î¸,x)>0}(x)Î·Ëœi(Î¸,xi )
]}
.
To differentiate Î”i with respect to Sj , note that only 1{gij (Î¸,x)>0}(Î¸,x) depends on
Sj . Since gij (Î¸,x) âˆˆ Gi and
sign
(
âˆ‚gij (Î¸,x)
âˆ‚xi
)
âˆ‚gij (Î¸,x)/âˆ‚Sj
âˆ‚gij (Î¸,x)/âˆ‚xi
= âˆ’e
(râˆ’Ïƒ 2j /2)T +Ïƒj
âˆš
T xj
SiÏƒi
âˆš
T e(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi
,
apply Theorem 3.3 to obtain
Î“ij = eâˆ’rT Eq
[
e(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi
âˆ’e(râˆ’Ïƒ 2j /2)T +Ïƒj
âˆš
T xj
SiÏƒi
âˆš
T e(râˆ’Ïƒ 2i /2)T +Ïƒi
âˆš
T xi
Ã—
âˆ
âˆˆB\{j}
1{gi(Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡ij (Î¸,xj )
= eâˆ’rT Eq
[âˆ’e(râˆ’Ïƒ 2j /2)T +Ïƒj
âˆš
T xj
SiÏƒi
âˆš
T
âˆ
âˆˆB\{j}
1{gj(Î¸,x)>0}(x)Î·Ëœij (Î¸,xi )
]
. 
Appendix E: Proof of Theorem 4.3
Proof Similarly to the proof of Theorem 4.2, write â„˜(Î¸,x) as
â„˜(Î¸,x) =
âˆ
jâˆˆB
1{gij (Î¸,x)>0}(x) +
âˆ‘
âˆˆB\{i}
âˆ
jâˆˆB
1{gj (Î¸,x)>0}(x). (11.1)
Recall (10.2)â€“(10.4). Apply Theorem 3.3,
Î”i = eâˆ’rT
{
Eq
[
1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{i}
1{gij (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡ii (Î¸,xi )
+
âˆ‘
âˆˆB\{i}
Eq
[
1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{}
1{gij (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡i(Î¸,xi )
+
âˆ‘
âˆˆB\{i}
Eq
[ âˆ’1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{i}
1{gj (Î¸,x)>0}(x)Î·i(Î¸,x)
]
xi=Ï‡i(Î¸,xi )
}
,
= eâˆ’rT {(I) + (II) + (III)},
where (I) and (II) result from differentiating the first term in (11.1) and (III) results
from differentiating the second term in (11.1). The sum of (II) and (III) is zero by
(10.5). Following (10.7), we have
Î”i = eâˆ’rT Eq
[
1
SiÏƒi
âˆš
T
âˆ
jâˆˆB\{i}
1{âˆ’gjj (Î¸,x)>0}(Î¸, xj )Î·Ëœii (Î¸,xi )
]
.
Author's personal copy
178 Y.-D. Lyuu, H.W. Teng
Note that
h(Î¸,x)|x1=Ï‡(Î¸,x1)
=
â§
âªâ¨
âªâ©
He(râˆ’Ïƒ 2/2)(mâˆ’)
t+Ïƒ
âˆš

t(x+1+Â·Â·Â·+xm) âˆ’ K for  = 1, . . . ,m âˆ’ 1,
H âˆ’ K for  = m,
0 for  = m + 1.
For  âˆˆ B, define
JËœ(Î¸,x) = J(Î¸,x)|x1=Ï‡(Î¸,x1) =
1
SÏƒ
âˆš

t
,
Î·Ëœ(Î¸,x1) = Î·(Î¸,x)|x1=Ï‡(Î¸,x1) = 1âˆš2Ï€ eâˆ’Ï‡(Î¸,x1)
2/2,
(12.1)
where Ï‡(Î¸,x1) is defined in (4.8)â€“(4.10). Notice that the sets {x : gi(Î¸,x) > 0} and
{x : x1 > Ï‡i(Î¸,x1)} are equal for i âˆˆ B; therefore,
1{gi (Î¸,x)>0}(x)|x1=Ï‡(Î¸,x1) = 1{x1>Ï‡i(Î¸,x1)}(x)|x1=Ï‡(Î¸,x1) = 1{Ï‡(Î¸,x1)>Ï‡i(Î¸,x1)}(x).
Because the set {x : Ï‡(Î¸,x1) > Ï‡i(Î¸,x1)} only depends on x1 but not x,
1{Ï‡(Î¸,x1)>Ï‡i(Î¸,x1)}(x) equals 1{Ï‡(Î¸,x1)>Ï‡i(Î¸,x1)}(x1). Now,

 = eâˆ’rT
{
E
[
e(râˆ’Ïƒ 2/2)m
t+Ïƒ
âˆš

t(x1+Â·Â·Â·+xm) âˆ
iâˆˆB
1{gi(Î¸,x)>0}(x)
]
+
mâˆ’1âˆ‘
=1
Eq
[(
He(râˆ’Ïƒ 2/2)(mâˆ’)
t+Ïƒ
âˆš

t(x+1+Â·Â·Â·+xm) âˆ’ K)JËœ(Î¸,x)
Ã—
âˆ
iâˆˆB\{}
1{Ï‡(Î¸,x1)>Ï‡i(Î¸,x1)}(x1)Î·Ëœ(Î¸,x1)
]
+ Eq
[
(H âˆ’ K)JËœm(Î¸,x)
âˆ
iâˆˆB\{m}
1{Ï‡m(Î¸,x1)>Ï‡i(Î¸,x1)}(x1)Î·Ëœm(Î¸,x1)
]}
.(12.2)
Apply Theorem 3.3 to Î” to derive Î“ . Note that
e(râˆ’Ïƒ 2/2)m
t+Ïƒ
âˆš

t(x1+Â·Â·Â·+xm)|x1=Ï‡(Î¸,x1)
=
â§
âªâ¨
âªâ©
He(râˆ’Ïƒ 2/2)(mâˆ’)
t+Ïƒ
âˆš

t(x+1+Â·Â·Â·+xm)/S for  = 1, . . . ,m,
H/S for  = m,
K/S for  = m + 1.
From the definition of Ï‡i(Î¸,x1), we have the set identities
{
Ï‡i(Î¸,x1) > Ï‡j (Î¸,x1)
} =
{
xi+1 + Â· Â· Â· + xj > âˆ’(r âˆ’ Ïƒ
2/2)(j âˆ’ i)
t
Ïƒ
âˆš

t
}
Author's personal copy
180 Y.-D. Lyuu, H.W. Teng
Appendix G: Greeks using the likelihood ratio method
The relationship between ST and x is in (2.1). Let s = (s1, . . . , sn)t and fST(s) be the
probability density function of ST. Define
di(si) = log(si/Si) âˆ’ (r âˆ’ Ïƒ
2
i /2)T
Ïƒi
âˆš
T
for i = 1, . . . , n,
and d(s) = (d1(s1), . . . , dn(sn))t . Then âˆ‚di (si )âˆ‚Si = âˆ’1/(SiÏƒi
âˆš
T ), and
fST(s) = f
(
d(s);0,)
(
nâˆ
i=1
1
siÏƒi
âˆš
T
)
. (13.1)
Recall that vi is an n Ã— 1 vector having 1 in the ith component and 0 elsewhere. By
straightforward calculations,
âˆ‚
âˆ‚Si
fST(s) = fST(s)
[
vitâˆ’1d(s)
SiÏƒi
âˆš
T
]
,
âˆ‚2
âˆ‚S2i
fST(s) = fST(s)
[
(vit
âˆ’1d(s))2 âˆ’ vitâˆ’1vi âˆ’ vitâˆ’1d(s)Ïƒi
âˆš
T
S2i Ïƒ
2
i T
]
,
âˆ‚2
âˆ‚Siâˆ‚Sj
fST(s) = fST(s)
[
(vit
âˆ’1d(s))(vjtâˆ’1d(s)) âˆ’ vitâˆ’1vj
SiSjÏƒiÏƒjT
]
.
The Greeks using the likelihood ratio method are [4]:
Î”i = eâˆ’rT E
[
â„˜(ST)
vit
âˆ’1d(ST)
SiÏƒi
âˆš
T
]
,
Î“ii = eâˆ’rT E
[
â„˜(ST)
(vit
âˆ’1d(ST))2 âˆ’ vitâˆ’1vi âˆ’ vitâˆ’1d(ST)Ïƒi
âˆš
T
S2i Ïƒ
2
i T
]
,
Î“ij = eâˆ’rT E
[
â„˜(ST)
(vit
âˆ’1d(ST))(vjtâˆ’1d(ST)) âˆ’ vitâˆ’1vj
SiSjÏƒiÏƒjT
]
, i = j,
where the expectation is taken over the random variable ST whose probability density
function is in (13.1). Or equivalently after change of variables,
Î”i = eâˆ’rT E
[
â„˜(ST)
vit
âˆ’1x
SiÏƒi
âˆš
T
]
,
Î“ii = eâˆ’rT E
[
â„˜(ST)
(vit
âˆ’1x)2 âˆ’ vitâˆ’1vi âˆ’ vitâˆ’1xÏƒi
âˆš
T
S2i Ïƒ
2
i T
]
,
Î“ij = eâˆ’rT E
[
â„˜(ST)
(vit
âˆ’1x)(vjtâˆ’1x) âˆ’ vitâˆ’1vj
SiSjÏƒiÏƒjT
]
, i = j,
where the expectation is taken over the random variable x.
Author's personal copy
å‡ºå¸­åœ‹éš›å­¸è¡“æœƒè­°å¿ƒå¾—å ±å‘Š 
                                                             
è¨ˆç•«ç·¨è™Ÿ 97-2221-E-002-096-MY3 
è¨ˆç•«åç¨± GARCH é¡æ¨¡å‹èˆ‡å¤šè®Šæ•¸è¡ç”Ÿæ€§é‡‘å•†å“ä¹‹ç†è«–èˆ‡è¨ˆåƒ¹æ¼”ç®—æ³• 
å‡ºåœ‹äººå“¡å§“å 
æœå‹™æ©Ÿé—œåŠè·ç¨± 
å‘‚è‚²é“ 
è‡ºç£å¤§å­¸è³‡è¨Šå·¥ç¨‹ç³»æ•™æˆ 
æœƒè­°æ™‚é–“åœ°é» June 10-11, 2011, Chania, Greece 
æœƒè­°åç¨± International Conference of the Financial Engineering & Banking Society  (FEBS) 
ç™¼è¡¨è«–æ–‡é¡Œç›® Performance of GPU for a Tree Model for Convertible Bonds Pricing with Equity, Interest Rate, and Default Risk 
 
ä¸€ã€åƒåŠ æœƒè­°ç¶“é 
â€œThe 1st International Conference of the Financial Engineering and Banking Society aims 
towards providing a forum for researchers and practitioners to exchange ideas and to present new 
research results on the theory and modern practice of financial engineering and banking risk 
management.â€  
The conference is organized by the Financial Engineering Laboratory of the Technical 
University of Crete, and it be held in Chania, Crete, Greece, during June 10-11, 2011. 
The chair of the conference is Constantin Zopounidis, Technical University of Crete, Greece. 
The scientific committee consists of 
1. Andriosopoulos, D., Hull University Business School, UK  
2. Andriosopoulos, K., Cass Business School, UK  
3. Baourakis, G., Mediterranean Agronomic Institute of Chania, Greece  
4. Delis, M., University of Ioannina, Greece  
5. Dimitras, A., Hellenic Open University, Greece  
6. Doumpos, M., Technical University of Crete, Greece  
7. Dounias, G., University of Aegean, Greece  
8. Fethi, M., University of Leicester, UK  
9. Gaganis, Ch., University of Crete, Greece  
10. Galariotis, E., Audencia Nantes - School of Management, France   
11. Girardone, C., University of Essex, UK  
12. Gortsos, M., Hellenic Bank Association, Greece  
13. Hasan, I., Rensselaer Polytechnic Institute, USA  
14. Ioannidis, Ch., University of Bath, UK  
15. Katzos, K., Technological Educational Institute of Piraeus, Greece  
16. Kavousanos, M., Athens University of Economics and Business, Greece  
17. Kosmidou, K., Aristotle University of Thessaloniki, Greece  
11. Money and capital markets 
12. Financial derivatives 
As one can tell, they cover major topics in finance. 
 
I saw people from the following countries: 
1. Belgium 
2. Greece 
3. Hong Kong 
4. Italy 
5. Latvia 
6. Luxembourg 
7. Portugal 
8. Taiwan 
9. Thailand 
10. Turkey 
11. UK 
12. USA 
 
A total of 43 papers were accepted. There were 10 sessions. There was one invited speech by a 
finance professor, Iftekhar Hasan, from RPI.  
Our paper was presented in the afternoon of June 10, 2011. My student Jimmy Kuo-Wei Wen 
gave a very good presentation in English. He was asked a few questions. There was no other paper 
from Taiwan or China. 
FEBS provides a gathering place for theoreticians and practitioners in finance to communicate 
their ideas. I especially felt lucky that there was an author from Italy, Prof Silvia Muzzioli, who 
happened to work on exactly the same topic as I: implied binomial tree. So I asked a paper from her 
to work on.  
how to exploit the GPUâ€™s computational power. Section 5 describes and interprets our numerical 
results. Section 6 concludes. 
2 Convertible Bonds 
2.1 Overview 
A CB is a type of bond which can be converted into the issuing companyâ€™s common stock in 
the future, usually at a given ratio. It may also contain embedded options such as a call or a put. 
CBs are usually called a hybrid security as they are pure bonds which can be converted into new 
stock at the discretion of its owner. Due to such hybrid characteristics, the investor can exercise the 
call option to convert CBs to stocks at a specific price for a specific time period or prevent losses by 
exercising the put option. Like many other bonds, CBs are typically issued with some contractual 
structures, including coupon rate, par value, maturity date, issue size, and issue date. In addition, 
CBs contain the following unusual features: 
z Conversion ratio: The number of shares which can be converted from each CB. 
z Conversion price: The nominal price per share, i.e., the par value divided by the conversion 
ratio. 
The conversion value is defined as the underlying stockâ€™s current market value times the 
conversion ratio. Therefore, the conversion value changes with time. The conversion premium is 
defined as the difference between the market price of the CB and the conversion value. Table 1 is an 
example CB that incorporates all the features mentioned above (Connolly, 1998). 
 
2.2 Literature Review 
There are several methods to price CBs. The first is a closed-form solution to the price. 
Ingersoll (1977) presents a closed-form formula to value CBs and studies the optimal conversion 
strategy for investors and the optimal call policy for the issuers. 
The second pricing approach uses the numerical partial differential equation (PDE) approach. 
Brennan and Schwartz (1977, 1980) introduce finite-difference schemes to solve the partial 
differential equation for CB prices. McConnell and Schwartz (1986) develop a single-factor model 
based on a finite-difference method to model the stock price. Tsiveriotis and Fernandes (1998) take 
the default risk into account and use two partial differential equations to price CBs. 
Monte Carlo simulation is another method to price CBs. Lvov et al. (2004), Ammann et al. 
(2008) and Longstaff and Schwartz (2001) all price CBs with the simulation method. However, the 
simulation method has some disadvantages: it takes much computational time, the result converges 
slowly, and it cannot handle American options. Although the least-squares Monte Carlo of 
 
Table 1: A typical CB indenture. 
 
Since Chambers and Luâ€™s model considers several risks (the stock price movement, the 
prevailing interest rate at each period, and the default rates of the CB), the model is expected to 
provide a more accurate price for CBs. 
3.2 Implementation Methodology 
Before implementing Chambers and Luâ€™s tree, we should first construct the BDT model. Lyuu 
(2002) provides a quadratic-time algorithm to calibrate the binomial interest rate tree, and we will 
adopt this algorithm for the risk-free interest rate model implementation. Assume the tree model has 
a flat short-rate volatility. After calibrating the risk-free interest rate model, we solve the default rate 
at each period. 
For backward induction for pricing a CB on Chambers and Luâ€™s pricing tree, the main obstacle 
is to know each nodeâ€™s child nodes while doing backward induction because two factors need to be 
taken into account. We use a 2-dimension array where the size of each dimension is ( )1n +  at time 
period n. There are ( )21n +  nodes at time period n. The first index of the 2-dimension array points 
to a risk-free interest rate, and the second index of the 2-dimension array points to a stock price. The 
first index of the 2-dimension array is increased by 1 with each risk-free interest rateâ€™s down 
movement; it stays constant otherwise. The second index of the 2-dimension array is increased by 1 
with each stock priceâ€™s down movement; it stays constant otherwise. 
Based on this concept, we can identify each nodeâ€™s child nodes when doing backward 
induction. The space complexity when implementing Chambers and Luâ€™s model is ( )2O n , and the 
time complexity is ( )3O n , where n means the number of periods of the tree between now and the 
maturity date of the bond. We can finally derive the CBâ€™s price. 
4 GPU Implementation 
In order to speed up the computation, a natural idea is to execute our program on a faster 
hardware. In recent years, parallel computing has become mainstream. GPGPU (general-purpose 
GPU) is one approach that exploits GPUsâ€™ extensive computational power to different applications 
beyond its original computer graphics applications. 
4.1 CPU and GPU: Comparisons 
CPU is the most important kernel of the computer. It comprises arithmetic units and a control 
 
Figure 1: Branching probabilities at each node. 
the computation in the shared memory (for highly reusable data) and the constant memory instead 
of in the global memory. 
5 Numerical Results 
This section shows our implementation results. Throughout, n means the number of periods of 
the tree between now and the maturity date of the bond. We first show the pricing results by 
executing our program on the CPU to confirm the correctness of our implementation. Then we 
show the implementation results on the GPU to evaluate the performance gains. 
 
The specifications of the CPU and the GPU are listed in Table 2. The data transferring bus 
between the CPU and the GPU is the PCI-Express 16x. Only 1 thread is created on the CPU when 
executing our program. We measure the execution times on the CPU and the GPU with the 
high-resolution performance clock counter (in milliseconds) of the operating system. 
5.1 Accuracy of Implementation 
We first show our implementation results with Chambers and Luâ€™s tree model. The two 
examples are the same as those in Chambers and Lu (2007). The inputs of the first example, a 
hypothetical CB, are as follows: 
0 30S = , 0.23sÏƒ = , 1tâˆ† = , call price 105= , par 100= , 0.32Î´ = , conversion ratio 3= , 
0.1Ï = âˆ’ , 
where the call prices are flat at $105 from the first year to the maturity date; the term structure is 
listed in Table 3. Assume the volatility is constant ( 0.1rÏƒ = ). We compare our implementation 
results with Chambers and Luâ€™s in Chambers and Lu (2007). The numerical results of the risk-free 
interest rate and the default rate models for the hypothetical example are shown in Table 4 and 
Table 5, respectively. The pricing results are listed in Table 6 and the numbers are matched. 
 
 
Table 2: The CPU and the GPU hardware specifications. 
 
Table 3: The term structure for the hypothetical CB.
  
5.2 Performance of the GPU Implementation 
The goal of our implementation on the GPU is to reduce the execution time as much as 
possible. We will let n grow up to 1000. The implementation results show that the execution time on 
the GPU never exceeds 410  ms. We implement our model on the GPU with only 1 thread, that is, 
no parallelism and also no memory optimization, to confirm the accuracy of the pricing results as 
compared with the results on the CPU. Table 11 and Table 12 show the numerical results of the 
interest rate and the default rate models for the hypothetical and the Lucent CB (described in 
Section 5.1). Table 13 lists the pricing results by the GPU and the CPU. The absolute errors of these 
results are less than 310âˆ’ . 
 
 
(a) From the hypothetical CB. 
 
(b) From the Lucent CB. 
Table 11: The numerical results of the risk-free interest rate model with 1 thread on the 
GPU. 
 
Table 10: The pricing results of the Lucent CB. 
 
Table 9: The numerical results of the default rate model with the Lucent CB. 
  
 
6 Conclusions 
Pricing CBs is computationally demanding, and there are many pricing methods in the 
literature. Chambers and Lu describe a popular two-factor tree model which considers the stock 
price, the risk-free interest rate, and the default risk for CBs pricing. Its time complexity is ( )3O n . 
To accelerate the computation, we implement Chambers and Luâ€™s tree model on the GPU with 
CUDA to exploit the GPUâ€™s computing power and compare it with the CPU. Hundred-fold speedup 
is achieved as a result. Furthermore, the pricing results from the GPU and the CPU differ by less 
than 310âˆ’  on average. Now we can price CBs with Chambers and Luâ€™s model much more 
efficiently. 
References 
Ammann, M., Kind, A., and Wilde, C., 2008, â€œSimulation-Based Pricing of Convertible Bondsâ€, 
Journal of Empirical Finance, 15, 310â€“331. 
Black, F., Derman, E., and Toy, W., 1990, â€œA One-Factor Model of Interest Rates and Its 
Application to Treasury Bond Optionsâ€, Financial Analysts Journal, 46, 33â€“39. 
Brennan, M.J., and Schwartz, E.S., 1977, â€œConvertible Bonds: Valuation and Optimal Strategies for 
Call and Conversionâ€, Journal of Finance, 32, 1699â€“1715. 
Brennan, M.J., and Schwartz, E.S., 1980, â€œAnalyzing Convertible Bondsâ€, Journal of Financial and 
Quantitative Analysis, 15, 907â€“929. 
Brunner, T., Deinzer, F., Feldmann, T., Kubias, A.K., Paulus, D., Paulus, S., and Schreiber, B., 2008, 
Table 17: The performance with various thread counts per block on the GPU (at 
500n = ). 
 
Table 16:  The performance comparison between the CPU and the GPU with the parallel 
implementation and memory optimization. 
 
Table 15: The performance comparison between the CPU and the GPU with the parallel 
implementation without memory optimization. 
Tsiveriotis, K., and Fernandes, C., 1998, â€œValuing Convertible Bonds with Credit Riskâ€, Journal of 
Fixed Income, 8, 95â€“102. 
 
97 å¹´åº¦å°ˆé¡Œç ”ç©¶è¨ˆç•«ç ”ç©¶æˆæœå½™æ•´è¡¨ 
è¨ˆç•«ä¸»æŒäººï¼šå‘‚è‚²é“ è¨ˆç•«ç·¨è™Ÿï¼š97-2221-E-002-096-MY3 
è¨ˆç•«åç¨±ï¼šGARCH é¡æ¨¡å‹èˆ‡å¤šè®Šæ•¸è¡ç”Ÿæ€§é‡‘å•†å“ä¹‹ç†è«–èˆ‡è¨ˆåƒ¹æ¼”ç®—æ³• 
é‡åŒ– 
æˆæœé …ç›® å¯¦éš›å·²é”æˆ
æ•¸ï¼ˆè¢«æ¥å—
æˆ–å·²ç™¼è¡¨ï¼‰
é æœŸç¸½é”æˆ
æ•¸(å«å¯¦éš›å·²
é”æˆæ•¸) 
æœ¬è¨ˆç•«å¯¦
éš›è²¢ç»ç™¾
åˆ†æ¯” 
å–®ä½ 
å‚™ è¨» ï¼ˆ è³ª åŒ– èªª
æ˜ï¼šå¦‚æ•¸å€‹è¨ˆç•«
å…±åŒæˆæœã€æˆæœ
åˆ— ç‚º è©² æœŸ åˆŠ ä¹‹
å° é¢ æ•… äº‹ ...
ç­‰ï¼‰ 
æœŸåˆŠè«–æ–‡ 9 9 100%  
ç ”ç©¶å ±å‘Š/æŠ€è¡“å ±å‘Š 0 0 100%  
ç ”è¨æœƒè«–æ–‡ 3 3 100% 
ç¯‡ 
 
è«–æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100%   
ç”³è«‹ä¸­ä»¶æ•¸ 0 0 100%  å°ˆåˆ© å·²ç²å¾—ä»¶æ•¸ 0 0 100% ä»¶  
ä»¶æ•¸ 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šåˆ©é‡‘ 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 0 0 100%  
åšå£«ç”Ÿ 4 4 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å…§ 
åƒèˆ‡è¨ˆç•«äººåŠ› 
ï¼ˆæœ¬åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ç† 0 0 100% 
äººæ¬¡ 
 
æœŸåˆŠè«–æ–‡ 0 0 100%  
ç ”ç©¶å ±å‘Š/æŠ€è¡“å ±å‘Š 0 0 100%  
ç ”è¨æœƒè«–æ–‡ 0 0 100% 
ç¯‡ 
 
è«–æ–‡è‘—ä½œ 
å°ˆæ›¸ 0 0 100% ç« /æœ¬  
ç”³è«‹ä¸­ä»¶æ•¸ 0 0 100%  å°ˆåˆ© å·²ç²å¾—ä»¶æ•¸ 0 0 100% ä»¶  
ä»¶æ•¸ 0 0 100% ä»¶  
æŠ€è¡“ç§»è½‰ 
æ¬Šåˆ©é‡‘ 0 0 100% åƒå…ƒ  
ç¢©å£«ç”Ÿ 0 0 100%  
åšå£«ç”Ÿ 0 0 100%  
åšå£«å¾Œç ”ç©¶å“¡ 0 0 100%  
åœ‹å¤– 
åƒèˆ‡è¨ˆç•«äººåŠ› 
ï¼ˆå¤–åœ‹ç±ï¼‰ 
å°ˆä»»åŠ©ç† 0 0 100% 
äººæ¬¡ 
 
åœ‹ç§‘æœƒè£œåŠ©å°ˆé¡Œç ”ç©¶è¨ˆç•«æˆæœå ±å‘Šè‡ªè©•è¡¨ 
è«‹å°±ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹åº¦ã€é”æˆé æœŸç›®æ¨™æƒ…æ³ã€ç ”ç©¶æˆæœä¹‹å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹
å€¼ï¼ˆç°¡è¦æ•˜è¿°æˆæœæ‰€ä»£è¡¨ä¹‹æ„ç¾©ã€åƒ¹å€¼ã€å½±éŸ¿æˆ–é€²ä¸€æ­¥ç™¼å±•ä¹‹å¯èƒ½æ€§ï¼‰ã€æ˜¯å¦é©
åˆåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨æˆ–ç”³è«‹å°ˆåˆ©ã€ä¸»è¦ç™¼ç¾æˆ–å…¶ä»–æœ‰é—œåƒ¹å€¼ç­‰ï¼Œä½œä¸€ç¶œåˆè©•ä¼°ã€‚
1. è«‹å°±ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹åº¦ã€é”æˆé æœŸç›®æ¨™æƒ…æ³ä½œä¸€ç¶œåˆè©•ä¼° 
â– é”æˆç›®æ¨™ 
â–¡æœªé”æˆç›®æ¨™ï¼ˆè«‹èªªæ˜ï¼Œä»¥ 100 å­—ç‚ºé™ï¼‰ 
â–¡å¯¦é©—å¤±æ•— 
â–¡å› æ•…å¯¦é©—ä¸­æ–· 
â–¡å…¶ä»–åŸå›  
èªªæ˜ï¼š 
2. ç ”ç©¶æˆæœåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨æˆ–ç”³è«‹å°ˆåˆ©ç­‰æƒ…å½¢ï¼š 
è«–æ–‡ï¼šâ– å·²ç™¼è¡¨ â–¡æœªç™¼è¡¨ä¹‹æ–‡ç¨¿ â–¡æ’°å¯«ä¸­ â–¡ç„¡ 
å°ˆåˆ©ï¼šâ–¡å·²ç²å¾— â–¡ç”³è«‹ä¸­ â– ç„¡ 
æŠ€è½‰ï¼šâ–¡å·²æŠ€è½‰ â–¡æ´½è«‡ä¸­ â– ç„¡ 
å…¶ä»–ï¼šï¼ˆä»¥ 100 å­—ç‚ºé™ï¼‰ 
We have published about 20 SCI/SSCI journal papers between 2008 and 2011. 
 
We also published about 16 international conference papers between June, 2008 and 
June, 2011. 
3. è«‹ä¾å­¸è¡“æˆå°±ã€æŠ€è¡“å‰µæ–°ã€ç¤¾æœƒå½±éŸ¿ç­‰æ–¹é¢ï¼Œè©•ä¼°ç ”ç©¶æˆæœä¹‹å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹
å€¼ï¼ˆç°¡è¦æ•˜è¿°æˆæœæ‰€ä»£è¡¨ä¹‹æ„ç¾©ã€åƒ¹å€¼ã€å½±éŸ¿æˆ–é€²ä¸€æ­¥ç™¼å±•ä¹‹å¯èƒ½æ€§ï¼‰ï¼ˆä»¥
500 å­—ç‚ºé™ï¼‰ 
1. å®Œ æˆ Financial Engineering and Computation: Principles, Mathematics, 
Algorithms ä¸€æ›¸ã€‚å…¨æ›¸ä»¥è‹±æ–‡å¯«æˆï¼Œå…±ä¸‰åä¸‰ç« ï¼Œå…­ç™¾äºŒåå…­é ï¼Œç”±åœ‹éš›è‘—åå­¸è¡“å‡ºç‰ˆå•†
Cambridge University Press æ–¼ 2002 å¹´å‡ºç‰ˆï¼Œç‚ºã€Œè²¡å‹™å·¥ç¨‹ã€ç•Œå»£æ³›ä½¿ç”¨ï¼Œä¿„æ–‡ç‰ˆæ–¼ 2007
å‡ºç‰ˆï¼Œç°¡é«”ä¸­æ–‡ç‰ˆæ–¼ 2008 å‡ºç‰ˆã€‚ 
2. äºæ´²å¼é¸æ“‡æ¬Šå®šåƒ¹å…¬èªç‚ºè¤‡é›œçš„è¨ˆç®—å•é¡Œï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„å­¸è¡“å•é¡Œä¹‹ä¸€ã€‚æˆ‘å€‘è¨­è¨ˆå‡º
æœ€ä½³çš„ä¿è­‰æ”¶æ­›è¿‘ä¼¼æ¼”ç®—æ³•ï¼Œå°‡è¤‡é›œåº¦é™ä½è‡³  ï¼Œå¯«æˆçš„è«–æ–‡ç™»åœ¨ Applied Mathematics 
and Computation (2007)ä¸Šã€‚æˆ‘å€‘ä¸¦æå‡ºæ–‡ç»ä¸Šç¬¬ä¸€å€‹å¯è­‰æ˜ç‚ºéæŒ‡æ•¸é‹ç®—æ™‚é–“ä¹‹éè¿‘ä¼¼
æ¼”ç®—æ³•ï¼Œå°‡è¤‡é›œåº¦é™ä½è‡³ ï¼ŒæœŸåˆŠç‰ˆç™»æ–¼ Acta Informatica (2007)ã€‚ 
3. spreading å•é¡Œæœ‰å¾ˆå¤šæ‡‰ç”¨ï¼Œè«¸å¦‚å‚³æŸ“ç—…ã€ç¤¾ç¾¤ç¶²è·¯ã€ç‰©ç†ã€è¨ˆç®—æ©Ÿå®¹éŒ¯ç­‰ï¼Œæˆ‘å€‘åš
äº†ä¸€ç³»åˆ—çš„è«–æ–‡ï¼Œè¨è«–éœ€å¤šå°‘èµ·å§‹é»æ‰æœƒè®“åœ–æœ€çµ‚æ‰€æœ‰é»çš†è™•æ–¼æŸç‹€æ…‹ï¼Œä¹Ÿç¬¬ä¸€æ¬¡æ‡‰ç”¨åˆ°
éš¨æ©Ÿåœ–ï¼Œå¾—åˆ°è¨±å¤šæœ€ä½³ä¸Šé™èˆ‡ä¸‹é™ï¼Œæ–‡ç« ç™»æ–¼ Theoretical Computer Scienceã€Theory of 
Computing Systemsã€‚ 
4. åˆ©ç”¨çµ„åˆæ•¸å­¸ï¼Œæˆ‘å€‘è¨­è¨ˆå‡ºè«¸å¤šæœ€ä½³çš„è¨ˆåƒ¹æ¼”ç®—æ³•ï¼Œä¾‹å¦‚å¤šç¨®éšœç¤™é¸æ“‡æ¬Šèˆ‡å·´é»å¼é¸
æ“‡æ¬Šï¼Œæ–‡ç« ç™»åœ¨ Computers and Mathematics with Applications (2008)ã€Decisions in 
Economics and Finance (2010)ã€‚ 
