 1 
 
æ‘˜è¦  
    å°–å³°å¼æº«åº¦è»Œè·¡çš„å¿«é€Ÿç†±è™•ç†ç³»çµ±
å»£æ³›ç”¨æ–¼åŠå°é«”è£½ç¨‹ä»¥æä¾›ç²¾ç¢ºçš„ç†±ç©
å­˜ã€‚ç„¶è€Œï¼Œéš¨è‘—åŠå°é«”å…ƒä»¶ç·šå¯¬é€æ¼¸åœ°
æ”¶ç¸®ï¼Œç†±ç©å­˜æ§åˆ¶çš„è­°é¡Œè®Šçš„æ„ˆä¾†æ„ˆé‡
è¦ï¼Œé€™æ˜¯å› ç‚ºåš´æ ¼çš„æ€§èƒ½è¦æ±‚ (ä¾‹å¦‚ï¼šç¶­
æŒå‡å‹»åœ°å¿«é€Ÿå‡æº«å’Œå¿«é€Ÿé™æº« )ï¼Œä½¿å¾—æº«
åº¦æ§åˆ¶åœ¨å¿«é€Ÿç†±è™•ç†ç³»çµ±æˆç‚ºä¸€é …è‰±é‰…
çš„ä»»å‹™ã€‚æœ¬ç ”ç©¶è¨­è¨ˆäº†ä¸€å€‹å¯ä»¥æä¾›æº–
ç¢ºç†±ç©å­˜çš„æ§åˆ¶ç³»çµ±ã€‚æ­¤ç³»çµ±æ˜¯ç›´æ¥é‡
å°ç†±ç©å­˜æŒ‡æ¨™ä¾†æ§åˆ¶ï¼Œè€Œä¸æ˜¯é‡å°æº«åº¦
åšä¼ºæœæ§åˆ¶ï¼Œè—‰ç”±åŒæ™‚èª¿è«§æ§åˆ¶å™¨åƒæ•¸
å’Œè¨­è¨ˆè¨­å®šé»è»Œè·¡ä¾†é”åˆ°æ§åˆ¶ç†±ç©å­˜æŒ‡
æ¨™çš„ç›®çš„ï¼Œå…¶ä¸­æ¡ç”¨çš„æ§åˆ¶å™¨ç‚º PI å’Œ
PI2D æ§åˆ¶å™¨ã€‚æœ¬ç ”ç©¶ä¸¦æ¢è¨å¯¦ç”¨ä¸Šçš„è­°
é¡Œï¼Œå¦‚æº«åº¦ä¸Šå‡ /ä¸‹é™é€Ÿç‡çš„å¯è¡Œæ€§ç¯„åœ
ä»¥åŠæ¨¡å¼èª¤å·®æ‰€é€ æˆçš„å½±éŸ¿ã€‚çµæœé¡¯ç¤º
ç°¡å–®çš„ PI æ§åˆ¶å™¨å°å°–å³°å¼å¿«é€Ÿç†±è™•ç†ç³»
çµ±å¯é”åˆ°è‰¯å¥½çš„ç†±ç©å­˜æ§åˆ¶ã€‚  
é—œéµå­—ï¼šå¿«é€Ÿç†±è™•ç†ï¼Œç¨‹åºæ§åˆ¶ï¼Œç†±ç©
å­˜ï¼ŒPI æ§åˆ¶å™¨ï¼ŒPI2D æ§åˆ¶å™¨ã€‚  
 
Abstract â€” The spike-shaped temperature 
profile in thermal treatments is widely used in IC 
industry for providing precise thermal budgets. 
This thermal budget control issue gets more 
crucial as the technology node progressively 
shrinking. Therefore, rapid thermal processing 
(RTP), such as spike annealing, has the ability to 
yields ultra-shallow junctions. With its 
exceptionally stringent performance requirements 
(for example, high temperature uniformity and 
high temperature ramp-up/down rate), 
temperature control in RTP systems is a 
challenging task. In this study, a novel 
methodology of designing a control system for 
providing precise thermal budget is presented. By 
tuning controller parameters and designing the 
set-point profile, the method targets thermal 
budget indices instead of temperature servo 
control. Two types of controllers, PI and PI2D, are 
considered. Practical issues, such as the feasibility 
range for temperature ramp-up/down rate and the 
effect of model mismatch, are also discussed. The 
results show the simple PI controller performs 
well in spike RTP systems. 
Keywords:  Rapid thermal processing, 
Process control,  Thermal budget, PI 
controller,  PI2D controller. 
 
1. Introduction 
Single wafer rapid thermal processing (RTP) 
is widely used in the fabrication of semiconductor 
devices. It has become one of the key 
technologies due to faster wafer processing with 
precise control of thermal budget. The thermal 
budget is an important process issue contributed 
from the duration and maximum of temperature 
beyond a specific value, as represented in Fig. 1. 
This index needs a tight process control in many 
processes, such as rapid thermal annealing, 
oxidation in semiconductor manufacturing and 
reflow soldering in IC packaging industry. A 
review of RTP control has been given by Edgar et 
al. [1]. 
 
Figure 1. Thermal budget and temperature profile in rapid 
thermal annealing. 
The traditional annealing process uses a 
soak-shaped temperature profile as shown in Fig. 
 3 
direction are interested by assuming symmetrical 
temperature distribution and the distribution in z 
direction can be ignored. A lumped physical 
model of the wafer temperature at different 
positions, Ti, is given by the energy balance 
equation [8] 
cond conv rad lampi
i p i i i i
dTV C q q q q
dt
Ï = + + +     (1) 
where subscript i is the index of annual zone with 
volume Vi, Ï  is the density, Cp is the heat 
capacity, and qicond, qiconv, qirad, and qilamp represent 
the heat exchanged by conduction, convection, 
radiation, and heat addition from the lamp power, 
respectively. Since the temperature in the spike 
step is relative high (e.g., 1000oC), the heat 
conduction term can be neglected. After 
linearization about an operating point ( ,is jsT U ), 
Eq.(1) can be written, in the form of deviation 
variables ( i i isT T T= âˆ’É¶  and j j jsU U U= âˆ’É¶ ), as [9] 
1
m
i
i i ij j
j
dT T K U
dt
Ï„
=
= âˆ’ +âˆ‘
É¶
É¶ É¶
         (2) 
where m is the total number of lamp rings; the 
time constant and process steady-state gain are of 
the form 
3,
3
1, 2,
4,
3
1, 2,
i
i
i i i
ij
ij
i i i
a
a T a
a
K
a T a
Ï„ =
+
=
+
             (3) 
and a1,i, a2,i, a3,i, and a4,ij denote physically based 
parameters. Therefore, a simple first-order model 
could be used to describe the relationship between 
the lamp power from the jth zone, Uj, and the 
wafer temperature at the ith zone, Ti. 
Although the RTP system is a multivariable 
process in nature, as shown in Eq.(2), the present 
work will focus on single-input single-output 
(SISO) case for simplicity. The results of SISO 
systems will serve as the basis of further 
extensions to multivariable systems. Since an 
approximated first-order transfer function of the 
process is obtained, the control system designs are 
based on a process model of the following form. 
( )
1P
KG s
sÏ„
=
+
            (4) 
For the thermal budget control problem of RTP 
system, this study formulates the control objective 
as two specifications: time duration beyond the 
reference temperature, âˆ†t , and the range between 
the maximum temperature and the reference value, 
âˆ†T , as shown in Fig. 1. Since constructing a 
control system to perfectly tracking this spike 
set-point is almost an impossible task, in this work, 
designing both the set-point profile and the 
controller to satisfy the specifications of the 
thermal budget is considered. The spike-shaped 
set-point profile can be characterized as three 
parameters: the ramp-up rate k1, the ramp-down 
rate k2, and the maximum value of set-point, max
setT  
(see Fig. 4). The controllers considered are PI 
controller and PI2D controller (i.e. a PID 
controller with double integrators) [8]. In this 
study, the ramp-up/down rates of set-point profile, 
k1 and k2, are assumed given. The controller 
parameters and the maximum of set-point profile, 
max
setT , are to be designed to meet the control 
specifications. 
+
-
k1 k2 GpGcE U TT
set
set
maxT
 
Figure 4. Feedback control system and set-point profile for 
thermal budget control. 
 5 
from the Laplace inversion, with the initial 
condition (0) 0T = : 
{ }
( )( )
1 1
/
1 2 2
( ) ( )( ) ( ) ( )
1 ( ) ( )
1 cl
setC P
C P
t
cl
G s G sT t L T s L T s
G s G s
k k e k tÏ„Ï„
âˆ’ âˆ’
âˆ’
ï£± ï£¼
= = ï£² ï£½
+ï£³ ï£¾
= + âˆ’ âˆ’
(12) 
With Eq.(12), the maximum temperature can be 
found, by taking its derivative, as 
1 2
max 1 2
2
( ) lnc cl cl
k kT T t k k
k
Ï„ Ï„
ï£« ï£¶+
= = âˆ’ ï£¬ ï£·
ï£­ ï£¸
   (13) 
where 
1 2
2
lnc cl
k k
t
k
Ï„
ï£« ï£¶+
= ï£¬ ï£·
ï£­ ï£¸
          (14) 
In addition, the following equation for 2t  holds 
by the temperature response intersecting the 
reference temperature. 
( )( )2 /2 1 2 2 2( ) 1 0cltref cl refT t T k k e k t TÏ„Ï„ âˆ’âˆ’ = + âˆ’ âˆ’ âˆ’ = (15) 
Now, the control specifications can be represented 
as 
2 1t t tâˆ† = âˆ’             (16) 
max refT T Tâˆ† = âˆ’          (17) 
For simplicity, assume the ramp rates, k1 and k2, 
are given. Therefore, one can tune the parameter 
clÏ„  (or CK ) and design pT  (or maxsetT ) to satisfy 
both specifications of tâˆ†  and Tâˆ† . The 
procedures are described as follows. 
First, by substituting Eqs.(9), (13), (16), and 
(17) into Eq.(15), a nonlinear equation for Ï„ cl  is 
resulted. The analytical solution for Ï„ cl  is found 
as 
       
exp
cl
bB
bC bAW B bA
B B
Ï„ =
ï£« ï£¶ï£« ï£¶
âˆ’ï£¬ ï£·ï£¬ ï£·
ï£­ ï£¸ï£­ ï£¸
     (18) 
where 
           
( )( )
( )
1 2
2
1 2
2 1 2
1 2
1
1
1 ln
a
A k k a
B T k b
C k k e
k k k
a
k k
Tb t
k
âˆ’
= + âˆ’
= âˆ† âˆ’
= +
ï£« ï£¶+
= âˆ’ ï£¬ ï£·
ï£­ ï£¸
âˆ†
= âˆ† âˆ’
        (19) 
and ( )W â€¢  denotes the Lambert W-function [10]. 
Then, pT  is calculated by 
( )maxp ref ref refT T T T T T= âˆ’ = âˆ’ âˆ’ âˆ† , and maxsetT  can 
be obtained as max 1
set
p clT T kÏ„= + . 
By Eq.(9), 1 0t â‰¤  implies 0refT < . In the 
limiting condition of 1 0t = , we have 0refT =  
and, by Eq.(17), maxT T= âˆ† . Therefore, the value 
of clÏ„  in this limiting case can be found from 
Eq.(13) as 
*
1 2
1 2
2
ln
Ï„
âˆ†
=
ï£« ï£¶+
âˆ’ ï£¬ ï£·
ï£­ ï£¸
cl
T
k kk k
k
        (20) 
Since the closed-loop time constant Ï„ cl  must be 
positive for feasibility, *0 cl clÏ„ Ï„< â‰¤  is necessary 
to have 1 0t â‰¤ . Thus, the solution given in Eq.(18), 
which is derived based on the assumption of 
1 0t â‰¤ , is valid only when it falls in the interval of 
*0 cl clÏ„ Ï„< â‰¤ . 
3.2 Design of PI2D Control System 
By applying internal model control (IMC) [11] 
principle to the first-order process of Eq.(4) for 
dealing with a type-2 (or ramp) input signal, an 
 7 
treatment for simplification, it is found that there 
is no analytical solution for fÏ„ . Thus, fÏ„  can be 
solved using a simple root-finding method (e.g., 
Newton-Raphson method), in which various 
initial guesses could be tried to explore the 
possible solution for fÏ„ . After solving for fÏ„ , 
max
setT  is calculated by 
( )max max= = âˆ’ âˆ’ âˆ†set p refT T T T T . 
In the limiting condition of 1 0t = , we have 
0refT =  and maxT T= âˆ† . Therefore, fÏ„  in this 
limiting case can be found from Eq.(26) as 
( )
*
1 2 2
f
T
k k e kÏ†
Ï„ Ï† Ï†âˆ’
âˆ†
=
+ âˆ’
       (28) 
Again, the controller parameter Ï„ f  must be 
positive for feasibility. As a result, *0 f fÏ„ Ï„< â‰¤  is 
necessary to have 1 0t â‰¤ . 
 
4. Simulation Examples 
Consider the following first-order model for 
RTP system. 
4( )
6 1
=
+P
G s
s
            (29) 
The process conditions are given as: the ramp-up 
rate k1=200 oC/sec, the ramp-down rate k2=50 
oC/sec, and the reference temperature 
refT =1000
 
oC. The control targets are set as âˆ†t =2 sec and 
âˆ†T =50 oC. 
4.1 Nominal Condition 
There are two possible solutions of Ï„ cl  
computed from Eq.(18), which are 0.378 and 
4.349. However, the value of *Ï„ cl  in Eq.(20) is 
found as 0.418. Thus, there exists unique solution 
for Ï„ cl  (i.e., 0.378) in this condition. The 
parameter Ï„ I  is set as 6Ï„ Ï„= =I . Then, by the 
proposed method, Ï„ cl  = 0.378 (or KC = 3.97) and 
max
setT =1080.4 oC are resulted to hit two control 
targets. The set-point and temperature trajectories 
are as shown in Fig. 7, where the control input U, 
i.e., lamp power, is also given. 
4.5 5 5.5 6 6.5 7 7.5 8
980
1000
1020
1040
1060
1080
1100
Time (sec)
Te
m
pe
ra
tu
re
 
(o C
)
4.5 5 5.5 6 6.5 7 7.5 8
100
200
300
400
500
600
Time (sec)
La
m
p 
po
w
e
r 
U
 
(W
)
T set
T
ref
T
âˆ† t = 2 sec
âˆ† T = 50 oC
 
Figure 7. Control result of proposed design using PI 
controller (k1=200 oC/sec and k2=50 oC/sec). 
For PI2D controller, it is found that the 
control specifications cannot be achieved by the 
proposed method. In fact, the feasibility ranges on 
k1 and k2 for PI and PI2D control systems can be 
constructed, and the results are shown in Fig. 8. It 
can be seen that, under these two control 
specifications, the proposed method for PI control 
system has a wider feasibility range on k1 and k2 
by tuning Ï„ cl , compared to that for PI
2D control 
system. Thus, the ramp-up rate and ramp-down 
rate are changed to be k1=140 oC/sec and k2=40 
oC/sec for demonstrating the control result of PI2D 
controller. Consequently, the control targets are 
achieved with Ï„ f = 1.222 and max
setT =1007 oC. The 
 9 
structure reaches its limitation, balancing design 
and control of the system is a feasible solution. In 
this work, a novel method is proposed for 
adjusting thermal budget specification through 
designing controllers and the set-point profile. In 
contrast with the conventional temperature 
tracking design, the proposed method can 
effectively control the thermal budget in a 
straightforward manner. It comes out that the 
simple PI controller performs better compared to 
PI2D controller in the aspects of feasible range on 
temperature ramp-up/down rate and system 
robustness. 
In practice, the wafer temperature uniformity 
is also a very important specification. The RTP 
equipment usually has many lamps, and these 
lamps cluster into several adjusting zones for 
wafer temperature control. Extension of the 
proposed method to multivariable control system 
and considering the process nonlinearity for 
achieving good temperature uniformity within 
wafer is under research. 
 
 
è¨ˆç•«æˆæœè‡ªè©• 
    æœ¬è¨ˆç•«å®Œæˆé å®šç›®æ¨™ï¼Œç™¼å±•å‡ºé‡å°å°–å³°
å¼å¿«é€Ÿç†±è™•ç†ç³»çµ±ä¹‹ç†±ç©å­˜æ§åˆ¶ç­–ç•¥ï¼Œå…¶
ä¸­æ¡ç”¨çš„æ§åˆ¶å™¨ç‚º PI å’Œ PI2D æ§åˆ¶å™¨ï¼Œ
ä¸¦å°å¯¦ç”¨ä¸Šçš„è­°é¡Œï¼Œå¦‚æº«åº¦ä¸Šå‡ /ä¸‹é™é€Ÿ
ç‡çš„å¯è¡Œæ€§ç¯„åœä»¥åŠæ¨¡å¼èª¤å·®æ‰€é€ æˆçš„
å½±éŸ¿åŠ ä»¥æ¢è¨ã€‚çµæœé¡¯ç¤ºç°¡å–®çš„ PI æ§åˆ¶
å™¨å°å°–å³°å¼å¿«é€Ÿç†±è™•ç†ç³»çµ±å¯é”åˆ°è‰¯å¥½
çš„ç†±ç©å­˜æ§åˆ¶ã€‚  
æœ¬è¨ˆç•«æ‰€æå‡ºé‡å° RTP ç³»çµ±ç†±ç©å­˜
çš„æ§åˆ¶æ–¹æ³•éå¸¸å‰µæ–°ï¼Œä¸¦ä¸”è¨ˆç®—ç°¡å–®ï¼Œ
æ§åˆ¶æ•ˆæœè‰¯å¥½ï¼Œå…·æœ‰ç›¸ç•¶ç¨‹åº¦çš„å­¸è¡“åƒ¹
å€¼ã€‚è‹¥èƒ½å°‡æ­¤æŠ€è¡“ç™¼å±•çš„æ›´æˆç†Ÿï¼Œé€²ä¸€
æ­¥è€ƒæ…®ç³»çµ±éç·šæ€§ç‰¹è³ªèˆ‡æº«åº¦åˆ†ä½ˆçš„å‡
å‹»æ€§ï¼Œå°åŠå°é«”è£½é€ æ¥­èƒ½æœ‰æ•ˆæé«˜å…¶ç”¢
ç‡èˆ‡é‡ç‡ã€‚ç›¸é—œç ”ç©¶æˆæœå·²æ•´ç†æŠ•ç¨¿è‡³åœ‹éš›
å­¸è¡“æœŸåˆŠç™¼è¡¨ã€‚ 
Jyh-Cheng Jeng and Bo-Chi Li, â€œThermal budget 
control for processes with spike-shaped 
temperature profiles: application to rapid thermal 
annealing,â€ Asian Journal of Control. 
 
Reference 
1. Edgar, T. F., S. W. Butler, W. J. Campbell, C. 
Pfeiffer, C. Bode, S. B. Hwang, K. S. 
Balakrishnan and J. Hahn, â€œAutomatic control 
in microelectronics manufacturing: Practices, 
challenges, and possibilities,â€ Automatica, Vol. 
36, pp. 1567-1603 (2000). 
2. Jung, M. Y. L., R. Gunawan, R. D. Braatz and 
E. G. Seebauer, â€œRamp-rate effect on transient 
enhanced diffusion and dopant activation,â€ J. 
Electronchemical Society, Vol. 150, pp. 
838-842 (2003). 
3. Balakrishnan, K. S. and T. F. Edgar, 
â€œModel-based control in rapid thermal 
processing,â€ Thin Solid Films, Vol. 365, pp. 
322-333 (2000). 
4. Choi, J. Y., H. M. Do and H. S. Choi, 
â€œAdaptive control approach of rapid thermal 
processing,â€ IEEE Trans. Semicond. Manuf., 
Vol. 16, pp. 621-632 (2003). 
5. Cho, M., Y. Lee, S. Joo and K. S. Lee, 
â€œSemi-empirical model-based multivariable 
iterative learning control of an RTP system,â€ 
IEEE Trans. Semicond. Manuf., Vol. 18, pp. 
430-439 (2005). 
6. Dassau, E., B. Grosman and D. R. Lewin, 
â€œModeling and temperature control of rapid 
thermal processing,â€ Comput. Chem. Eng., 
Vol. 30, pp. 686-697 (2006). 
7. Emami-Naeini, A., J. L. Ebert, D. de Roover, 
R. L. Kosut, M. Dettori, L. M. Porter and S. 
Ghosal, â€œModeling and control of distributed 
1 
!"#$%&'()*+,-./!012#34567 
                                   89: 100 ; 12 < 17 8 
=>?@#3AB 
C(D#EFGH1I IEEE JKLMNOP#QRS=TUVW6XYZX[\
]#3^_U`a?@=Q WorkshopN`abTccddef Plenary/Keynote 
presentation ghijklRmnopqrghs6opqrNtuRopqrvw
xyWSzTR{|Usession }~ Process Control Applications IIUEÂ€Â{Â‚Âƒ
Â„mnqrU[Â…Â†fÂ‡ÂˆÂ‰U#lÂŠÂ‹ÂŒi!R1ÂÂƒÂ„DoÂÂNC(D#[
@ÂH Alberta H1Â‘ S. L. Shah Â’Â“Â”Â„Â•Â–Â—#UrÂ˜Â™WÂšÂ›ÂœÂÂÂŸ\Â 
Â‘Â¡Â¢NÂ£a=TÂ¤Â¥Â¦Â‘aÂ§Â¨ 2012gh 2013;Â©Âª!0#3RCall for Paper 
8aÂ«Â¬Â­Â®Â¯UÂ°CbTRÂŠ#Â„ÂœÂ±Â²Â³Â´N
z>ÂŠ#45 
 ?ÂŠ!0#3LÂµÂ¶RÂ·Â¸Â¹ÂºÂ»Â¶Â¼Â£Â½RqÂ¾Â¿Ã€>ÃÃ‚ÃƒRÃ„Ã…ghÃ†Ã‡
*+ÃˆÃ‰ NSC 99-2221-E-027-104- 
*+}~ ÃŠÃ‹ÃŒÃÂœlÃÃÂ¦ÃÃ‘Ã’YÃ“Ã”Ã•Â‘Ã’Ã–Ã—ÂÂŸÃ˜Ã™ 
.!ÂÃš
Ã›} 
ÃœÃÃ 
ÃŸÃ Ã¡Ã¢
hÃ£~ 
Â‚Ã¤"Ã¥H1Ã¦ÂšÃ” %Ã“Â’Â“ 
#3vw 
100; 5< 238Â°
100 ; 5 < 26 8 
#3Ã§Ã¨ HcÃ©Ãª 
#3}~ 
Ã«lpÃ¬ SÃ­Ã®ÂšÂ›ÂœÂVÂƒÂÂŸÃ¥2!0(D# 
Ã«Ã¯pÃ¬ The 4th International Symposium on Advanced Control of 
Industrial Processes 
qrop
'Â¶ 
(lp) Ã°Ã±=Ã²vÃ³Â·Ã´ÃµÂœÂÂ‘Ã¶Ã· IMCÃ¸ÃÃ¹ÃºÃµÃ¨Ã»Ã¼Â‘PID
Ã½Ã¾
(Ã¯p) IMC Based Set-point Weighted PID Tuning for First Order Delay 
Unstable Process (FODUP) 
Ã¿ Ã­
  
 
  
Abstractâ€”Present work provides a discussion for 
synthesizing PID from IMC controller for first order delay 
unstable process. Recently, Lee, et al. [1] has shown the 
effectiveness of using MacLaurin series for synthesizing PID 
controller tuning relation from IMC framework. In this paper, 
the desired closed loop response based on optimal performance 
for unit set point input and input disturbance are provided. We 
also develop the IMC-set point weighting tuning formulation. 
I. INTRODUCTION 
ESPITE the theoretical and practical development of 
advanced process control such as model predictive 
control (i.e. dynamic matrix control, model algorithmic 
control) for controlling chemical process especially in the 
supervisory layer, PID controller is still the most widely used 
controller type for regulatory control. This mainly due to the 
simplicity of the algorithm which can be understand relative 
easier by operator. Although, a tremendous effort have been 
devoted for developing the tuning relation, many recent 
surveys show that only a few loops worked well [2]. From 
those reports, it appears that poor controller tuning is one of 
the major reason which responsible for poor control 
performance. 
Internal Model Controller (IMC) provides a transparent 
analysis of controller design. It gives a simple 
parameterization of all stabilizing controller either for stable 
and unstable process. For stable process, the feedback 
controller design can be done in the â€œfeed forwardâ€ manner. 
IMC can also be extended to the unstable process 
straightforward.  
The development of PID tuning rules based on IMC 
originated by Rivera, et al. [3]. In their works, PID tuning 
rules augmented by first order filter in series are derived for 
several class of stable process with the aim at zeroth- and 
first- order padÃ© approximation. The tuning rules are further 
extended by Chien and Fruehauf [4] with utilizing first order 
Taylor series for approximating time delay. After these two, 
several modification and simplification are proposed for 
 
Jyh-Cheng Jeng is with the Department of Chemical Engineering and 
Biotechnology, National Taipei University of Technology, Taipei 106, 
Taiwan. (corresponding author to provide phone: +886-2-27712171 ext. 
2540; e-mail: jcjeng@ntut.edu.tw). 
Anggi A. Nasution is with the Department of Chemical Engineering, 
National Taiwan University, Taipei 106, Taiwan. (e-mail: 
a.arifin.nasution@gmail.com). 
Hsiao-Ping Huang is with the Department of Chemical Engineering, 
National Taiwan University, Taipei 106, Taiwan (e-mail: 
huanghpc@ntu.edu.tw). 
stable process. The first investigation of IMC-PID tuning 
rule for unstable process comes from Rotstein and Lewin [5]. 
In their work, time delay is neglected. An extension to the 
unstable process with time delay is presented by Lee, et al. 
[6]. They utilize MacLaurin series to approximate a whole 
ideal controller derived from IMC instead of time delay 
approximation. They also show that by approximating a 
whole controller rather than only-time delay, better control 
system performance can be obtained [1]. Shamsuzzoha and 
Lee [7] proposed different desired closed loop response 
which shown to be more effective deal with disturbance 
rejection. Shamsuzzoha and Lee [8] then proposed the 
analytical design of PID â€“ filter (i.e. PID cascade with lead â€“ 
lag element) for unstable and integrating process. Panda [9] 
investigated the synthesizing PID tuning formula through the 
Laurent series instead of Maclaurin series. In his work, he 
showed that the same result of PID tuning relation can be 
achieved. In this paper, the desired closed loop response is 
derived based on H2-optimal performance for step input and 
input disturbance.  
Huang and Chen [10] showed the time domain and 
frequency domain limitation imposed by unstable pole of 
process model when we use one degree of freedom control 
structure. It appears that there is a lower bound for overshoot 
and MT (i.e. peak of complementary sensitivity function) as 
a function of dead time to unstable time constant ratio. As the 
ratio becomes bigger, the lower bound increases and the 
system more difficult to control. Based on this result, they 
suggest three element control structure which is proved to be 
equivalent to two degree of freedom control structure [11]. In 
the work of [11], the tuning rule for set point weighting is 
proposed based on three element control structure in the 
earlier work [10]. In that suggestion the derivative weighting 
parameter is set to zero. However, in this work, we will 
develop a general correlation which links the set point 
weighting parameter to the IMC controller. Through this way, 
we can synthesize both the proportional and derivative 
weighting parameter. 
II. CONTROL SYSTEM DESIGN 
Figure 1 shows the two degree of freedom internal model 
control structure. QCD is the IMC controller for disturbance 
rejection, QCS is the IMC controller for set point tracking. GP 
is the process, PG  is the process model and GD d is the 
disturbance affecting the output y. It can be shown that the 
IMC Based Set-point Weighted PID Tuning for First Order Delay 
Unstable Process (FODUP) 
Jyh-Cheng Jeng, Anggi A. Nasution, and Hsiao-Ping Huang 
D 
Proceedings of the 2011 4th International Symposium on
Advanced Control of Industrial Processes, Thousand
Islands Lake, Hangzhou, P.R. China, May 23-26, 2011
WeA3.4
397
  
 
 ( ) ( )
'
1 1
;
k k
i i
P vH H
i ii i
s sb s b s
s s
pi pi
pi pi
= =
âˆ’ + âˆ’ +
= =
+ +
âˆ âˆ  (9) 
Then the H2 optimal controller can be found by deriving this 
formula 
 ( ) ( ) ( ){ }1 1CD P P v P P vQ s b G b v b G b vâˆ’ âˆ’âˆ’ âˆ’ + âˆ’
âˆ—
=
  
 (10) 
where { }
âˆ—
 is defined as the operator that operates by 
omitting all terms involving the poles of ( ) 1PG âˆ’+ after taking 
a partial fraction expansion. 
 For DCLR â€“ 4, we have 
 ( )
1
s
P
P
P
K e
G s
s
Î¸
Ï„
âˆ’
=
âˆ’

 (11) 
( )
1
P
P
P
P
K
G s
sÏ„
Ï„
âˆ’
âˆ’
=
âˆ’ +
 
	 

 

 and ( ) sPG s e Î¸âˆ’+ =  (12) 
( ) 1v s
s
âˆ’
=   and  ( ) 1v s+ =                    (13) 
( )
1
1
P
P
P
s
b s
s
Ï„
Ï„
âˆ’ +
=
+
  and  ( ) 1vb s =              (14) 
Then, by substituting (12)-(14) into (10), we get 
 ( ) 11 2 1 1
1
PP
CD P
P P
sQ s e s
K s
Î¸
Ï„Ï„ Ï„
Ï„
âˆ’
= âˆ’ +
+
 
 
 
 
	 

 
 
	 

 
 
 
 

 (15) 
 For DCLR â€“ 5, we have ,( ) ( )P PG Gs sâˆ’ +  , ( )v s+ , and ( )Pb s  
are the same as in DCLR â€“ 4. 
( )
1
1
P
v
P
s
b s
s
Ï„
Ï„
âˆ’ +
=
+
   and  ( )
1
P
P
P
K
v s
s sÏ„
Ï„
âˆ’
âˆ’
=
âˆ’ +
 
	 

 
 (16) 
Therefore, by substituting (16) into (10), we get 
 ( ) ( )1 1 1PPCD
P
sQ s e s
K
Î¸
Ï„Ï„ âˆ’
= âˆ’ +
 
 
 
	 

 
	 

 
 
 

 (17) 
2) F(s) is used to de-tune the controller to deal with the 
robustness problem. In this case we have one tuning 
parameter, Î» , which is closely related to the closed loop 
time constant. 
 ( ) ( )
1
1 1 0...
1
k
k
n
a s a s a
F s
sÎ»
âˆ’
âˆ’
+ + +
=
+
 (18) 
where n is chosen so that Q(s) is proper. 
In this case, (4) and (6) will be satisfied when ( ) 1iF p = , 
1,...,i k= . We can write this requirement in the matrix form 
 
( )
( )
1
1 1 1 1
1
0
1 1
1 1
nk
k
k n
k k k
p p a p
p p a p
Î»
Î»
âˆ’
âˆ’
âˆ’
+
=
+
 
 
 
	 

	 

	 

	 

	 

	 

	 

	 

	 

 
 
 

    

 (19) 
For no repeated poles, we have an explicit solution as 
 ( ) ( ) ( )1 1
1
1
1
kk
n i
jn
j i j i
i j
s p
F s p
p ps
Î»
Î» = =
â‰ 
âˆ’
= +
âˆ’+
 âˆ  (20) 
 For DCLR â€“ 4, we have  n = 2, 1 21 and 0Pp pÏ„= = .  
Then, we have 
 ( ) ( )2
2 1
1
P
s
F s
s
Î» Î»
Ï„
Î»
+ +
=
+
 
	 

 
 (21) 
 For DCLR â€“ 5, we have n = 3, 1 21 and 0Pp pÏ„= = . 
Then, we have 
 ( ) ( )3
1
1
s
F s
s
Î³
Î»
+
=
+
 (22) 
with 
 
2
3 3
P P
Î» Î»Î³ Î»
Ï„ Ï„
= + +
 
   
 
 
	 
 	 

   
 
 
 (23) 
From (5), we have 
 ( ) ( ) ( ) 1CD PQ s H s G s âˆ’=  
 

 (24) 
Therefore, by applying (24), we get the desired closed loop 
responses, DCLR â€“ 4 and 5, as shown in Table 1. 
The conventional feedback controller (i.e. CD) can be 
derived by using (1), that is 
 ( ) ( )( )[ ] ( )1D P
H s
C s
H s G s
=
âˆ’

 (25) 
It can be seen that the controller, CD, have the zeros and poles 
at the location of RHP poles of ( )PG s . The RHP zeros of 
CD(s) will be cancelled out by the zeros of ( )1 H sâˆ’  as we 
satisfy (5) and (6). Therefore there is no RHP poles â€“ zeros 
cancellation in conventional feedback control structure (i.e. 
Fig. 2). 
The controller, CD, is not finite dimensional due to the time 
delay which appears in ( )1 H sâˆ’ . We will use Maclaurin 
series expansion to get PID controller which approximates 
CD. Although it is not guaranteed to be the optimal one, but it 
is relatively easy to do with it and it has been shown as a good 
399
  
 
( )[ ]
( )[ ]
2
2
3
2
6
2
0
2
2
0 0
.1
2!
.1
2!
1 1
1
2
CS
CD
s
CS CS
sD I D s
d s C s
K ds
d s C sK
ds
dQ d Q
ds ds
Î³
Ï„ Ï„ Ï„
=
= =
= =
= + +
 
 
 
 
 	 

	 

 
 
 
 
 
 (38) 
This is the relation between derivative mode weighting and 
IMC controller. 
It should be noted that if we only approximate CS(s) by the 
first two terms of MacLaurin series, then 3 6/ 0K KÎ³ = = . 
Surprisingly, this is the rule of thumb which is usually used. 
However, it can be shown that if we can find the nearly 
optimal derivative mode weighting, the set point tracking 
performance will be better, that is we can reduce the 
overshoot, without losing the rise time. 
By using the relation given in (37) and (38), we can design 
the set point weighting PID controller. First define 
( )0H s as the complementary sensitivity function of one 
degree of freedom controller. Then we can divide it into two 
parts as follow 
 ( ) ( )0 0 0H s H s H
âˆ’ +=  (39) 
where ( )0H s+  is the non minimum phase part of ( )0H s+  in 
all pass form. Then the IMC controller for set point tracking 
can be designed as 
 ( ) ( )( )
10
1CS n
r
H
Q s
sÎ»
âˆ’
âˆ’
=
+
 (40) 
where n is chosen so that QCS(s) is semi-proper.  
III. ILLUSTRATIVE EXAMPLES 
Basically, the proposed design of 2 DOF shown in (37) 
and (38) can be used for any kind of DCLR shown in Table I. 
In the following illustration, we will utilize the DCLR â€“ 1 
considering that the same step can be applied for the other 
DCLR. 
A. Example 1 
Consider an example with open loop process described by 
 
1.2
1
s
P
e
G
s
âˆ’
=
âˆ’
 (41) 
The corresponding complementary sensitivity function of 
one degree of freedom controller can be described by 
 ( ) ( )
0
2
1
1
ssH s e
s
Î¸Î±
Î»
âˆ’
+
=
+
 
 
 
 
 (42) 
From (40), we can design the IMC controller for set point 
tracking as follows 
 
( )
( )( )
21
1 1CS
r
sQ
s s
Î»
Î± Î»
+
=
+ +
 (43) 
In order to make QCS semi-proper, we choose n = 1. By using 
(28) and (29)for designing PID controller for disturbance 
rejection and (37) and (38) for obtaining the set point 
weighting tuning parameter we can examine the performance 
of proposed set point weighting tuning method. Figure 4 
illustrate the response of set point tracking with unit step set 
point change introduce at t = 0. It is shown in Fig. 4 that the 
method give the satisfactory performance with significantly 
reduced the overshoot for a large range of
r
Î» . And because 
the characteristic equation does not change by applying the 
set point weighting thus the robust stability of the system can 
not be influenced. 
The proposed method has an advantage comparing to the 
trial and error using the rule of thumb of setting the set point 
weighting parameter (i.e. 0Î³ =  and vary the Î²  parameter). 
Figure 5 illustrate this statement by applying the unit step set 
point change at t = 0. Especially for unstable open loop 
process, the overshoot can be very sensitive as Î²  parameter 
is change and if we use a very small Î²  with 0Î³ = , the 
0 5 10 15 20 25 30 35 40
0
0.2
0.4
0.6
0.8
1
1.2
1.4
y
t
Î»r = 0.75 ISE = 1.636
Î»r = 2 ISE = 2.079
Î»r = 3 ISE = 2.622
Î»r = 4 ISE = 3.16
Î»r = 5 ISE = 3.617
Fig. 4.  Illustration for different 
r
Î»  for example 1. 
0 5 10 15 20 25 30 35 40
0
1
2
3
4
5
6
7
y
t
Î² = 0.8 ISE = 206.7 
Î² = 0.6 ISE = 106.9 
Î² = 0.4 ISE = 40.24
Î² = 0.2 ISE = 6.858
Î² = 0.0068
Chan-Cheng Chen ISE = 106.9
Fig. 5.  Illustration for different Î²  if we set 0Î³ =  for example 1. 
401
åœ‹ç§‘æœƒè£œåŠ©è¨ˆç•«è¡ç”Ÿç ”ç™¼æˆæœæ¨å»£è³‡æ–™è¡¨
æ—¥æœŸ:2011/12/23
åœ‹ç§‘æœƒè£œåŠ©è¨ˆç•«
è¨ˆç•«åç¨±: åŠå°é«”è£½ç¨‹ä¸­å°–å³°å¼å¿«é€Ÿç†±è™•ç†ç³»çµ±ä¹‹ç†±ç©å­˜æ§åˆ¶ç­–ç•¥
è¨ˆç•«ä¸»æŒäºº: é„­æ™ºæˆ
è¨ˆç•«ç·¨è™Ÿ: 99-2221-E-027-104- å­¸é–€é ˜åŸŸ: ç¨‹åºå·¥ç¨‹
ç„¡ç ”ç™¼æˆæœæ¨å»£è³‡æ–™
å…¶ä»–æˆæœ 
(ç„¡æ³•ä»¥é‡åŒ–è¡¨é”ä¹‹æˆ
æœå¦‚è¾¦ç†å­¸è¡“æ´»å‹•ã€ç²
å¾—çé …ã€é‡è¦åœ‹éš›åˆ
ä½œã€ç ”ç©¶æˆæœåœ‹éš›å½±éŸ¿
åŠ›åŠå…¶ä»–å”åŠ©ç”¢æ¥­æŠ€
è¡“ç™¼å±•ä¹‹å…·é«”æ•ˆç›Šäº‹
é …ç­‰ï¼Œè«‹ä»¥æ–‡å­—æ•˜è¿°å¡«
åˆ—ã€‚) 
ç„¡ 
 æˆæœé …ç›® é‡åŒ– åç¨±æˆ–å…§å®¹æ€§è³ªç°¡è¿° 
æ¸¬é©—å·¥å…·(å«è³ªæ€§èˆ‡é‡æ€§) 0  
èª²ç¨‹/æ¨¡çµ„ 0  
é›»è…¦åŠç¶²è·¯ç³»çµ±æˆ–å·¥å…· 0  
æ•™æ 0  
èˆ‰è¾¦ä¹‹æ´»å‹•/ç«¶è³½ 0  
ç ”è¨æœƒ/å·¥ä½œåŠ 0  
é›»å­å ±ã€ç¶²ç«™ 0  
ç§‘ 
æ•™ 
è™• 
è¨ˆ 
ç•« 
åŠ  
å¡« 
é … 
ç›® è¨ˆç•«æˆæœæ¨å»£ä¹‹åƒèˆ‡ï¼ˆé–±è½ï¼‰äººæ•¸ 0  
 
