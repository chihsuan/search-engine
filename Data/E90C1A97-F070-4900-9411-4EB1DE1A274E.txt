 1
 
ä¸­æ–‡æ‘˜è¦ 
æœ€è¿‘é€™å¹¾ï¦ç„¡ç·šç¶²ï¤·å¤§ï¥¾çš„è¢«ä½¿ç”¨åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸Šï¼Œè€Œä½¿ç”¨è€…çš„ä½ç½®éš±ç§ä¹Ÿå—åˆ°ï¦ºå¾ˆå¤§
çš„å¨è„…ã€‚åœ¨ç¾æœ‰çš„ç„¡ç·šå€åŸŸç¶²ï¤·çš„ç’°å¢ƒä¸­ï¼Œæ”»æ“Šè€…æœƒé€éä½¿ç”¨è€…ï¥§æœƒæ”¹è®Šçš„ç¶²ï¤·å¡å¯¦é«”ä½
ç½®ï¤­è¿½è¹¤ä½¿ç”¨è€…ã€‚åˆ°ç›®å‰ç‚ºæ­¢æœ‰è¨±å¤šç›¸é—œçš„ç ”ç©¶æ˜¯ç‚ºï¦ºè§£æ±ºé€™å€‹å•é¡Œè€Œæå‡ºï¤­çš„ï¼Œä½†ç”±æ–¼
é€™äº›ç›¸é—œçš„ç ”ç©¶ä¸¦æ²’æœ‰å°‡é™„è¿‘çš„ï¨ˆå‹•è£ç½®ä¹‹ç§»å‹•ï¨ˆç‚ºï¦œå…¥è€ƒæ…®ï¼Œæ‰€ä»¥é€™äº›ç ”ç©¶çš„è§£æ±ºæ–¹æ³•
æœƒéŒ¯å¤±è¨±å¤šå¯ä»¥æ”¹å–„ä½¿ç”¨è€…éš±ç§çš„æ™‚æ©Ÿï¼Œä¹Ÿå°±æ˜¯ï¥¯ç¾æœ‰çš„æ–¹æ³•åœ¨äº¤æ›ç¶²ï¤·å¡å¯¦é«”ä½å€çš„æ™‚
æ©Ÿä¸¦ï¥§ä¸€å®šæ˜¯æœ€å¥½çš„ï¼›è€Œä¸”å¯èƒ½æœƒé€ æˆè¨±å¤šï¥§å¿…è¦çš„äº¤æ›ç¶²ï¤·å¡å¯¦é«”ä½å€ï¼Œå°è‡´ç¶²ï¤·çš„æ•ˆ
èƒ½ï¨‰ä½ã€‚å› æ­¤ï¼Œåœ¨æœ¬è¨ˆåŠƒä¸­ï¼Œæˆ‘å€‘ä»¥ç›¸å°å®šä½çš„æ–¹æ³•ç‚ºåŸºç¤ï¤­æé«˜ä½¿ç”¨è€…çš„ä½ç½®éš±ç§ï¼›ä¸¦
åˆ†æä½¿ç”¨è€…é™„è¿‘ï¨ˆå‹•è£ç½®çš„ç§»å‹•ï¨ˆç‚ºï¤­æ±ºå®šå“ªäº›ï¨ˆå‹•è£ç½®éœ€è¦äº¤æ›å…¶ç¶²ï¤·å¡å¯¦é«”ä½ç½®ã€‚è€Œ
ç¶“ç”±å¯¦é©—çµæœå¾—çŸ¥ï¼Œæˆ‘å€‘çš„æ–¹æ³•èˆ‡ç¾æœ‰çš„æ–¹æ³•æ¯”è¼ƒé›–ç„¶æœƒç¨å¾®æ¸›ä½ç¶²ï¤·ï§Šï¥¾ï¼Œä½†ç¢ºå¯¦èƒ½æ¸›
ä½å…¶ç¶²ï¤·å¡å¯¦é«”ä½ç½®çš„äº¤æ›æ¬¡ï¥©ï¼Œä¹Ÿæé«˜ï¦ºä½¿ç”¨è€…çš„ä½ç½®éš±ç§ã€‚ 
 
é—œéµå­—ï¼šä½ç½®éš±ç§ã€ç„¡ç·šå€åŸŸç¶²ï¤·ã€ç¶²ï¤·å¡å¯¦é«”ä½ç½®ã€ç›¸å°å®šä½æŠ€è¡“ã€ç§»å‹•ï¨ˆç‚ºã€‚ 
 
Abstract 
The widespread deployment of wireless local area networks (WLAN) has introduced 
location privacy risks to wireless users, which enabled malicious individuals online to infer usersâ€™ 
private information or remotely locate them through the fixed MAC address. While a number of 
research studies have been proposed in order to solve the problems, they have not considered the 
influence of mobile behavior between neighboring nodes. Therefore, these research solutions 
may overlook the opportune moment updating the MAC address to improve or secure a userâ€™s 
location privacy. In other words, existing schemes may encounter difficulties seizing the 
opportune moment when updating the MAC address. Furthermore, many unnecessary MAC 
updates result in the major network throughput decrease. In this project, we propose a relative 
position-based scheme to improve a userâ€™s location privacy by analyzing his/her mobile 
behaviors. This scheme requires each mobile station related to the same access point to collect the 
received signal strength from one another, and the measured data will be transmitted periodically 
to a centralized server in order to determine which stationâ€™s MAC address should be updated. The 
results of this experiment have proved that there is a little decrease in the network throughput 
under the proposed scheme; however, they certainly reduce MAC address update frequency as 
well as enhance a userâ€™s privacy location.  
   
Key words: Location privacy, WLAN, MAC address, relative- positioning technology, mobile 
behavior. 
 
 
 3
addressæ˜¯éš¨æ©Ÿç¶“ç”±hash functionæ‰€ç”¢ç”Ÿçš„ã€‚æ–°MAC addressæ˜¯éš¨æ©Ÿå¾248 çš„MAC address 
poolä¸­é¸æ“‡çš„ã€‚æ‰€ä»¥é€™å€‹çµæ§‹ä½¿ï¨ˆå‹•è£ç½®åªèƒ½å¤ åœ¨ç‰¹å®šæ™‚é–“æ”¹é€²ä»–å€‘çš„MAC addressã€‚
å‡è¨­ä¸€å€‹æ”»æ“Šè€…å·²ç¶“å…¥ä¾µï¦ºä¸€äº›APï¼›ä¸¦ä¸”é€éé€™äº›APçš„ï¦šç·šè¨˜ï¤¿ï¤­è·Ÿè¹¤ä¸€å€‹ä½¿ç”¨è€…çš„
ï¨ˆå‹•ï¼Œå‰‡å¨è„…åˆ°ä½ç½®éš±ç§çš„åªåœ¨ä¸€äº›APçš„æ¶µè“‹ç¯„åœå…§ã€‚ä½†æ˜¯å¦‚æœä¸€å€‹æ”»æ“Šè€…ä½¿ç”¨RSS
èˆ‡TOAçš„è·Ÿè¹¤æ–¹æ³•è·Ÿè¹¤ä¸€å€‹ä½¿ç”¨è€…ï¼Œå‰‡é€™å€‹çµæ§‹å°‡ï¥§èƒ½æœ‰æ•ˆçš„é˜²ç¯„é€™ç¨®æ”»æ“Šã€‚ 
2. SWAP approach[4][17]  
é€™å€‹SWAP approachè®“æ¥è¿‘çš„ä½¿ç”¨è€…èƒ½å¤ äº¤æ›ä»–å€‘çš„MAC addressï¼Œå…¶MAC 
address poolå®¹ï¥¾æ¯”ä¸€æ¬¡æ€§çš„æ–¹æ³•å°çš„å¤šã€‚SWAP approachæœ‰ä¸‹ï¦œå„ªå‹¢ï¼šé€™ç¨®æ–¹æ³•å…¨éƒ¨
ï¥§éœ€è¦ç¯€é»åŒæ™‚ï¥§æ–·ï¤æ”¹ä»–å€‘çš„MAC addressï¼Œä½¿ç”¨ï¤å°‘ç¯€é»ï¥«åŠ äº¤æ›è€Œå¯ä»¥å¾—åˆ°ç›¸åŒ
çš„æ··ï¤›æ•ˆæœï¥§éœ€è¦åµæ¸¬MAC addressçš„ç¢°æ’ï¼›ä½†æ˜¯é€™å€‹æ–¹æ³•æœƒæœ‰å¾ˆå¤§çš„èŠ±è²»æ˜¯åœ¨äº¤æ›èº«
åˆ†çš„æºé€šä¸Š[17]ã€‚ 
ï¬ æ²‰é»˜å€é–“[10] 
æ²‰é»˜å€é–“æ˜¯ç”¨ï¤­æ¸›å°‘æ”»æ“Šè€…å°‡æ–°çš„MAC addressè·ŸèˆŠçš„ï¦šèµ·ï¤­çš„æ©Ÿæœƒ[10]ã€‚æ²‰é»˜å€é–“å°±
æ˜¯è¦ï¨ˆå‹•è£ç½®é€²å…¥ä¸€å€‹çŸ­æ™‚é–“çš„ç„¡é€šè¨Šï§ºæ…‹ï¼Œåœ¨é€™ï§ºæ…‹ä¸‹ï¤æ–°ä»–çš„MAC addressï¼Œç„¡é€š
è¨Šï§ºæ…‹æ™‚é–“çµæŸï¦ºä¹‹å¾Œå°±ä½¿ç”¨é€™æ–°çš„MAC addressã€‚æ²‰é»˜å€é–“çš„éæ¸¡æ™‚æœŸæ˜¯ä¸€å€‹å¯è®Šçš„
é•·ï¨è€Œä½¿ç”¨è€…åœ¨é€™æ®µæœŸé–“ï¥§å¯ä»¥é€ï¤¸ä»»ä½•æœ‰é—œæ–°èˆŠä½å€çš„è³‡è¨Šã€‚æ¡ç”¨æ²‰é»˜å€é–“ï¼Œå°‡å¯
ä»¥æ¸›ä½ç©ºé–“å’Œæ™‚é–“çš„é—œï¦šæ€§æ”»æ“Šï¼Œå› ç‚ºä½¿ç”¨è€…åœ¨æ²‰é»˜å€é–“é€™æ®µæ™‚é–“ï¥§èƒ½å‚³é€ä»»ä½•è¨Š
æ¯ï¼Œæ”»æ“Šè€…å°‡æ²’æœ‰è¾¦æ³•å¾—çŸ¥ä½¿ç”¨çš„ï¨ˆå‹•è³‡è¨Šã€‚é›–ç„¶èˆ‡Disposable approachæ¯”è¼ƒèµ·ï¤­ï¼Œé€™
å€‹æ–¹æ³•æä¾›ï¤å¤šçš„ä¿è­·ï¼Œä½†æ˜¯ä½¿ç”¨è€…ï¥§èƒ½ï¤é•·æ™‚é–“çš„é€²å…¥WLANã€‚å› æ­¤ï¼Œé€™å€‹çµæ§‹æ˜¯
åœ¨ä½ç½®éš±ç§å’Œæ€§èƒ½ä¹‹é–“çš„å–æ¨ã€‚ 
ï¬ æ¸›è¼•ç¶²ï¤·è² è¼‰çš„çµæ§‹[6] 
æ¡ç”¨åªç”¨ä¸€æ¬¡çš„MAC addressä½¿ç¶²ï¤·è² è¼‰åŠ å¤§ï¼Œé‡æ–°èˆ‡APåšï¦šçµä¹‹æ™‚é–“é”2.5ç§’ï¼Œé€™å€‹
éç¨‹æœƒï¨‰ä½ä½¿ç”¨è€…çš„è™•ï§¤é€Ÿï¨ã€‚å› æ­¤ï¼Œæ¸›è¼•ç¶²ï¤·è² è¼‰çš„çµæ§‹[6]å¾å¯è®ŠMAC addressä»¥åŠ
å»ºï§·å¯ä»¥ä¿¡ä»»çš„ä¸­å¿ƒä¼ºæœå™¨å–å¾—é€²å‡ºå°åŒ…çš„æœ‰ï§ç‰¹å¾µã€‚é€éä¸­å¿ƒä¼ºæœå™¨ä»¥åŠï¨ˆå‹•è£ç½®
ä¹‹é–“çš„åˆä½œï¼Œé€™äº›ï¨ˆå‹•è£ç½®èƒ½æœ‰æ•ˆæ¸›çŸ­æ¯æ¬¡ï¤æ›MAC addresséœ€è¦é‡æ–°ï¦šç·šçš„æ™‚é–“ã€‚ 
ï¬ ä½¿ç”¨è€…ä¸­å¿ƒçš„çµæ§‹[4]  
ä½¿ç”¨è€…ä¸­å¿ƒçš„çµæ§‹æè­°ä½¿é‚£äº›ä½¿ç”¨è€…èƒ½å¤ ç¢ºå®šåœ¨å“ªï§¨æˆ–ï§½éº¼æ™‚å€™ï¤æ”¹ä»–å€‘çš„MAC 
addressã€‚é€™å€‹çµæ§‹æ¡ç”¨æ¯å€‹ï¨ˆå‹•è£ç½®ï¨¦æœ‰GPSåŠŸèƒ½ï¼Œä¸¦ä¸”èƒ½è‡ªæˆ‘è¨­å®šé—œæ–¼åœ°åœ–éœ€è¦çš„
ä½ç½®ï¼Œä¹Ÿèƒ½é ï¦¾ä½¿ç”¨è€…çš„é€Ÿï¨è®ŠåŒ–ã€‚æ¯ä½ä½¿ç”¨è€…åªåœ¨ä»–ï¤æ”¹é€Ÿï¨æˆ–è€…æ–¹å‘æ™‚ï¤æ”¹å…¶
MAC addressã€‚ç„¶è€Œï¼Œå¦‚æœæƒ³å¢åŠ æ”¹é€²ä½ç½®éš±ç§éœ€è¦é¡å¤–çš„ç¡¬é«”èŠ±è²»ã€‚ 
è·Ÿæ“šå‰é¢æ‰€ï¥¯ç¾æœ‰çš„å¹¾ç¨®æ–¹æ³•ï¼Œè€Œå…¶ä¸­æœ‰å¹¾å€‹æ–¹æ³•å°æ–¼æŸç¨®çš„æ”»æ“Šæœ‰è¼ƒå¥½çš„é˜²æ²»æ•ˆæœ
ä½†æ˜¯ä¹Ÿæœƒè¢«å…¶ä»–æŸç¨®æ”»æ“Šæ‰€å¨è„…ã€‚ 
 
3. ç ”ç©¶æ–¹æ³• 
3.1 ç³»çµ±è¨­è¨ˆï§¤ï¦£ 
 æˆ‘å€‘çš„æ–¹æ³•æœ€ä¸»è¦æ˜¯ä½¿ç”¨å‹•æ…‹çš„ MAC address ï¤­é¿å…æ”»æ“Šè€…çš„è¿½è¹¤ï¼Œä»¥åŠèƒ½ï¨‰ä½ï¥§å¿…
è¦çš„èŠ±è²»ï¼Œä»¥ç›¸å°å®šä½çš„æ–¹æ³•ç‚ºåŸºç¤ï¤­æé«˜ä½¿ç”¨è€…çš„ä½ç½®éš±ç§ï¼Œä¸¦åˆ†æä½¿ç”¨è€…é™„è¿‘ï¨ˆå‹•è£
ç½®çš„ç§»å‹•ï¨ˆç‚ºï¤­æ±ºå®šå“ªäº›ï¨ˆå‹•è£ç½®éœ€è¦äº¤æ›å…¶ç¶²ï¤·å¡å¯¦é«”ä½ç½®ã€‚ 
ï¬ ç„¡æ³•è¿½è¹¤çš„MAC Address  
ç‚ºï¦ºé˜»æ­¢æ”»æ“Šè€…é€éå›ºå®šï¥§è®Šçš„MAC addressè·Ÿè¹¤ï¼Œå¿…é ˆæ¡ç”¨å‹•æ…‹çš„MAC addressã€‚ä¹Ÿçµåˆ
 5
3.2 ç³»çµ±æ¶æ§‹ 
ç³»çµ±çš„æ¶æ§‹å¦‚åœ–äºŒæ‰€ç¤ºï¼Œå…¶ç¬¦è™ŸåŠé‹ä½œï¥¯æ˜å¦‚ä¸‹ï¼š 
ï¬ Assignment Server(AS)ï¼š 
é¦–å…ˆå»ºï§·ä¸€å€‹å¯ä»¥ç›¸ä¿¡çš„ Server ï¤­åšè¨ˆç®—ï¨ˆå‹•è£ç½®çš„ç§»å‹•ï¨ˆç‚ºä»¥åŠæ±ºå®šå“ªäº›ï¨ˆå‹•è£ç½®
è¦äº¤æ› MAC addressï¼Œæ­¤ä¸€å¯åŠ å¼·éš±ç§æŒ‡å®šçš„å¯ä¿¡çš„ server ç‚º ASï¼Œé€™å€‹ Server æ˜¯è¦å¯
ä»¥è¢«ç›¸ä¿¡ä»¥åŠå®‰å…¨çš„ï¼Œ  ä»¥åŠè¦æœ‰ Authentication (ç¢ºèª)ã€Authorization (æˆæ¬Š)åŠ 
Accounting (è¨˜ï¤¿)çš„åŠŸèƒ½ã€‚AS ä¸­å°‡æœƒæœ‰ä¸€å€‹ table ï¤­è¨˜ï¤¿ AS åº•ä¸‹çš„ APï¼Œä¸¦å°‡æ¯å€‹ AP
åˆ†æˆä¸€å€‹ç¾¤çµ„ï¼Œæ¯ä¸€ç¾¤çµ„å…§æœ‰æ‰€æœ‰åœ¨æ­¤ AP ä¸‹çš„ MSï¼Œä¸”å°‡ MS çš„ MAC address è¨˜ï¤¿åœ¨
table å…§ã€‚ 
 
åœ–äºŒï¼šç³»çµ±æ¶æ§‹ 
 
ï¬ Access Point(AP) 
æˆ‘å€‘ä½¿ç”¨çš„ AP è·Ÿå¹³å¸¸çš„ AP å¤§è‡´ä¸Šï¨¦ç›¸åŒï¼Œåªæ˜¯åœ¨ï¨ˆå‹•è£ç½®èˆ‡ AP å»ºï§·ï¦šç·šå¾Œï¼ŒAP
è¦èˆ‡ AS æºé€šï¼ŒAP å·²åŠ å…¥ï¦ºä¸€å€‹æ–°çš„ï¨ˆå‹•è£ç½®ï¼Œå‰‡ AS è¦å»ï¤æ–° table ï§¨çš„è³‡ï¦¾ã€‚ 
ï¬ Mobile Station(MS) 
æ¯å€‹ï¨ˆå‹•è£ç½®ï¨¦æœƒæœ‰ä¸€å€‹ä½¿ç”¨è€…çš„ tableï¼Œè¨˜ï¤¿ï¦ºæ‰€æœ‰èˆ‡è‡ªå·±ä½¿ç”¨åŒä¸€å€‹ AP çš„å…¶ä»–ä½¿
ç”¨è€…çš„ MAC addressï¼Œï¨ˆå‹•è£ç½®æœƒä¾ç…§é€™å€‹ table è’é›†å½¼æ­¤çš„è¨Šè™Ÿï¼Œä»¥åŠ AP çš„è¨Šè™Ÿï¼Œ
å‚³å›çµ¦ ASï¼ŒAS å‰‡æœƒæ ¹æ“šé€™äº›è³‡ï¦¾ç®—å‡º MS çš„ç§»å‹•ï¨ˆç‚ºï¼Œï¤­æ±ºå®šè¦äº¤æ›çš„ä½¿ç”¨è€…ã€‚ 
æ¥ä¸‹ï¤­ä»‹ç´¹æ‰€ä½¿ç”¨åˆ°çš„ä¸€äº›å‡½ï¥©ä»¥åŠç¬¦è™Ÿï¼š 
uiï¼šè¡¨ç¤ºä½¿ç”¨è€… i 
APÎ»ï¼šè¡¨ç¤ºç·¨è™ŸÎ»çš„ AP 
dijï¼šè¡¨ç¤º uièˆ‡ ujä¹‹é–“çš„è·ï§ª 
Ek(m)ï¼šè¡¨ç¤ºä½¿ç”¨ key K å°‡è¨Šæ¯ m åŠ å¯† 
Sk(m)ï¼šè¡¨ç¤ºä½¿ç”¨ key K å°‡è¨Šæ¯ m åŠ ä¸Šç°½ç«  
MACiï¼šè¡¨ç¤ºä½¿ç”¨è€… i çš„ MAC address 
}-{uG i
MAC ï¬ ï¼šåœ¨ GÎ»å…§æ‰€æœ‰çš„ä½¿ç”¨è€…é™¤ï¦º ui ä»¥å¤–å…¶ä»–ä½¿ç”¨è€…çš„ MAC address 
SSiï¼šè¡¨ç¤º uiçš„è¨Šè™Ÿå¼·ï¨ 
AS   
MS1
AP
MS2
MS3
MS4
AP2  
MS5   
MS6  
 7
æ¸¬ï¼Œå†æ ¹æ“šé€™äº›ç§»å‹•ï¨ˆç‚ºåšä¸€äº›è¨ˆç®—å¾Œï¼Œå†æ±ºå®šå“ªäº›ï¨ˆå‹•è£ç½®éœ€è¦äº¤æ›å…¶ MAC addressï¼Œ
æ­¤æ™‚ AS æœƒå…ˆï¤æ–° GÎ»çš„ tableï¼Œå†å‚³å°åŒ…çµ¦éœ€è¦äº¤æ› MAC address çš„ï¨ˆå‹•è£ç½®ï¼Œå…¶ä¸­åŒ…å«ï¦º
éœ€è¦äº¤æ›çš„æ–° MAC address  
MAC-Change [ 
juPK
E (new 'jMAC ||TS|| ASSKS (new 
'
jMAC ||TS))]ã€‚ 
ujåœ¨æ”¶åˆ°é€™å€‹å°åŒ…ä»¥å¾Œå°‡æœƒä¾ç…§å…§å®¹ï¤­äº¤æ› MAC addressï¼Œä¸¦ä¸”åœ¨äº¤æ› MAC address çš„æœŸ
é–“ï¼Œä½¿ç”¨è€…å°‡ç„¡æ³•å‚³é€ä»»ä½•è¨Šæ¯ï¼Œè€Œäº¤æ›å®Œ MAC address ä¹‹å¾Œå‰‡æœƒç¹¼çºŒè’é›†è¨Šè™Ÿå¼·ï¨ï¼Œä¸¦
ä¸”æ¯ç§’å‚³é€ Signal-Resp çµ¦ AS ç›´åˆ°ï§ªé–‹é€™å€‹ groupã€‚ç•¶ä½¿ç”¨è€… ujï§ªé–‹é€™å€‹ group å‰‡ AP å°‡æœƒ
ç™¼é€ï§ªé–‹çš„è¨Šæ¯çµ¦ AS 
Leave [ 
ASPKE (
'
jMAC || ï¬APMAC ||TS|| ï¬APSKS (
'
jMAC || ï¬APMAC || TS))] ã€‚ 
è€Œ AS æ”¶åˆ°ä»¥å¾Œå‰‡æœƒå°‡ 'jMAC åŠ MACjå¾è¨»å†Šè¡¨ä¸­åˆªé™¤ï¼Œä¸¦ä¸”ç™¼é€ Table-Update å°åŒ…çµ¦é‚„
åœ¨é€™å€‹ group ï§¨çš„æ‰€æœ‰ä½¿ç”¨è€…ï¤­ï¤æ–°ä»–å€‘çš„ table ä»¥åŠæ–°çš„
ï¬GGK'   
Table-Update [ ï¬GGKE (delete ||
'
jMAC || ï¬GGK' ||TS|| ASSKS (delete ||
'
jMAC || ï¬GGK' ||TS))] ã€‚ 
 
3.2.2 ç›¸å°å®šä½ 
 ä½¿ç”¨è€…å¿…é ˆè’é›†åœ¨è‡ªå·±æ‰€å±¬çš„ç¾¤çµ„ä¸­é™¤ï¦ºè‡ªå·±ä»¥å¤–çš„å…¶ä»–ï¨ˆå‹•è£ç½®ä»¥åŠ AP çš„è¨Šè™Ÿå¼·
ï¨ï¼Œä¸¦ä¸”å‚³é€çµ¦ ASï¼Œè€Œ AS åœ¨æ”¶åˆ°é€™äº›è¨Šè™Ÿå¼·ï¨ä»¥å¾Œå°‡æœƒä¾ç…§å…¶æå¤±çš„è¨Šè™Ÿå¼·ï¨ï¤­è¨ˆç®—å‡º
ï¥¸è€…ä¹‹é–“çš„è·ï§ªï¼Œé€™å€‹è½‰æ›çš„éƒ¨åˆ†åœ¨ï¥§åŒçš„ç’°å¢ƒä¸­æœƒæœ‰ï¥§åŒæå¤±è¨Šè™Ÿå¼·ï¨çš„æ¨¡å‹ï¼ŒåŸºç¤å¼
å­å¦‚ä¸‹[7][19]ï¼š  
ï¦
ïƒ·ïƒ·ïƒ¸
ïƒ¶
ïƒ§ïƒ§ïƒ¨
ïƒ¦ï‚µ
0d
dPL(d) ï¼ŒPL ç‚ºå¹³å‡ï¦ºæå¤±ï¼ŒÏˆè¡¨ç¤ºå¹³å‡æå¤±é€Ÿï¨å¢åŠ çš„æŒ‡ï¥©ï¼Œd ç‚ºç™¼é€è€…èˆ‡
æ¥æ”¶è€…ä¹‹é–“çš„è·ï§ªï¼Œd0 ç‚ºï¥«è€ƒè·ï§ªã€‚ 
AS åœ¨æ”¶åˆ°ï¦ºæ‰€æœ‰ï¨ˆå‹•è£ç½®æ‰€å›å‚³çš„è¨Šè™Ÿå¼·ï¨ä»¥å¾Œï¼Œä¾ç…§æå¤±è¨Šè™Ÿå¼·ï¨çš„æ¨¡å‹å°‡ï¥©æ“šè½‰æ›æˆ
è·ï§ªï¼Œä¸¦ä¸”æœƒå»ºï§·ä¸€å€‹çŸ©é™£ DM(Distance Matrix)ï¤­å­˜è½‰æ›ä»¥å¾Œçš„è·ï§ªå¦‚ä¸‹ï¼š 
 
 
 
 
DM= 
 
 
 
 
 ïƒºïƒº
ïƒºïƒº
ïƒºïƒº
ïƒºïƒº
ïƒº
ïƒ»
ïƒ¹
ïƒªïƒª
ïƒªïƒª
ïƒªïƒª
ïƒªïƒª
ïƒª
ïƒ«
ïƒ©
ï¬
ï¬
ï¬
ï¬
ï¬
ï¬
nAPnnnjnnn
iAPinijiii
APnj
APnj
APnj
n
i
nj
dddddd
dddddd
dddddd
dddddd
dddddd
u
u
u
u
u
APuuuuu
ïŒïŒ
ïïïïïïïï
ïŒïŒ
ïïïïïïïï
ïŒïŒ
ïŒïŒ
ïŒïŒ
ï
ï
ïŒïŒ
321
321
333333231
222232221
111131211
3
2
1
321                
 9
ï¤­æ±‚å‡ºç§»å‹•å‘ï¥¾ï¼Œå‡è¨­ ui åŸæœ¬çš„åº§æ¨™ç‚º( iuX , iuY )è€Œæ–°åº§æ¨™ç‚º(
'
iuX , 
'
iuY )ï¼Œå‰‡ç§»å‹•å‘ï¥¾
iuMV ç‚º((
'
iuX - iuX ),(
'
iuY - iuY ))ã€‚å°‡æ‰€æœ‰çš„å‘ï¥¾ï¨¦ç®—å‡ºï¤­ä»¥å¾Œå­˜åœ¨ table ä¸­ï¼Œç„¶å¾Œ AS æœƒ
å»ç®—å‡ºå…¶å‘ï¥¾çš„å¤¾è§’ï¤­åšç‚ºä¹‹å¾Œæ±ºå®šå“ªäº›ï¨ˆå‹•è£ç½®è¦äº¤æ› MAC address çš„ä¾æ“šï¼Œç®—æ³•å¦‚åœ–
å››ï¼Œç®—å®Œä»¥å¾Œæœƒå°‡æ‰€æœ‰çš„è§’ï¨å­˜åˆ° AM(Angle Matrix)ä¹‹ä¸­ï¼Œä»¥ï¥¥ä¹‹å¾Œçš„é‹ç”¨ã€‚ 
 
 
 
 
 
 
 
 
     AM= 
 
 
 
 
 
åœ–å››ï¼šç§»å‹•æ–¹å‘å¤¾è§’ 
 
æœ€å¾Œè¦æ±ºå®šå“ªäº›ï¨ˆå‹•è£ç½®éœ€è¦äº¤æ›å…¶ MAC addressï¼Œæˆ‘å€‘çš„æ–¹æ³•æ˜¯ç•¶æœ‰ä¸€å€‹ä½¿ç”¨è€…æå‡ºä¿
è­·ä½ç½®éš±ç§çš„è¦æ±‚ï¼Œå‰‡ AS æœƒåœ¨ DM ä¸­å»æª¢æŸ¥æœ‰å“ªäº›ï¨ˆå‹•è£ç½®èˆ‡æ­¤ä½¿ç”¨è€…çš„è·ï§ªåœ¨ä¸€å€‹ç¯„
åœå…§ï¼Œä¸¦ä¸”å†å» AM ä¸­æª¢æŸ¥é€™äº›ï¨ˆå‹•è£ç½®èˆ‡æ­¤ä½¿ç”¨è€…ç§»å‹•ï¨ˆç‚ºçš„å¤¾è§’ï¼Œï¥´å¤¾è§’å°æ–¼æ‰€å®šçš„
è§’ï¨å‰‡é€™äº›ï¨ˆå‹•è£ç½®å‰‡æœƒåŠ å…¥æ­¤æ¬¡äº¤æ› MAC address çš„ç¾¤çµ„ä¸­ï¼Œå¤¾è§’ï¥´å¤§æ–¼æˆ‘å€‘æ‰€å®šçš„è§’
ï¨å‰‡ï¥§æœƒåœ¨æ­¤æ¬¡äº¤æ› MAC addressï¼Œæ±ºå®šï¦ºå“ªäº›ï¨ˆå‹•è£ç½®è¦äº¤æ›ï¼Œä»¥å¾Œ AS å‰‡æœƒï¤›ï¥©æ±ºå®šå¦‚
ä½•äº¤æ›ç¾¤çµ„ä¸­çš„ MAC address ä¸¦ä¸”å‚³é€ MAC-Change çµ¦é€™äº›ï¨ˆå‹•è£ç½®ã€‚ 
 
4.å¯¦é©—çµæœ 
 æ¥ä¸‹ï¤­ä»‹ç´¹å¯¦é©—çš„ç’°å¢ƒï¼Œä½¿ç”¨çš„æ¨¡æ“¬è»Ÿé«”ç‚ºNS2ï¼Œæ¨¡æ“¬çš„ç’°å¢ƒç¯„åœæ˜¯è¨­å®šç‚º
100*100m2ï¼Œç¶²ï¤·æœ€å¤§ï§Šï¥¾è¨­å®šç‚º100Mb/secï¼Œåœ¨é€™å€‹ç¯„åœï§¨çš„ï¨ˆå‹•è£ç½®æœ‰100å€‹ï¼Œæ‰€æœ‰ï¨ˆå‹•
è£ç½®æ˜¯éš¨æ©Ÿç§»å‹•çš„ï¼Œè€Œé€Ÿï¥¡å‰‡æœƒåœ¨0~3 m/sä¹‹é–“ï¼Œé€Ÿï¥¡çš„è®ŠåŒ–å‰‡ä»¥1m/s2ç‚ºåŸºæº–ï¼Œå‡è¨­åŠ é€Ÿã€
ç¶­æŒï¥§è®Šæˆ–æ¸›é€Ÿçš„æ©Ÿï¥¡è¨­å®šç‚º [P+ , P0 , P-]=[0.1 , 0.8, 0.1]ï¼Œåœ¨æ¯3~5ç§’ä¹‹é–“ç§»å‹•ç¯€é»æœƒä¾ç…§
ïƒºïƒº
ïƒºïƒº
ïƒºïƒº
ïƒ»
ïƒ¹
ïƒªïƒª
ïƒªïƒª
ïƒªïƒª
ïƒ«
ïƒ©
nnnnn
n
n
n
n
n
u
u
u
u
uuuu
ï±ï±ï±ï±
ï±ï±ï±ï±
ï±ï±ï±ï±
ï±ï±ï±ï±
ïŒ
ïïïïï
ïŒ
ïŒ
ïŒ
ï
ïŒ
321
3333213
2232212
1132111
3
2
1
 3       2   1      
ïƒ·ïƒ·
ïƒ·
ïƒ¸
ïƒ¶
ïƒ§ïƒ§
ïƒ§
ïƒ¨
ïƒ¦
ï‚´
ï‚·ï€½ ï€­
ji
ji
uu
uu
ij
MVMV
MVMV1cosï±
Î¸ij  
Î¸
uMV
uMV
uMV
 11
åœ¨åœ–äº”ï¼šäº”ä¸­å¯ä»¥çœ‹åˆ°åœ¨æ‰€å®šçš„å¤¾è§’ç‚º 22.5 ï¨æ™‚ 4 ç¨®è¨­å®šçš„ç¯„åœæ‰€å¾—åˆ°çš„çµæœï¼Œç”±åœ–
ä¸­å¯çœ‹å‡ºç¯„åœå®šç‚º 5m æ™‚ï¼Œæ¸¬è©¦å‡ºï¤­çš„æˆæœæ¯”ç¯„åœè¨­å®š 10m æ™‚é‚„å·®ï¼Œå› ç‚ºåœ¨ç¯„åœå®šç‚º 5m
æ™‚ç¬¦åˆå¤¾è§’ç‚º 22.5 ï¨çš„ï¨ˆå‹•è£ç½®ï¥©ï¥¾æ¯”ç¯„åœå®šç‚º 10m çš„å°‘ï¼Œè€Œä¸”ï¥§è¶³ä»¥æ··ï¤›æ”»æ“Šè€…ï¼Œé›–ç„¶
åœ¨ç¯„åœ 10m çš„ï¨ˆå‹•è£ç½®ï¥©ï¥¾æ¯”ç¯„åœç‚º 15m åŠ 20m çš„å°‘ï¼Œä½†æ˜¯å¯ä»¥é”åˆ°æ··ï¤›çš„æ•ˆæœï¼Œæ‰€ä»¥
ç¯„åœç‚º 15m åŠ 20m çš„ï¨ˆå‹•è£ç½®ï¥©ï¥¾é›–å¤šä½†å¤šï¥©ç‚ºæ²’æœ‰å¿…è¦çš„äº¤æ›ï¼›è€Œåœ¨åœ–ï§‘ä¹Ÿå¯ä»¥ç™¼ç¾åŒ
æ¨£çš„æƒ…å½¢ï¼Œåœ¨ 45 ï¨ä¸­ç¯„åœè¨­å®šç‚º 5m çš„ï¨ˆå‹•è£ç½®ï¥©ï¥¾ï¨¦å°‘ï¦ºä¸€é»ï¼Œè€Œè¨­å®šç‚º 15m åŠ 20m
çš„å‰‡æ˜¯å¤šï¦ºç„¡æ•ˆçš„äº¤æ›ï¼Œæ‰€ä»¥å°‡æ¯ä¸€å€‹è§’ï¨ä¸­ç¯„åœç‚º 10m çš„æ‹¿å‡ºï¤­åšæ¯”è¼ƒï¼Œå¦‚åœ–ä¸ƒæ‰€ç¤ºåœ¨
æ‰€æœ‰ç¯„åœç‚º 10m çš„æƒ…å½¢ï¼Œå¯ä»¥è§€å¯Ÿåœ¨ 45 ï¨çš„æ··ï¤›æ•ˆæœè¼ƒå¥½ï¼Œå› æ­¤æŠŠç¯„åœè¨­åœ¨ 10m è€Œå¤¾è§’
è¨­ç‚º 45 ï¨ï¼Œä¸¦ä¸”è·Ÿä»¥å‰çš„æ–¹æ³•åšä¸€äº›æ¯”è¼ƒã€‚ 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1 2 3 4 5 6 7 8 9 10 11 12 13 14
Change Round
Pe
rce
nta
ge
 of
 N
od
es
angle-22.5
angle-45
 
åœ–ä¸ƒï¼šå„å€‹å¤¾è§’åœ¨ç¯„åœè¨­å®šç‚º 10m çš„å¯¦é©—çµæœ 
 
èˆ‡åªäº¤æ› MAC address çš„æ–¹æ³•[9]ä»¥åŠ 2 ç§’çš„æ²‰é»˜å€é–“çš„æ–¹æ³•[10]åšæ¯”è¼ƒï¼Œçµæœå¦‚åœ–å…«
æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°åœ¨äº¤æ› 3 æ¬¡ä»¥å¾Œï¼Œæˆ‘å€‘çš„æ–¹æ³•åªå‰©ä¸‹ 40%å¯ä»¥è¢«è¿½è¹¤åˆ°ï¼Œè€Œ[10]é‚„æœ‰ 60%
çš„å¯ä»¥è¢«è¿½è¹¤åˆ°ï¼Œ[9]é‚„æœ‰å¤šé” 80%çš„ï¨ˆå‹•è£ç½®å¯ä»¥è¢«è¿½è¹¤ï¼Œè€Œåœ¨åœ–ä¹ä¸­å¯ä»¥çœ‹ï¨Šæˆ‘å€‘çš„æ–¹
æ³•è¦è®“æ‰€æœ‰çš„ï¨ˆå‹•è£ç½®ï¨¦ï¥§æœƒè¢«è¿½è¹¤åˆ°éœ€è¦ 8 æ¬¡ï¼Œ[10]éœ€è¦ 14 æ¬¡ï¼Œè€Œ[9]å‰‡éœ€è¦ 26 æ¬¡ï¼Œç”±
æ­¤å¯çŸ¥æˆ‘å€‘çš„æ–¹æ³•ç¢ºå¯¦å¯ä»¥æ¸›å°‘äº¤æ›çš„æ¬¡ï¥©ï¼Œä¸¦ä¸”å¯ä»¥ï¤æœ‰æ•ˆçš„ä¿è­·ä½¿ç”¨è€…çš„éš±ç§ã€‚ 
0
0.2
0.4
0.6
0.8
1
1 5 9 13 17 21 25
Change Round
Pe
rce
nta
ge
 of
 N
od
es only change MACaddress[11]
change MAC
address with 2s
silent period[13]
the proposed scheme
 
åœ–å…«ï¼šä½ç½®éš±ç§ä¿è­·æ•ˆæœä¹‹æ¯”è¼ƒ 
 13
[4] S. Capkun, M. Hamdi, and J. Hubaux, â€œGPS-free positioning in mobile ad-hoc networksâ€ in 
Proc. of the 34th Annual Hawaii Intâ€™l Conf. on System Sciences, vol. 9, 2001: pp.157-167. 
[5] D. Chaum, â€œUntraceable electronic mail, return addresses and digital pseudonyms, â€ Comm. 
ACM, vol. 24, no. 2, 1981:pp. 84-88. 
[6] K. E. Defrawy, C. Soriente, â€œPEUC-WiN: privacy enhancement by user cooperation in 
wireless networksâ€ in Proc. IEEE Workshop on Secure Network Protocols, 2006: pp.38-43. 
[7] V. Erceg, L.J. Greenstein, S.Y. Tjandra, S.R. Parkoff, A. Gupta, B. Kulic, A.A. Julius, R. 
Bianchi, â€An empirically based path loss model for wireless channels in suburban 
environmentsâ€ Digital Object Identifier: 10.1109/GLOCOM.1998.776865, vol. 17, Issue 7, 
1999: pp.1205-1211 
[8] A. Gorlach, A. Heinemann and W. W. Terpstra, â€œSurvey on location privacy in pervasive 
computing.â€ Privacy, Security, and Trust Within the Context of Pervasive Computing 2004: 
pp. 24-34. 
[9] M. Gruteser and D. Grunwald, â€œEnhancing location privacy in wireless LAN through 
disposable interface identifiers: a quantitative analysisâ€ in Proc. of 1st ACM Intâ€™l workshop 
on Wireless mobile applications and services on WLAN hotspots, 2005: pp.315-325. 
[10] L. Huang, K. Matsuura, H. Yamane, and K. Sezaki, â€œEnhancing wireless location privacy 
using silent periodâ€ in Proc. IEEE Wireless Commun. Netw. Conf. ,2005: pp.1178-1192. 
[11] T, Jiang, J. W. Helen, Y. C. Hu,â€Preserving location privacy in wireless LANsâ€ in Proc. the 
5th Intâ€™l conf. on Mobile systems, applications and services, 2007: pp.246 â€“ 257. 
[12] A. Juels, R. L. Rivest and M. Szydlo, â€œThe blocker tag: selective blocking of RFID tags for 
consumer privacyâ€ in Proc. of 10th ACM Conf. on Computer and Commun. Security,  2003: 
pp.103-111. 
[13] H. Kido, Y. Yanagisawa and T. Satoh, â€œProtection of location privacy using dummies for 
location-based servicesâ€ in Proc. of the 21st Intâ€™l Conf. on Data Engineering, 2005: 
pp.1248-1253. 
[14] A. Kushki, K. N. Plataniotis and A. N. Venetsanopoulos, â€œLocation tracking in wireless local 
Area networks with adaptive radio mapsâ€ IEEE ICASSP, 2006: pp. 741-744. 
[15] A. M. Ladd,  K. E. Bekris, A. Rudys, L. E. Kavraki and D. S. Wallach, â€œRobotics-based 
location sensing using wireless ethernetâ€ Wireless Networks, vol. 11, no. 1-2 ,2005: 
pp.189-204. 
[16] M. Li, K. Sampigethaya, L. Huang and R. Poovendran, â€œAnonymity: swing & swap: 
user-centric approaches towards maximizing location privacyâ€ in Proc. of the 5th ACM 
workshop on Privacy in electronic society, October 2006: pp.19-28. 
[17] L. Ming, H. Xiaoyan, S. V. Vrbsky, â€œProtecting location privacy with dynamic Mac address 
exchanging in wireless networksâ€ Global Telecommunications Conference, 2007: pp.49-53. 
[18] K. Muthukrishnan, N. Meratnia, M. Lijding, G. Koprinkov, P. H., â€œWLAN location sharing 
through a privacy observant architectureâ€ in Proc. Intâ€™l Conf. Communication System 
Software and Middleware 2006, paper no. 43. 
[19] S. Phaiboon, â€ An empirically based path loss model for indoor wireless channels in 
laboratory buildingâ€ in Proc. of TENCONâ€™02 Oct. 2002: pp.1020-1023. 
 1
å‡ºå¸­åœ‹éš›å­¸è¡“æœƒè­°å¿ƒå¾—å ±å‘Š 
                                                             
è¨ˆç•«ç·¨è™Ÿ NSC97-2213-E-158-003 
è¨ˆç•«åç¨± åœ¨ç„¡ç·šå€åŸŸç¶²ï¤·ä¸­å¢é€²ä½ç½®éš±ç§ä¹‹ç ”ç©¶ 
å‡ºåœ‹äººå“¡å§“å 
æœå‹™æ©Ÿé—œåŠè·ç¨± å³ï¤Šé›„ å¯¦è¸å¤§å­¸ è³‡è¨Šç§‘æŠ€èˆ‡é€šè¨Šå­¸ç³»æ•™æˆå…¼å‰¯æ•™å‹™é•· 
æœƒè­°æ™‚é–“åœ°é»  2009 ï¦ 8 æœˆ 25 æ—¥è‡³ 27 æ—¥ éŸ“åœ‹é¦–çˆ¾ 
æœƒè­°åç¨± 2009 Fifth International Joint Conference on INC, IMS and IDC 
ç™¼è¡¨ï¥æ–‡é¡Œç›® Detecting Unknown Malicious Executables Using Portable Executable Headers 
 
 
ä¸€ã€ ï¥«åŠ æœƒè­°ç¶“é 
International Joint Conference on INC, IMS and IDC æ˜¯ç”± AICIT å­¸æœƒï¼ˆThe 
worldâ€™s leading research association of Theory, Development, Applications, 
Experiences, and Evaluation of Multidisciplinary and Hybrid/Convergent 
Research/ Technology/Serviceï¼‰æ‰€ä¸»è¾¦çš„åœ‹éš›ç ”è¨æœƒï¼Œå”è¾¦å–®ä½æ˜¯ IEEE 
Computer Societyï¼Œä»Šï¦æ˜¯ç¬¬ 5 å±†ï¼Œæ–¼ 8 æœˆ 25 æ—¥è‡³ 27 æ—¥ç”±éŸ“åœ‹ Sogangèˆ‡
é¦–çˆ¾å¤§å­¸åˆè¾¦ï¼Œåœ¨éŸ“åœ‹é¦–çˆ¾å¸‚çš„ Grand Hilton Seoul ï¨ªåº—èˆ‰ï¨ˆï¼Œç‚ºåœ‹éš›é–“ç¶²
ï¤·é‹ç®—ï¼Œè³‡è¨Šç®¡ï§¤èˆ‡ï¥©ä½å¤šåª’é«”æŠ€è¡“ç›¸é—œï¦´åŸŸä¹‹é‡è¦ç ”è¨æœƒï¼Œæä¾›å­¸è€…
å­¸è¡“åŠæŠ€è¡“äº¤ï§Šèšæœƒã€‚æœ¬ç ”ç©¶è¨ˆç•«ä¸»è¦æ˜¯ç ”ç©¶å€åŸŸç¶²ï¤·ä¸­çš„å®‰å…¨æ€§ï¼Œèƒ½
å‡ºå¸­æ­¤åœ‹éš›å­¸è¡“ç››æœƒäº¤æ›ç ”ç©¶å¿ƒå¾—ä»¥åŠæœ€æ–°çŸ¥ï§¼ï¼Œæ·±æ„Ÿæ¦®å¹¸ï¼ 
æˆ‘æ–¼8 æœˆ23 æ—¥å…ˆå¾é«˜é›„æ©Ÿå ´æ­ä¹˜ä¸­è¯èˆªç©ºç­æ©Ÿç›´é£›éŸ“åœ‹ä»å·åœ‹éš›
æ©Ÿå ´ï¼Œçœ‹åˆ°ä»å·åœ‹éš›æ©Ÿå ´çš„è¨­å‚™æ–°ç©ï¼Œæœå‹™äººå“¡çš„è¦ªï¨€ï¼Œé›£æ€ªé€™äº›ï¦ï¤­
éŸ“ï§Šèƒ½å¸­æ²äºæ´²ã€‚æœƒå ´æœ‰å¾ˆå¤šï¤­è‡ª31å€‹ï¥§åŒåœ‹å®¶çš„å­¸è€…èˆ‡æœƒï¼ŒåŒ…æ‹¬ç¾åŠ 
åœ°å€ã€æ¾³æ´²ã€æ­æ´²ã€å°ï¨ã€ä¿„ï¤æ–¯ã€æ—¥æœ¬ç­‰ï¼Œä½†é‚„æ˜¯ä»¥éŸ“åœ‹äººåŠè¯äººå­¸
è€…å±…å¤šï¼Œè€Œæ‰¿è¾¦åŠæ¥å¾…äººå“¡å¹¾ä¹ï¨¦æ˜¯éŸ“åœ‹äººï¼Œä½†ä¸­åœ‹å¤§ï§“å­¸è€…åŠï§å­¸ç”Ÿ
ï¥«åŠ çš„äººï¥©å´æ¯”ä¸»è¾¦çš„éŸ“åœ‹äººé‚„å¤šï¼Œå¯ï¨Šå¤§ï§“é€™äº›ï¦ï¤­éå¸¸é‡è¦–åœ‹éš›å­¸
è¡“äº¤ï§Šã€‚25æ—¥æ™šä¸Šçš„é–‹å¹•é¤æœƒï¼Œç‚ºï¤­è‡ªä¸–ç•Œå„åœ°çš„å°ˆå®¶å­¸è€…æ´—å¡µï¼Œæœƒä¸­
ä¸¦æœ‰ç•¶åœ°ç‰¹è‰²çš„è¡¨æ¼”ï¼Œåœ¨é¤æœƒä¸­çµï§¼ï¦ºå¤§ï§“å­¸è€…åŠä¸€äº›ï¤­è‡ªå°ç£çš„ç ”ç©¶
ç”Ÿï¼Œä»–å€‘èˆ‡å¤§ï§“çš„ç ”ç©¶ç”Ÿå¾ˆå¿«å°±æ‰“æˆä¸€ç‰‡ï¼Œç•¢ç«Ÿåœ¨åœ‹å¤–çš„ç’°å¢ƒä¸­ï¼ŒåŒæ–‡
åŒç¨®æ¯”è¼ƒå®¹ï§ äº¤è«‡ã€‚ä¸‰å¤©çš„è­°ç¨‹åˆ†æˆåˆ†4çµ„åŒæ™‚é€²ï¨ˆï¼Œå…±åŒ52å€‹sessionsï¼Œ
 3
å­¸è€…åš´æ ¼å¯©æŸ¥ï¼Œå…±æœ‰399ç¯‡è¢«æ¥å—ï¼Œæ¥å—ï¥¡ç‚º29.6%ï¼Œå¯è¬‚è³ªèˆ‡ï¥¾ä¿±ä½³ã€‚
è€Œæœ¬ç ”ç©¶çš„ä¸»è¦è²¢ç»åœ¨æ–¼æ•´åˆéœæ…‹èˆ‡å‹•æ…‹çš„åˆ†ææŠ€è¡“å»è’é›†ã€åˆ†æï¦¹æ„
ç¨‹å¼çš„Portable Executable Headersï¼Œå†ï§ç”¨è³‡ï¦¾æ¢å‹˜(Data Mining) æŠ€
è¡“ï¤­èƒå–æœ‰ç”¨çš„è³‡è¨Šç•¶åšï¦¹æ„ç¨‹å¼ç‰¹å¾µï¼Œæˆ‘å€‘ä»¥è³‡ï¦¾æ¢å‹˜åŠæ©Ÿå™¨å­¸ç¿’æŠ€
è¡“çš„çµåˆï¼Œï¤­ç™¼å±•åµæ¸¬æœªçŸ¥ï¦¹æ„ç¨‹å¼ï¼ˆvirus, email worm, trojan and 
backdoorï¼‰çš„ç³»çµ±ã€‚æœ¬ï¥æ–‡å®‰æ’æ–¼åœ¨8æœˆ26æ—¥ä¸‹åˆç™¼è¡¨ï¼Œç•¶å ´ä¸¦ç²å¾—èˆ‡æœƒ
å­¸è€…è¨±å¤šå¯¶è²´çš„æ„ï¨Šã€‚ 
 
äºŒã€ èˆ‡æœƒå¿ƒå¾— 
å¤§æœƒè²»å¿ƒå®‰æ’èˆ‡çµ„ç¹”æœƒè­°å…§å®¹ï¼Œå…§å®¹æ—¢å¤šå…ƒåˆè±å¯Œã€‚é™¤ç ”ç©¶æˆæœçš„
åˆ†äº«å¤–ï¼Œäº¦æœ‰å°ˆé¡Œæ¼”è¬›ã€å£é ­å ±å‘Šã€é¤æœƒã€ç ”è¨æœƒã€å£å ±ï¥æ–‡ã€ç•¶åœ°ï¦ƒ
éŠç­‰ï¥§åŒå‹æ…‹çš„ç ”ç©¶åˆ†äº«åŠå„é …ç¤¾äº¤æ´»å‹•ï¼›ç¸½ç™¼è¡¨ï¥æ–‡æœ‰399å¤šç¯‡æ–‡
ç« ï¼Œæœ‰æ©Ÿæœƒèƒ½ï¥«èˆ‡æ­¤åœ‹éš›ç ”è¨æœƒï¼Œèˆ‡åœ‹å…§å¤–æ­¤ä¸€ï¦´åŸŸå­¸æœ‰å°ˆï¨ä¹‹å¤§å¸«åŒ
å°ç ”è¨ï¼Œèˆˆå¥®ä¹‹æƒ…æº¢æ–¼è¨€è¡¨ã€‚é›–ç„¶æœƒå ´å¾ˆå¤šè¯äººåŠéŸ“åœ‹äººï¼Œï¦¨äººæ„Ÿåˆ°ä»–
é„‰é‡æ•…çŸ¥ï¼Œä½†æˆ‘çœŸçš„å­¸ç¿’åˆ°è‹±æ–‡çœŸçš„å¾ˆé‡è¦ï¼Œæœƒå ´ï¤æ˜¯ä¸€å ´åœ‹éš›äº¤ï§Šçš„
èˆå°ï¼Œï¥´è‹±æ–‡è¡¨é”èƒ½ï¦Šï¥§å¥½ï¼Œå¦‚ä½•èˆ‡äººæºé€šå‘¢ï¼Ÿ  
å°ç£éå»åœ¨åœ‹éš›å­¸è¡“æœ‰å¾ˆå¥½çš„è¡¨ç¾ï¼Œä½†é¢ï§¶ä¸­åœ‹å¤§ï§“èˆ‡éŸ“åœ‹çš„å´›
èµ·ï¼Œå°ç£çš„å­¸è¡“åœ°ä½ä¹Ÿå—åˆ°å¾ˆå¤§çš„æŒ‘æˆ°ã€‚å€‹äººè¦ºå¾—ä¸­åœ‹å¤§ï§“èˆ‡éŸ“åœ‹çš„å­¸
è¡“ç ”ç©¶æ©Ÿæ§‹ã€é¢¨æ°£ã€èƒ½ï¦Šèˆ‡æˆæœï¼Œé€™äº›ï¦ï¤­å·²æ¯”è‡ºç£å¼·å¾ˆå¤šã€‚è€Œå¤§ï§“èˆ‡
éŸ“åœ‹çš„ï§å­¸ç”Ÿä¹Ÿå‘ä¸–ç•Œå„çŸ¥åå¤§å­¸ç™¼å±•ï¼Œè¸´èºï¥«èˆ‡åœ‹éš›ç ”è¨æœƒï¼Œå°¤å…¶ä»–
å€‘çš„ï¦ƒå¤–å­¸è€…ç›¸é—œåœ˜çµï¼ŒåŠªï¦Šçˆ­å–å„ç¨®åœ‹éš›æœƒè­°ä¸»è¾¦æ¬Šï¼Œå†å°‡ä¸‹å±†ç§»å¾€
ä¸­åœ‹å¤§ï§“èˆ‰ï¨ˆï¼Œå…§å¤–åˆä½œå·²åœ¨åœ‹éš›é–“æ‰“éŸ¿çŸ¥åï¨ï¼Œå…¶åœ¨å­¸è¡“ä¸Šä¹‹ç™¼å±•ï¼Œ
Detecting Unknown Malicious Executables Using Portable Executable Headers 
 
Tzu-Yen Wang 
Dept. of Computer Sci. 
National Chiao Tung Univ. 
Hsinchu, Taiwan 
tzu-yen.wang@hotmail.com 
 
Chin-Hsiung Wu* 
Dept. of Info. Tech. & Comm.  
Shih Chien Univ. Kaohsiung Campus, 
 Kaohsiung, Taiwan 
chwu@mail.kh.usc.edu.tw 
Chu-Cheng Hsieh 
Dept. of Computer Sci.  
Univ. of California,  
Los Angeles, USA 
chucheng@ucla.edu
 
Abstractâ€”Even though numerous kinds of anti-virus software 
packages have been used for many years, previously unseen 
malware is still a serious threat to computer and information 
system. By analyzing portable executable header entries of 
executables, a malware detection model which consists of four 
stages: attribute extraction, attribute binarization, attribute 
elimination, and feature selection and classifier training was 
carried out in this study. First, we collected header entries 
from all executables in our dataset and viewed each entry as a 
potential attribute. Second, information gain and gain ratio 
were used to binarize numerical and nominal attributes. Next, 
useless and redundant attributes were eliminated in the third 
stage. Finally, by using support vector machine which is a 
classification algorithm of conspicuous generalization ability, 
feature selection was simultaneously performed with classifier 
training to reduce the number of attributes and retain the 
performance of classifier in a cost-effective. We evaluated our 
model by 1,908 benign programs and 7,863 malicious files 
(virus, email worm, trojan and backdoor) and estimated its 
generalization ability by cross validation. The experiment 
results showed that our model had promising performance for 
detecting virus and email worm.* 
Keywords- previously unseen malware; information gain; 
gain ratio; feature selection; support vector machine 
I.  INTRODUCTION 
Malware, which refers to codes performing malicious 
activities such as crashing computer systems, jamming 
network flows and stealing personal information, etc., has 
been a notorious threat to information security for nearly 30 
years. Commercial anti-virus packages, which have been 
widely used for malware detection, seemed to be reliable to 
fight against malicious codes. In general, these commercial 
programs are based on signatures generated by both static 
analysis and dynamic analysis. Static analysis usually 
constructs signatures by segmenting the binary code 
sequences from known malware while dynamic analysis 
executes the malware in a safe environment and observes its 
own behaviors. By matching malware to those predefined 
patterns, anti-virus software could accurately detect known 
malicious codes without any false alarm. However, 
according to the report from AV-Comparatives.org1 in May 

*Corresponding author. This work was partially supported by the National 
Science Council under the contract no. NSC-97-2221-E-158-003. 
1 www.av-comparatives.org/ 
2008, the proactive detection abilities of sixteen anti-virus 
software packages were examined by detecting new 
malicious code without updating their virus definitions. The 
examination results were utterly unsatisfying that none of 
them had proactive detection rate higher than 60%. 
Therefore, the main problem of current signature-based 
method is that it is ineffective against zero-day attacks 
launched by previously unseen malicious files or even 
polymorphic ones due to the lack of virus definitions of them. 
Every minute people wait for an update of virus definitions is 
another minute that their computer is vulnerable to any 
vicious damage. Hence it is no doubt that malware is 
remaining a noticeable security challenge and the needs of 
continuing improvements in unknown malware detection 
methods are crucial. 
The goal of this research is to propose a novel model to 
detect unknown malware in Portable Executable (PE) [13] 
format since it is the most wildly distributed type of 
malicious codes. To fulfill the purpose of preventing 
malware from crashing usersâ€™ computers, we adopted static 
analysis method to exploit the information of PE headers 
entries. With the assistance of Support Vector Machine 
(SVM) [20], which is a classification algorithm of 
conspicuous generalization ability, these attributes could be 
used to construct an effective and reliable model to 
distinguish malicious executables from benign programs. 
The rest of this paper is divided into five sections. The 
first section is devoted to some related studies in the area of 
unknown malware detection. After which the second section 
sketches the content of PE header entries. This is followed 
by the methodology and procedures of our malware 
detection model. The experiment results for detecting 
unknown malware are illustrated in the next section. Finally, 
some concluding remarks and future works are made in the 
final section. 
II. RELATIVE WORKS 
Owing to the lack of proactive detection ability of 
nowadays commercial virus scanners, considerable concern 
has arisen over the field of unknown malware detection. To 
detect previously unseen malware in advance, we only 
focused on the use of static analysis methods and data 
mining techniques in this study and gave some literature 
review which is related to our work in this section. 
Schultz and Zadok [15] presented some kinds of features 
such as Dynamic Linked Libraries (DLLs), Application 
2009 Fifth International Joint Conference on INC, IMS and IDC
978-0-7695-3769-6/09 $26.00 Â© 2009 IEEE
DOI 10.1109/NCM.2009.385
278
 
Figure 2. Malware detection model 
A.  Data collection 
Due to the lack of a public dataset to evaluate our model, 
we must collect both benign and malicious executables by 
ourselves. Our dataset was made up of 1908 benign 
programs and 7863 malware (913 viruses, 808 email worms, 
2809 trojans and 3333 backdoors). All of them were PE-
formatted executable files. Those malicious binaries were 
acquired from VX Heaven2 and each of them was identify 
by Kaspersky anti-virus software3. Note that we examined 
only the loader programs for viruses; we did not include 
infected executables in our study. Besides, the benign 
programs were obtained from pure installations of Windows 
2000 and XP operating system plus several common user 
applications acquired from the web site PChome4. Similarly, 
these benign programs were also verified by the same anti-
virus software to guarantee that they were not composed of 
any malicious codes.  
B. Attribution extraction 
To characterize executables, we first utilized a tool called 
DUMPBIN which is provided by Microsoft to dump the 
entries of PE headers of each file. Viewing every header 
entry as a potential attribute, we calculated and visualized the 
number of appearance of every attribute by category and 
conducted a total census for further analyzing. An example is 
given in Table 1 and Fig. 3. 
TABLE 1. CENSUS OF HEADER ATTRIBUTES 
Entry 
Name 
Entry 
Values 
# of appearance 
Benign Virus Email Worm Trojan Backdoor
# of 
sections 
1 1 1 0 26 7 
2 23 12 18 36 19 
3 652 180 428 1186 1377 
4 517 482 153 306 290 
... ... ... ... ... ...
18 1 0 0 0 0 
1D 1 0 0 0 0 
.reloc 
section 
True 521 647 230 1060 1429 
False 1387 266 578 1746 1904 

2 vx.netlux.org 
3 www.kaspersky.com 
4 toget.pchome.com.tw
 
 
Figure 3. Visualization of header attributes. Top: The number of section. 
Bottom: Existence of reloc section. 
C. Attribute binarization 
Although SVM is able to process data of rational 
attribute values, we converted every numerical or nominal 
PE header field into a binary attribute for the sake of 
simplifying the training process. For the case of numerical 
attribute, after sorting the values of an attribute, we bisected 
the values so that a split point could be chosen if its resulting 
two intervals are purely distributed over the classes. 
Similarly, nominal attributes can also be binarized by 
repeatedly grouping all values except the one of interest 
together as a negation of this value.  
To measure the purity of intervals, two entropy-based 
methods- information gain and gain ratio were considered as 
discretization strategies. Information gain (IG), which 
computes the discrimination of an attribute, was proposed by 
Quinlan [14] in 1986. Let X be a finite set of examples, if 
there are m classes {C1, C2, ..., Cm} in X, the entropy of X is 
defined in (1), where Pi is the proportion of class i. H(X) 
measures the randomness of the distribution of examples in 
X over m possible classes. Suppose that Y = {à¬µ, à¬¶, â€¦, à­®} 
is a set of attributes and each attribute à­®  has k values 
{à¬µà­®,à¬¶à­®, ..., à­©à­®}, (2) implies the entropy of X conditioned by 
the values of à­®. Then IG is given by (3) where |à­¨à­®| is the 
number of examples in X having attribute à­®with value à­¨à­®. 
The amount of (3) reflects additional information about X 
provided by à­® . The higher the IG is, the purer of the 
distribution of examples in X over m possible classes we 
have. We modified (3) into (4) to help us to decide the 
splitting value à­±à­®  of à­®  which makes highest IG for a 
280
ÂÂƒÂšÏƒ àµ† à¬µà¬¶ß™à¯œ Ïƒ ß™à¯œß™à¯İ•à¯œİ•à¯Ü­àµ«İ”à¯œÇ¡ İ”à¯ à¯œÇ¡à¯ à¬µà¯ à¯œà­€à¬µ
 Í²Ç¡ (9) 
à¯àµ¯à­€ 
Â•Ç¤ Â–Ç¤ Ïƒ İ•à¯œß™à¯œ àµŒ Í² àµ‘ ß™à¯œ àµ‘ Ü¥à¯ à¯œà­€à¬µ  
 Ü¦áˆºİ”áˆ» àµŒ İ“à­˜İ” àµ… Ü¾ àµŒ Ïƒ ß™à¯œİ•à¯œà¯œ×à¯Œ Ü­áˆºİ”à¯œÇ¡ İ”áˆ» àµ… Ü¾ 
In this study, we directly used the RBF kernel due to the 
linear kernel is a special case of it [6] and the sigmoid kernel 
also behaves like RBF kernel for certain parameters [9]. (11) 
denotes the RBF function where ß› is the parameter of the 
RBF kernel function. 
 Ü­áˆºİ”Ç¡ İ•áˆ» àµŒ Â‡ÂšÂ’áˆºàµ†ß›Ô¡İ” àµ† İ•Ô¡à¬¶à¬¶áˆ»  
Since the deletion of a zero or little element of w does not 
affect the optimal hyperplane, the attribute corresponding to 
the element can also be deleted. Therefore, we first ranked 
all attributes by estimating their values described in (12) 
w re áˆºà¯áˆ» i h  ith v r n S  th nt set to zero. he  İ”à¯œ s t e ecto  i   with its k  eleme
   ÈŸáˆºà¯áˆ»Ô¡İ“Ô¡à¬¶ àµŒ Ïƒ ß™à¯œß™à¯İ•à¯œİ•à¯á‰„Ü­àµ«İ”à¯œÇ¡ İ”à¯àµ¯ àµ† Ü­àµ«İ”à¯œáˆºà¯áˆ»Ç¡ İ”à¯áˆºà¯áˆ»àµ¯á‰…à¯œÇ¡à¯×à¯Œ 
Finally, suppose that P is the performance of a RBF-
SVM classifier and Y is the set of attributes which has been 
process by the elimination stage as stated above. Then the 
algorithm of SVM-based feature selection in feature space is 
represented below: 
z Train a RBF-SVM classifier using all attributes in Y. 
Rank all attributes according to their ÈŸáˆºà­©áˆ»Ô¡Â™Ô¡à¬¶ in order. 
z Delete one or a number of attributes with lower rank 
from Y and denote remaining attribute set as Yâ€™. 
z Use Yâ€™ to train a RBF-SVM classifier and get the Pâ€™ of it. 
If Pâ€™Ì±P, then set P=Pâ€™ and Y=Yâ€™ and go to Step 2. 
Otherwise, stop this procedure if Pâ€™ is significantly 
degraded and define Yâ€™ as the set of selected features.  
V. EXPERIMENT RESULTS 
In this study, LIBSVM [3] was utilized for the 
implementation for SVM and the algorithm of feature 
selection was coded by ourselves. Some terms used for 
evaluated our malware detection model are listed in the 
following: 
z True Positives (TP): the number of malware correctly 
classified as malicious. 
z True Negatives (TN): the number of benign programs 
correctly classified as benign. 
z False Positives (FP): the number of benign programs 
falsely classified as malicious. 
z False Negative (FN): the number of malware falsely 
classified as benign. 
z Overall Accuracy: evaluation of the performance of a 
system. Higher TP and lower FP are necessary to be 
considered at the same time. 
z Receiver Operating Characteristic (ROC) [17] curves and 
its area under curve (AUC) were both produced to 
demonstrate the relationship between detection rate and 
 ra .  false alarm te
z True Positive Rate (Detection Rate) is defined as 
  áˆº àµ… 	áˆ»Î¤
z False Positive Rate (False Alarm) is defined as 
áˆº	 àµ… 	áˆ»Î¤   
z Overall Accuracy Rate (OA) is defined as 
áˆº àµ… áˆ» áˆº àµ…  àµ… 	 àµ… 	áˆ»Î¤  
 
The detection accuracy over previously unseen data was 
calculated by five-fold cross-validation (CV). In other words, 
the dataset were randomly divided into five disjoint 
partitions with an equal number of sizes in each partition. 
One of them was chosen as the testing set and the remaining 
four partitions were merged to be the training set. This 
procedure was repeated five times by choosing different 
partition as the testing set. The average of the five OA results 
was set as the generalization ability of our malware detection 
model.  
The results of experiment are described as follows: first 
of all, we evaluated the performance of our model without 
performing feature selection. As mentioned above, we used 
both IG and GR to binarize numerical and nominal attributes 
and got different amounts of attributes when using different 
binarization methods as shown in Table 3. Furthermore, it 
reveals that the number of attributes could be economical 
after removing useless and redundant attributes. We 
accomplished virus and email worm detection with 98.19% 
and 93.96% OA respectively. However, the results of 
84.11% and 89.54% OA indicated that there is room for 
improvement of our model in detecting trojan and backdoor. 
Next, for each kind of malware, we then chose the attribute 
set which achieved better performance in previous 
experiment for the SVM-based feature selection. Table 4 
presents the final performances of our malware detection 
model. The outcome reveals the fact that even a very few 
number of PE header features were adopted, the performance 
of our model were still retained and slightly improved. We 
only used 143 and 133 features to obtain 98.23% and 
94.07% OA for virus and email worm detection respectively. 
Similarly, the performances of trojan and backdoor 
detections were not promising enough. Finally, Fig. 5 shows 
ROC curves for detecting the four kinds of malware. 
VI. CONCLUSIONS AND FUTURE WORKS 
In conclusion, there are three contributions of this study. 
First, we proposed a model which has high accuracy in 
unknown virus and email worm detection respectively. 
Second, we can guarantee that PE header entries is a proper 
kind of resource for virus and email worm detection. Finally, 
it is noticeable that both attribute elimination and SVM-
based feature selection are useful to economize the cost of 
SVM classifier training without any decline of performance. 
In future works, since we neglected the possible effect of 
executable packing [12], we should surmount this problem to 
investigate more sophisticating information in PE file to 
improve the detection ability of trojan and backdoor. 
Moreover, it is difficult to compare our experiment results 
with other studies owing to the lack of public datasets. To 
282
