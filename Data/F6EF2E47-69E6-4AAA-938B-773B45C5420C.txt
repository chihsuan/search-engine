è‹±æ–‡é—œéµè©ï¼š simulated annealing, automated velocity picking, 
global optimization, normal move-out correction, 
common midpoint stacking. 
 
  
 
2 
global optimization method which called 
simulated annealing (SA) [4]. By using 
Metropolis criterion [5], the higher energy 
state can be accepted with certain condition. 
The method was successfully applied on 
solving many optimization problems. 
 
We propose the simulated annealing to 
optimize time-velocity pair combination. 
 
ä¸‰ã€çµæœèˆ‡è¨è«– 
 
(1) çµæœ: 
 
(a) Automated Velocity Picking By 
Simulated Annealing 
 
 
 Fig. 1. System overview. 
 
Fig. 1 shows the proposed system of 
velocity picking. Each point on a semblance 
image has a unique pair of velocity and time. 
First, we use peak-climbing clustering with 
size 3x3 to identify these local peak points. 
Moreover, from these local peak points, we 
only choose a certain number of points with 
higher semblance value. After that, we 
arrange the points with the increasing order 
of time and velocity. We use a bit string S 
with length n to represent the peak string 
encoding. The string S = {ğ‘¥1, ğ‘¥2, ğ‘¥3, â€¦ ,
ğ‘¥ğ‘›âˆ’1, ğ‘¥ğ‘›} represents a possible combination 
of these candidate points. Each ğ‘¥ğ‘–  has a bit 
value in string S. The bit value 1 means that 
the candidate point is picked; otherwise the 
candidate point is not picked. Since that, a 
bit string S with length n has 2ğ‘› possible 
combinations. In S, the points with bit value 
with 1 are linked as a polyline. 
 
We use two constrains to restrict the 
interval velocity and velocity slope in a 
candidate peak point combination. The 
internal velocity and velocity slope are 
defined as follows: 
 
Interval velocity: 
 
ğ‘‰ğ¼ ğ‘› = ï¿½ğ‘¡0,ğ‘›âˆ—ğ‘£ğ‘ ,ğ‘›2 âˆ’ğ‘¡0,ğ‘›âˆ’1âˆ—ğ‘£ğ‘ ,ğ‘›âˆ’12ğ‘¡0,ğ‘›âˆ’ğ‘¡0,ğ‘›âˆ’1       (1) 
 
Velocity slope: 
 
ğ‘‰ğ‘†ğ‘›âˆ’1,ğ‘›  = ğ‘‰ğ‘ ,ğ‘›âˆ’ğ‘‰ğ‘ ,ğ‘›âˆ’1ğ‘¡0,ğ‘›âˆ’ğ‘¡0,ğ‘›âˆ’1            (2) 
 
Where  ğ‘¡0,ğ‘› is the two-way time of layer n, 
ğ‘¡0,ğ‘›âˆ’1 is the two-way time of layer n-1, ğ‘£ğ‘ ,ğ‘›2  
is the staking velocity of layer n, ğ‘£ğ‘ ,ğ‘›âˆ’12  is 
the staking velocity of layer n-1 and 
ğ‘‰ğ‘†ğ‘›âˆ’1,ğ‘›  represents the velocity slope 
between layer n and layer n-1. The two 
constrains are the penalty and shown in (3) 
and (4). 
 
ğ›¿(ğ‘‰ğ¼ ğ‘›) =
ï¿½1, ğ‘–ğ‘“  ğ‘‰ğ¼ ğ‘› >  VI(max) ğ‘œğ‘Ÿ ğ‘‰ğ¼ ğ‘› <  VI(min) 0                                      ğ‘œğ‘¡â„ğ‘’ğ‘Ÿğ‘¤ğ‘–ğ‘ ğ‘’       (3) 
 
Î´ï¿½ğ‘‰ğ‘†ğ‘›âˆ’1,ğ‘›ï¿½ = ï¿½ 1, ğ‘–ğ‘“ ğ‘‰ğ‘†ğ‘›âˆ’1,ğ‘› > ğ‘‰ğ‘†ğ‘šğ‘ğ‘¥                ğ‘œğ‘Ÿ ğ‘‰ğ‘†ğ‘›âˆ’1,ğ‘› < ğ‘‰ğ‘†ğ‘šğ‘–ğ‘›  0                                    ğ‘œğ‘¡â„ğ‘’ğ‘Ÿğ‘¤ğ‘–ğ‘ ğ‘’  (4) 
 
where VI(max), VI(min), ğ‘‰ğ‘†ğ‘šğ‘ğ‘¥, ğ‘‰ğ‘†ğ‘šğ‘–ğ‘›are 
the predefined ranges for the two constraints. 
According to equation (1), (2), (3), and (4), 
we calculate the two constraints between 
every two adjacent picked points in string S. 
With the interval velocity constraint and the 
velocity slope constraint, the number of the 
violation of the two constraints would affect 
the picked string. 
  
 
4 
 
(b) Experimental Results 
The proposed velocity picking system is 
applied to the real seismic data at Nankai [6]. 
Table 1 and 2 show the common-mid-point 
(CMP) gather information of Nankai data. 
Table 3 shows that range of velocity 
constraint. Table 4 shows the parameters in 
SA. 
 
Table 1. Information of Nankai seismic data. 
2869 cdp traces and 2250 traces 
326 shots from 1687 to 2012 
0~69 traces per shot gather 
Offset range from -2435m to -170m 
Total 19057 traces 
401 CMP gathers from 900 to 1300 
Total time is 11 sec with 2750 time 
samples. 
0.004 sec sampling interval 
 
 
Table 2. Range of stacking velocity. 
velocitymin  (m/sec) velocitymax  (m/sec) 
1300 5000 
 
Table 3. Range of velocity constraint. 
Interval velocity 
constraint (m/sec) 
Velocity slope 
constraint 
Min max min max 
1500 5000 0 70000 
 
Table 4. Parameters in simulating annealing 
 
Because there is water layer in Nankai 
data, the two-way travel time is 
approximately 6 sec, we only perform 
picking between 5.5 sec and 11 sec. Here we 
apply the proposed  velocity picking 
system to the CMP 933 of Nankai data. Fig. 
1 shows the cooling schedule. Fig. 2 is the 
energy versus iterations. 
 
Fig. 1. Temperature versus iterations. 
 
 
Fig. 2. Energy versus iterations. 
 
Fig. 3 shows the proposed velocity 
picking result on semblance image. And Fig. 
4 shows the partial enlargement of Fig. 3. 
The color means the strength of energy. 
Thus, the red color is the higher energy. In 
the other hand, the blue color is lower 
energy. The dark circles represent the picked 
points by simulating annealing, and these 
points are connected as a polyline. 
 
 
 
Tmax Neq iter n Î± Î² Î³ 
10000 500 1500 70 5 10 0.97 
  
 
6 
 
Fig. 7. Traces of CMP 933 before NMO. 
 
 
Fig. 8. Traces of CMP 933 after NMO 
through SA velocity picking. 
 
 
 
Fig. 9. Stacked traces of CMP 933 with 
NMO through SA velocity picking. 
 
(2) è¨è«–: 
 
We propose a system that adopts the SA 
algorithm to find an optimal time-velocity 
pair combination. Also we use two 
constrains, interval velocity and velocity 
slope, as the penalty in SA. Since the SA 
picking result is close to human picking 
result, the proposed method is feasible.  
The system can be applied to other real 
seismic data in the future. Also the 
determination of the parameter setting is the 
future work. 
 
å››ã€æˆæœè‡ªè©• 
 
ç ”ç©¶å…§å®¹èˆ‡åŸè¨ˆç•«ç›¸ç¬¦ç¨‹ï¨: 100% 
é”æˆé æœŸç›®æ¨™æƒ…æ³: 100% 
ç ”ç©¶æˆæœçš„å­¸è¡“æˆ–æ‡‰ç”¨åƒ¹å€¼: 
åˆ©ç”¨æ¨¡æ“¬é€€ç«çš„å…¨åŸŸæœ€ä½³åŒ–ç‰¹æ€§é€²è¡Œ
é€Ÿï¨è‡ªå‹•é¸å–ï¼Œå°æ–¼éœ‡æ¸¬è¨Šè™Ÿè‡ªå‹•åŒ–æœ‰
å¯¦è³ªçš„è²¢ç»ã€‚ 
æ˜¯å¦é©åˆåœ¨å­¸è¡“æœŸåˆŠç™¼è¡¨: æ˜¯ 
ä¸»è¦ç™¼ç¾æˆ–å…¶ä»–æœ‰é—œåƒ¹å€¼: 
1.æ‰€å¾—è‡ªå‹•åŒ–çµæœå¯é€²ä¸€æ­¥ç”¨åœ¨éœ‡æ¸¬
è³‡æ–™è™•ç†èˆ‡éœ‡æ¸¬è§£é‡‹ã€‚ 
2.å¯æ‡‰ç”¨ simulating annealing æ–¼å…¶ä»–
æœ€ä½³åŒ–å•é¡Œä¸Šï¼Œå¦‚ pattern detectionã€‚ 
 
äº”ã€åƒè€ƒæ–‡ç» 
 
[1] J. Schmidt and F. A. Hadsell, "Neural 
network stacking velocity picking," SEG 
Technical Program Expanded Abstracts, 
vol. 11, pp. 18-21, 1992.  
[2] B. C. Fish and T. Kusuma, "A neural 
network approach to automate velocity 
picking," SEG Technical Program 
Expanded Abstracts, vol. 13. pp. 
185-188, 1994.  
[3] J. R. Beveridge, C. Ross, D. Whitely, 
and B. Fish, "Augmented geophysical 
data interpretation through automated 
velocity picking in semblance velocity 
images," Machine Vision and 
Applications 13, pp. 141-148, 2002. 
è¡¨ Y04 
è¡Œæ”¿é™¢åœ‹å®¶ç§‘å­¸å§”å“¡æœƒè£œåŠ©åœ‹å…§å°ˆå®¶å­¸è€…å‡ºå¸­åœ‹éš›å­¸è¡“æœƒè­°å ±å‘Š 
                                                           100å¹´ 10 æœˆ 12 æ—¥ 
å ±å‘Šäººå§“å  
é»ƒåœ‹æº 
 
æœå‹™æ©Ÿæ§‹ 
åŠè·ç¨± 
 
äº¤é€šå¤§å­¸è³‡è¨Šå·¥ç¨‹ç³»  æ•™æˆ 
 
     æ™‚é–“ 
æœƒè­° 
     åœ°é» 
100 å¹´ 7 æœˆ 24 æ—¥è‡³ 29 æ—¥ 
åŠ æ‹¿å¤§çš„ Vancouver 
æœ¬æœƒæ ¸å®š 
è£œåŠ©æ–‡è™Ÿ 
 
è¨ˆç•« NSC99-2221-E-009-134 
æœƒè­° 
åç¨± 
(ä¸­æ–‡) 2011 å¹´åœ‹éš›é›»æ©Ÿèˆ‡é›»å­å·¥ç¨‹å¸«å­¸æœƒåœ°çƒç§‘å­¸èˆ‡é™æ¸¬æœƒè­° 
(è‹±æ–‡) 2011 IEEE International Geoscience & Remote Sensing Symposium 
ç™¼è¡¨ 
è«–æ–‡ 
é¡Œç›® 
(ä¸­æ–‡)éå¸¸å¿«é€Ÿé€€ç«éç¨‹æ–¼åœ–å½¢åµæ¸¬åŠéœ‡æ¸¬æ‡‰ç”¨ 
(è‹±æ–‡) Very Fast simulated Annealing for Pattern Detection and       
Seismic Applications 
å ±å‘Šå…§å®¹æ‡‰åŒ…æ‹¬ä¸‹åˆ—å„é …ï¼š 
ä¸€ã€åƒåŠ æœƒè­°ç¶“é              <<å ±å‘Šæ›¸å¦‚ä¸‹é >> 
 
 
 
 
äºŒã€èˆ‡æœƒå¿ƒå¾— 
 
 
 
 
ä¸‰ã€è€ƒå¯Ÿåƒè§€æ´»å‹•(ç„¡æ˜¯é …æ´»å‹•è€…çœç•¥) 
 
 
 
å››ã€å»ºè­° 
 
 
 
äº”ã€æ”œå›è³‡æ–™åç¨±åŠå…§å®¹ 
 
 
 
å…­ã€å…¶ä»– 
 
 
 
 
 
è¡¨ Y04 
äºŒã€ èˆ‡æœƒå¿ƒå¾— 
 
 ç¾åœ‹ã€åŠ æ‹¿å¤§ã€æ­æ´²ã€åŠæ—¥æœ¬ç­‰å…ˆé€²åœ‹å®¶ç›¸ç•¶é‡è¦– Geoscience & Remote 
Sensing ä¹‹ç ”ç©¶ï¼Œç™¼è¡¨çš„è«–æ–‡ç›¸ç•¶å¤šã€‚å…¨çƒç½å®³å¤šï¼Œæ—¥æœ¬311å¤§åœ°éœ‡å¾Œï¼Œæ›´é¡¯å¾—
é€™ä¸€é ˜åŸŸä¹‹é‡è¦æ€§ã€‚å‡ºå¸­æ­¤æ¬¡æœƒè­°èˆ‡å¤§å¸«ç´šçš„å­¸è€…å°ˆå®¶è¨è«–ç ”ç©¶å¿ƒå¾—ï¼Œæ©Ÿæœƒç›¸
ç•¶é›£å¾—ï¼Œè€Œä¸”è½æ¼”è¬›åŠç•¶å ´çš„è¨è«–ï¼Œæ•ˆæœç›¸ç•¶è‰¯å¥½ã€‚å¢å»£è¦‹èï¼Œç²ç›Šè‰¯å¤šã€‚ 
  
ä¸‰ã€ è€ƒå¯Ÿåƒè§€æ´»å‹•ï¼šç„¡ 
 
å››ã€ å»ºè­°ï¼šç„¡ 
 
äº”ã€ æ”œå›è³‡æ–™åç¨±åŠå…§å®¹ 
 
 æ”œå›è³‡æ–™ç‚ºæ­¤æ¬¡æœƒè­°çš„Programï¼Œä¸¦æ”œå›DVDä¸€å€‹ï¼Œç‚º IGARSS 2011 
Proceedingsã€‚ 
 
å…­ã€ å…¶ä»–ï¼šç„¡ 
 
 
 
VERY FAST SIMULATED ANNEALING FOR PATTERN DETECTION AND SEISMIC 
APPLICATIONS 
 
Kou-Yuan Huang and Yueh-Hsun Hsieh 
  Department of Computer Science, National Chiao Tung University, Hsinchu, Taiwan 
E-mail: kyhuang@cs.nctu.edu.tw 
 
ABSTRACT 
 
We use three global optimization methods in the pattern 
parameter detection system, including simulated annealing 
(SA), fast simulated annealing (FSA) and very fast 
simulated annealing (VFSA). The sequential pattern 
parameter detection system can detect three types of patterns 
that include the lines, hyperbolas and ellipses in image. We 
use steps in the parameter detection for reducing the 
computation and getting fast convergence. This system has 
the capability of searching pattern parameter vectors with 
global minimal distance between the patterns and the image 
data. After the system is successful in image pattern 
detection, we apply it to detect the parameters of the 
hyperbolic patterns on real one-shot seismogram and 
seismic common depth point (CDP) gather data. This 
procedure provides an automatic velocity analysis method 
and improves the seismic interpretation and further seismic 
data processing. 
 
Index Termsâ€”simulated annealing, fast simulated 
annealing, very fast simulated annealing, common depth 
point(CDP), velocity analysis. 
 
1. INTRODUCTION 
 
A one-shot seismogram consists of line pattern of direct 
wave and hyperbolic pattern of reflection wave [1]-[3]. 
There are hyperbolic patterns on seismic CDP gathers [4]. In 
1985, Huang et al. had applied Hough transform (HT) to 
detect hyperbolic pattern of reflection wave [5]. In 2002, 
Hough transform neural network (HTNN) was proposed to 
detect lines, circles, and ellipses, but it did not detect 
hyperbolas [6]. In 2006, Huang et al. adopted HTNN to 
detect lines of direct wave and hyperbola of reflection wave 
in a one-shot seismogram [7]. But the gradient descent 
method in HTNN had local minimum problem. In 2009, 
Huang and Chou detect CDP gathers by simulated annealing 
algorithm [8]. 
In 1983, Kirkpatrick et al. proposed SA [9]. It is a global 
optimization algorithm. The key of the algorithm to reach 
the global minimum is in conditionally accepting higher-
energy states by Metropolis criterion [10]. Harold Szu and 
Ralph Hartley proposed the FSA in 1987 [11]. Lester Ingber 
proposed the VFSA in 1989 [12]-[13].  Both of them have 
faster convergence than SA. 
We use three global optimization methods in the seismic 
pattern detection system. The seismic pattern detection 
system can detect line pattern of direct wave and hyperbolic 
pattern of reflection wave on real one-shot seismogram. We 
also apply it to detect the parameters of the hyperbolic 
patterns on seismic common depth point (CDP) gather data. 
 
2. METHOD PROPOSED: SEISMIC PATTERN 
DETECTION SYSTEM 
 
2.1. Parametric patterns 
 
We propose the seismic pattern detection system in Fig. 1. 
First, we preprocess the seismic data by thresholding for 
input seismic data. It takes the N data as the input from the 
preprocessed image, then through the seismic pattern 
detection system to detect a set of parameter vectors of K 
patterns. After convergence, patterns are recovered from the 
detected parameter vectors.   
 
 
Input N data in 
seismic image 
Seismic pattern detection 
system 
Detected  
parameters 
Recovered 
K patterns 
Fig. 1. Block diagram of the seismic pattern detection 
system. 
 
We use a general equation based on the translation and 
rotation of the standard type of hyperbola. 
2
2
[( )cos ( )sin ]
      [ ( )sin ( )cos ]
x y
x y
a x m y m
b x m y m f
T T
T T
   
     
 (1) 
where (mx, my) is the center, a and b are the shape 
parameters, Î¸ is the rotation angle and  f is the size of the 
pattern.  
In vector form, a parameter vector p = [mx, my, a, b, Î¸, f]T 
represents a pattern. For the kth pattern, pK = [mk,x, mk,y, ak, bk, 
Î¸k, fk]T, and for all K patterns, the matrix P = [p1, p2, â€¦, pK] 
represents all K patterns. When (a > 0, b < 0, and f â‰  0) or (a 
< 0, b > 0, and f â‰  0) the graph is a hyperbola. 
 
2.2. System error 
 
For the error or energy of the system, we define the distance 
from a point xi = [xi, yi]T to the kth pattern.  
499978-1-4577-1005-6/11/$26.00 Â©2011 IEEE IGARSS 2011
We obtain seismic data from Seismic Unix System [4]. The 
real data in Fig. 2(a) is at Canadian Artic. It has 48 traces 
and 3,100 samples per trace with sampling interval 0.002 
seconds. The seismogram passes through the preprocessing 
that includes envelope processing, peak detection, and 
thresholding. We choose points with t < 1.4 seconds, which 
includes points from direct wave, first layer reflection wave, 
and second layer reflection wave as in Fig. 2(b). Fig. 2(b) is 
the input to the seismic pattern detection system. Fig.3, Fig. 
4 and Fig. 5 are the detection results by SA, FSA and VFSA. 
 
 
(a) 
 
(b) 
Fig. 2. (a) Real seismic data at Canadian Artic. (b) After 
preprocessing, choose peaks with t < 1.4 seconds as input 
image. 
 
 
Fig. 3. Final result by SA detection system. 
 
Fig. 4. Final result by FSA detection system. 
 
Fig. 5. Final result by VFSA detection system. 
 
3.2. Experiments on CDP gather and velocity analysis  
 
First, we built a 5 layer earth model; each layer has different 
interval velocity. Then we obtain the CDP gather from 40 
shot records. Second, we detect the parameters of hyperbolic 
pattern on the CDP gather, as shown in Fig. 6 and Fig. 7. 
The parameters are used to calculate the root-mean-squared 
velocity Vrms. Finally, we use the Vrms to do the NMO 
correction and stacking. After NMO and stacking, each CDP 
gather become a trace. We collect the total traces to stack 
the seismic signal, as shown in Fig. 8. Fig 8(a) is the stacked 
seismic signal by the conventional VSPEC method. Fig 8(b), 
Fig 8(c) and Fig 8(d) are the stacked seismic signal by SA, 
FSA and VFSA. 
 
 
(a)               (b) 
Fig. 6. (a) CDP gather after processing. (b) Final result by 
SA detection system.  
501
åœ‹ç§‘æœƒè£œåŠ©è¨ˆç•«è¡ç”Ÿç ”ç™¼æˆæœæ¨å»£è³‡æ–™è¡¨
æ—¥æœŸ:2011/12/30
åœ‹ç§‘æœƒè£œåŠ©è¨ˆç•«
è¨ˆç•«åç¨±: æ¨¡æ“¬é€€ç«ç³»çµ±æ–¼éœ‡æ¸¬é€Ÿåº¦é¸å–ä¹‹æœ€ä½³åŒ–ä¹‹ç ”ç©¶
è¨ˆç•«ä¸»æŒäºº: é»ƒåœ‹æº
è¨ˆç•«ç·¨è™Ÿ: 99-2221-E-009-134- å­¸é–€é ˜åŸŸ: åœ–å½¢è¾¨è­˜
ç„¡ç ”ç™¼æˆæœæ¨å»£è³‡æ–™
å…¶ä»–æˆæœ 
(ç„¡æ³•ä»¥é‡åŒ–è¡¨é”ä¹‹æˆ
æœå¦‚è¾¦ç†å­¸è¡“æ´»å‹•ã€ç²
å¾—çé …ã€é‡è¦åœ‹éš›åˆ
ä½œã€ç ”ç©¶æˆæœåœ‹éš›å½±éŸ¿
åŠ›åŠå…¶ä»–å”åŠ©ç”¢æ¥­æŠ€
è¡“ç™¼å±•ä¹‹å…·é«”æ•ˆç›Šäº‹
é …ç­‰ï¼Œè«‹ä»¥æ–‡å­—æ•˜è¿°å¡«
åˆ—ã€‚) 
ç„¡ 
 æˆæœé …ç›® é‡åŒ– åç¨±æˆ–å…§å®¹æ€§è³ªç°¡è¿° 
æ¸¬é©—å·¥å…·(å«è³ªæ€§èˆ‡é‡æ€§) 0  
èª²ç¨‹/æ¨¡çµ„ 0  
é›»è…¦åŠç¶²è·¯ç³»çµ±æˆ–å·¥å…· 0  
æ•™æ 0  
èˆ‰è¾¦ä¹‹æ´»å‹•/ç«¶è³½ 0  
ç ”è¨æœƒ/å·¥ä½œåŠ 0  
é›»å­å ±ã€ç¶²ç«™ 0  
ç§‘ 
æ•™ 
è™• 
è¨ˆ 
ç•« 
åŠ  
å¡« 
é … 
ç›® è¨ˆç•«æˆæœæ¨å»£ä¹‹åƒèˆ‡ï¼ˆé–±è½ï¼‰äººæ•¸ 0  
 
